<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<link rel="top" title="Home" href="http://www.mozilla.org/">
<link rel="stylesheet" type="text/css" href="../../css/print.css"  media="print">
<link rel="stylesheet" type="text/css" href="../../css/base/content.css"  media="all">
<link rel="stylesheet" type="text/css" href="../../css/cavendish/content.css" title="Cavendish" media="screen">
<link rel="stylesheet" type="text/css" href="../../css/base/template.css"  media="screen">
<link rel="stylesheet" type="text/css" href="../../css/cavendish/template.css" title="Cavendish" media="screen">
<link rel="icon" href="../../images/mozilla-16.png" type="image/png">

 <title>The Tree Widget</title>
 <link rel="content" href="./">
 <link rel="prev" href="buttons.html">
 <link rel="next" href="tabs.html">
<script src="../../__utm.js" type="text/javascript"></script>
</head>
<body id="www-mozilla-org" class="deepLevel">
<div id="container">
<p class="important">You are currently viewing a snapshot of www.mozilla.org taken on April 21, 2008. Most of this content is
highly out of date (some pages haven't been updated since the project began in 1998) and exists for historical purposes only.  If
there are any pages on this archive site that you think should be added back to www.mozilla.org, please <a
href="https://bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=www.mozilla.org">file a bug</a>.</p>
<p class="skipLink"><a href="#mainContent" accesskey="2">Skip to main content</a></p>
<div id="header">
<h1><a href="/" title="Return to home page" accesskey="1">Mozilla</a></h1>
<ul>
<li id="menu_aboutus"><a href="../../about/" title="Getting the most out of your online experience">About</a></li>
<li id="menu_developers"><a href="../../developer/" title="Using Mozilla's products for your own applications">Developers</a></li>
<li id="menu_store"><a href="http://store.mozilla.org/?r=mozorg1" title="Shop for Mozilla products on CD and other merchandise">Store</a></li>
<li id="menu_support"><a href="../../support/" title="Installation, trouble-shooting, and the knowledge base">Support</a></li>
<li id="menu_products"><a href="../../products/" title="All software Mozilla currently offers">Products</a></li>
</ul>
<form id="searchbox_002443141534113389537:ysdmevkkknw" action="http://www.google.com/cse" title="mozilla.org Search">
<div>
<label for="q" title="Search mozilla.org's sites">search mozilla:</label>
<input type="hidden" name="cx" value="002443141534113389537:ysdmevkkknw">
<input type="hidden" name="cof" value="FORID:0">
<input type="text" id="q" name="q" accesskey="s" size="30">
<input type="submit" id="submit" value="Go">
</div>
</form>
</div>
<hr class="hide">
<div id="mBody">
<div id="side">

<ul id="nav">
<li><a title="Roadmap" href="../../roadmap.html"><strong> Roadmap</strong></a></li>
<li><a title="Projects" href="../../projects/"><strong> Projects</strong></a></li>
<li><a title="For developers" href="../../developer/"><strong> Coding</strong></a>
<ul>
<li><a title="Module Owners" href="../../owners.html"> Module Owners</a></li>
<li><a title="Hacking" href="../../hacking/"> Hacking</a></li>
<li><a title="Get the Source" href="http://developer.mozilla.org/en/docs/Download_Mozilla_Source_Code"> Get the Source</a></li>
<li><a title="Building Mozilla" href="http://developer.mozilla.org/en/docs/Build_Documentation"> Build It</a></li>
</ul>
</li>
<li><a title="Testing" href="../../quality/"><strong> Testing</strong></a>
<ul>
<li><a title="Downloads of mozilla.org software releases" href="../../download.html"> Releases</a></li>
<li><a title="Latest mozilla builds for testers" href="../../developer/#builds"> Nightly Builds</a></li>
<li><a title="For testers to report bugs" href="https://bugzilla.mozilla.org/"> Report A Problem</a></li>
</ul>
</li>
<li><a title="Tools for mozilla developers" href="../../tools.html"><strong> Tools</strong></a>
<ul>
<li><a title="Bug tracking system for mozilla testers." href="https://bugzilla.mozilla.org/"> Bugzilla</a></li>
<li><a title="Latest status of mozilla builds" href="http://tinderbox.mozilla.org/showbuilds.cgi?tree=Firefox"> Tinderbox</a></li>
<li><a title="Latest checkins" href="http://bonsai.mozilla.org/cvsqueryform.cgi"> Bonsai</a></li>
<li><a title="Source cross reference" href="http://lxr.mozilla.org/seamonkey/"> LXR</a></li>
</ul>
</li>
<li><a title="Frequently Asked Questions." href="../../faq.html"><strong> FAQs</strong></a></li>
</ul>

</div>
<hr class="hide">
<div id="mainContent">




 <h1>The Tree Widget</h1>
 <ul class="snav">
  <li><a href="buttons.html">Previous: Titled Buttons</a>
  <li><a href="./">Table of Contents</a>
  <li><a href="tabs.html">Next: Tab Widget</a>
 </ul>
 <dl> 
  <dt>Feature Owner
  <dd><a href="mailto:hyatt@netscape.com">David Hyatt</a>
 </dl>
 <p>The tree widget provides the ability to display multiple
  items in a tabular format. Each item is represented as a row
  in the table. Each row may consist of multiple <dfn>cells</dfn>.
  A tree widget has all the same components as an HTML table,
  and any users of this widget should be thoroughly familiar
  with the capabilites of
  <a href="http://www.w3.org/TR/REC-html40/struct/tables.html">HTML
  tables</a>. Trees can also respond to all of the same
  CSS properties as HTML tables, as documented in the
  <a href="http://www.w3.org/TR/REC-CSS2/tables.html">CSS2
  spec on tables</a>.
 <p>The following tags are roughly analogous to their HTML
  table counterparts.
 <table class="data">
  <tr>
   <th><code>table</code>
   <th><code>tree</code>
  <tr>
   <td><code>table</code>
   <td><code>tree</code>
  <tr>
   <td><code>caption</code>
   <td><code>treecaption</code>
  <tr>
   <td><code>colgroup</code>
   <td><code>treecolgroup</code>
  <tr>
   <td><code>col</code>
   <td><code>treecol</code>
  <tr>
   <td><code>thead</code>
   <td><code>treehead</code>
  <tr>
   <td><code>tbody</code>
   <td><code>treechildren, treeitem</code>
  <tr>
   <td><code>tfoot</code>
   <td><code>treefoot</code>
  <tr>
   <td><code>tr</code>
   <td><code>treerow</code>
  <tr>
   <td><code>td</code>
   <td><code>treecell</code>
 </table>
 <p>To insert a tree widget into a document, use the
  <code>tree</code> tag. This tag is analogous
  to the <code>table</code> tag in HTML.
 <p>The tree widget can contain a caption, which can be
  specified using the <code>treecaption</code>
  tag.
 <p>The tree's column information can be specified using the
  <code>treecolgroup</code> and
  <code>treecol</code> tags; these tags
  respond to all the same properties that the HTML
  <code>col</code> tags do. These column tags
  can be used to specify column widths and to apply styles to
  individual columns in the tree view. Tree column tags can
  respond to an additional CSS property,
  <code>column-layout</code>, which indicates
  whether or not this column's size is alterable using the
  tree's column resizing capabilities. It has values of fixed
  and flexible, with the default being flexible.
  <span class="remark">This is not yet
  implemented.</span>
 <p>A tree can contain headers, bodies, and footers, just as
  a table does. <span class="remark">Not yet
  implemented, but coming online soon, so pay
  attention.</span> A tree widget's body, unlike a
  table's body will constrain itself when the height of the
  table is constrained.
 <p>The <code>treeitem</code> tag is used to
  declare a single item (along with that item's row and
  children) in the tree. The tree item contains one or more
  rows, which are specified using the
  <code>treerow</code> tag. Each row consists
  of one or more cells, which are specified using the
  <code>treecell</code> tag.
 <pre class="code">&lt;tree&gt;
  &lt;treehead&gt;
    &lt;treerow&gt;
      &lt;treecell&gt;Name&lt;/treecell&gt;
      &lt;treecell&gt;URL&lt;/treecell&gt;
    &lt;/treerow&gt;
  &lt;/treehead&gt;
  &lt;treechildren&gt;
    &lt;treeitem&gt;
	  &lt;treerow&gt;
        &lt;treecell&gt;Netscape Home Page&lt;/treecell&gt;
        &lt;treecell&gt;http://www.netscape.com&lt;/treecell&gt;
      &lt;/treerow&gt;
	&lt;/treeitem&gt;
  &lt;/treechildren&gt;
&lt;/tree&gt;</pre>
 <p>Tree items are either open or closed, and their state is
  specified using the <code>open</code>
  attribute. This attribute, when set to true, indicates that
  the tree item's children should be displayed in the tree. If
  it is set to false, or if it isn't set at all, then the tree
  item's children are not displayed.
 <p>A tree item's children are specified using the
  <code>treechildren</code> tag, which is
  placed within the parent
  <code>treeitem</code> tag. The
  <code>treechildren</code> tag contains tree
  items that represent the children of the parent node.
 <pre class="code">&lt;tree&gt;
  &lt;treehead&gt;
    &lt;treerow&gt;
      &lt;treecell&gt;Name&lt;/treecell&gt;
      &lt;treecell&gt;URL&lt;/treecell&gt;
    &lt;/treeitem&gt;
  &lt;/treerow&gt;
  &lt;treechildren&gt;
    &lt;treeitem&gt;
	  &lt;treerow&gt;
        &lt;treecell&gt;Netscape Bookmarks Folder&lt;/treecell&gt;
        &lt;treecell/&gt;
      &lt;/treerow&gt;
      &lt;treechildren&gt;
        &lt;treeitem&gt;
		  &lt;treerow&gt;
	        &lt;treecell&gt;Netscape Home Page&lt;/treecell&gt;
	        &lt;treecell&gt;http://www.netscape.com&lt;/treecell&gt;
		  &lt;/treerow&gt;
        &lt;/treeitem&gt;
      &lt;/treechildren&gt;
    &lt;/treeitem&gt;
  &lt;/treechildren&gt;
&lt;/tree&gt;</pre>
 <p>The tree automatically handles selection, and it is
  capable of supporting single and multiple selection (through
  the use of CTRL/command and SHIFT modifier keys). The tree's
  selection is reflected into the content model. Tree items
  that are selected have an attribute called
  <code>selected</code> set to true. Tree rows
  that are selected have an attribute called
  <code>selectedrow</code> set. Tree cells
  that are selected have an attribute called
  <code>selectedcell</code> that is set to
  true. CSS can be applied using attribute selector rules,
  thus enabling the tree designer to control the look of the
  tree's selection.
 <p>A <code>select</code> handler can be
  attached to the tree, and this handler will be invoked
  whenever the tree's selection changes. You can either add it
  as an attribute (e.g.,
  <code>onselect</code>) on the
  <code>tree</code> tag or add it using the
  DOM <code>addEventListener</code>
  method.
 <p>The tree widget also supports hover feedback on items and
  cells. This hover feedback is also reflected into the
  content model. Tree items that are currently moused over
  have an attribute called <code>hover</code>
  set to true. Tree cells that are being moused over have an
  attribute called <code>hover</code> set to
  true. Tree rows also use <code>hover</code>.
  CSS can be applied using attribute selector rules, which
  enable control of the hover feedback effects for the tree.
  <span class="remark">This will probably change to use
  the :hover mechanism at some point, assuming some sort of
  bubbling mechanism for hover is determined.</span>
 <p>Because the tree handles selection, events that would
  normally go to the content inside the cell are intercepted
  by the cell. This behavior can be turned off on a cell by
  cell basis by setting the
  <code>treeallowevents</code> attribute on
  the cell. This attribute, when set to true, indicates that
  the cell is unselectable, and that the content inside should
  receive events (like mouse clicks and keystrokes).
 <p>To selectively allow events to go to cell content (e.g.,
  a button inside a cell), the
  <code>treeallowevents</code> attribute can
  be placed on a node that is a descendant of the cell.
 <p>The tree widget supports a selection API that can be used
  to modify its current selection. This API is outlined
  below.
 <pre class="code">interface XULTreeElement : XULElement {
  readonly attribute NodeList selectedItems;
  readonly attribute NodeList selectedCells;
                  
  void selectItem(in XULElement treeItem);
  void selectCell(in XULElement treeCell);
                  
  void clearItemSelection();
  void clearCellSelection();
                  
  void addItemToSelection(in XULElement treeItem);
  void removeItemFromSelection(in XULElement treeItem);
                  
  void addCellToSelection(in XULElement treeCell);
  void removeCellFromSelection(in XULElement treeCell);
                  
  void toggleItemSelection(in XULElement treeItem);
  void toggleCellSelection(in XULElement treeCell);
                  
  void selectItemRange(in XULElement startItem, in XULElement endItem);
  void selectCellRange(in XULElement startItem, in XULElement endItem);
                  
  void selectAll();
  void invertSelection();
};</pre>
 <p>Content in a tree cell can be automatically indented
  based on the node's level in the tree by using the
  <code>treeindentation</code> tag. The
  indentation tag can have a
  <code>width</code> property applied to it
  using CSS, and this property is multiplied by the node's
  level of indentation to determine how much padding to
  insert. The default if no property is specified is 16 pixels
  per level. <span class="remark">Style support for
  treeindentation is not yet implemented.</span>
 <h2>Answers to Common Questions</h2>
 <dl>
  <dt>How do I give column headers a visually distinct
   look?
  <dd>
   <p>You can make a CSS rule like the following to apply a look
    only to cells inside the head of the table.
   <pre class="code">treehead &gt; treerow &gt; treecell { ... }</pre>
  <dt>Can I set the widths of my columns using
   percentages?
  <dd>Yes. Click <a href="http://www.w3.org/TR/REC-html40/struct/tables.html#h-11.2.4.4">here</a>
   for details.
  <dt>I don't want the text in my tree cells to wrap. What
   do I do?
  <dd>Set the <code>whitespace</code> property
   on your tree cells in CSS to a value of nowrap. Then
   constrain the width of your tree (e.g., give your tree a
   width of 100%). Once you have done this, the contents of the
   cells will be clipped.
  <dt>I would like the text in my tree cells to be cropped
   in addition to being clipped. What do I do?
  <dd>
   <p><span class="remark">Not yet
    implemented.</span> You will be able to specify this
    through CSS. If the <code>nowrap</code>
    property is set and an additional <code>
    cropstyle</code> property is set (whose value can be left,
    middle, or right), then the text in the cell can be made to
    crop.
   <p>A temporary workaround to get this feature working would
    be to use titled buttons to hold the text. (See <a href="buttons.html">Titled
    Buttons</a> for details.) Titled buttons already know how to
    crop right by default when their widths are constrained.
  <dt>I want to use the same event handler for all items in
   my tree, but I don't want to define these handlers over and
   over on each node. What do I do?
  <dd>
   <p>Take advantage of the DOM's event handling capabilities.
    You can allow events to bubble up to your
    <code>tree</code> node, and handle the
    events there. The target of an event that bubbles up can be
    retrieved using <code>evt.target</code>.
   <p>When using bubbling on a tree view, it is important to
    remember that the events will bubble from child node to
    parent node. Don't think of it like a table, where the
    events will always go from cell to row to body. If a node is
    11 levels deep, then the event will bubble out through the
    node's parents before getting to the tree body. Be aware of
    this distinction when writing event-handling code.
  <dt>How do I make the tree's body scroll independently of
   the header/footer?
  <dd>Constrain the height of the tree and this overflow will
   happen automatically when there are too many items to fit in
   the displayable area. Boxes can be used to make the tree
   springy (and to make the tree be sized to the width and
   height of a window).
  <dt>How do I make clickable graphical cell contents like
   in Messenger (flags, checks, etc.)?
  <dd>Use <a href="buttons.html">Titled Buttons</a>. In the
   click handler for the button, set an attribute on the button
   to cycle through the various states. Use attribute selector
   rules for each possible attribute value to set up different
   images for each state of the button. If desired, the
   button's border can even be hidden using CSS.
  <dt>How do I hide columns?
  <dd>You can read about this capability <a href="http://www.w3.org/TR/REC-CSS2/tables.html#q4">here</a>.
  <dt>I want to do "insert my
   feature here" with the tree, but I don't know
   where to start!
  <dd>It is important to remember that a tree is an extended
   table, and therefore many of its capabilities are inherited
   from tables. Make sure you read the CSS2 and HTML specs on
   tables (links are at the top of this page) to see if your
   question is answered there.
 </dl>
 <h2 id=DD>Tree Drag &amp; Drop</h2>
 <p>The main thing to remember during a tree drag is that the
  event <code>target</code> will be a tree
  cell, but all of the information about the drag is done at
  the tree item level. This requires going up two levels in
  the content tree from the target.
 <h3>Tracking During The Drag</h3>
 <p>The tree item makes use of a DOM event capturer to
  annotate the item's content node with information about
  where the drag will go in order to draw the correct drop
  feedback.
 <p>The tree needs a little help from the
  <code>ondragover</code> event handler to
  trigger the drop feedback magic. The capturer always
  annotates the tree item with various attributes, but it
  might not be valid to drop on the tree based on the contents
  of the drag. When the event handler determines that a drag
  is valid, it needs to touch the
  <code>dd-triggerrepaint</code> attribute on
  the tree item which triggers a repaint with the correct drop
  feedback. By not touching this attribute, the item will not
  redraw and this prevents the feedback from appearing. If you
  don't want drop feedback at all, this is how you'd
  accomplish it.
 <pre class="code">function DragOverTree ( event )
{
  var validFlavor = false;
  var dragSession = null;
                  
  var dragService = 
    Components.classes&#91;"component://netscape/widget/dragservice"&#93;.getService(Components.interfaces.nsIDragService);
  if ( dragService ) {
    dragSession = dragService.getCurrentSession();
    if ( dragSession ) {
      if ( dragSession.isDataFlavorSupported("moz/toolbaritem") )
        validFlavor = true;
      else if ( dragSession.isDataFlavorSupported("text/plain") )
        validFlavor = true;
      //XXX other flavors here...
                  
      // touch the attribute on the rowgroup to trigger the repaint with the drop feedback.
      if ( validFlavor ) {
        var treeItem = event.target.parentNode.parentNode;
        treeItem.setAttribute ( "dd-triggerrepaint", 0 );
        dragSession.canDrop = true;
                  
        event.preventBubble();
      }
    }
  }
                  
} // DragOverTree</pre>
 <h3>Determining Where To Drop</h3>
 <p>Instead of placing an
  <code>ondragdrop</code> event handler on
  every single tree item, it's easiest to place one on the
  topmost <code>tree</code> tag and use the
  <code>target</code> of the event to find the
  actual drop location. Remember that the tree cell is the
  actual target and you need to go up two levels to get the to
  correct tree item.
 <p>The event capturer sets two attributes on the target tree
  item during the drag tracking which are useful when the user
  finally releases the mouse over the tree. The first is
  <code>dd-droplocation</code> which a boolean
  which when true indicates that the drop should go
  <strong>before</strong> this tree item. If it is false, the drop
  should go <strong>after</strong>. The second attribute,
  <code>dd-dropon</code>, tells if the drop
  should go on (or into) a container on the tree. When
  this is true, <code>dd-droplocation</code>
  is undefined.
 <p>The tree item determines if something is a container by
  checking the <code>container</code>
  attribute of the content node, and determines if it is open
  by checking the <code>open</code>
  attribute.
 <h4>Very Important</h4>
 <p>When the target of the drop is a container and the
  <code>dd-droplocation</code> is false
  (meaning after), you must check if the container is open and
  do different things in each situation. If the container is
  open, the dropped item should be placed as the first child
  of the container. If the container is closed, the item
  should be placed after the container, as its sibling.
 <p>There really isn't a good way to hide this situation
  within the implementation of the tree because we're not
  allowed to change event.target after the fact. As a result,
  all JS implementors need to take this into account. A good
  wrapper layer could hide this detail from average users
  (hint hint).
 <p>Here's a simple example which demonstrates how to get the
  before/after/on information for a handler registered on the
  tree as a whole.
 <pre class="code">&lt;tree id="bookmarksTree" ref="NC:BookmarksRoot" context="contextual"
   datasources="rdf:bookmarks rdf:files rdf:ftp rdf:localsearch rdf:internetsearch"
   ondragdrop="return DropOnTree(event);"&gt;</pre>
 <pre class="code">function DropOnTree ( event )
{
  // id (url) is on the &lt;treeitem&gt; which is two levels above the &lt;treecell&gt; which is
  // the target of the event.
  var treeItem = event.target.parentNode.parentNode;
  var id = treeItem.getAttribute("id");
  var dropBefore = treeItem.getAttribute("dd-droplocation");
  var dropOn = treeItem.getAttribute("dd-dropon");
  dump("**** before is " + dropBefore + " on is " + dropOn + "\n");
  var beforeString = "before";
  if ( dropBefore == "false" )
    beforeString = "after";
  dump ( "*** tree drop " + beforeString + " target &#91;" + id + "&#93;\n" );
        
  event.preventBubble();
}</pre>
 <h3>Customizing Drop Feedback</h3>
 <p>The drop feedback marker bar is normally black, but can
  be customized on a particular toolbar via CSS. To do this,
  use the <code>:-moz-drop-marker</code>
  pseudoelement. You can also customize the color a
  container's cell is colored indicating it will be dropped on
  with <code>:-moz-drop-container-bg</code>.
 <pre class="code">:-moz-drop-marker {
   color: blue;
}
                  
:-moz-drop-container-bg {
   color: blue;
}</pre>



<hr class="hide">
</div>
</div>
<div id="footer">
<ul>
<li><a href="../../sitemap.html">Site Map</a></li>
<li><a href="../../security/">Security Updates</a></li>
<li><a href="../../contact/">Contact Us</a></li>
<li><a href="../../foundation/donate.html">Donate</a></li>
</ul>
<p class="copyright">
Portions of this content are &copy; 1998&#8211;2009 by individual mozilla.org
contributors; content available under a Creative Commons license | <a
href="http://www.mozilla.org/foundation/licensing/website-content.html">Details</a>.</p>
<p>
<span>Last modified January 18,  2005</span>
<span><a href="http://bonsai-www.mozilla.org/cvslog.cgi?file=mozilla-org/html/xpfe/xptoolkit/trees.html&amp;rev=&amp;root=/www/">Document History</a></span>
</p>
</div>
</div>
</body>
</html>
