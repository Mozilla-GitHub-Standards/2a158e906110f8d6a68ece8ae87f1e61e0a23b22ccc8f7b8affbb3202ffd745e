<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<link rel="top" title="Home" href="http://www.mozilla.org/">
<link rel="stylesheet" type="text/css" href="../../css/print.css"  media="print">
<link rel="stylesheet" type="text/css" href="../../css/base/content.css"  media="all">
<link rel="stylesheet" type="text/css" href="../../css/cavendish/content.css" title="Cavendish" media="screen">
<link rel="stylesheet" type="text/css" href="../../css/base/template.css"  media="screen">
<link rel="stylesheet" type="text/css" href="../../css/cavendish/template.css" title="Cavendish" media="screen">
<link rel="icon" href="../../images/mozilla-16.png" type="image/png">

 <title>Popup Content (Context Menus and Tooltips)</title>
 <link rel="content" href="./">
 <link rel="prev" href="keys.html">
 <link rel="next" href="overlays.html">
<script src="../../__utm.js" type="text/javascript"></script>
</head>
<body id="www-mozilla-org" class="deepLevel">
<div id="container">
<p class="important">You are currently viewing a snapshot of www.mozilla.org taken on April 21, 2008. Most of this content is
highly out of date (some pages haven't been updated since the project began in 1998) and exists for historical purposes only.  If
there are any pages on this archive site that you think should be added back to www.mozilla.org, please <a
href="https://bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=www.mozilla.org">file a bug</a>.</p>
<p class="skipLink"><a href="#mainContent" accesskey="2">Skip to main content</a></p>
<div id="header">
<h1><a href="/" title="Return to home page" accesskey="1">Mozilla</a></h1>
<ul>
<li id="menu_aboutus"><a href="../../about/" title="Getting the most out of your online experience">About</a></li>
<li id="menu_developers"><a href="../../developer/" title="Using Mozilla's products for your own applications">Developers</a></li>
<li id="menu_store"><a href="http://store.mozilla.org/?r=mozorg1" title="Shop for Mozilla products on CD and other merchandise">Store</a></li>
<li id="menu_support"><a href="../../support/" title="Installation, trouble-shooting, and the knowledge base">Support</a></li>
<li id="menu_products"><a href="../../products/" title="All software Mozilla currently offers">Products</a></li>
</ul>
<form id="searchbox_002443141534113389537:ysdmevkkknw" action="http://www.google.com/cse" title="mozilla.org Search">
<div>
<label for="q" title="Search mozilla.org's sites">search mozilla:</label>
<input type="hidden" name="cx" value="002443141534113389537:ysdmevkkknw">
<input type="hidden" name="cof" value="FORID:0">
<input type="text" id="q" name="q" accesskey="s" size="30">
<input type="submit" id="submit" value="Go">
</div>
</form>
</div>
<hr class="hide">
<div id="mBody">
<div id="side">

<ul id="nav">
<li><a title="Roadmap" href="../../roadmap.html"><strong> Roadmap</strong></a></li>
<li><a title="Projects" href="../../projects/"><strong> Projects</strong></a></li>
<li><a title="For developers" href="../../developer/"><strong> Coding</strong></a>
<ul>
<li><a title="Module Owners" href="../../owners.html"> Module Owners</a></li>
<li><a title="Hacking" href="../../hacking/"> Hacking</a></li>
<li><a title="Get the Source" href="http://developer.mozilla.org/en/docs/Download_Mozilla_Source_Code"> Get the Source</a></li>
<li><a title="Building Mozilla" href="http://developer.mozilla.org/en/docs/Build_Documentation"> Build It</a></li>
</ul>
</li>
<li><a title="Testing" href="../../quality/"><strong> Testing</strong></a>
<ul>
<li><a title="Downloads of mozilla.org software releases" href="../../download.html"> Releases</a></li>
<li><a title="Latest mozilla builds for testers" href="../../developer/#builds"> Nightly Builds</a></li>
<li><a title="For testers to report bugs" href="https://bugzilla.mozilla.org/"> Report A Problem</a></li>
</ul>
</li>
<li><a title="Tools for mozilla developers" href="../../tools.html"><strong> Tools</strong></a>
<ul>
<li><a title="Bug tracking system for mozilla testers." href="https://bugzilla.mozilla.org/"> Bugzilla</a></li>
<li><a title="Latest status of mozilla builds" href="http://tinderbox.mozilla.org/showbuilds.cgi?tree=Firefox"> Tinderbox</a></li>
<li><a title="Latest checkins" href="http://bonsai.mozilla.org/cvsqueryform.cgi"> Bonsai</a></li>
<li><a title="Source cross reference" href="http://lxr.mozilla.org/seamonkey/"> LXR</a></li>
</ul>
</li>
<li><a title="Frequently Asked Questions." href="../../faq.html"><strong> FAQs</strong></a></li>
</ul>

</div>
<hr class="hide">
<div id="mainContent">




 <h1>Popup Content (Context Menus and Tooltips)</h1>
 <ul class="snav">
  <li><a href="keys.html">Previous: Key Binding</a>
  <li><a href="./">Table of Contents</a>
  <li><a href="overlays.html">Next: XUL Overlays</a>
 </ul>
 <dl>
  <dt>Feature Owners
  <dd><a href="mailto:hyatt@netscape.com">Dave Hyatt</a>
   (Content Model Work, Arbitrary XUL Popups)
  <dd><a href="mailto:saari@netscape.com">Chris Saari</a>
   (Popup Menus and Context Menus)
  <dd><a href="mailto:pinkerton@netscape.com">Mike Pinkerton</a>
   (Tooltips, Making Things Suck Less)
 </dl>
 <p>The XUL language provides a way for developers to declare
  that a XUL subtree is <dfn>popup content</dfn>, meaning that the
  content is displayed in its own window when a certain event
  occurs (e.g., a right mouse click to bring up a context
  menu, or a left click to bring up a popup color picker on a
  toolbar).
 <p>There are two kinds of popup content: menus and windows.
  Popup menus use the native menus on each platform and are
  described using <code>menu</code> and
  <code>menuitem</code> elements (See
  <a href="menus.html">Menus and Menu Bars</a> for details).
  Popup windows can contain arbitrary XUL, and are
  full-fledged XUL windows, declared using the
  <code>window</code> tag (See <a href="windows.html">Windows
  and Dialogs</a> for details).
 <p>Popup content is placed inside a
  <code>popup</code> tag, which prevents it
  from being displayed in the main document. The popup tag
  always has an identifier attached to it (using the
  <code>id</code> attribute) that is used when
  attaching the popup content to a UI element.
 <pre class="code">&lt;popup id="replyMenu"&gt;
  &lt;menu&gt;
    &lt;menuitem name="Reply to Sender"&gt;
    &lt;menuitem name="Reply to All"&gt;
  &lt;/menu&gt;
&lt;/popup&gt;</pre>
 <p>There are three different ways of automatically attaching
  a popup to content. All three methods involve setting
  attributes on the content node that should have the popup
  content attached to it. The attributes are
  <code>popup</code>,
  <code>context</code>, and
  <code>tooltip</code>. The value of one of
  these attributes is the <code>id</code> of
  the popup element that should be used to build the popup
  content.
 <pre class="code">&lt;titledbutton value="Reply" popup="replyMenu"/&gt;</pre>
 <p>The <code>popup</code> attribute is used
  to attach popup content that will be invoked on a
  "left mouse down". The
  <code>context</code> attribute is used to
  attach popup content that will be invoked on a context menu
  event (with the cross-platform abstraction being taken care
  of for you). The <code>tooltip</code>
  attribute is used to attach popup content that will be
  invoked after a time-delay hover over the node that has the
  popup content attached. (Note that tooltips may only be used
  with popup window content and never with popup menu
  content.)
 <p>By default the popup content appears with its top left
  point located directly underneath the point at which the
  user's mouse goes down (on tooltips the content is displaced
  by the height of the mouse cursor). This placement can be
  controlled using the
  <code>popupanchor</code> and
  <code>popupalign</code> attributes.
 <p>The <code>popupanchor</code> and
  <code>popupalign</code> attributes have four
  possible values: topleft, topright, bottomleft and
  bottomright. The <code>popupanchor</code>
  attribute can be used to specify that the popup content
  should come up anchored to one of the four corners of the
  content object (e.g., the button popping up the content). If
  omitted, no anchoring occurs. Instead the popup content
  comes up directly underneath the mouse event coordinates.
  This point (either directly under the mouse or attached to
  one of the four corners) is called the <dfn>originating
  point</dfn>.
 <p>The <code>popupalign</code> attribute can
  be used to specify which corner of the popup content is tied
  to the originating point. If omitted, the default is
  topleft. The example below shows how to create the
  traditional buttons with attached left mouse menus that
  exist in the 4.x Communicator product.
 <pre class="code">&lt;titledbutton value="Reply" popup="replyMenu" popupanchor="bottomleft"/&gt;</pre>
 <p>On Windows 98, anchored menus will animate (unless the
  property is turned off) to the opposite corner of the value
  specified in the <code>popupalign</code>
  attribute. In the above example, since the attribute is
  omitted, the default is topleft, and the menu will therefore
  animate to the bottomright corner.
 <p>The popup content can have attached event handlers just
  as regular content might. In these event handlers, the
  element that the popup was invoked upon can be retrieved by
  examining the <code>popupNode</code>
  property of the document. This property is set only when the
  popup is currently open.
 <pre class="code">&lt;popup id="toolbarContextMenu"&gt;
  &lt;menu&gt;
        ...
    &lt;menuitem name="Delete" onclick="mailNewsCore.deleteButton(document.popupNode)"&gt;
        ...
  &lt;/menu&gt;
&lt;/popup&gt;</pre>
 <p>A similar property,
  <code>tooltipNode</code>, is set for the
  element that has a tooltip displayed over it.
 <p>Arbitrary XUL windows that are created as popups have
  their own document, and any namespaces must be declared
  again on the new window tag. Style sheets, however, are
  inherited from the parent document. A popup XUL window is
  linked to the parent window that spawned it using the
  <code>opener</code> property, and thus can
  get back to the originating document to invoke functions or
  to examine data.
 <p>Arbitrary XUL popups can be closed or repositioned just
  as normal windows can using the methods of the
  <code>window</code> object. The most
  relevant method is
  <code>window.close()</code>, which can be
  used to discard the popup.
 <pre class="code">&lt;popup id="justifierPopup"&gt;
  &lt;window xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
    width="40" height="100"&gt;
     &lt;titledbutton id="left"
       onclick="opener.setJustification('left'); window.close();"/&gt;
     &lt;titledbutton id="center"
       onclick="opener.setJustification('center'); window.close();"/&gt;
     &lt;titledbutton id="right"
       onclick="opener.setJustification('right'); window.close();"/&gt;
  &lt;/window&gt;
&lt;/popup&gt;
...
&lt;titledbutton popup="justifierPopup" popupanchor="bottomleft"/&gt;
...</pre>
 <p>Popup content can also be created in response to any
  event (and not just the predefined
  <code>popup</code>,
  <code>context</code> and
  <code>tooltip</code> events. There are two
  new methods on the <code>window</code>
  object that allow popup content to be instantiated
  programmatically.
 <p><code>createPopup</code> takes six
  arguments: the DOM element to attach the popup to, the DOM
  element that represents the popup content, the x screen
  coordinate of the popup, the y screen coordinate of the
  popup, the popup type (context, popup, or tooltip), and the
  popup alignment (topleft, bottomright, bottomleft,
  topright).
 <p>The <code>createAnchoredPopup</code>
  method can be used to create popup content at a specific
  anchor point on a content object. It takes five arguments:
  the element to attach the popup to, the popup content
  element, the anchor position for the content (topleft,
  bottomright, bottomleft, topright), the popup type, and the
  popup alignment.
 <p>Using these methods, fine-grained control of popup
  instantiation is possible, e.g., a popup can be brought up
  after a time-delay or in response to keyboard events.
 <p>Popups can also be built dynamically or be modified just
  prior to being displayed. The
  <code>create</code> and
  <code>destroy</code> events are fired on a
  popup element just prior to it being displayed and just
  after it has lost the focus, respectively. Event listeners
  can be attached using the
  <code>oncreate</code> and
  <code>ondestroy</code> attributes or by
  using the DOM <code>addEventListener</code>
  function.
 <div class="important">
  <p>Due to how
   the menubar and dynamic menus are implemented on MacOS, the
   <code>ondestroy</code> handler is not
   guaranteed to be called at any particular time. On MacOS
   only, it will be called at one of the following times:
  <ul>
   <li>just before the next menu is to be displayed (which
    could be hours after the menu actually leaves the screen
    or when a different menubar is active)
   <li>when the app quits
  </ul>
  <p>The window associated with this menubar may be long gone
   by the time the handler is executed. <strong>Do not</strong> put
   anything time-critical or anything that relies on a window
   being present in this handler.
 </div>
 <h2>Tooltips</h2>
 <p>Tooltips are basically timed xul popups. You have full
  control over the appearance of these popups, or you may use
  a combination of JS and a standard "template" tooltip to get
  up and running quickly.
 <p>The easy way:
 <pre class="code">&lt;!-- this popup is in globaloverlay.xul. you don't need to duplicate it
     it is included here as an example. --&gt;
&lt;popupset&gt;
  &lt;popup id="aTooltip" oncreate="return FillInTooltip(document.tooltipNode);"&gt;
   &lt;window xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
     width="200" height="20" style="border: thin solid black"&gt;
        &lt;titledbutton id = "replaceMe" align="left" class="borderless paneltitle"/&gt;
   &lt;/window&gt;
  &lt;/popup&gt;
&lt;/popupset&gt;

...
&lt;toolbar tooltip="aTooltip"&gt;
  &lt;titledbutton tooltiptext="Tip for Button One"/&gt;
  &lt;titledbutton tooltiptext="Tip for Button Two"/&gt;
  &lt;titledbutton tooltiptext="Tip for Button Three"/&gt;
&lt;/toolbar&gt;
...</pre>
 <p>The <code>tooltiptext</code> attribute
  specifies the text displayed in the tooltip for this item.
  If you need more control over the tooltip for a particular
  button, you can specify the
  <code>tooltip</code> attribute directly on
  that item and set its id to a different popup where the new
  content lives.
 <p>You can use the JS convenience routine
  <code>FillInTooltip()</code> (available from
  globaloverlay.js) anywhere you want as long as you have one
  node within the popup whose name is "replaceMe". This way
  you keep the convenience of only having to specify the
  tooltip text on the button but can use any popup you
  like.
 <p>To prevent tooltips from showing up based on content,
  return false from the <code>oncreate</code>
  event handler. Actually, this is true for any xul popup, but
  most useful for tooltips.
 <p>Tooltips will automatically time out after 5 seconds or
  so and go away on their own. If you have a lot of
  information in your tooltip and would prefer that it didn't,
  set the <code>noautohide</code> attribute to
  true on the tooltip's
  <code>&lt;popup&gt;</code> tag. Tooltips
  will also go away when the mouse leaves the Gecko frame
  corresponding to the DOM node that was the event target that
  spawned the tip.
 <h2>Known Issues</h2>
 <ul>
  <li>HTML Elements - Popups can only be attached to XUL
   elements right now and not to HTML elements.
  <li>Anchoring - Don't try to use the popupanchor
   attribute yet. It will cause the popups to not even show
   up at all. Also, the createAnchoredPopup method doesn't
   do anything yet.
  <li>
   <p>Arbitrary XUL Popup Issues
   <ul>
    <li>The destruct event doesn't fire when an arbitrary
     XUL popup is closed.
   </ul>
 </ul>



<hr class="hide">
</div>
</div>
<div id="footer">
<ul>
<li><a href="../../sitemap.html">Site Map</a></li>
<li><a href="../../security/">Security Updates</a></li>
<li><a href="../../contact/">Contact Us</a></li>
<li><a href="../../foundation/donate.html">Donate</a></li>
</ul>
<p class="copyright">
Portions of this content are &copy; 1998&#8211;2009 by individual mozilla.org
contributors; content available under a Creative Commons license | <a
href="http://www.mozilla.org/foundation/licensing/website-content.html">Details</a>.</p>
<p>
<span>Last modified January 18,  2005</span>
<span><a href="http://bonsai-www.mozilla.org/cvslog.cgi?file=mozilla-org/html/xpfe/xptoolkit/popups.html&amp;rev=&amp;root=/www/">Document History</a></span>
</p>
</div>
</div>
</body>
</html>
