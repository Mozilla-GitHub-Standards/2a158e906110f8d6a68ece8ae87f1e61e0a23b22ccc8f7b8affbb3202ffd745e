
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<link rel="top" title="Home" href="http://www.mozilla.org/">
<link rel="stylesheet" type="text/css" href="../css/print.css"  media="print">
<link rel="stylesheet" type="text/css" href="../css/base/content.css"  media="all">
<link rel="stylesheet" type="text/css" href="../css/cavendish/content.css" title="Cavendish" media="screen">
<link rel="stylesheet" type="text/css" href="../css/base/template.css"  media="screen">
<link rel="stylesheet" type="text/css" href="../css/cavendish/template.css" title="Cavendish" media="screen">
<link rel="icon" href="../images/mozilla-16.png" type="image/png">
   <META NAME="GENERATOR" CONTENT="Mozilla/4.04 [en] (X11; I; IRIX 6.2 IP22) [Netscape]">   <META NAME="KeyWords" CONTENT="client, source, documentation">   <TITLE>Module Description Template</TITLE><script src="../__utm.js" type="text/javascript"></script>
</head>
<body id="www-mozilla-org" class="deepLevel">
<div id="container">
<p class="important">You are currently viewing a snapshot of www.mozilla.org taken on April 21, 2008. Most of this content is
highly out of date (some pages haven't been updated since the project began in 1998) and exists for historical purposes only.  If
there are any pages on this archive site that you think should be added back to www.mozilla.org, please <a
href="https://bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=www.mozilla.org">file a bug</a>.</p>
<p class="skipLink"><a href="#mainContent" accesskey="2">Skip to main content</a></p>
<div id="header">
<h1><a href="/" title="Return to home page" accesskey="1">Mozilla</a></h1>
<ul>
<li id="menu_aboutus"><a href="../about/" title="Getting the most out of your online experience">About</a></li>
<li id="menu_developers"><a href="../developer/" title="Using Mozilla's products for your own applications">Developers</a></li>
<li id="menu_store"><a href="http://store.mozilla.org/?r=mozorg1" title="Shop for Mozilla products on CD and other merchandise">Store</a></li>
<li id="menu_support"><a href="../support/" title="Installation, trouble-shooting, and the knowledge base">Support</a></li>
<li id="menu_products"><a href="../products/" title="All software Mozilla currently offers">Products</a></li>
</ul>
<form id="searchbox_002443141534113389537:ysdmevkkknw" action="http://www.google.com/cse" title="mozilla.org Search">
<div>
<label for="q" title="Search mozilla.org's sites">search mozilla:</label>
<input type="hidden" name="cx" value="002443141534113389537:ysdmevkkknw">
<input type="hidden" name="cof" value="FORID:0">
<input type="text" id="q" name="q" accesskey="s" size="30">
<input type="submit" id="submit" value="Go">
</div>
</form>
</div>
<hr class="hide">
<div id="mBody">
<div id="side">

<ul id="nav">
<li><a title="Roadmap" href="../roadmap.html"><strong> Roadmap</strong></a></li>
<li><a title="Projects" href="../projects/"><strong> Projects</strong></a></li>
<li><a title="For developers" href="../developer/"><strong> Coding</strong></a>
<ul>
<li><a title="Module Owners" href="../owners.html"> Module Owners</a></li>
<li><a title="Hacking" href="../hacking/"> Hacking</a></li>
<li><a title="Get the Source" href="http://developer.mozilla.org/en/docs/Download_Mozilla_Source_Code"> Get the Source</a></li>
<li><a title="Building Mozilla" href="http://developer.mozilla.org/en/docs/Build_Documentation"> Build It</a></li>
</ul>
</li>
<li><a title="Testing" href="../quality/"><strong> Testing</strong></a>
<ul>
<li><a title="Downloads of mozilla.org software releases" href="../download.html"> Releases</a></li>
<li><a title="Latest mozilla builds for testers" href="../developer/#builds"> Nightly Builds</a></li>
<li><a title="For testers to report bugs" href="https://bugzilla.mozilla.org/"> Report A Problem</a></li>
</ul>
</li>
<li><a title="Tools for mozilla developers" href="../tools.html"><strong> Tools</strong></a>
<ul>
<li><a title="Bug tracking system for mozilla testers." href="https://bugzilla.mozilla.org/"> Bugzilla</a></li>
<li><a title="Latest status of mozilla builds" href="http://tinderbox.mozilla.org/showbuilds.cgi?tree=Firefox"> Tinderbox</a></li>
<li><a title="Latest checkins" href="http://bonsai.mozilla.org/cvsqueryform.cgi"> Bonsai</a></li>
<li><a title="Source cross reference" href="http://lxr.mozilla.org/seamonkey/"> LXR</a></li>
</ul>
</li>
<li><a title="Frequently Asked Questions." href="../faq.html"><strong> FAQs</strong></a></li>
</ul>

</div>
<hr class="hide">
<div id="mainContent">
<H2><FONT FACE="Arial,Helvetica">NSPR Module Description</FONT></H2>NSPR provides platform independence for non-GUI operating system facilities.These facilities include threads, thread synchronization, normal file andnetwork I/O, interval timing and calendar time, basic memory management(malloc and free) and shared library linking. A good portion of the library'spurpose, and perhaps the primary purpose in the existing environment, isto provide the underpinnings of the Java VM, more or less mapping the <I>syslayer</I> that Java defines for the porting of the Java VM to various platforms.NSPR does go beyond that requirement in some areas and since it is alsothe platform independent layer for most of the servers produced by Netscape.<H3><HR WIDTH="100%"><FONT FACE="Arial,Helvetica">History</FONT></H3>The current version of NSPR is known as NSPR 2.0. 1.0 was originally conceivedjust to satisfy the requirements of porting Java to various host environments.NSPR 2.0, an effort started over a year ago, builds on that original idea.Very little is left of the original code. Many of the concepts have beenreformed, expanded and matured. But the basic intent lives on. Today NSPRis still used as the platform dependent layer under Java, but its primaryapplication are clients written entirely in C or C++.<H3><HR WIDTH="100%"><FONT FACE="Arial,Helvetica">How It Works</FONT></H3>NSPR's goal is to provide uniform service over a wide range of operatingsystem environments. It strives to not export the <I>lowest common denominator</I>,but to exploit the best features of each operating system on which it runs,and still provide a uniform service across a wide range of host offerings.<H4>Threads</H4>Threads are the major feature of NSPR. The industry's offering of threadsis quite sundry. NSPR, while far from perfect, does provide a single APIto which clients may program and expect reasonably consistent behavior.The operating systems provide everything from no concept of threading atall up to and including sophisticated, scalable and efficient implementations.NSPR makes as much use of&nbsp; what the systems offer as it can. It isthe goal of NSPR that NSPR impose as little overhead as possible in accessingthose appropriate system features.<H4>Thread synchronization</H4>Thread synchronization is loosely based on Monitors as described by C.A.R.Hoare in <I>Monitors: An operating system structuring concept</I>, Communicationsof the ACM, 17(10), October 1974 and then formalized by Xerox' Mesa programminglanguage ("Mesa Language Manual", J.G. Mitchell et al, Xerox PARC, CSL-79-3(Apr 1979)). This mechanism provides the basic mutual exclusion (mutex)and thread notification facilities (condition variables)&nbsp; implementedby NSPR. Additionally, NSPR provides synchronization methods more suitedfor use by Java. The Java-like facilities include monitor <I>reentrancy</I>,implicit and tightly bound notification capabilities with the ability toassociate the synchronization objects dynamically.<H4>I/O</H4>NSPR's I/O is a slightly augmented BSD sockets model that allows arbitrarylayering. It is was originally intended to export&nbsp; synchronous I/Omethods only, relying on threads to provide the concurrency needed forcomplex applications. That method of operation is preferred though it ispossible to configure the network I/O channels as <I>non-blocking</I> inthe traditional sense.<H4>Network addresses</H4>Part of NSPR deals with manipulation of network addresses. NSPR definesa network address object that is Internet Protocol (IP) centric. Whilethe object is not declared as opaque, the API provides methods that allowand encourage clients to treat the addresses as polymorphic items. Thegoal in this area is to provide a migration path between IPv4 and IPv6.To that end it is possible to perform translations of ASCII strings (DNSnames) into NSPR's network address structures, with no regard to whetherthe addressing technology is IPv4 or IPv6.<H4>Time</H4>Timing facilities are available in two forms: interval timing and calendarfunctions.<P>Interval timers are based on a free running, 32-bit, platform dependentresolution timer. Such timers are normally used to specify timeouts onI/O, waiting on condition variables and other rudimentary thread scheduling.Since these timers have finite namespace and are free running, they canwrap at any time. NSPR does not provide an <I>epoch</I>, but expects clientsto deal with that issue. The <I>granularity</I> of the timers is guaranteedto be between 10 microseconds and 1 millisecond. This allows a timer <I>period</I>in excess of one day. But in order to deal with the wrap-around issue,only half that namespace may be trusted. Therefore, the minimal usableinterval available from the timers is approximately 14 hours.<P>Calendar times are 64-bit signed numbers with units of microseconds.The <I>epoch</I> for calendar times is midnight, January 1, 1970, GreenwichMean Time. Negative times extend to times before 1970, and positive numbersforward. Use of 64 bits allows a representation of times approximatelyin the range of -30000 to the year 30000. There is a structural representation(<I>i.e., exploded</I> view), routines to acquire the current time fromthe host system, and convert them to and from the 64-bit and structuralrepresentation. Additionally there are routines to convert to and frommost well-known forms of ASCII into the 64-bit NSPR representation.<H4>Memory managment</H4>NSPR provides API to perform the basic malloc, calloc, realloc and freefunctions. Depending on the platform, the functions may be implementedalmost entirely in the NSPR runtime or simply shims that call immediatelyinto the host operating system's offerings.<H4>Linking</H4><FONT COLOR="#000000">Support for linking (shared library loading and unloading)is part of NSPR's feature set. In most cases this is simply a smoothingover of the facilities offered by the various platform providers.</FONT><H3><HR WIDTH="100%"><FONT FACE="Arial,Helvetica">Where It's Headed</FONT></H3>NPSR is applicable as a platform on which to write threaded applicationsthat need to be ported to multiple platforms. The current implementationsupports Macintosh (PPC), WIN-32 (WIN NT, WIN '95) and 20+ versions ofUNIX and is still expanding. The basic API is stable and expected to remainthat way. Additional effort is being put into offering thread safe librariesand other functionality.<DIV ALIGN=right>&nbsp;</DIV><DIV ALIGN=right></DIV><DIV ALIGN=right><HR WIDTH="100%"></DIV><DIV ALIGN=right><I><FONT SIZE=-1>Last updated: Tue Mar 28 09:44:49 PST1998</FONT></I></DIV><HR WIDTH="100%"><CENTER>Copyright &copy; 1998 <A HREF="http://home.netscape.com/misc/contact_info.html">NetscapeCommunications Corporation</A></CENTER>&nbsp;
<hr class="hide">
</div>
</div>
<div id="footer">
<ul>
<li><a href="../sitemap.html">Site Map</a></li>
<li><a href="../security/">Security Updates</a></li>
<li><a href="../contact/">Contact Us</a></li>
<li><a href="../foundation/donate.html">Donate</a></li>
</ul>
<p class="copyright">
Portions of this content are &copy; 1998&#8211;2009 by individual mozilla.org
contributors; content available under a Creative Commons license | <a
href="http://www.mozilla.org/foundation/licensing/website-content.html">Details</a>.</p>
<p>
<span>Last modified October  5,  1999</span>
<span><a href="http://bonsai-www.mozilla.org/cvslog.cgi?file=mozilla-org/html/classic/nsprdesc.html&amp;rev=&amp;root=/www/">Document History</a></span>
</p>
</div>
</div>
</body>
</html>
