%!PS-Adobe-3.0
%%Creator: groff version 1.11
%%CreationDate: Mon Jul 13 12:35:05 1998
%%DocumentNeededResources: font Times-Roman
%%+ font Times-Bold
%%+ font Times-Italic
%%+ font Courier
%%+ font Symbol
%%DocumentSuppliedResources: procset grops 1.11 0
%%Pages: 12
%%PageOrder: Ascend
%%Orientation: Portrait
%%EndComments
%%BeginProlog
%%BeginResource: procset grops 1.11 0
/setpacking where{
pop
currentpacking
true setpacking
}if
/grops 120 dict dup begin
/SC 32 def
/A/show load def
/B{0 SC 3 -1 roll widthshow}bind def
/C{0 exch ashow}bind def
/D{0 exch 0 SC 5 2 roll awidthshow}bind def
/E{0 rmoveto show}bind def
/F{0 rmoveto 0 SC 3 -1 roll widthshow}bind def
/G{0 rmoveto 0 exch ashow}bind def
/H{0 rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/I{0 exch rmoveto show}bind def
/J{0 exch rmoveto 0 SC 3 -1 roll widthshow}bind def
/K{0 exch rmoveto 0 exch ashow}bind def
/L{0 exch rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/M{rmoveto show}bind def
/N{rmoveto 0 SC 3 -1 roll widthshow}bind def
/O{rmoveto 0 exch ashow}bind def
/P{rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/Q{moveto show}bind def
/R{moveto 0 SC 3 -1 roll widthshow}bind def
/S{moveto 0 exch ashow}bind def
/T{moveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/SF{
findfont exch
[exch dup 0 exch 0 exch neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/MF{
findfont
[5 2 roll
0 3 1 roll
neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/level0 0 def
/RES 0 def
/PL 0 def
/LS 0 def
/MANUAL{
statusdict begin/manualfeed true store end
}bind def
/PLG{
gsave newpath clippath pathbbox grestore
exch pop add exch pop
}bind def
/BP{
/level0 save def
1 setlinecap
1 setlinejoin
72 RES div dup scale
LS{
90 rotate
}{
0 PL translate
}ifelse
1 -1 scale
}bind def
/EP{
level0 restore
showpage
}bind def
/DA{
newpath arcn stroke
}bind def
/SN{
transform
.25 sub exch .25 sub exch
round .25 add exch round .25 add exch
itransform
}bind def
/DL{
SN
moveto
SN
lineto stroke
}bind def
/DC{
newpath 0 360 arc closepath
}bind def
/TM matrix def
/DE{
TM currentmatrix pop
translate scale newpath 0 0 .5 0 360 arc closepath
TM setmatrix
}bind def
/RC/rcurveto load def
/RL/rlineto load def
/ST/stroke load def
/MT/moveto load def
/CL/closepath load def
/FL{
currentgray exch setgray fill setgray
}bind def
/BL/fill load def
/LW/setlinewidth load def
/RE{
findfont
dup maxlength 1 index/FontName known not{1 add}if dict begin
{
1 index/FID ne{def}{pop pop}ifelse
}forall
/Encoding exch def
dup/FontName exch def
currentdict end definefont pop
}bind def
/DEFS 0 def
/EBEGIN{
moveto
DEFS begin
}bind def
/EEND/end load def
/CNT 0 def
/level1 0 def
/PBEGIN{
/level1 save def
translate
div 3 1 roll div exch scale
neg exch neg exch translate
0 setgray
0 setlinecap
1 setlinewidth
0 setlinejoin
10 setmiterlimit
[]0 setdash
/setstrokeadjust where{
pop
false setstrokeadjust
}if
/setoverprint where{
pop
false setoverprint
}if
newpath
/CNT countdictstack def
userdict begin
/showpage{}def
}bind def
/PEND{
clear
countdictstack CNT sub{end}repeat
level1 restore
}bind def
end def
/setpacking where{
pop
setpacking
}if
%%EndResource
%%IncludeResource: font Times-Roman
%%IncludeResource: font Times-Bold
%%IncludeResource: font Times-Italic
%%IncludeResource: font Courier
%%IncludeResource: font Symbol
grops begin/DEFS 1 dict def DEFS begin/u{.001 mul}bind def end/RES 72
def/PL 792 def/LS false def/ENC0[/asciicircum/asciitilde/Scaron/Zcaron
/scaron/zcaron/Ydieresis/trademark/quotesingle/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/space/exclam/quotedbl/numbersign/dollar/percent
/ampersand/quoteright/parenleft/parenright/asterisk/plus/comma/hyphen
/period/slash/zero/one/two/three/four/five/six/seven/eight/nine/colon
/semicolon/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N/O
/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright/circumflex
/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/y
/z/braceleft/bar/braceright/tilde/.notdef/quotesinglbase/guillemotleft
/guillemotright/bullet/florin/fraction/perthousand/dagger/daggerdbl
/endash/emdash/ff/fi/fl/ffi/ffl/dotlessi/dotlessj/grave/hungarumlaut
/dotaccent/breve/caron/ring/ogonek/quotedblleft/quotedblright/oe/lslash
/quotedblbase/OE/Lslash/.notdef/exclamdown/cent/sterling/currency/yen
/brokenbar/section/dieresis/copyright/ordfeminine/guilsinglleft
/logicalnot/minus/registered/macron/degree/plusminus/twosuperior
/threesuperior/acute/mu/paragraph/periodcentered/cedilla/onesuperior
/ordmasculine/guilsinglright/onequarter/onehalf/threequarters
/questiondown/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE
/Ccedilla/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute/Thorn
/germandbls/agrave/aacute/acircumflex/atilde/adieresis/aring/ae/ccedilla
/egrave/eacute/ecircumflex/edieresis/igrave/iacute/icircumflex/idieresis
/eth/ntilde/ograve/oacute/ocircumflex/otilde/odieresis/divide/oslash
/ugrave/uacute/ucircumflex/udieresis/yacute/thorn/ydieresis]def
/Courier@0 ENC0/Courier RE/Times-Italic@0 ENC0/Times-Italic RE
/Times-Bold@0 ENC0/Times-Bold RE/Times-Roman@0 ENC0/Times-Roman RE
%%EndProlog
%%Page: 1 1
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 347.72(TCPDUMP\(1\) TCPDUMP\(1\))72 48 R/F1 9
/Times-Bold@0 SF -.18(NA)72 84 S(ME).18 E F0(tcpdump \255 dump traf)108
96 Q(\214c on a netw)-.25 E(ork)-.1 E F1(SYNOPSIS)72 112.8 Q/F2 10
/Times-Bold@0 SF(tcpdump)108 124.8 Q F0([)2.5 E F2(\255ade\215nNOpqStvx)
2.5 E F0 2.5(][)2.5 G F2<ad63>A/F3 10/Times-Italic@0 SF(count)2.5 E F0
2.5(][)2.5 G F2<ad46>A F3(\214le)2.5 E F0(])2.5 E([)188 136.8 Q F2<ad69>
2.5 E F3(interface)2.5 E F0 2.5(][)2.5 G F2<ad72>A F3(\214le)2.5 E F0
2.5(][)2.5 G F2<ad73>A F3(snaplen)2.5 E F0(])2.5 E([)188 148.8 Q F2
<ad54>2.5 E F3(type)2.5 E F0 2.5(][)2.5 G F2<ad77>A F3(\214le)2.5 E F0
2.5(][)2.5 G F3 -.2(ex)C(pr).2 E(ession)-.37 E F0(])2.5 E F1
(DESCRIPTION)72 165.6 Q F3(Tcpdump)108 177.6 Q F0
(prints out the headers of pack)2.5 E(ets on a netw)-.1 E(ork interf)-.1
E(ace that match the boolean)-.1 E F3 -.2(ex)2.5 G(pr).2 E(ession)-.37 E
F0(.)A F2 .139(Under SunOS with nit or bpf:)108 194.4 R F0 1.739 -.8
(To r)2.639 H(un).8 E F3(tcpdump)2.639 E F0 .139(you must ha)2.639 F
.439 -.15(ve r)-.2 H .139(ead access to).15 F F3(/de)2.639 E(v/nit)-.15
E F0(or)2.639 E F3(/de)2.638 E(v/bpf*)-.15 E F0(.).42 E F2(Under)5.138 E
.621(Solaris with dlpi:)108 206.4 R F0 -1.1(Yo)3.121 G 3.121(um)1.1 G
.621(ust ha)-3.121 F .921 -.15(ve r)-.2 H .621(ead access to the netw)
.15 F .621(ork pseudo de)-.1 F .622(vice, e.g.)-.25 F F3(/de)5.622 E
(v/le)-.15 E F0(.).18 E F2 .622(Under HP-UX)5.622 F .543(with dlpi:)108
218.4 R F0 -1.1(Yo)3.043 G 3.043(um)1.1 G .543
(ust be root or it must be installed setuid to root.)-3.043 F F2 .542
(Under IRIX with snoop:)5.542 F F0 -1.1(Yo)3.042 G 3.042(um)1.1 G .542
(ust be)-3.042 F .398(root or it must be installed setuid to root.)108
230.4 R F2 .398(Under Linux:)5.398 F F0 -1.1(Yo)2.898 G 2.898(um)1.1 G
.398(ust be root or it must be installed setuid to)-2.898 F(root.)108
242.4 Q F2 1.717(Under Ultrix and Digital UNIX:)6.717 F F0 1.717
(Once the super)4.217 F 1.716
(-user has enabled promiscuous-mode operation)-.2 F(using)108 254.4 Q F3
(pfcon\214g)2.5 E F0(\(8\), an).22 E 2.5(yu)-.15 G(ser may run)-2.5 E F2
(tcpdump)2.5 E F0(.)A F2(Under BSD:)5 E F0 -1.1(Yo)2.5 G 2.5(um)1.1 G
(ust ha)-2.5 E .3 -.15(ve r)-.2 H(ead access to).15 E F3(/de)2.5 E
(v/bpf*)-.15 E F0(.).42 E F1(OPTIONS)72 271.2 Q F2<ad61>108 283.2 Q F0
(Attempt to con)25.3 E -.15(ve)-.4 G(rt netw).15 E
(ork and broadcast addresses to names.)-.1 E F2<ad63>108 300 Q F0
(Exit after recei)25.86 E(ving)-.25 E F3(count)2.5 E F0(pack)2.5 E(ets.)
-.1 E F2<ad64>108 316.8 Q F0(Dump the compiled pack)24.74 E
(et-matching code in a human readable form to standard output and stop.)
-.1 E F2(\255dd)108 333.6 Q F0(Dump pack)19.18 E(et-matching code as a)
-.1 E F2(C)2.5 E F0(program fragment.)2.5 E F2(\255ddd)108 350.4 Q F0
(Dump pack)13.62 E
(et-matching code as decimal numbers \(preceded with a count\).)-.1 E F2
<ad65>108 367.2 Q F0(Print the link-le)25.86 E -.15(ve)-.25 G 2.5(lh).15
G(eader on each dump line.)-2.5 E F2<ad66>108 384 Q F0 .827(Print `fore\
ign' internet addresses numerically rather than symbolically \(this opt\
ion is intended to)26.97 F 1.163
(get around serious brain damage in Sun')144 396 R 3.663(sy)-.55 G 3.663
(ps)-3.663 G(erv)-3.663 E 1.162(er \212 usually it hangs fore)-.15 F
-.15(ve)-.25 G 3.662(rt).15 G 1.162(ranslating non-)-3.662 F
(local internet numbers\).)144 408 Q F2<ad46>108 424.8 Q F0(Use)24.19 E
F3(\214le)3.06 E F0 .56(as input for the \214lter e)3.06 F 3.06
(xpression. An)-.15 F .56(additional e)3.06 F .56(xpression gi)-.15 F
-.15(ve)-.25 G 3.06(no).15 G 3.06(nt)-3.06 G .56(he command line is)
-3.06 F(ignored.)144 436.8 Q F2<ad69>108 453.6 Q F0 .32(Listen on)27.52
F F3(interface)2.82 E F0 5.32(.I)C 2.82(fu)-5.32 G(nspeci\214ed,)-2.82 E
F3(tcpdump)2.819 E F0 .319(searches the system interf)2.819 F .319
(ace list for the lo)-.1 F .319(west num-)-.25 F 1.839
(bered, con\214gured up interf)144 465.6 R 1.839(ace \(e)-.1 F 1.839
(xcluding loopback\).)-.15 F -.35(Ti)6.839 G 1.839(es are brok).35 F
1.839(en by choosing the earliest)-.1 F(match.)144 477.6 Q F2<ad6c>108
494.4 Q F0(Mak)27.52 E 2.5(es)-.1 G(tdout line b)-2.5 E(uf)-.2 E 2.5
(fered. Useful)-.25 F(if you w)2.5 E
(ant to see the data while capturing it.)-.1 E(E.g.,)5 E -.74(``)144
506.4 S 2.5(tcpdump \255l | tee).74 F(dat')2.5 E 2.5('o)-.74 G 2.5(r`)
-2.5 G 2.5(`tcpdump \255l)-3.24 F 2.5(>d)7.5 G 2.5(at & tail \255f dat')
-2.5 F('.)-.74 E F2<ad6e>108 523.2 Q F0(Don')24.74 E 2.5(tc)-.18 G(on)
-2.5 E -.15(ve)-.4 G
(rt addresses \(i.e., host addresses, port numbers, etc.\) to names.).15
E F2<ad4e>108 540 Q F0(Don')23.08 E 2.722(tp)-.18 G .222
(rint domain name quali\214cation of host names.)-2.722 F .221
(E.g., if you gi)5.221 F .521 -.15(ve t)-.25 H .221(his \215ag then).15
F F3(tcpdump)2.721 E F0(will)2.721 E(print `)144 552 Q(`nic')-.74 E 2.5
('i)-.74 G(nstead of `)-2.5 E(`nic.ddn.mil')-.74 E('.)-.74 E F2<ad4f>108
568.8 Q F0 1.075(Do not run the pack)22.52 F 1.075
(et-matching code optimizer)-.1 F 6.075(.T)-.55 G 1.075
(his is useful only if you suspect a b)-6.075 F 1.076(ug in the)-.2 F
(optimizer)144 580.8 Q(.)-.55 E F2<ad70>108 597.6 Q F3(Don')24.74 E(t)
-.3 E F0 .785(put the interf)3.285 F .785(ace into promiscuous mode.)-.1
F .785(Note that the interf)5.785 F .785(ace might be in promiscuous)-.1
F .6(mode for some other reason; hence, `-p' cannot be used as an abbre)
144 609.6 R .601(viation for `ether host {local-)-.25 F
(hw-addr} or ether broadcast'.)144 621.6 Q F2<ad71>108 638.4 Q F0
(Quick \(quiet?\) output.)24.74 E
(Print less protocol information so output lines are shorter)5 E(.)-.55
E F2<ad72>108 655.2 Q F0 1.104(Read pack)25.86 F 1.104(ets from)-.1 F F3
(\214le)3.604 E F0 1.104(\(which w)3.604 F 1.104
(as created with the -w option\).)-.1 F 1.103(Standard input is used if)
6.103 F F3(\214le)3.603 E F0(is)3.603 E -.74(``)144 667.2 S(-').74 E('.)
-.74 E F2<ad73>108 684 Q F0(Snarf)26.41 E F3(snaplen)2.814 E F0 .314
(bytes of data from each pack)2.814 F .315(et rather than the def)-.1 F
.315(ault of 68 \(with SunOS')-.1 F 2.815(sN)-.55 G(IT)-2.815 E 2.815
(,t)-.74 G(he)-2.815 E .317(minimum is actually 96\).)144 696 R .317
(68 bytes is adequate for IP)5.317 F 2.817(,I)-1.11 G(CMP)-2.817 E 2.817
(,T)-1.11 G .317(CP and UDP b)-2.817 F .317(ut may truncate pro-)-.2 F
.37(tocol information from name serv)144 708 R .37(er and NFS pack)-.15
F .37(ets \(see belo)-.1 F 2.87(w\). P)-.25 F(ack)-.15 E .37
(ets truncated because of a)-.1 F 2.132
(limited snapshot are indicated in the output with `)144 720 R(`[|)-.74
E F3(pr)A(oto)-.45 E F0(]')A 2.132(', where)-.74 F F3(pr)4.632 E(oto)
-.45 E F0 2.132(is the name of the)4.632 F(30 June 1997)279.335 768 Q(1)
202.335 E EP
%%Page: 2 2
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 347.72(TCPDUMP\(1\) TCPDUMP\(1\))72 48 R 2.626
(protocol le)144 84 R -.15(ve)-.25 G 5.126(la).15 G 5.126(tw)-5.126 G
2.626(hich the truncation has occurred.)-5.126 F 2.626
(Note that taking lar)7.626 F 2.627(ger snapshots both)-.18 F .673
(increases the amount of time it tak)144 96 R .673(es to process pack)
-.1 F .673(ets and, ef)-.1 F(fecti)-.25 E -.15(ve)-.25 G(ly).15 E 3.172
(,d)-.65 G .672(ecreases the amount of)-3.172 F(pack)144 108 Q 1.426
(et b)-.1 F(uf)-.2 E 3.926(fering. This)-.25 F 1.426(may cause pack)
3.926 F 1.426(ets to be lost.)-.1 F -1.1(Yo)6.426 G 3.926(us)1.1 G 1.426
(hould limit)-3.926 F/F1 10/Times-Italic@0 SF(snaplen)3.926 E F0 1.426
(to the smallest)3.926 F
(number that will capture the protocol information you')144 120 Q
(re interested in.)-.5 E/F2 10/Times-Bold@0 SF<ad54>108 136.8 Q F0 -.15
(Fo)23.63 G .35(rce pack).15 F .35(ets selected by ")-.1 F F1 -.2(ex)C
(pr).2 E(ession)-.37 E F0 2.849("t)C 2.849(ob)-2.849 G 2.849(ei)-2.849 G
.349(nterpreted the speci\214ed)-2.849 F F1(type)2.849 E F0 2.849(.C)C
.349(urrently kno)-2.849 F .349(wn types)-.25 F(are)144 148.8 Q F2 -.1
(rp)2.999 G(c).1 E F0 .499(\(Remote Procedure Call\),)2.999 F F2(rtp)
2.999 E F0(\(Real-T)2.999 E .499(ime Applications protocol\),)-.35 F F2
(rtcp)2.999 E F0(\(Real-T)2.999 E .5(ime Appli-)-.35 F
(cations control protocol\),)144 160.8 Q F2 -.1(va)2.5 G(t).1 E F0(\(V)
2.5 E(isual Audio T)-.6 E(ool\), and)-.8 E F2(wb)2.5 E F0(\(distrib)2.5
E(uted White Board\).)-.2 E F2<ad53>108 177.6 Q F0
(Print absolute, rather than relati)24.74 E -.15(ve)-.25 G 2.5(,T).15 G
(CP sequence numbers.)-2.5 E F2<ad74>108 194.4 Q F1(Don')26.97 E(t)-.3 E
F0(print a timestamp on each dump line.)2.5 E F2(\255tt)108 211.2 Q F0
(Print an unformatted timestamp on each dump line.)23.64 E F2<ad76>108
228 Q F0 .032(\(Slightly more\) v)25.3 F .032(erbose output.)-.15 F -.15
(Fo)5.032 G 2.531(re).15 G .031(xample, the time to li)-2.681 F .331
-.15(ve a)-.25 H .031(nd type of service information in an).15 F
(IP pack)144 240 Q(et is printed.)-.1 E F2(\255vv)108 256.8 Q F0(Ev)20.3
E(en more v)-.15 E(erbose output.)-.15 E -.15(Fo)5 G 2.5(re).15 G
(xample, additional \214elds are printed from NFS reply pack)-2.65 E
(ets.)-.1 E F2<ad77>108 273.6 Q F0 .593(Write the ra)23.08 F 3.093(wp)
-.15 G(ack)-3.093 E .593(ets to)-.1 F F1(\214le)3.093 E F0 .594
(rather than parsing and printing them out.)3.093 F(The)5.594 E 3.094
(yc)-.15 G .594(an later be printed)-3.094 F(with the \255r option.)144
285.6 Q(Standard output is used if)5 E F1(\214le)2.5 E F0(is `)2.5 E
(`-')-.74 E('.)-.74 E F2<ad78>108 302.4 Q F0 .418(Print each pack)25.3 F
.418(et \(minus its link le)-.1 F -.15(ve)-.25 G 2.918(lh).15 G .418
(eader\) in he)-2.918 F 2.918(x. The)-.15 F .417
(smaller of the entire pack)2.918 F .417(et or)-.1 F F1(snaplen)2.917 E
F0(bytes will be printed.)144 314.4 Q F1 -.2(ex)110.5 331.2 S(pr).2 E
(ession)-.37 E F0 1.241(selects which pack)144 343.2 R 1.241
(ets will be dumped.)-.1 F 1.242(If no)6.242 F F1 -.2(ex)3.742 G(pr).2 E
(ession)-.37 E F0 1.242(is gi)3.742 F -.15(ve)-.25 G 1.242(n, all pack)
.15 F 1.242(ets on the net will be)-.1 F 2.5(dumped. Otherwise,)144
355.2 R(only pack)2.5 E(ets for which)-.1 E F1 -.2(ex)2.5 G(pr).2 E
(ession)-.37 E F0(is `true' will be dumped.)2.5 E(The)144 372 Q F1 -.2
(ex)3.578 G(pr).2 E(ession)-.37 E F0 1.078(consists of one or more)3.578
F F1(primitives.)3.578 E F0(Primiti)6.078 E -.15(ve)-.25 G 3.578(su).15
G 1.078(sually consist of an)-3.578 F F1(id)3.578 E F0 1.078(\(name or)
3.578 F(number\) preceded by one or more quali\214ers.)144 384 Q
(There are three dif)5 E(ferent kinds of quali\214er:)-.25 E F1(type)144
400.8 Q F0 .02
(quali\214ers say what kind of thing the id name or number refers to.)
19.34 F .02(Possible types are)5.02 F F2(host)2.52 E F0(,)A F2(net)180
412.8 Q F0(and)2.886 E F2(port)2.886 E F0 5.386(.E)C .386
(.g., `host foo', `net 128.3', `port 20'.)-5.386 F .386
(If there is no type quali\214er)5.386 F(,)-.4 E F2(host)2.885 E F0(is)
2.885 E(assumed.)180 424.8 Q F1(dir)144 441.6 Q F0 .376
(quali\214ers specify a particular transfer direction to and/or from)
24.33 F F1(id.)2.876 E F0 .376(Possible directions are)5.376 F F2(sr)180
453.6 Q(c)-.18 E F0(,)A F2(dst)3.16 E F0(,)A F2(sr)3.16 E 3.16(co)-.18 G
3.16(rd)-3.16 G(st)-3.16 E F0(and)3.16 E F2(sr)3.16 E 3.16(ca)-.18 G .66
(nd dst)-3.16 F F0 5.66(.E)C .66
(.g., `src foo', `dst net 128.3', `src or dst port ftp-)-5.66 F 3.101
(data'. If)180 465.6 R .601(there is no dir quali\214er)3.101 F(,)-.4 E
F2(sr)3.101 E 3.101(co)-.18 G 3.101(rd)-3.101 G(st)-3.101 E F0 .601
(is assumed.)3.101 F -.15(Fo)5.601 G 3.101(r`).15 G .602
(null' link layers \(i.e. point)-3.101 F .092
(to point protocols such as slip\) the)180 477.6 R F2(inbound)2.592 E F0
(and)2.592 E F2(outbound)2.592 E F0 .092
(quali\214ers can be used to spec-)2.592 F(ify a desired direction.)180
489.6 Q F1(pr)144 506.4 Q(oto)-.45 E F0 .644
(quali\214ers restrict the match to a particular protocol.)14.78 F .644
(Possible protos are:)5.644 F F2(ether)3.144 E F0(,)A F2(fddi)3.144 E F0
(,)A F2(ip)3.144 E F0(,)A F2(ar)180 518.4 Q(p)-.1 E F0(,)A F2(rar)3.381
E(p)-.1 E F0(,)A F2(decnet)3.381 E F0(,)A F2(lat)3.381 E F0(,)A F2(sca)
3.381 E F0(,)A F2(mopr)3.381 E(c)-.18 E F0(,)A F2(mopdl)3.381 E F0(,)A
F2(tcp)3.381 E F0(and)3.381 E F2(udp)3.381 E F0 5.881(.E)C .88
(.g., `ether src foo', `arp net)-5.881 F .658(128.3', `tcp port 21'.)180
530.4 R .659(If there is no proto quali\214er)5.658 F 3.159(,a)-.4 G
.659(ll protocols consistent with the type)-3.159 F .996(are assumed.)
180 542.4 R .995
(E.g., `src foo' means `\(ip or arp or rarp\) src foo' \(e)5.996 F .995
(xcept the latter is not)-.15 F(le)180 554.4 Q -.05(ga)-.15 G 3.531(ls)
.05 G 1.031(yntax\), `net bar' means `\(ip or arp or rarp\) net bar' an\
d `port 53' means `\(tcp or)-3.531 F(udp\) port 53'.)180 566.4 Q .566([\
`fddi' is actually an alias for `ether'; the parser treats them identic\
ally as meaning `)144 583.2 R .565(`the data link)-.74 F(le)144 595.2 Q
-.15(ve)-.25 G 3.927(lu).15 G 1.427(sed on the speci\214ed netw)-3.927 F
1.427(ork interf)-.1 F(ace.)-.1 E 5.408 -.74('' F)-.7 H 1.428
(DDI headers contain Ethernet-lik).74 F 3.928(es)-.1 G 1.428(ource and)
-3.928 F 1.956(destination addresses, and often contain Ethernet-lik)144
607.2 R 4.456(ep)-.1 G(ack)-4.456 E 1.956
(et types, so you can \214lter on these)-.1 F .193
(FDDI \214elds just as with the analogous Ethernet \214elds.)144 619.2 R
.194(FDDI headers also contain other \214elds, b)5.193 F(ut)-.2 E
(you cannot name them e)144 631.2 Q(xplicitly in a \214lter e)-.15 E
(xpression.])-.15 E .281(In addition to the abo)144 648 R -.15(ve)-.15 G
2.781(,t).15 G .281(here are some special `primiti)-2.781 F -.15(ve)-.25
G 2.781('k).15 G -.15(ey)-2.881 G -.1(wo).15 G .28(rds that don').1 F
2.78(tf)-.18 G(ollo)-2.78 E 2.78(wt)-.25 G .28(he pattern:)-2.78 F F2
(gateway)144 660 Q F0(,)A F2(br)2.5 E(oadcast)-.18 E F0(,)A F2(less)2.5
E F0(,)A F2(gr)2.5 E(eater)-.18 E F0(and arithmetic e)2.5 E 2.5
(xpressions. All)-.15 F(of these are described belo)2.5 E -.65(w.)-.25 G
.161(More comple)144 676.8 R 2.661<788c>-.15 G .161(lter e)-2.661 F .161
(xpressions are b)-.15 F .161(uilt up by using the w)-.2 F(ords)-.1 E F2
(and)2.661 E F0(,)A F2(or)2.661 E F0(and)2.661 E F2(not)2.661 E F0 .162
(to combine prim-)2.662 F(iti)144 688.8 Q -.15(ve)-.25 G 3.565(s. E.g.,)
.15 F 1.064(`host foo and not port ftp and not port ftp-data'.)3.565 F
2.664 -.8(To s)6.064 H -2.25 -.2(av e).8 H 1.064
(typing, identical quali\214er)3.764 F .823(lists can be omitted.)144
700.8 R .823(E.g., `tcp dst port ftp or ftp-data or domain' is e)5.823 F
.824(xactly the same as `tcp dst)-.15 F
(port ftp or tcp dst port ftp-data or tcp dst port domain'.)144 712.8 Q
(Allo)144 729.6 Q -.1(wa)-.25 G(ble primiti).1 E -.15(ve)-.25 G 2.5(sa)
.15 G(re:)-2.5 E(30 June 1997)279.335 768 Q(2)202.335 E EP
%%Page: 3 3
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 347.72(TCPDUMP\(1\) TCPDUMP\(1\))72 48 R/F1 10
/Times-Bold@0 SF(dst host)144 84 Q/F2 10/Times-Italic@0 SF(host)2.5 E F0
-.35(Tr)180 96 S .507(ue if the IP destination \214eld of the pack).35 F
.507(et is)-.1 F F2(host)3.007 E F0 3.007(,w)C .506
(hich may be either an address or a)-3.007 F(name.)180 108 Q F1(sr)144
124.8 Q 2.5(ch)-.18 G(ost)-2.5 E F2(host)2.5 E F0 -.35(Tr)180 136.8 S
(ue if the IP source \214eld of the pack).35 E(et is)-.1 E F2(host)2.5 E
F0(.)A F1(host)144 153.6 Q F2(host)2.5 E F0 -.35(Tr)180 165.6 S 1.053
(ue if either the IP source or destination of the pack).35 F 1.053
(et is)-.1 F F2(host)3.553 E F0 6.053(.A)C 1.353 -.15(ny o)-6.053 H
3.553(ft).15 G 1.053(he abo)-3.553 F 1.353 -.15(ve h)-.15 H(ost).15 E
-.15(ex)180 177.6 S(pressions can be prepended with the k).15 E -.15(ey)
-.1 G -.1(wo).15 G(rds,).1 E F1(ip)2.5 E F0(,)A F1(ar)2.5 E(p)-.1 E F0
2.5(,o)C(r)-2.5 E F1(rar)2.5 E(p)-.1 E F0(as in:)2.5 E F1(ip host)216
189.6 Q F2(host)2.5 E F0(which is equi)180 201.6 Q -.25(va)-.25 G
(lent to:).25 E F1(ether pr)216 213.6 Q(oto)-.18 E F2(\\ip)2.5 E F1
(and host)2.5 E F2(host)2.5 E F0(If)180 225.6 Q F2(host)2.5 E F0
(is a name with multiple IP addresses, each address will be check)2.5 E
(ed for a match.)-.1 E F1(ether dst)144 242.4 Q F2(ehost)2.5 E F0 -.35
(Tr)180 254.4 S 2.252(ue if the ethernet destination address is).35 F F2
(ehost)4.751 E F0(.)A F2(Ehost)7.251 E F0 2.251
(may be either a name from)4.751 F(/etc/ethers or a number \(see)180
266.4 Q F2(ether)2.5 E(s)-.1 E F0(\(3N\) for numeric format\).).27 E F1
(ether sr)144 283.2 Q(c)-.18 E F2(ehost)2.5 E F0 -.35(Tr)180 295.2 S
(ue if the ethernet source address is).35 E F2(ehost)2.5 E F0(.)A F1
(ether host)144 312 Q F2(ehost)2.5 E F0 -.35(Tr)180 324 S
(ue if either the ethernet source or destination address is).35 E F2
(ehost)2.5 E F0(.)A F1(gateway)144 340.8 Q F2(host)2.5 E F0 -.35(Tr)180
352.8 S .439(ue if the pack).35 F .439(et used)-.1 F F2(host)2.939 E F0
.439(as a g)2.939 F(ate)-.05 E -.1(wa)-.25 G 4.239 -.65(y. I).1 H .44
(.e., the ethernet source or destination address).65 F -.1(wa)180 364.8
S(s).1 E F2(host)3 E F0 -.2(bu)3 G 3(tn).2 G .5
(either the IP source nor the IP destination w)-3 F(as)-.1 E F2(host)
2.999 E F0(.)A F2(Host)5.499 E F0 .499(must be a name)2.999 F
(and must be found in both /etc/hosts and /etc/ethers.)180 376.8 Q
(\(An equi)5 E -.25(va)-.25 G(lent e).25 E(xpression is)-.15 E F1
(ether host)216 388.8 Q F2(ehost)2.5 E F1(and not host)2.5 E F2(host)2.5
E F0(which can be used with either names or numbers for)180 400.8 Q F2
(host / ehost)2.5 E F0(.\))A F1(dst net)144 417.6 Q F2(net)2.5 E F0 -.35
(Tr)180 429.6 S .396(ue if the IP destination address of the pack).35 F
.396(et has a netw)-.1 F .396(ork number of)-.1 F F2(net)2.896 E F0(.)A
F2(Net)2.896 E F0 .396(may be)2.896 F(either a name from /etc/netw)180
441.6 Q(orks or a netw)-.1 E(ork number \(see)-.1 E F2(networks\(4\))2.5
E F0(for details\).)2.5 E F1(sr)144 458.4 Q 2.5(cn)-.18 G(et)-2.5 E F2
(net)2.5 E F0 -.35(Tr)180 470.4 S
(ue if the IP source address of the pack).35 E(et has a netw)-.1 E
(ork number of)-.1 E F2(net)2.5 E F0(.)A F1(net)144 487.2 Q F2(net)2.5 E
F0 -.35(Tr)7.95 G .456
(ue if either the IP source or destination address of the pack).35 F
.456(et has a netw)-.1 F .456(ork number of)-.1 F F2(net)180 499.2 Q F0
(.)A F1(net)144 516 Q F2(net)2.5 E F1(mask)2.5 E F2(mask)2.5 E F0 -.35
(Tr)180 528 S .65(ue if the IP address matches).35 F F2(net)3.15 E F0
.65(with the speci\214c netmask.)3.15 F .65(May be quali\214ed with)5.65
F F1(sr)3.15 E(c)-.18 E F0(or)180 540 Q F1(dst)2.5 E F0(.)A F1(net)144
556.8 Q F2(net)2.5 E F0(/)A F2(len)A F0 -.35(Tr)180 568.8 S .378
(ue if the IP address matches).35 F F2(net)2.878 E F0 2.878(an)2.878 G
(etmask)-2.878 E F2(len)2.878 E F0 .378(bits wide.)2.878 F .377
(May be quali\214ed with)5.377 F F1(sr)2.877 E(c)-.18 E F0(or)2.877 E F1
(dst)180 580.8 Q F0(.)A F1(dst port)144 597.6 Q F2(port)2.5 E F0 -.35
(Tr)180 609.6 S .909(ue if the pack).35 F .909
(et is ip/tcp or ip/udp and has a destination port v)-.1 F .91(alue of)
-.25 F F2(port)3.41 E F0 5.91(.T)C(he)-5.91 E F2(port)3.41 E F0 .523
(can be a number or a name used in /etc/services \(see)180 621.6 R F2
(tcp)3.022 E F0 .522(\(4P\) and).19 F F2(udp)3.022 E F0 3.022
(\(4P\)\). If).19 F 3.022(an)3.022 G .522(ame is)-3.022 F .344
(used, both the port number and protocol are check)180 633.6 R 2.845
(ed. If)-.1 F 2.845(an)2.845 G .345(umber or ambiguous name is)-2.845 F
.526(used, only the port number is check)180 645.6 R .525(ed \(e.g.,)-.1
F F1 .525(dst port 513)3.025 F F0 .525(will print both tcp/login traf)
3.025 F<8c63>-.25 E .043(and udp/who traf)180 657.6 R .043(\214c, and)
-.25 F F1 .043(port domain)2.543 F F0 .044
(will print both tcp/domain and udp/domain traf)2.543 F(\214c\).)-.25 E
F1(sr)144 674.4 Q 2.5(cp)-.18 G(ort)-2.5 E F2(port)2.5 E F0 -.35(Tr)180
686.4 S(ue if the pack).35 E(et has a source port v)-.1 E(alue of)-.25 E
F2(port)2.5 E F0(.)A F1(port)144 703.2 Q F2(port)2.5 E F0 -.35(Tr)180
715.2 S .661(ue if either the source or destination port of the pack).35
F .661(et is)-.1 F F2(port)3.161 E F0 5.661(.A)C .961 -.15(ny o)-5.661 H
3.161(ft).15 G .661(he abo)-3.161 F .961 -.15(ve p)-.15 H(ort).15 E -.15
(ex)180 727.2 S(pressions can be prepended with the k).15 E -.15(ey)-.1
G -.1(wo).15 G(rds,).1 E F1(tcp)2.5 E F0(or)2.5 E F1(udp)2.5 E F0 2.5
(,a)C 2.5(si)-2.5 G(n:)-2.5 E(30 June 1997)279.335 768 Q(3)202.335 E EP
%%Page: 4 4
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 347.72(TCPDUMP\(1\) TCPDUMP\(1\))72 48 R/F1 10
/Times-Bold@0 SF(tcp sr)216 84 Q 2.5(cp)-.18 G(ort)-2.5 E/F2 10
/Times-Italic@0 SF(port)2.5 E F0(which matches only tcp pack)180 96 Q
(ets whose source port is)-.1 E F2(port)2.5 E F0(.)A F1(less)144 112.8 Q
F2(length)2.5 E F0 -.35(Tr)180 124.8 S(ue if the pack).35 E
(et has a length less than or equal to)-.1 E F2(length)2.5 E F0 5(.T)C
(his is equi)-5 E -.25(va)-.25 G(lent to:).25 E F1(len <=)216 136.8 Q F2
(length)2.5 E F1(.)A(gr)144 153.6 Q(eater)-.18 E F2(length)2.5 E F0 -.35
(Tr)180 165.6 S(ue if the pack).35 E
(et has a length greater than or equal to)-.1 E F2(length)2.5 E F0 5(.T)
C(his is equi)-5 E -.25(va)-.25 G(lent to:).25 E F1(len >=)216 177.6 Q
F2(length)2.5 E F1(.)A(ip pr)144 194.4 Q(oto)-.18 E F2(pr)2.5 E(otocol)
-.45 E F0 -.35(Tr)180 206.4 S .029(ue if the pack).35 F .029
(et is an ip pack)-.1 F .029(et \(see)-.1 F F2(ip)2.529 E F0 .03
(\(4P\)\) of protocol type).19 F F2(pr)2.53 E(otocol)-.45 E F0(.)A F2
(Pr)5.03 E(otocol)-.45 E F0 .03(can be a)2.53 F .15
(number or one of the names)180 218.4 R F2(icmp)2.65 E F0(,)A F2(igrp)
2.65 E F0(,)A F2(udp)2.649 E F0(,)A F2(nd)2.649 E F0 2.649(,o)C(r)-2.649
E F2(tcp)2.649 E F0 5.149(.N)C .149(ote that the identi\214ers)-5.149 F
F2(tcp)2.649 E F0(,)A F2(udp)2.649 E F0(,)A(and)180 230.4 Q F2(icmp)3.21
E F0 .71(are also k)3.21 F -.15(ey)-.1 G -.1(wo).15 G .711
(rds and must be escaped via backslash \(\\\), which is \\\\ in the C-)
.1 F(shell.)180 242.4 Q F1(ether br)144 259.2 Q(oadcast)-.18 E F0 -.35
(Tr)180 271.2 S(ue if the pack).35 E(et is an ethernet broadcast pack)
-.1 E 2.5(et. The)-.1 F F2(ether)2.5 E F0 -.1(ke)2.5 G(yw)-.05 E
(ord is optional.)-.1 E F1(ip br)144 288 Q(oadcast)-.18 E F0 -.35(Tr)180
300 S .18(ue if the pack).35 F .18(et is an IP broadcast pack)-.1 F
2.679(et. It)-.1 F .179(checks for both the all-zeroes and all-ones)
2.679 F(broadcast con)180 312 Q -.15(ve)-.4 G
(ntions, and looks up the local subnet mask.).15 E F1(ether multicast)
144 328.8 Q F0 -.35(Tr)180 340.8 S .267(ue if the pack).35 F .267
(et is an ethernet multicast pack)-.1 F 2.767(et. The)-.1 F F2(ether)
2.767 E F0 -.1(ke)2.768 G(yw)-.05 E .268(ord is optional.)-.1 F .268
(This is)5.268 F(shorthand for `)180 352.8 Q F1(ether[0] & 1 != 0)A F0
('.)A F1(ip multicast)144 369.6 Q F0 -.35(Tr)180 381.6 S(ue if the pack)
.35 E(et is an IP multicast pack)-.1 E(et.)-.1 E F1(ether pr)144 398.4 Q
(oto)-.18 E F2(pr)2.5 E(otocol)-.45 E F0 -.35(Tr)180 410.4 S .502
(ue if the pack).35 F .501(et is of ether type)-.1 F F2(pr)3.001 E
(otocol)-.45 E F0(.)A F2(Pr)5.501 E(otocol)-.45 E F0 .501
(can be a number or a name lik)3.001 F(e)-.1 E F2(ip)3.001 E F0(,)A F2
(arp)180 422.4 Q F0 2.837(,o)C(r)-2.837 E F2 -.15(ra)2.837 G(rp).15 E F0
5.338(.N)C .338(ote these identi\214ers are also k)-5.338 F -.15(ey)-.1
G -.1(wo).15 G .338(rds and must be escaped via backslash).1 F 3.744
(\(\\\). [In)180 434.4 R 1.244(the case of FDDI \(e.g., `)3.744 F F1
1.244(fddi pr)B 1.244(otocol ar)-.18 F(p)-.1 E F0 1.244
('\), the protocol identi\214cation comes)B .085
(from the 802.2 Logical Link Control \(LLC\) header)180 446.4 R 2.585
(,w)-.4 G .086(hich is usually layered on top of the)-2.585 F .592
(FDDI header)180 458.4 R(.)-.55 E F2(Tcpdump)5.592 E F0 .592
(assumes, when \214ltering on the protocol identi\214er)3.092 F 3.091
(,t)-.4 G .591(hat all FDDI)-3.091 F(pack)180 470.4 Q
(ets include an LLC header)-.1 E 2.5(,a)-.4 G
(nd that the LLC header is in so-called SN)-2.5 E(AP format.])-.35 E F1
(decnet sr)144 487.2 Q(c)-.18 E F2(host)2.5 E F0 -.35(Tr)180 499.2 S
2.204(ue if the DECNET source address is).35 F F2(host)4.705 E F0 4.705
(,w).68 G 2.205(hich may be an address of the form)-4.705 F -.74(``)180
511.2 S(10.123').74 E .686(', or a DECNET host name.)-.74 F .686
([DECNET host name support is only a)5.686 F -.25(va)-.2 G .686
(ilable on).25 F(Ultrix systems that are con\214gured to run DECNET)180
523.2 Q(.])-.74 E F1(decnet dst)144 540 Q F2(host)2.5 E F0 -.35(Tr)180
552 S(ue if the DECNET destination address is).35 E F2(host)2.5 E F0(.)
.68 E F1(decnet host)144 568.8 Q F2(host)2.5 E F0 -.35(Tr)180 580.8 S
(ue if either the DECNET source or destination address is).35 E F2(host)
2.5 E F0(.).68 E F1(ip)144 597.6 Q F0(,)A F1(ar)2.5 E(p)-.1 E F0(,)A F1
(rar)2.5 E(p)-.1 E F0(,)A F1(decnet)2.5 E F0(Abbre)180 609.6 Q
(viations for:)-.25 E F1(ether pr)216 621.6 Q(oto)-.18 E F2(p)2.5 E F0
(where)180 633.6 Q F2(p)2.5 E F0(is one of the abo)2.5 E .3 -.15(ve p)
-.15 H(rotocols.).15 E F1(lat)144 650.4 Q F0(,)A F1(mopr)2.5 E(c)-.18 E
F0(,)A F1(mopdl)2.5 E F0(Abbre)180 662.4 Q(viations for:)-.25 E F1
(ether pr)216 674.4 Q(oto)-.18 E F2(p)2.5 E F0(where)180 686.4 Q F2(p)
2.518 E F0 .018(is one of the abo)2.518 F .319 -.15(ve p)-.15 H 2.519
(rotocols. Note).15 F(that)2.519 E F2(tcpdump)2.519 E F0 .019
(does not currently kno)2.519 F 2.519(wh)-.25 G .519 -.25(ow t)-2.519 H
(o).25 E(parse these protocols.)180 698.4 Q(30 June 1997)279.335 768 Q
(4)202.335 E EP
%%Page: 5 5
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 347.72(TCPDUMP\(1\) TCPDUMP\(1\))72 48 R/F1 10
/Times-Bold@0 SF(tcp)144 84 Q F0(,)A F1(udp)2.5 E F0(,)A F1(icmp)2.5 E
F0(Abbre)180 96 Q(viations for:)-.25 E F1(ip pr)216 108 Q(oto)-.18 E/F2
10/Times-Italic@0 SF(p)2.5 E F0(where)180 120 Q F2(p)2.5 E F0
(is one of the abo)2.5 E .3 -.15(ve p)-.15 H(rotocols.).15 E F2 -.2(ex)
144 136.8 S(pr r).2 E(elop e)-.37 E(xpr)-.2 E F0 -.35(Tr)180 148.8 S
.529(ue if the relation holds, where).35 F F2 -.37(re)3.029 G(lop).37 E
F0 .529(is one of >, <, >=, <=, =, !=, and)3.029 F F2 -.2(ex)3.029 G(pr)
.2 E F0 .529(is an arith-)3.029 F 1.712(metic e)180 160.8 R 1.712
(xpression composed of inte)-.15 F 1.713(ger constants \(e)-.15 F 1.713
(xpressed in standard C syntax\), the)-.15 F .376
(normal binary operators [+, -, *, /, &, |], a length operator)180 172.8
R 2.875(,a)-.4 G .375(nd special pack)-2.875 F .375(et data acces-)-.1 F
2.5(sors. T)180 184.8 R 2.5(oa)-.8 G(ccess data inside the pack)-2.5 E
(et, use the follo)-.1 E(wing syntax:)-.25 E F2(pr)216 196.8 Q(oto)-.45
E F1([)2.5 E F2 -.2(ex)2.5 G(pr).2 E F1(:)2.5 E F2(size)2.5 E F1(])2.5 E
F2(Pr)180 208.8 Q(oto)-.45 E F0 .758(is one of)3.258 F F1(ether)3.258 E
3.259(,f)-.92 G .759(ddi, ip, ar)-3.259 F .759(p, rar)-.1 F .759
(p, tcp, udp,)-.1 F F0(or)3.259 E F1(icmp)3.259 E F0 3.259(,a)C .759
(nd indicates the protocol)-3.259 F .726(layer for the inde)180 220.8 R
3.226(xo)-.15 G 3.226(peration. The)-3.226 F .726(byte of)3.226 F .726
(fset, relati)-.25 F 1.026 -.15(ve t)-.25 H 3.226(ot).15 G .725
(he indicated protocol layer)-3.226 F 3.225(,i)-.4 G(s)-3.225 E(gi)180
232.8 Q -.15(ve)-.25 G 2.585(nb).15 G(y)-2.585 E F2 -.2(ex)2.585 G(pr).2
E F0(.)A F2(Size)5.086 E F0 .086(is optional and indicates the number o\
f bytes in the \214eld of interest; it)2.586 F .276
(can be either one, tw)180 244.8 R .276(o, or four)-.1 F 2.776(,a)-.4 G
.276(nd def)-2.776 F .276(aults to one.)-.1 F .275(The length operator)
5.275 F 2.775(,i)-.4 G .275(ndicated by the)-2.775 F -.1(ke)180 256.8 S
(yw)-.05 E(ord)-.1 E F1(len)2.5 E F0 2.5(,g)C -2.15 -.25(iv e)-2.5 H 2.5
(st).25 G(he length of the pack)-2.5 E(et.)-.1 E -.15(Fo)180 280.8 S
3.398(re).15 G .898(xample, `)-3.548 F F1 .898(ether[0] & 1 != 0)B F0
3.399('c)C .899(atches all multicast traf)-3.399 F 3.399(\214c. The)-.25
F -.15(ex)3.399 G .899(pression `).15 F F1 .899(ip[0] &)B 1.78(0xf != 5)
180 292.8 R F0 4.28('c)C 1.78(atches all IP pack)-4.28 F 1.779
(ets with options. The e)-.1 F 1.779(xpression `)-.15 F F1 1.779
(ip[6:2] & 0x1fff = 0)B F0(')A 2.565(catches only unfragmented datagram\
s and frag zero of fragmented datagrams.)180 304.8 R(This)7.565 E 1.692
(check is implicitly applied to the)180 316.8 R F1(tcp)4.192 E F0(and)
4.192 E F1(udp)4.191 E F0(inde)4.191 E 4.191(xo)-.15 G 4.191
(perations. F)-4.191 F 1.691(or instance,)-.15 F F1(tcp[0])4.191 E F0
(al)180 328.8 Q -.1(wa)-.1 G .246(ys means the \214rst byte of the TCP)
.1 F F2(header)2.746 E F0 2.746(,a)C .247(nd ne)-2.746 F -.15(ve)-.25 G
2.747(rm).15 G .247(eans the \214rst byte of an inter)-2.747 F(-)-.2 E
-.15(ve)180 340.8 S(ning fragment.).15 E(Primiti)144 357.6 Q -.15(ve)
-.25 G 2.5(sm).15 G(ay be combined using:)-2.5 E 3.651(Ap)180 374.4 S
1.151(arenthesized group of primiti)-3.651 F -.15(ve)-.25 G 3.651(sa).15
G 1.151(nd operators \(parentheses are special to the Shell)-3.651 F
(and must be escaped\).)180 386.4 Q(Ne)180 403.2 Q -.05(ga)-.15 G
(tion \(`).05 E F1(!)A F0 2.5('o)C 2.5(r`)-2.5 G F1(not)-2.5 E F0('\).)A
(Concatenation \(`)180 420 Q F1(&&)A F0 2.5('o)C 2.5(r`)-2.5 G F1(and)
-2.5 E F0('\).)A(Alternation \(`)180 436.8 Q F1(||)A F0 2.5('o)C 2.5(r`)
-2.5 G F1(or)-2.5 E F0('\).)A(Ne)144 453.6 Q -.05(ga)-.15 G .379
(tion has highest precedence.).05 F .379
(Alternation and concatenation ha)5.379 F .679 -.15(ve e)-.2 H .379
(qual precedence and asso-).15 F .048(ciate left to right.)144 465.6 R
.048(Note that e)5.048 F(xplicit)-.15 E F1(and)2.548 E F0(tok)2.548 E
.048(ens, not juxtaposition, are no)-.1 F 2.548(wr)-.25 G .048
(equired for concatena-)-2.548 F(tion.)144 477.6 Q
(If an identi\214er is gi)144 494.4 Q -.15(ve)-.25 G 2.5(nw).15 G
(ithout a k)-2.5 E -.15(ey)-.1 G -.1(wo).15 G(rd, the most recent k).1 E
-.15(ey)-.1 G -.1(wo).15 G(rd is assumed.).1 E -.15(Fo)5 G 2.5(re).15 G
(xample,)-2.65 E F1(not host vs and ace)180 506.4 Q F0(is short for)144
518.4 Q F1(not host vs and host ace)180 530.4 Q F0
(which should not be confused with)144 542.4 Q F1
(not \( host vs or ace \))180 554.4 Q F0 .792(Expression ar)144 571.2 R
.792(guments can be passed to tcpdump as either a single ar)-.18 F .792
(gument or as multiple ar)-.18 F(gu-)-.18 E .611(ments, whiche)144 583.2
R -.15(ve)-.25 G 3.111(ri).15 G 3.111(sm)-3.111 G .611(ore con)-3.111 F
-.15(ve)-.4 G 3.111(nient. Generally).15 F 3.111(,i)-.65 G 3.111(ft)
-3.111 G .611(he e)-3.111 F .611
(xpression contains Shell metacharacters,)-.15 F 1.686
(it is easier to pass it as a single, quoted ar)144 595.2 R 4.187
(gument. Multiple)-.18 F(ar)4.187 E 1.687(guments are concatenated with)
-.18 F(spaces before being parsed.)144 607.2 Q/F3 9/Times-Bold@0 SF
(EXAMPLES)72 624 Q F0 1.6 -.8(To p)108 636 T(rint all pack).8 E
(ets arri)-.1 E(ving at or departing from)-.25 E F2(sundown)2.5 E F0(:)A
F1(tcpdump host sundo)144 648 Q(wn)-.1 E F0 1.6 -.8(To p)108 664.8 T
(rint traf).8 E(\214c between)-.25 E F2(helios)2.5 E F0(and either)2.5 E
F2(hot)2.5 E F0(or)2.5 E F2(ace)2.5 E F0(:)A F1
(tcpdump host helios and \\\( hot or ace \\\))144 676.8 Q F0 1.6 -.8
(To p)108 693.6 T(rint all IP pack).8 E(ets between)-.1 E F2(ace)2.5 E
F0(and an)2.5 E 2.5(yh)-.15 G(ost e)-2.5 E(xcept)-.15 E F2(helios)2.5 E
F0(:)A F1(tcpdump ip host ace and not helios)144 705.6 Q F0 1.6 -.8
(To p)108 722.4 T(rint all traf).8 E
(\214c between local hosts and hosts at Berk)-.25 E(ele)-.1 E(y:)-.15 E
(30 June 1997)279.335 768 Q(5)202.335 E EP
%%Page: 6 6
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 347.72(TCPDUMP\(1\) TCPDUMP\(1\))72 48 R/F1 10
/Times-Bold@0 SF(tcpdump net ucb-ether)144 84 Q F0 1.825 -.8(To p)108
100.8 T .225(rint all ftp traf).8 F .225(\214c through internet g)-.25 F
(ate)-.05 E -.1(wa)-.25 G(y).1 E/F2 10/Times-Italic@0 SF(snup)2.725 E F0
2.725(:\()C .225(note that the e)-2.725 F .225
(xpression is quoted to pre)-.15 F -.15(ve)-.25 G .225(nt the shell).15
F(from \(mis-\)interpreting the parentheses\):)108 112.8 Q F1
(tcpdump 'gateway snup and \(port ftp or ftp-data\)')144 124.8 Q F0
2.003 -.8(To p)108 141.6 T .403(rint traf).8 F .403
(\214c neither sourced from nor destined for local hosts \(if you g)-.25
F(ate)-.05 E -.1(wa)-.25 G 2.903(yt).1 G 2.903(oo)-2.903 G .404
(ne other net, this stuf)-2.903 F(f)-.25 E(should ne)108 153.6 Q -.15
(ve)-.25 G 2.5(rm).15 G(ak)-2.5 E 2.5(ei)-.1 G 2.5(to)-2.5 G
(nto your local net\).)-2.5 E F1(tcpdump ip and not net)144 165.6 Q F2
(localnet)2.5 E F0 1.67 -.8(To p)108 182.4 T .07
(rint the start and end pack).8 F .07(ets \(the SYN and FIN pack)-.1 F
.069(ets\) of each TCP con)-.1 F -.15(ve)-.4 G .069(rsation that in).15
F -.2(vo)-.4 G(lv).2 E .069(es a non-)-.15 F(local host.)108 194.4 Q F1
(tcpdump 'tcp[13] & 3 != 0 and not sr)144 206.4 Q 2.5(ca)-.18 G
(nd dst net)-2.5 E F2(localnet)2.5 E F1(')A F0 1.6 -.8(To p)108 223.2 T
(rint IP pack).8 E(ets longer than 576 bytes sent through g)-.1 E(ate)
-.05 E -.1(wa)-.25 G(y).1 E F2(snup)2.5 E F0(:)A F1
(tcpdump 'gateway snup and ip[2:2] > 576')144 235.2 Q F0 1.6 -.8(To p)
108 252 T(rint IP broadcast or multicast pack).8 E(ets that were)-.1 E
F2(not)2.5 E F0(sent via ethernet broadcast or multicast:)2.5 E F1
(tcpdump 'ether[0] & 1 = 0 and ip[16] >= 224')144 264 Q F0 1.6 -.8(To p)
108 280.8 T(rint all ICMP pack).8 E
(ets that are not echo requests/replies \(i.e., not ping pack)-.1 E
(ets\):)-.1 E F1(tcpdump 'icmp[0] != 8 and icmp[0] != 0")144 292.8 Q/F3
9/Times-Bold@0 SF(OUTPUT FORMA)72 309.6 Q(T)-.855 E F0 1.431
(The output of)108 321.6 R F2(tcpdump)3.931 E F0 1.431
(is protocol dependent.)3.931 F 1.431(The follo)6.431 F 1.431(wing gi)
-.25 F -.15(ve)-.25 G -6.43 3.931(sa b).15 H 1.432
(rief description and e)-3.931 F 1.432(xamples of)-.15 F
(most of the formats.)108 333.6 Q F1(Link Le)108 363.6 Q -.1(ve)-.15 G
2.5(lH).1 G(eaders)-2.5 E F0 1.301(If the '-e' option is gi)108 380.4 R
-.15(ve)-.25 G 1.301(n, the link le).15 F -.15(ve)-.25 G 3.801(lh).15 G
1.301(eader is printed out.)-3.801 F 1.301
(On ethernets, the source and destination)6.301 F
(addresses, protocol, and pack)108 392.4 Q(et length are printed.)-.1 E
.275(On FDDI netw)108 409.2 R .275(orks, the)-.1 F .275
('-e' option causes)5.275 F F2(tcpdump)2.775 E F0 .275
(to print the `frame control' \214eld,)2.775 F .276
(the source and desti-)5.276 F .486(nation addresses, and the pack)108
421.2 R .486(et length.)-.1 F .486(\(The `frame control' \214eld go)
5.486 F -.15(ve)-.15 G .485(rns the interpretation of the rest of).15 F
1.196(the pack)108 433.2 R 3.696(et. Normal)-.1 F(pack)3.696 E 1.197
(ets \(such as those containing IP datagrams\) are `async' pack)-.1 F
1.197(ets, with a priority)-.1 F -.25(va)108 445.2 S .234
(lue between 0 and 7; for e).25 F .234(xample, `)-.15 F F1(async4)A F0
2.734('. Such)B(pack)2.734 E .233
(ets are assumed to contain an 802.2 Logical Link)-.1 F
(Control \(LLC\) pack)108 457.2 Q
(et; the LLC header is printed if it is)-.1 E F2(not)2.5 E F0
(an ISO datagram or a so-called SN)2.5 E(AP pack)-.35 E(et.)-.1 E F2
1.539(\(N.B.: The following description assumes familiarity with the SL\
IP compr)108 474 R 1.54(ession algorithm described in)-.37 F
(RFC-1144.\))108 486 Q F0 .917(On SLIP links, a direction indicator \(`)
108 502.8 R(`I')-.74 E 3.417('f)-.74 G .917(or inbound, `)-3.417 F(`O')
-.74 E 3.417('f)-.74 G .916(or outbound\), pack)-3.417 F .916
(et type, and compression)-.1 F .14(information are printed out.)108
514.8 R .14(The pack)5.14 F .14(et type is printed \214rst.)-.1 F .14
(The three types are)5.14 F F2(ip)2.64 E F0(,)A F2(utcp)2.64 E F0 2.64
(,a)C(nd)-2.64 E F2(ctcp)2.64 E F0 5.14(.N)C 2.64(of)-5.14 G(ur)-2.64 E
(-)-.2 E .217(ther link information is printed for)108 526.8 R F2(ip)
2.717 E F0(pack)2.717 E 2.717(ets. F)-.1 F .217(or TCP pack)-.15 F .217
(ets, the connection identi\214er is printed follo)-.1 F(w-)-.25 E .631
(ing the type.)108 538.8 R .631(If the pack)5.631 F .631
(et is compressed, its encoded header is printed out.)-.1 F .631
(The special cases are printed)5.631 F .763(out as)108 550.8 R F1(*S+)
3.263 E F2(n)A F0(and)3.263 E F1(*SA+)3.263 E F2(n)A F0 3.263(,w)C(here)
-3.263 E F2(n)3.263 E F0 .763
(is the amount by which the sequence number \(or sequence number and)
3.263 F .339(ack\) has changed.)108 562.8 R .339
(If it is not a special case, zero or more changes are printed.)5.339 F
2.839(Ac)5.339 G .339(hange is indicated by U)-2.839 F(\(ur)108 574.8 Q
.358(gent pointer\), W \(windo)-.18 F .357
(w\), A \(ack\), S \(sequence number\), and I \(pack)-.25 F .357
(et ID\), follo)-.1 F .357(wed by a delta \(+n or)-.25 F 1.724
(-n\), or a ne)108 586.8 R 4.224(wv)-.25 G 1.724(alue \(=n\).)-4.474 F
(Finally)6.724 E 4.224(,t)-.65 G 1.724(he amount of data in the pack)
-4.224 F 1.725(et and compressed header length are)-.1 F(printed.)108
598.8 Q -.15(Fo)108 615.6 S 3.424(re).15 G .924(xample, the follo)-3.574
F .924(wing line sho)-.25 F .924(ws an outbound compressed TCP pack)-.25
F .923(et, with an implicit connection)-.1 F .435(identi\214er; the ack\
 has changed by 6, the sequence number by 49, and the pack)108 627.6 R
.436(et ID by 6; there are 3 bytes)-.1 F
(of data and 6 bytes of compressed header:)108 639.6 Q F1 2.5(Oc)144
651.6 S(tcp * A+6 S+49 I+6 3 \(6\))-2.5 E(ARP/RARP P)108 681.6 Q(ack)-.1
E(ets)-.1 E F0 .227(Arp/rarp output sho)108 698.4 R .227
(ws the type of request and its ar)-.25 F 2.726(guments. The)-.18 F .226
(format is intended to be self e)2.726 F(xplanatory)-.15 E(.)-.65 E
(Here is a short sample tak)108 710.4 Q
(en from the start of an `rlogin' from host)-.1 E F2(rtsg)2.5 E F0
(to host)2.5 E F2(csam)2.5 E F0(:)A/F4 10/Courier@0 SF
(arp who-has csam tell rtsg)144 728.4 Q F0(30 June 1997)279.335 768 Q(6)
202.335 E EP
%%Page: 7 7
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 347.72(TCPDUMP\(1\) TCPDUMP\(1\))72 48 R/F1 10
/Courier@0 SF(arp reply csam is-at CSAM)144 84 Q F0 .567
(The \214rst line says that rtsg sent an arp pack)108 102 R .568
(et asking for the ethernet address of internet host csam.)-.1 F(Csam)
5.568 E .922(replies with its ethernet address \(in this e)108 114 R
.921(xample, ethernet addresses are in caps and internet addresses in)
-.15 F(lo)108 126 Q(wer case\).)-.25 E(This w)108 142.8 Q
(ould look less redundant if we had done)-.1 E/F2 10/Times-Bold@0 SF
(tcpdump \255n)2.5 E F0(:)A F1
(arp who-has 128.3.254.6 tell 128.3.254.68)144 160.8 Q
(arp reply 128.3.254.6 is-at 02:07:01:00:01:c4)144 172.8 Q F0 1.46
(If we had done)108 189.6 R F2 1.46(tcpdump \255e)3.96 F F0 3.96(,t)C
1.46(he f)-3.96 F 1.46(act that the \214rst pack)-.1 F 1.46
(et is broadcast and the second is point-to-point)-.1 F -.1(wo)108 201.6
S(uld be visible:).1 E F1(RTSG Broadcast 0806)144 219.6 Q
(64: arp who-has csam tell rtsg)12 E(CSAM RTSG 0806)144 231.6 Q
(64: arp reply csam is-at CSAM)12 E F0 -.15(Fo)108 249.6 S 3.096(rt).15
G .596(he \214rst pack)-3.096 F .596
(et this says the ethernet source address is R)-.1 F .596
(TSG, the destination is the ethernet broadcast)-.6 F
(address, the type \214eld contained he)108 261.6 Q 2.5(x0)-.15 G
(806 \(type ETHER_ARP\) and the total length w)-2.5 E(as 64 bytes.)-.1 E
F2(TCP P)108 291.6 Q(ack)-.1 E(ets)-.1 E/F3 10/Times-Italic@0 SF .85
(\(N.B.:The following description assumes familiarity with the TCP pr)
108 308.4 R .85(otocol described in RFC-793.)-.45 F .85(If you)5.85 F
(ar)108 320.4 Q 2.5(en)-.37 G(ot familiar with the pr)-2.5 E
(otocol, neither this description nor tcpdump will be of muc)-.45 E 2.5
(hu)-.15 G(se to you.\))-2.5 E F0
(The general format of a tcp protocol line is:)108 337.2 Q F3(sr)144
355.2 Q 2.5(c>d)-.37 G(st: \215a)-2.5 E(gs data-seqno ac)-.1 E 2.5(kw)
-.2 G(indow ur)-2.5 E -.1(ge)-.37 G(nt options).1 E(Sr)108 373.2 Q(c)
-.37 E F0(and)2.688 E F3(dst)2.688 E F0 .187
(are the source and destination IP addresses and ports.)2.688 F F3(Fla)
5.187 E(gs)-.1 E F0 .187(are some combination of S \(SYN\),)2.687 F
3.764(F\()108 385.2 S 1.264
(FIN\), P \(PUSH\) or R \(RST\) or a single `.)-3.764 F 3.765('\()-.7 G
1.265(no \215ags\).)-3.765 F F3(Data-seqno)6.265 E F0 1.265
(describes the portion of sequence)3.765 F 1.169(space co)108 397.2 R
-.15(ve)-.15 G 1.169(red by the data in this pack).15 F 1.169
(et \(see e)-.1 F 1.169(xample belo)-.15 F(w\).)-.25 E F3(Ac)6.169 E(k)
-.2 E F0 1.169(is sequence number of the ne)3.669 F 1.168(xt data)-.15 F
-.15(ex)108 409.2 S 1.303
(pected the other direction on this connection.).15 F F3 -.55(Wi)6.304 G
(ndow).55 E F0 1.304(is the number of bytes of recei)3.804 F 1.604 -.15
(ve b)-.25 H(uf)-.05 E 1.304(fer space)-.25 F -.2(av)108 421.2 S .337
(ailable the other direction on this connection.)-.05 F F3(Ur)5.337 E(g)
-.37 E F0 .337(indicates there is `ur)2.837 F .337
(gent' data in the pack)-.18 F(et.)-.1 E F3(Options)5.336 E F0
(are tcp options enclosed in angle brack)108 433.2 Q
(ets \(e.g., <mss 1024>\).)-.1 E F3(Sr)108 450 Q .667(c, dst)-.37 F F0
(and)3.167 E F3<8d61>3.167 E(gs)-.1 E F0 .667(are al)3.167 F -.1(wa)-.1
G .667(ys present.).1 F .667
(The other \214elds depend on the contents of the pack)5.667 F(et')-.1 E
3.168(st)-.55 G .668(cp protocol)-3.168 F
(header and are output only if appropriate.)108 462 Q
(Here is the opening portion of an rlogin from host)108 478.8 Q F3(rtsg)
2.5 E F0(to host)2.5 E F3(csam)2.5 E F0(.)A/F4 8/Courier@0 SF
(rtsg.1023 > csam.login: S 768512:768512\(0\) win 4096 <mss 1024>)144
496.8 Q(csam.login > rtsg.1023: S 947648:947648\(0\) ack 768513 win 409\
6 <mss 1024>)144 508.8 Q(rtsg.1023 > csam.login: . ack 1 win 4096)144
520.8 Q(rtsg.1023 > csam.login: P 1:2\(1\) ack 1 win 4096)144 532.8 Q
(csam.login > rtsg.1023: . ack 2 win 4096)144 544.8 Q
(rtsg.1023 > csam.login: P 2:21\(19\) ack 1 win 4096)144 556.8 Q
(csam.login > rtsg.1023: P 1:2\(1\) ack 21 win 4077)144 568.8 Q
(csam.login > rtsg.1023: P 2:3\(1\) ack 21 win 4077 urg 1)144 580.8 Q
(csam.login > rtsg.1023: P 3:4\(1\) ack 21 win 4077 urg 1)144 592.8 Q F0
.683(The \214rst line says that tcp port 1023 on rtsg sent a pack)108
610.8 R .682(et to port)-.1 F F3(lo)3.182 E(gin)-.1 E F0 .682(on csam.)
3.182 F(The)5.682 E F2(S)3.182 E F0 .682(indicates that the)3.182 F F3
(SYN)108 622.8 Q F0 1.331(\215ag w)3.831 F 1.331(as set.)-.1 F 1.332
(The pack)6.331 F 1.332(et sequence number w)-.1 F 1.332
(as 768512 and it contained no data.)-.1 F 1.332(\(The notation is)6.332
F .656(`\214rst:last\(nbytes\)' which means `sequence numbers)108 634.8
R F3<8c72>3.156 E(st)-.1 E F0 .655(up to b)3.155 F .655
(ut not including)-.2 F F3(last)3.155 E F0 .655(which is)3.155 F F3
(nbytes)3.155 E F0(bytes)3.155 E .115(of user data'.\))108 646.8 R .115
(There w)5.115 F .115(as no piggy-back)-.1 F .115(ed ack, the a)-.1 F
-.25(va)-.2 G .115(ilable recei).25 F .415 -.15(ve w)-.25 H(indo).15 E
2.615(ww)-.25 G .116(as 4096 bytes and there w)-2.715 F(as)-.1 E 2.5(am)
108 658.8 S(ax-se)-2.5 E
(gment-size option requesting an mss of 1024 bytes.)-.15 E .877
(Csam replies with a similar pack)108 675.6 R .877(et e)-.1 F .877
(xcept it includes a piggy-back)-.15 F .877(ed ack for rtsg')-.1 F 3.377
(sS)-.55 G 3.377(YN. Rtsg)-3.377 F .877(then acks)3.377 F(csam')108
687.6 Q 3.149(sS)-.55 G 3.149(YN. The)-3.149 F(`.)3.149 E 3.149('m)-.7 G
.649(eans no \215ags were set.)-3.149 F .649(The pack)5.649 F .65
(et contained no data so there is no data sequence)-.1 F(number)108
699.6 Q 5.161(.N)-.55 G .161
(ote that the ack sequence number is a small inte)-5.161 F .16
(ger \(1\).)-.15 F .16(The \214rst time)5.16 F F2(tcpdump)2.66 E F0 .16
(sees a tcp `con-)2.66 F -.15(ve)108 711.6 S .624
(rsation', it prints the sequence number from the pack).15 F 3.125
(et. On)-.1 F .625(subsequent pack)3.125 F .625(ets of the con)-.1 F
-.15(ve)-.4 G .625(rsation, the).15 F(dif)108 723.6 Q .413
(ference between the current pack)-.25 F(et')-.1 E 2.913(ss)-.55 G .413
(equence number and this initial sequence number is printed.)-2.913 F
(This)5.412 E(30 June 1997)279.335 768 Q(7)202.335 E EP
%%Page: 8 8
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 347.72(TCPDUMP\(1\) TCPDUMP\(1\))72 48 R 1.127(\
means that sequence numbers after the \214rst can be interpreted as rel\
ati)108 84 R 1.428 -.15(ve b)-.25 H 1.128(yte positions in the con).15 F
-.15(ve)-.4 G(rsa-).15 E(tion')108 96 Q 2.836(sd)-.55 G .336
(ata stream \(with the \214rst data byte each direction being `1'\).)
-2.836 F .336(`-S' will o)5.336 F -.15(ve)-.15 G .335
(rride this feature, causing).15 F
(the original sequence numbers to be output.)108 108 Q .152(On the 6th \
line, rtsg sends csam 19 bytes of data \(bytes 2 through 20 in the rtsg)
108 124.8 R/F1 10/Symbol SF<ae>2.652 E F0 .152(csam side of the con)
2.652 F -.15(ve)-.4 G -.2(r-).15 G 2.78(sation\). The)108 136.8 R .28
(PUSH \215ag is set in the pack)2.78 F 2.78(et. On)-.1 F .279
(the 7th line, csam says it')2.78 F 2.779(sr)-.55 G(ecei)-2.779 E -.15
(ve)-.25 G 2.779(dd).15 G .279(ata sent by rtsg up to)-2.779 F -.2(bu)
108 148.8 S 3.171(tn).2 G .671(ot including byte 21.)-3.171 F .671
(Most of this data is apparently sitting in the sock)5.671 F .671(et b)
-.1 F(uf)-.2 E .671(fer since csam')-.25 F 3.172(sr)-.55 G(ecei)-3.172 E
-.15(ve)-.25 G(windo)108 160.8 Q 3.286(wh)-.25 G .786
(as gotten 19 bytes smaller)-3.286 F 5.786(.C)-.55 G .785
(sam also sends one byte of data to rtsg in this pack)-5.786 F 3.285
(et. On)-.1 F .785(the 8th)3.285 F(and 9th lines, csam sends tw)108
172.8 Q 2.5(ob)-.1 G(ytes of ur)-2.5 E(gent, pushed data to rtsg.)-.18 E
.259(If the snapshot w)108 189.6 R .259(as small enough that)-.1 F/F2 10
/Times-Bold@0 SF(tcpdump)2.759 E F0(didn')2.759 E 2.759(tc)-.18 G .26
(apture the full TCP header)-2.759 F 2.76(,i)-.4 G 2.76(ti)-2.76 G .26
(nterprets as much of)-2.76 F 1.354
(the header as it can and then reports `)108 201.6 R(`[|)-.74 E/F3 10
/Times-Italic@0 SF(tcp)A F0(]')A 3.854('t)-.74 G 3.854(oi)-3.854 G 1.354
(ndicate the remainder could not be interpreted.)-3.854 F 1.353(If the)
6.353 F .497(header contains a bogus option \(one with a length that')
108 213.6 R 2.997(se)-.55 G .497(ither too small or be)-2.997 F .497
(yond the end of the header\),)-.15 F .952(tcpdump reports it as `)108
225.6 R(`[)-.74 E F3 .951(bad opt)B F0(]')A 3.451('a)-.74 G .951
(nd does not interpret an)-3.451 F 3.451(yf)-.15 G .951
(urther options \(since it')-3.451 F 3.451(si)-.55 G .951
(mpossible to tell)-3.451 F .566(where the)108 237.6 R 3.066(ys)-.15 G
3.066(tart\). If)-3.066 F .567
(the header length indicates options are present b)3.066 F .567
(ut the IP datagram length is not long)-.2 F
(enough for the options to actually be there, tcpdump reports it as `)
108 249.6 Q(`[)-.74 E F3(bad hdr length)A F0(]')A('.)-.74 E F2(UDP P)108
279.6 Q(ack)-.1 E(ets)-.1 E F0
(UDP format is illustrated by this rwho pack)108 296.4 Q(et:)-.1 E/F4 10
/Courier@0 SF(actinide.who > broadcast.who: udp 84)144 314.4 Q F0 .92
(This says that port)108 332.4 R F3(who)3.42 E F0 .92(on host)3.42 F F3
(actinide)3.42 E F0 .919(sent a udp datagram to port)3.42 F F3(who)3.419
E F0 .919(on host)3.419 F F3(br)3.419 E(oadcast)-.45 E F0 3.419(,t)C
.919(he Internet)-3.419 F(broadcast address.)108 344.4 Q(The pack)5 E
(et contained 84 bytes of user data.)-.1 E .121(Some UDP services are r\
ecognized \(from the source or destination port number\) and the higher\
 le)108 361.2 R -.15(ve)-.25 G 2.622(lp).15 G(roto-)-2.622 E .146
(col information printed.)108 373.2 R .146(In particular)5.146 F 2.646
(,D)-.4 G .145
(omain Name service requests \(RFC-1034/1035\) and Sun RPC calls)-2.646
F(\(RFC-1050\) to NFS.)108 385.2 Q F2(UDP Name Ser)108 415.2 Q -.1(ve)
-.1 G 2.5(rR).1 G(equests)-2.5 E F3 3.228(\(N.B.:The following descript\
ion assumes familiarity with the Domain Service pr)108 432 R 3.229
(otocol described in)-.45 F 2.893(RFC-1035. If)108 444 R .393(you ar)
2.893 F 2.893(en)-.37 G .393(ot familiar with the pr)-2.893 F .393
(otocol, the following description will appear to be written in)-.45 F
(gr)108 456 Q(eek.\))-.37 E F0(Name serv)108 472.8 Q
(er requests are formatted as)-.15 E F3(sr)144 490.8 Q 2.5(c>d)-.37 G
(st: id op? \215a)-2.5 E(gs qtype qclass name \(len\))-.1 E F4
(h2opolo.1538 > helios.domain: 3+ A? ucbvax.berkeley.edu. \(37\))144
508.8 Q F0(Host)108 526.8 Q F3(h2opolo)2.883 E F0(ask)2.883 E .383
(ed the domain serv)-.1 F .384(er on)-.15 F F3(helios)2.884 E F0 .384
(for an address record \(qtype=A\) associated with the name)2.884 F F3
(ucbvax.berk)108 538.8 Q(ele)-.1 E -.55(y.)-.3 G(edu.).55 E F0 .043
(The query id w)5.043 F .043(as `3'.)-.1 F .043(The `+' indicates the)
5.043 F F3 -.37(re)2.542 G(cur).37 E .042(sion desir)-.1 F(ed)-.37 E F0
.042(\215ag w)2.542 F .042(as set.)-.1 F .042(The query)5.042 F .492
(length w)108 550.8 R .492
(as 37 bytes, not including the UDP and IP protocol headers.)-.1 F .493
(The query operation w)5.493 F .493(as the normal)-.1 F(one,)108 562.8 Q
F3(Query)4.02 E F0 4.02(,s)C 4.02(ot)-4.02 G 1.52(he op \214eld w)-4.02
F 1.52(as omitted.)-.1 F 1.519(If the op had been an)6.52 F 1.519
(ything else, it w)-.15 F 1.519(ould ha)-.1 F 1.819 -.15(ve b)-.2 H
1.519(een printed).15 F .051(between the `3' and the `+'.)108 574.8 R
(Similarly)5.051 E 2.552(,t)-.65 G .052(he qclass w)-2.552 F .052
(as the normal one,)-.1 F F3(C_IN)2.552 E F0 2.552(,a)C .052
(nd omitted.)-2.552 F(An)5.052 E 2.552(yo)-.15 G .052(ther qclass)-2.552
F -.1(wo)108 586.8 S(uld ha).1 E .3 -.15(ve b)-.2 H
(een printed immediately after the `).15 E -1.11(A')-.8 G(.)1.11 E 2.605
(Af)108 603.6 S .605 -.25(ew a)-2.605 H .105(nomalies are check).25 F
.105(ed and may result in e)-.1 F .104
(xtra \214elds enclosed in square brack)-.15 F 2.604(ets: If)-.1 F 2.604
(aq)2.604 G .104(uery contains)-2.604 F 1.024(an answer)108 615.6 R
3.524(,n)-.4 G 1.024(ame serv)-3.524 F 1.024(er or authority section,)
-.15 F F3(ancount)3.524 E F0(,).68 E F3(nscount)3.524 E F0 3.524(,o).68
G(r)-3.524 E F3(ar)3.524 E(count)-.37 E F0 1.025(are printed as `[)3.525
F F3(n)A F0 1.025(a]', `[)B F3(n)A F0 1.025(n]' or)B(`[)108 627.6 Q F3
(n)A F0 .123(au]' where)B F3(n)2.623 E F0 .123
(is the appropriate count.)2.623 F .123(If an)5.123 F 2.623(yo)-.15 G
2.623(ft)-2.623 G .123
(he response bits are set \(AA, RA or rcode\) or an)-2.623 F 2.622(yo)
-.15 G 2.622(ft)-2.622 G(he)-2.622 E .292
(`must be zero' bits are set in bytes tw)108 639.6 R 2.792(oa)-.1 G .292
(nd three, `[b2&3=)-2.792 F F3(x)A F0 .292(]' is printed, where)B F3(x)
2.792 E F0 .292(is the he)2.792 F 2.792(xv)-.15 G .292(alue of header)
-3.042 F(bytes tw)108 651.6 Q 2.5(oa)-.1 G(nd three.)-2.5 E F2
(UDP Name Ser)108 681.6 Q -.1(ve)-.1 G 2.5(rR).1 G(esponses)-2.5 E F0
(Name serv)108 698.4 Q(er responses are formatted as)-.15 E F3(sr)144
716.4 Q 2.5(c>d)-.37 G 2.5(st: id)-2.5 F(op r)2.5 E(code \215a)-.37 E
(gs a/n/au type class data \(len\))-.1 E F0(30 June 1997)279.335 768 Q
(8)202.335 E EP
%%Page: 9 9
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 347.72(TCPDUMP\(1\) TCPDUMP\(1\))72 48 R/F1 10
/Courier@0 SF
(helios.domain > h2opolo.1538: 3 3/3/7 A 128.32.137.3 \(273\))144 84 Q
(helios.domain > h2opolo.1537: 2 NXDomain* 0/1/0 \(97\))144 96 Q F0
1.428(In the \214rst e)108 114 R(xample,)-.15 E/F2 10/Times-Italic@0 SF
(helios)3.928 E F0 1.428(responds to query id 3 from)3.928 F F2(h2opolo)
3.928 E F0 1.427(with 3 answer records, 3 name serv)3.928 F(er)-.15 E
.394(records and 7 authority records.)108 126 R .395(The \214rst answer\
 record is type A \(address\) and its data is internet address)5.394 F
4.52(128.32.137.3. The)108 138 R 2.02(total size of the response w)4.52
F 2.019(as 273 bytes, e)-.1 F 2.019(xcluding UDP and IP headers.)-.15 F
2.019(The op)7.019 F
(\(Query\) and response code \(NoError\) were omitted, as w)108 150 Q
(as the class \(C_IN\) of the A record.)-.1 E .964(In the second e)108
166.8 R(xample,)-.15 E F2(helios)3.464 E F0 .964
(responds to query 2 with a response code of non-e)3.464 F .965
(xistent domain \(NXDo-)-.15 F .573
(main\) with no answers, one name serv)108 178.8 R .573
(er and no authority records.)-.15 F .573(The `*' indicates that the)
5.573 F F2(authoritative)3.073 E(answer)108 190.8 Q F0(bit w)2.5 E
(as set.)-.1 E
(Since there were no answers, no type, class or data were printed.)5 E
.117(Other \215ag characters that might appear are `\255' \(recursion a)
108 207.6 R -.25(va)-.2 G .118(ilable, RA,).25 F F2(not)2.618 E F0 .118
(set\) and `|' \(truncated message,)2.618 F(TC, set\).)108 219.6 Q
(If the `question' section doesn')5 E 2.5(tc)-.18 G(ontain e)-2.5 E
(xactly one entry)-.15 E 2.5(,`)-.65 G([)-2.5 E F2(n)A F0
(q]' is printed.)A .469(Note that name serv)108 236.4 R .469
(er requests and responses tend to be lar)-.15 F .468(ge and the def)
-.18 F(ault)-.1 E F2(snaplen)2.968 E F0 .468(of 68 bytes may not)2.968 F
.073(capture enough of the pack)108 248.4 R .073(et to print.)-.1 F .073
(Use the)5.073 F/F3 10/Times-Bold@0 SF<ad73>2.573 E F0 .074
(\215ag to increase the snaplen if you need to seriously in)2.573 F -.15
(ve)-.4 G(s-).15 E(tig)108 260.4 Q(ate name serv)-.05 E(er traf)-.15 E
2.5(\214c. `)-.25 F F3(\255s 128)A F0 2.5('h)C(as w)-2.5 E(ork)-.1 E
(ed well for me.)-.1 E F3(NFS Requests and Replies)108 302.4 Q F0
(Sun NFS \(Netw)108 319.2 Q
(ork File System\) requests and replies are printed as:)-.1 E F2(sr)144
337.2 Q(c.xid > dst.nfs: len op ar)-.37 E(gs)-.37 E(sr)144 349.2 Q
(c.nfs > dst.xid: r)-.37 E(eply stat len op r)-.37 E(esults)-.37 E F1
(sushi.6709 > wrl.nfs: 112 readlink fh 21,24/10.73165)144 379.2 Q
(wrl.nfs > sushi.6709: reply ok 40 readlink "../var")144 391.2 Q
(sushi.201b > wrl.nfs:)144 403.2 Q
(144 lookup fh 9,74/4096.6878 "xcolors")180 415.2 Q
(wrl.nfs > sushi.201b:)144 427.2 Q
(reply ok 128 lookup fh 9,74/4134.3150)180 439.2 Q F0 .655
(In the \214rst line, host)108 469.2 R F2(sushi)3.155 E F0 .655
(sends a transaction with id)3.155 F F2(6709)3.155 E F0(to)3.155 E F2
(wrl)3.155 E F0 .655(\(note that the number follo)3.155 F .655
(wing the src)-.25 F .034(host is a transaction id,)108 481.2 R F2(not)
2.534 E F0 .034(the source port\).)2.534 F .034(The request w)5.034 F
.034(as 112 bytes, e)-.1 F .035(xcluding the UDP and IP headers.)-.15 F
.191(The operation w)108 493.2 R .191(as a)-.1 F F2 -.37(re)2.691 G
(adlink).37 E F0 .191(\(read symbolic link\) on \214le handle \()2.691 F
F2(fh)A F0 2.69(\)2)C 2.69(1,24/10.731657119. \(If)-2.69 F .19
(one is luck)2.69 F -.65(y,)-.15 G .002
(as in this case, the \214le handle can be interpreted as a major)108
505.2 R .003(,minor de)-.4 F .003(vice number pair)-.25 F 2.503(,f)-.4 G
(ollo)-2.503 E .003(wed by the inode)-.25 F
(number and generation number)108 517.2 Q(.\))-.55 E F2(Wrl)5 E F0
(replies `ok' with the contents of the link.)2.5 E .134
(In the third line,)108 534 R F2(sushi)2.634 E F0(asks)2.634 E F2(wrl)
2.634 E F0 .133(to lookup the name `)2.633 F F2(xcolor)A(s)-.1 E F0
2.633('i)C 2.633(nd)-2.633 G .133(irectory \214le 9,74/4096.6878.)-2.633
F .133(Note that the)5.133 F .895
(data printed depends on the operation type.)108 546 R .896
(The format is intended to be self e)5.895 F .896
(xplanatory if read in con-)-.15 F(junction with an NFS protocol spec.)
108 558 Q(If the \255v \(v)108 574.8 Q(erbose\) \215ag is gi)-.15 E -.15
(ve)-.25 G(n, additional information is printed.).15 E -.15(Fo)5 G 2.5
(re).15 G(xample:)-2.65 E F1(sushi.1372a > wrl.nfs:)144 604.8 Q
(148 read fh 21,11/12.195 8192 bytes @ 24576)180 616.8 Q
(wrl.nfs > sushi.1372a:)144 628.8 Q
(reply ok 1472 read REG 100664 ids 417/0 sz 29388)180 640.8 Q F0 .538(\
\(\255v also prints the IP header TTL, ID, and fragmentation \214elds, \
which ha)108 670.8 R .838 -.15(ve b)-.2 H .538(een omitted from this e)
.15 F(xam-)-.15 E 3.218(ple.\) In)108 682.8 R .719(the \214rst line,)
3.219 F F2(sushi)3.219 E F0(asks)3.219 E F2(wrl)3.219 E F0 .719
(to read 8192 bytes from \214le 21,11/12.195, at byte of)3.219 F .719
(fset 24576.)-.25 F F2(Wrl)5.719 E F0 .556(replies `ok'; the pack)108
694.8 R .556(et sho)-.1 F .556
(wn on the second line is the \214rst fragment of the reply)-.25 F 3.056
(,a)-.65 G .556(nd hence is only 1472)-3.056 F .951
(bytes long \(the other bytes will follo)108 706.8 R 3.451(wi)-.25 G
3.451(ns)-3.451 G .951(ubsequent fragments, b)-3.451 F .951
(ut these fragments do not ha)-.2 F 1.252 -.15(ve N)-.2 H .952(FS or).15
F -2.15 -.25(ev e)108 718.8 T 3.238(nU).25 G .737
(DP headers and so might not be printed, depending on the \214lter e)
-3.238 F .737(xpression used\).)-.15 F .737(Because the \255v)5.737 F
.48(\215ag is gi)108 730.8 R -.15(ve)-.25 G .48
(n, some of the \214le attrib).15 F .48(utes \(which are returned in ad\
dition to the \214le data\) are printed: the \214le)-.2 F(30 June 1997)
279.335 768 Q(9)202.335 E EP
%%Page: 10 10
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 347.72(TCPDUMP\(1\) TCPDUMP\(1\))72 48 R
(type \(`)108 84 Q(`REG')-.74 E(', for re)-.74 E(gular \214le\), the \
\214le mode \(in octal\), the uid and gid, and the \214le size.)-.15 E
(If the \255v \215ag is gi)108 100.8 Q -.15(ve)-.25 G 2.5(nm).15 G
(ore than once, e)-2.5 E -.15(ve)-.25 G 2.5(nm).15 G
(ore details are printed.)-2.5 E .474(Note that NFS requests are v)108
117.6 R .474(ery lar)-.15 F .473(ge and much of the detail w)-.18 F(on')
-.1 E 2.973(tb)-.18 G 2.973(ep)-2.973 G .473(rinted unless)-2.973 F/F1
10/Times-Italic@0 SF(snaplen)2.973 E F0 .473(is increased.)2.973 F -.35
(Tr)108 129.6 S 2.5(yu).35 G(sing `)-2.5 E/F2 10/Times-Bold@0 SF
(\255s 192)A F0 2.5('t)C 2.5(ow)-2.5 G(atch NFS traf)-2.6 E(\214c.)-.25
E .482(NFS reply pack)108 146.4 R .482(ets do not e)-.1 F .482
(xplicitly identify the RPC operation.)-.15 F(Instead,)5.482 E F1
(tcpdump)2.982 E F0 -.1(ke)2.982 G .482(eps track of `).1 F(`recent')
-.74 E(')-.74 E .854
(requests, and matches them to the replies using the transaction ID.)108
158.4 R .854(If a reply does not closely follo)5.854 F 3.353(wt)-.25 G
(he)-3.353 E(corresponding request, it might not be parsable.)108 170.4
Q F2(KIP A)108 200.4 Q(ppletalk \(DDP in UDP\))-.25 E F0 .625
(Appletalk DDP pack)108 217.2 R .625(ets encapsulated in UDP datagrams \
are de-encapsulated and dumped as DDP pack)-.1 F(ets)-.1 E .675
(\(i.e., all the UDP header information is discarded\).)108 229.2 R .675
(The \214le)5.675 F F1(/etc/atalk.names)3.175 E F0 .674
(is used to translate appletalk)3.174 F(net and node numbers to names.)
108 241.2 Q(Lines in this \214le ha)5 E .3 -.15(ve t)-.2 H(he form).15 E
F1 2.95(number name)144 259.2 R/F3 10/Courier@0 SF 36(1.254 ether)144
283.2 R 42(16.1 icsd-net)144 295.2 R 12(1.254.110 ace)144 307.2 R F0
.351(The \214rst tw)108 325.2 R 2.851(ol)-.1 G .351(ines gi)-2.851 F
.651 -.15(ve t)-.25 H .351(he names of appletalk netw).15 F 2.851
(orks. The)-.1 F .351(third line gi)2.851 F -.15(ve)-.25 G 2.851(st).15
G .351(he name of a particular host)-2.851 F .045(\(a host is distingui\
shed from a net by the 3rd octet in the number \255 a net number)108
337.2 R F1(must)2.545 E F0(ha)2.544 E .344 -.15(ve t)-.2 H .244 -.1
(wo o).15 H .044(ctets and a).1 F .465(host number)108 349.2 R F1(must)
2.965 E F0(ha)2.965 E .765 -.15(ve t)-.2 H .465(hree octets.\)).15 F
.465(The number and name should be separated by whitespace \(blanks or)
5.465 F 2.5(tabs\). The)108 361.2 R F1(/etc/atalk.names)2.5 E F0(\214le\
 may contain blank lines or comment lines \(lines starting with a `#'\)\
.)2.5 E(Appletalk addresses are printed in the form)108 378 Q F1
(net.host.port)144 396 Q F3(144.1.209.2 > icsd-net.112.220)144 420 Q
(office.2 > icsd-net.112.220)144 432 Q(jssmag.149.235 > icsd-net.2)144
444 Q F0 2.197(\(If the)108 462 R F1(/etc/atalk.names)4.697 E F0(doesn')
4.697 E 4.697(te)-.18 G 2.197(xist or doesn')-4.847 F 4.696(tc)-.18 G
2.196(ontain an entry for some appletalk host/net number)-4.696 F(,)-.4
E .628(addresses are printed in numeric form.\))108 474 R .628
(In the \214rst e)5.628 F .628
(xample, NBP \(DDP port 2\) on net 144.1 node 209 is)-.15 F .63
(sending to whate)108 486 R -.15(ve)-.25 G 3.13(ri).15 G 3.13(sl)-3.13 G
.63(istening on port 220 of net icsd node 112.)-3.13 F .63
(The second line is the same e)5.63 F .63(xcept the)-.15 F .214
(full name of the source node is kno)108 498 R .215(wn \(`of)-.25 F
2.715(\214ce'\). The)-.25 F .215
(third line is a send from port 235 on net jssmag node)2.715 F .241(149\
 to broadcast on the icsd-net NBP port \(note that the broadcast addres\
s \(255\) is indicated by a net name)108 510 R 1.741
(with no host number \255 for this reason it')108 522 R 4.241(sag)-.55 G
1.742(ood idea to k)-4.241 F 1.742
(eep node names and net names distinct in)-.1 F(/etc/atalk.names\).)108
534 Q .829(NBP \(name binding protocol\) and A)108 550.8 R .828
(TP \(Appletalk transaction protocol\) pack)-1.11 F .828(ets ha)-.1 F
1.128 -.15(ve t)-.2 H .828(heir contents inter).15 F(-)-.2 E 3.006
(preted. Other)108 562.8 R .506
(protocols just dump the protocol name \(or number if no name is re)
3.006 F .507(gistered for the protocol\))-.15 F(and pack)108 574.8 Q
(et size.)-.1 E F2(NBP pack)108 598.8 Q(ets)-.1 E F0(are formatted lik)
2.5 E 2.5(et)-.1 G(he follo)-2.5 E(wing e)-.25 E(xamples:)-.15 E/F4 8
/Courier@0 SF
(icsd-net.112.220 > jssmag.2: nbp-lkup 190: "=:LaserWriter@*")144 616.8
Q(jssmag.209.2 > icsd-net.112.220: nbp-reply 190: "RM1140:LaserWriter@*\
" 250)144 628.8 Q(techpit.2 > icsd-net.112.220: nbp-reply 190: "techpit\
:LaserWriter@*" 186)144 640.8 Q F0 .659(The \214rst line is a name look\
up request for laserwriters sent by net icsd host 112 and broadcast on \
net jss-)108 658.8 R 2.882(mag. The)108 670.8 R .382
(nbp id for the lookup is 190.)2.882 F .382(The second line sho)5.382 F
.383(ws a reply for this request \(note that it has the)-.25 F .132(sam\
e id\) from host jssmag.209 saying that it has a laserwriter resource n\
amed "RM1140" re)108 682.8 R .131(gistered on port)-.15 F 3.048
(250. The)108 694.8 R .549(third line is another reply to the same requ\
est saying host techpit has laserwriter "techpit" re)3.048 F(gis-)-.15 E
(tered on port 186.)108 706.8 Q F2 -.95(AT)108 730.8 S 2.5(Pp).95 G(ack)
-2.5 E(et)-.1 E F0(formatting is demonstrated by the follo)2.5 E(wing e)
-.25 E(xample:)-.15 E(30 June 1997)279.335 768 Q(10)197.335 E EP
%%Page: 11 11
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 347.72(TCPDUMP\(1\) TCPDUMP\(1\))72 48 R/F1 8
/Courier@0 SF(jssmag.209.165 > helios.132: atp-req)144 84 Q
(12266<0-7> 0xae030001)9.6 E
(helios.132 > jssmag.209.165: atp-resp 12266:0 \(512\) 0xae040000)144 96
Q(helios.132 > jssmag.209.165: atp-resp 12266:1 \(512\) 0xae040000)144
108 Q(helios.132 > jssmag.209.165: atp-resp 12266:2 \(512\) 0xae040000)
144 120 Q
(helios.132 > jssmag.209.165: atp-resp 12266:3 \(512\) 0xae040000)144
132 Q(helios.132 > jssmag.209.165: atp-resp 12266:4 \(512\) 0xae040000)
144 144 Q
(helios.132 > jssmag.209.165: atp-resp 12266:5 \(512\) 0xae040000)144
156 Q(helios.132 > jssmag.209.165: atp-resp 12266:6 \(512\) 0xae040000)
144 168 Q
(helios.132 > jssmag.209.165: atp-resp*12266:7 \(512\) 0xae040000)144
180 Q(jssmag.209.165 > helios.132: atp-req)144 192 Q
(12266<3,5> 0xae030001)9.6 E
(helios.132 > jssmag.209.165: atp-resp 12266:3 \(512\) 0xae040000)144
204 Q(helios.132 > jssmag.209.165: atp-resp 12266:5 \(512\) 0xae040000)
144 216 Q(jssmag.209.165 > helios.132: atp-rel)144 228 Q
(12266<0-7> 0xae030001)9.6 E
(jssmag.209.133 > helios.132: atp-req* 12267<0-7> 0xae030002)144 240 Q
F0 .244(Jssmag.209 initiates transaction id 12266 with host helios by r\
equesting up to 8 pack)108 258 R .244(ets \(the `<0-7>'\).)-.1 F(The)
5.244 E(he)108 270 Q 2.5(xn)-.15 G
(umber at the end of the line is the v)-2.5 E
(alue of the `userdata' \214eld in the request.)-.25 E 2.667
(Helios responds with 8 512-byte pack)108 286.8 R 5.167(ets. The)-.1 F
2.667(`:digit' follo)5.167 F 2.667(wing the transaction id gi)-.25 F
-.15(ve)-.25 G 5.168(st).15 G 2.668(he pack)-5.168 F(et)-.1 E .176(sequ\
ence number in the transaction and the number in parens is the amount o\
f data in the pack)108 298.8 R .175(et, e)-.1 F(xcluding)-.15 E
(the atp header)108 310.8 Q 5(.T)-.55 G(he `*' on pack)-5 E
(et 7 indicates that the EOM bit w)-.1 E(as set.)-.1 E 2.295
(Jssmag.209 then requests that pack)108 327.6 R 2.296
(ets 3 & 5 be retransmitted.)-.1 F 2.296
(Helios resends them then jssmag.209)7.296 F .172
(releases the transaction.)108 339.6 R(Finally)5.172 E 2.672(,j)-.65 G
.172(ssmag.209 initiates the ne)-2.672 F .172(xt request.)-.15 F .172
(The `*' on the request indicates that)5.172 F(XO \(`e)108 351.6 Q
(xactly once'\) w)-.15 E(as)-.1 E/F2 10/Times-Italic@0 SF(not)2.5 E F0
(set.)2.5 E/F3 10/Times-Bold@0 SF(IP Fragmentation)108 393.6 Q F0
(Fragmented Internet datagrams are printed as)108 410.4 Q F3(\(frag)144
428.4 Q F2(id)2.5 E F3(:)A F2(size)A F3(@)A F2(of)A(fset)-.18 E F3(+\))A
(\(frag)144 440.4 Q F2(id)2.5 E F3(:)A F2(size)A F3(@)A F2(of)A(fset)
-.18 E F3(\))A F0
(\(The \214rst form indicates there are more fragments.)108 458.4 Q
(The second indicates this is the last fragment.\))5 E F2(Id)108 475.2 Q
F0 .373(is the fragment id.)2.873 F F2(Size)5.373 E F0 .374
(is the fragment size \(in bytes\) e)2.873 F .374
(xcluding the IP header)-.15 F(.)-.55 E F2(Of)5.374 E(fset)-.18 E F0
.374(is this fragment')2.874 F(s)-.55 E(of)108 487.2 Q
(fset \(in bytes\) in the original datagram.)-.25 E .11
(The fragment information is output for each fragment.)108 504 R .109
(The \214rst fragment contains the higher le)5.109 F -.15(ve)-.25 G
2.609(lp).15 G(rotocol)-2.609 E .508
(header and the frag info is printed after the protocol info.)108 516 R
.509(Fragments after the \214rst contain no higher le)5.508 F -.15(ve)
-.25 G(l).15 E .207(protocol header and the frag info is printed after \
the source and destination addresses.)108 528 R -.15(Fo)5.206 G 2.706
(re).15 G .206(xample, here is)-2.856 F .298
(part of an ftp from arizona.edu to lbl-rtsg.arpa o)108 540 R -.15(ve)
-.15 G 2.798(raC).15 G .298(SNET connection that doesn')-2.798 F 2.799
(ta)-.18 G .299(ppear to handle 576)-2.799 F(byte datagrams:)108 552 Q
F1(arizona.ftp-data > rtsg.1170: . 1024:1332\(308\) ack 1 win 4096 \(fr\
ag 595a:328@0+\))144 570 Q(arizona > rtsg: \(frag 595a:204@328\))144 582
Q(rtsg.1170 > arizona.ftp-data: . ack 1536 win 2560)144 594 Q F0 .25
(There are a couple of things to note here:)108 612 R .249
(First, addresses in the 2nd line don')5.25 F 2.749(ti)-.18 G .249
(nclude port numbers.)-2.749 F(This)5.249 E .842(is because the TCP pro\
tocol information is all in the \214rst fragment and we ha)108 624 R
1.143 -.15(ve n)-.2 H 3.343(oi).15 G .843(dea what the port or)-3.343 F
.357(sequence numbers are when we print the later fragments.)108 636 R
.356(Second, the tcp sequence information in the \214rst)5.356 F .228
(line is printed as if there were 308 bytes of user data when, in f)108
648 R .229(act, there are 512 bytes \(308 in the \214rst frag)-.1 F .377
(and 204 in the second\).)108 660 R .377(If you are looking for holes i\
n the sequence space or trying to match up acks with)5.377 F(pack)108
672 Q(ets, this can fool you.)-.1 E 2.5(Ap)108 688.8 S(ack)-2.5 E
(et with the IP)-.1 E F2(don')2.5 E 2.5(tf)-.3 G -2.3 -.15(ra g)-2.5 H
(ment).15 E F0(\215ag is mark)2.5 E(ed with a trailing)-.1 E F3(\(DF\))
2.5 E F0(.)A F3 -.18(Ti)108 718.8 S(mestamps).18 E F0(30 June 1997)
279.335 768 Q(11)197.335 E EP
%%Page: 12 12
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 347.72(TCPDUMP\(1\) TCPDUMP\(1\))72 48 R .968
(By def)108 84 R .968
(ault, all output lines are preceded by a timestamp.)-.1 F .969
(The timestamp is the current clock time in the)5.968 F(form)108 96 Q/F1
10/Times-Italic@0 SF(hh:mm:ss.fr)144 108 Q(ac)-.15 E F0 .178
(and is as accurate as the k)108 120 R(ernel')-.1 E 2.678(sc)-.55 G
2.677(lock. The)-2.678 F .177(timestamp re\215ects the time the k)2.677
F .177(ernel \214rst sa)-.1 F 2.677(wt)-.15 G .177(he pack)-2.677 F
2.677(et. No)-.1 F .692(attempt is made to account for the time lag bet\
ween when the ethernet interf)108 132 R .693(ace remo)-.1 F -.15(ve)-.15
G 3.193(dt).15 G .693(he pack)-3.193 F .693(et from)-.1 F
(the wire and when the k)108 144 Q(ernel serviced the `ne)-.1 E 2.5(wp)
-.25 G(ack)-2.5 E(et' interrupt.)-.1 E/F2 9/Times-Bold@0 SF(SEE ALSO)72
160.8 Q F0(traf)108 172.8 Q(\214c\(1C\), nit\(4P\), bpf\(4\), pcap\(3\))
-.25 E F2 -.45(AU)72 189.6 S(THORS).45 E F0 -1.11(Va)108 201.6 S 3.25
(nJ)1.11 G .75(acobson, Craig Leres and Ste)-3.25 F -.15(ve)-.25 G 3.25
(nM).15 G .75(cCanne, all of the La)-3.25 F .75(wrence Berk)-.15 F(ele)
-.1 E 3.25(yN)-.15 G .75(ational Laboratory)-3.25 F 3.25(,U)-.65 G(ni-)
-3.25 E -.15(ve)108 213.6 S(rsity of California, Berk).15 E(ele)-.1 E
1.3 -.65(y, C)-.15 H(A.).65 E(The current v)108 230.4 Q(ersion is a)-.15
E -.25(va)-.2 G(ilable via anon).25 E(ymous ftp:)-.15 E F1(ftp://ftp.ee)
144 247.2 Q(.lbl.go)-.15 E(v/tcpdump.tar)-.1 E(.Z)-1.11 E F2 -.09(BU)72
264 S(GS).09 E F0(Please send b)108 276 Q
(ug reports to tcpdump@ee.lbl.go)-.2 E -.65(v.)-.15 G(NIT doesn')108
292.8 Q 2.5(tl)-.18 G(et you w)-2.5 E(atch your o)-.1 E
(wn outbound traf)-.25 E(\214c, BPF will.)-.25 E 1.6 -.8(We r)5 H
(ecommend that you use the latter).8 E(.)-.55 E .954
(Some attempt should be made to reassemble IP fragments or)108 309.6 R
3.454(,a)-.4 G 3.454(tl)-3.454 G .954
(east to compute the right length for the)-3.454 F(higher le)108 321.6 Q
-.15(ve)-.25 G 2.5(lp).15 G(rotocol.)-2.5 E .576(Name serv)108 338.4 R
.576(er in)-.15 F -.15(ve)-.4 G .575(rse queries are not dumped correct\
ly: The \(empty\) question section is printed rather than).15 F .651
(real query in the answer section.)108 350.4 R .652(Some belie)5.651 F
.952 -.15(ve t)-.25 H .652(hat in).15 F -.15(ve)-.4 G .652
(rse queries are themselv).15 F .652(es a b)-.15 F .652
(ug and prefer to \214x)-.2 F
(the program generating them rather than tcpdump.)108 362.4 Q .435
(Apple Ethertalk DDP pack)108 379.2 R .435
(ets could be dumped as easily as KIP DDP pack)-.1 F .434(ets b)-.1 F
.434(ut aren')-.2 F 2.934(t. Ev)-.18 F .434(en if we were)-.15 F .396
(inclined to do an)108 391.2 R .397
(ything to promote the use of Ethertalk \(we aren')-.15 F .397
(t\), LBL doesn')-.18 F 2.897(ta)-.18 G(llo)-2.897 E 2.897(wE)-.25 G
.397(thertalk on an)-2.897 F 2.897(yo)-.15 G(f)-2.897 E(its netw)108
403.2 Q(orks so we')-.1 E 2.5(dw)-.5 G(ould ha)-2.6 E .3 -.15(ve n)-.2 H
2.5(ow).15 G(ay of testing this code.)-2.6 E 2.581(Ap)108 420 S(ack)
-2.581 E .081(et trace that crosses a daylight sa)-.1 F .081
(vings time change will gi)-.2 F .38 -.15(ve s)-.25 H -.1(ke).15 G .08
(wed time stamps \(the time change is)-.15 F(ignored\).)108 432 Q .67
(Filters e)108 448.8 R .671
(xpressions that manipulate FDDI headers assume that all FDDI pack)-.15
F .671(ets are encapsulated Ethernet)-.1 F(pack)108 460.8 Q 2.904
(ets. This)-.1 F .404(is true for IP)2.904 F 2.904(,A)-1.11 G(RP)-2.904
E 2.904(,a)-1.11 G .404(nd DECNET Phase IV)-2.904 F 2.903(,b)-1.29 G
.403(ut is not true for protocols such as ISO CLNS.)-3.103 F .833
(Therefore, the \214lter may inadv)108 472.8 R .833
(ertently accept certain pack)-.15 F .834
(ets that do not properly match the \214lter e)-.1 F(xpres-)-.15 E
(sion.)108 484.8 Q(30 June 1997)279.335 768 Q(12)197.335 E EP
%%Trailer
end
%%EOF
