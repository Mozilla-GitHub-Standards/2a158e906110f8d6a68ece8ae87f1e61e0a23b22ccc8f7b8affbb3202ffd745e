<html><head><meta name=ProgId content=PowerPoint.Slide><meta name=Generator content="Microsoft Macintosh PowerPoint 10"><link id=Main-File rel=Main-File href="../gecko-overview.htm"><link title="Presentation File" type="application/powerpoint" rel=alternatehref=gecko-overview.ppt><script>
if ( ! top.PPTPRESENTATION ) {
	window.location.replace( "endshow.htm" );
}
</script><meta name=Robots content=NoIndex><style><!--a {text-decoration: none;}--></style></head><body onload=" parent.base.highlite();" onresize="self.location.reload();"><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID1 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p1" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('1')" id=AREF>Gecko Overview</a></b></font></td> </tr></table><table> <tr>  <td width=5 nowrap></td>  <td width="100%"></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>Chris Waterson</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>&lt;waterson@netscape.com&gt;</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>June 10, 2002</font></td> </tr></table><br><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID2 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p2" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('2')" id=AREF>Overview</a></b></font></td> </tr></table><table> <tr>  <td width=5 nowrap></td>  <td width="100%"></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>Basic data flow</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>Key data structures</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>Detailed walk-through</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>Incrementalism</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>Future tech-talks</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>Wrap-up, Q&amp;A</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1></td> </tr></table><br><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID3 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p3" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('3')" id=AREF>Basic Data Flow</a></b></font></td> </tr></table><table> <tr>  <td width=5 nowrap></td>  <td width=20 nowrap></td>  <td width="100%"></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Source document arrives via network  APIs</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Incrementally “pumped” through the  single-threaded layout engine</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Parse, compute style, render; repeat</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>CSS used for rendering all content</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Content theoretically separate from  “presentation”</font></td> </tr></table><br><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID4 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p4" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('4')" id=AREF>Basic Data Flow</a></b></font></td> </tr></table><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID5 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p5" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('5')" id=AREF>Basic Data Flow</a></b></font></td> </tr></table><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID6 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p6" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('6')" id=AREF>Basic Data Flow</a></b></font></td> </tr></table><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID7 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p7" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('7')" id=AREF>Basic Data Flow</a></b></font></td> </tr></table><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID8 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p8" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('8')" id=AREF>Basic Data Flow</a></b></font></td> </tr></table><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID9 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p9" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('9')" id=AREF>Basic Data Flow</a></b></font></td> </tr></table><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID10 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p10" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('10')" id=AREF>Key Data Structures</a></b></font></td> </tr></table><table> <tr>  <td width=5 nowrap></td>  <td width=20 nowrap></td>  <td width="100%"></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Content node</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Elements, attributes, leaves</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>DOM</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Frame</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Rectangular formatting primitive</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Geometric information</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>[0..n] per content node</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>2nd thru nth are “continuations”</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Style context</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Non-geometric information</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>May be shared by adjacent frames</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Reference counted, owned by frame</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>View</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Clipping, z-order, transparency</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>[0..1] per frame, owned by frame</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Widget</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Native window</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>[0..1] per view, owned by view</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2></td> </tr></table><br><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID11 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p11" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('11')" id=AREF>Key Data Structures</a></b></font></td> </tr></table><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID12 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p12" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('12')" id=AREF>Key Data Structures</a></b></font></td> </tr></table><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID13 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p13" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('13')" id=AREF>Key Data Structures</a></b></font></td> </tr></table><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID14 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p14" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('14')" id=AREF>Key Data Structures</a></b></font></td> </tr></table><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID15 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p15" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('15')" id=AREF>Key Data Structures</a></b></font></td> </tr></table><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID16 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p16" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('16')" id=AREF>Key Data Structures</a></b></font></td> </tr></table><table> <tr>  <td width=5 nowrap></td>  <td width=20 nowrap></td>  <td width="100%"></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>The document owns the content model,  and one or more presentations</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Exposed programmatically via DOM APIs</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>The presentation owns the frame  hierarchy</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Frames own the style contexts, views,  widgets</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Presentation has media type,  dimensions, etc.</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>May not be directly manipulated</font></td> </tr></table><br><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID17 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p17" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('17')" id=AREF>Detailed Walk-Through</a></b></font></td> </tr></table><table> <tr>  <td width=5 nowrap></td>  <td width="100%"></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>Setting up</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>Content model construction</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>Frame construction</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>Style resolution</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>Reflow</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>Painting</font></td> </tr></table><br><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID18 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p18" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('18')" id=AREF>Setting Up</a></b></font></td> </tr></table><table> <tr>  <td width=5 nowrap></td>  <td width=20 nowrap></td>  <td width=20 nowrap></td>  <td width="100%"></td> </tr> <tr>  <td colspan=1></td>  <td colspan=3><font face=Arial size=2>Assume basic knowledge of embedding and  network APIs (doc shell, streams)</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=3><font face=Arial size=2>Content DLL auto-registers a Document  Loader Factory</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=2><font face=Arial size=2>@mozilla.org/content-viewer-factory/view;1?type=text/html</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=2><font face=Arial size=2>All MIME types mapped to the same  class, nsContentDLF</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=3><font face=Arial size=2>nsDocShell</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=2><font face=Arial size=2>Receives inbound content via nsDSURIContentListener</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=2><font face=Arial size=2>Invokes nsIDLF::CreateInstance, passes  MIME type to DLF</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=3><font face=Arial size=2>nsContentDLF</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=2><font face=Arial size=2>Creates a nsHTMLDocument object,  invokes StartDocumentLoad.</font></td> </tr> <tr>  <td colspan=3></td>  <td colspan=1><font face=Arial size=2>Creates a parser, returned as nsIStreamListener  back to the docshell</font></td> </tr> <tr>  <td colspan=3></td>  <td colspan=1><font face=Arial size=2>Creates a content sink, which is linked  to the parser and the document</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=2><font face=Arial size=2>Creates a DocumentViewerImpl object,  which is returned as nsIContentViewer back to the docshell</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=3><font face=Arial size=2>DocumentViewerImpl creates pres context  and pres shell</font></td> </tr></table><br><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID19 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p19" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('19')" id=AREF>Setting Up</a></b></font></td> </tr></table><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID20 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p20" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('20')" id=AREF>Content Model Construction</a></b></font></td> </tr></table><table> <tr>  <td width=5 nowrap></td>  <td width=20 nowrap></td>  <td width="100%"></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Content arrives from network via nsIStreamListener::OnDataAvailable</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Parser tokenizes &amp; processes  content; invokes methods on nsIContentSink with parser node objects</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Some buffering and fixup occurs here</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>OpenContainer, CloseContainer, AddLeaf</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Content sink creates and attaches  content nodes using nsIContent interface</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Content sink maintains stack of “live”  elements</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>More buffering and fixup occurs here</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>InsertChildAt, AppendChildTo, RemoveChildAt</font></td> </tr></table><br><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID21 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p21" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('21')" id=AREF>Content Model Construction</a></b></font></td> </tr></table><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID22 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p22" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('22')" id=AREF>Frame Construction</a></b></font></td> </tr></table><table> <tr>  <td width=5 nowrap></td>  <td width=20 nowrap></td>  <td width="100%"></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Content sink uses nsIDocument interface  to notify of </font><font face=Symbol size=2>Ds </font><font face=Times  size=2>in content model</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>ContentAppended, ContentInserted, ContentRemoved</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>PresShell is registered as document  observer</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Receives ContentAppended, etc.  notifications</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Passes these to the style set object,  who in turn passes to the frame constructor</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Frame constructor creates frames</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>ConstructFrameInternal recursively  walks content tree, resolves style and creates frames</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Either created by tag (&lt;select&gt;)  or by display type (&lt;p&gt;)</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Frame manager maintains mapping from  content to frame</font></td> </tr></table><br><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID23 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p23" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('23')" id=AREF>Frame Construction</a></b></font></td> </tr></table><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID24 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p24" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('24')" id=AREF>Style Resolution</a></b></font></td> </tr></table><table> <tr>  <td width=5 nowrap></td>  <td width=20 nowrap></td>  <td width="100%"></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Compute stylistic information based on  the style rules that apply for the frame’s content node</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Style data broken into different  structures</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Display, visibility, font, color,  background, …</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Inherit vs. reset</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Style context object is a placeholder  for partially computed stylistic data</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Style data is computed lazily, as it is  asked for</font></td> </tr></table><br><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID25 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p25" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('25')" id=AREF>Reflow</a></b></font></td> </tr></table><table> <tr>  <td width=5 nowrap></td>  <td width=20 nowrap></td>  <td width="100%"></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Recursively compute geometry (x, y, w, h)  for frames, views, and widgets</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Given w &amp; h constraints of “root  frame” compute (x, y, w, h) for all children</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Constraints propagated “down” via nsHTMLReflowState</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Desired size returned “up” via nsHTMLReflowMetrics</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Basic pattern</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Parent frame initializes child reflow  state (available w, h); places child frame (x, y); invokes child’s Reflow  method</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Child frame computes desired (w, h),  returns via reflow metrics</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Parent frame sizes child frame and view  based on child’s metrics</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>N.B. many don’t work like this!  (Tables, blocks, XUL boxes)</font></td> </tr></table><br><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID26 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p26" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('26')" id=AREF>Reflow</a></b></font></td> </tr></table><table> <tr>  <td width=5 nowrap></td>  <td width=20 nowrap></td>  <td width="100%"></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>“Global” reflows</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Initial, resize, style-change</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Processed immediately via PresShell  method</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Incremental reflows</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Targeted at a specific frame</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Dirty, content-changed, style-changed, user-defined</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>nsHTMLReflowCommand object encapsulates  info</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Queued and processed asynchronously, nsIPressShell::AppendReflowCommand,  ProcessReflowCommands</font></td> </tr></table><br><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID27 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p27" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('27')" id=AREF>Incremental Reflow</a></b></font></td> </tr></table><table> <tr>  <td width=5 nowrap></td>  <td width=20 nowrap></td>  <td width="100%"></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Recursively descend to target recovering  reflow state</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Child rs.reason set to incremtenal</font></td> </tr></table><br><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID28 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p28" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('28')" id=AREF>Incremental Reflow</a></b></font></td> </tr></table><table> <tr>  <td width=5 nowrap></td>  <td width=20 nowrap></td>  <td width="100%"></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Recursively descend to target recovering  reflow state</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Child rs.reason set to incremental</font></td> </tr></table><br><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID29 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p29" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('29')" id=AREF>Incremental Reflow</a></b></font></td> </tr></table><table> <tr>  <td width=5 nowrap></td>  <td width=20 nowrap></td>  <td width="100%"></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Recursively descend to target recovering  reflow state</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Child rs.reason set to incremental</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Process reflow “normally” at target  frame</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Child rs.reason set based on rc’s type</font></td> </tr></table><br><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID30 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p30" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('30')" id=AREF>Incremental Reflow</a></b></font></td> </tr></table><table> <tr>  <td width=5 nowrap></td>  <td width=20 nowrap></td>  <td width="100%"></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Recursively descend to target recovering  reflow state</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Child rs.reason set to incremental</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Process reflow “normally” at target  frame</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Child rs.reason set based on rc’s type</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Propagate damage to frames later “in  the flow”</font></td> </tr></table><br><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID31 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p31" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('31')" id=AREF>Incremental Reflow</a></b></font></td> </tr></table><table> <tr>  <td width=5 nowrap></td>  <td width=20 nowrap></td>  <td width="100%"></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Multiple reflow commands are batched</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>nsReflowPath maintains a tree of target  frames</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Amortize state recovery and damage  propagation cost</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2></td> </tr></table><br><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID32 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p32" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('32')" id=AREF>Painting</a></b></font></td> </tr></table><table> <tr>  <td width=5 nowrap></td>  <td width="100%"></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>As reflow proceeds through the frame  hierarchy, areas are invalidated via nsIViewManager::UpdateView</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>Unless immediate, invalid areas are  coalesced and processed asynchronously via OS expose event</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>Native expose event dispatched to  widget; widget delegates to the view manager</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>View manager paints views  back-to-front, invoking PresShell’s Paint method</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>PresShell::Paint walks from the view to  the frame; invokes nsIFrame::Paint for each layer</font></td> </tr></table><br><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID33 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p33" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('33')" id=AREF>Incrementalism</a></b></font></td> </tr></table><table> <tr>  <td width=5 nowrap></td>  <td width=20 nowrap></td>  <td width="100%"></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Single-threaded</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Simple (no locking)</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Can’t leave event queue unattended</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Content construction unwinds “at will”</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Parser and content sink do some  buffering</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Content sink has “notification limits”</font></td> </tr> <tr>  <td colspan=2></td>  <td colspan=1><font face=Arial size=2>Efficiency vs. responsiveness trade-off</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Frame construction runs to completion</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>CSS parsing runs to completion</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Reflow runs to completion (mostly)</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=2><font face=Arial size=2>Painting runs to completion</font></td> </tr></table><br><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID34 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p34" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('34')" id=AREF>Incrementalism</a></b></font></td> </tr></table><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID35 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p35" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('35')" id=AREF>Future (?) Tech Talks</a></b></font></td> </tr></table><table> <tr>  <td width=5 nowrap></td>  <td width="100%"></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>Content model and DOM - jst, jkeiser</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>Parser and content sink (esp. invalid  content) - harishd</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>Events - saari, joki</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>Block-and-line reflow - waterson, dbaron</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>Table reflow - karnaze</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>Form controls - rods, bryner</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>Style resolution and rule tree - dbaron</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>Views, widgets, and painting - roc, kmcclusk</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>Editor - kin, jfrancis</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>XUL and box layout - hewitt, ben</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>XBL - hewitt, ben</font></td> </tr></table><br><table  width=100%> <tr>  <td width=1 ><script> if ( parent.base.isnav ) { document.write('<ilayer id= LAYERID36 VISIBILITY=hidden >&gt;</ilayer>'); } </script></td>  <td width=100%  id="p36" ><font face=Arial size=2><b><a  href="javascript:parent.base.Slide('36')" id=AREF>Conclusion</a></b></font></td> </tr></table><table> <tr>  <td width=5 nowrap></td>  <td width="100%"></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>Data flow</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>Key data structures</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>Detailed walk-through</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>Incrementalism</font></td> </tr> <tr>  <td colspan=1></td>  <td colspan=1><font face=Arial size=2>Q &amp; A?</font></td> </tr></table><br></body></html>