<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<link rel="top" title="Home" href="http://www.mozilla.org/">
<link rel="stylesheet" type="text/css" href="../css/print.css"  media="print">
<link rel="stylesheet" type="text/css" href="../css/base/content.css"  media="all">
<link rel="stylesheet" type="text/css" href="../css/cavendish/content.css" title="Cavendish" media="screen">
<link rel="stylesheet" type="text/css" href="../css/base/template.css"  media="screen">
<link rel="stylesheet" type="text/css" href="../css/cavendish/template.css" title="Cavendish" media="screen">
<link rel="icon" href="../images/mozilla-16.png" type="image/png">

 <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
 <title>Netscape Directory SDK for Java: Source Code Release</title>
<script src="../__utm.js" type="text/javascript"></script>
</head>
<body id="www-mozilla-org" class="deepLevel">
<div id="container">
<p class="important">You are currently viewing a snapshot of www.mozilla.org taken on April 21, 2008. Most of this content is
highly out of date (some pages haven't been updated since the project began in 1998) and exists for historical purposes only.  If
there are any pages on this archive site that you think should be added back to www.mozilla.org, please <a
href="https://bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=www.mozilla.org">file a bug</a>.</p>
<p class="skipLink"><a href="#mainContent" accesskey="2">Skip to main content</a></p>
<div id="header">
<h1><a href="/" title="Return to home page" accesskey="1">Mozilla</a></h1>
<ul>
<li id="menu_aboutus"><a href="../about/" title="Getting the most out of your online experience">About</a></li>
<li id="menu_developers"><a href="../developer/" title="Using Mozilla's products for your own applications">Developers</a></li>
<li id="menu_store"><a href="http://store.mozilla.org/?r=mozorg1" title="Shop for Mozilla products on CD and other merchandise">Store</a></li>
<li id="menu_support"><a href="../support/" title="Installation, trouble-shooting, and the knowledge base">Support</a></li>
<li id="menu_products"><a href="../products/" title="All software Mozilla currently offers">Products</a></li>
</ul>
<form id="searchbox_002443141534113389537:ysdmevkkknw" action="http://www.google.com/cse" title="mozilla.org Search">
<div>
<label for="q" title="Search mozilla.org's sites">search mozilla:</label>
<input type="hidden" name="cx" value="002443141534113389537:ysdmevkkknw">
<input type="hidden" name="cof" value="FORID:0">
<input type="text" id="q" name="q" accesskey="s" size="30">
<input type="submit" id="submit" value="Go">
</div>
</form>
</div>
<hr class="hide">
<div id="mBody">
<div id="side">

<ul id="nav">
<li><a title="Roadmap" href="../roadmap.html"><strong> Roadmap</strong></a></li>
<li><a title="Projects" href="../projects/"><strong> Projects</strong></a></li>
<li><a title="For developers" href="../developer/"><strong> Coding</strong></a>
<ul>
<li><a title="Module Owners" href="../owners.html"> Module Owners</a></li>
<li><a title="Hacking" href="../hacking/"> Hacking</a></li>
<li><a title="Get the Source" href="http://developer.mozilla.org/en/docs/Download_Mozilla_Source_Code"> Get the Source</a></li>
<li><a title="Building Mozilla" href="http://developer.mozilla.org/en/docs/Build_Documentation"> Build It</a></li>
</ul>
</li>
<li><a title="Testing" href="../quality/"><strong> Testing</strong></a>
<ul>
<li><a title="Downloads of mozilla.org software releases" href="../download.html"> Releases</a></li>
<li><a title="Latest mozilla builds for testers" href="../developer/#builds"> Nightly Builds</a></li>
<li><a title="For testers to report bugs" href="https://bugzilla.mozilla.org/"> Report A Problem</a></li>
</ul>
</li>
<li><a title="Tools for mozilla developers" href="../tools.html"><strong> Tools</strong></a>
<ul>
<li><a title="Bug tracking system for mozilla testers." href="https://bugzilla.mozilla.org/"> Bugzilla</a></li>
<li><a title="Latest status of mozilla builds" href="http://tinderbox.mozilla.org/showbuilds.cgi?tree=Firefox"> Tinderbox</a></li>
<li><a title="Latest checkins" href="http://bonsai.mozilla.org/cvsqueryform.cgi"> Bonsai</a></li>
<li><a title="Source cross reference" href="http://lxr.mozilla.org/seamonkey/"> LXR</a></li>
</ul>
</li>
<li><a title="Frequently Asked Questions." href="../faq.html"><strong> FAQs</strong></a></li>
</ul>

</div>
<hr class="hide">
<div id="mainContent">






<h1>Netscape Directory SDK for Java: Source Code Release</h1>
Discussion: 
<a href="news://news.mozilla.org/netscape.public.mozilla.directory">netscape.public.mozilla.directory</a>
</address>

<h2>Netscape LDAP Service Provider for JNDI (08-02-99)</h2>
<p>The Netscape LDAP service provider for JNDI implements the JNDI 
DirContext interface. It is implemented as a layer on top of the 
Netscape Directory SDK for Java (ldapjdk.jar). While the ldapjdk 
uses the LDAP connection as the primary abstraction enabling the 
access to the directory services, the JNDI provider uses the concept 
of a Directory Context (the DirContext interface) to achieve the 
same functionality. A DirContext as an equivalent of a directory 
entry in the ldapjdk.</p>

<p>The following sections are available in this document:</p>

<ul>
 <li><a href="#Using">Using Netscape Ldap Service Provider</a>
 <li><a href="#Env Props">Environment Properties</a>
 <li><a href="#Controls">Working With Controls</a>
 <li><a href="#Not Impl">What's Not Implemented</a>
</ul>

<h3 id="Using">Using Netscape LDAP Service Provider</h3>

<p>The current implementation is based on the JNDI 1.2 FCS. In 
addition to the DirContext interface implementation, the Netscape 
LDAP provider implements the new JNDI event service 
(<em>javax.naming.event</em> package) and support for controls 
(<em>javax.naming.ldap</em> package) which were introduced with the 
JNDI 1.2.</p>

<p>To use the service provider, you'll need to:</p>

<ol>
 <li>
  Add the provider and the jars it depends on in the classpath. For 
  example, on Windows NT the classpath should be set as follows:
  <p></p>
  <tt>set classpath=%classpath%;ldapsp.jar;ldapjdk.jar;jndi.jar;</tt>
  <p></p>
  Assuming that all the jars are available in the current directory. 
  The listed jar files are:
  <p></p>
  <table>
   <tr>
    <td>ldapsp.jar</td>
    <td>Netscape LDAP Service Provider for JNDI</td>
   </tr>
   <tr>
    <td>ldapjdk.jar</td>
    <td>Netscape Directory SDK for Java 4.0 Beta</td>
   </tr>
   <tr>
    <td>jndi.jar</td>
    <td>JNDI 1.2 FCS</td>
   </tr>
  </table>
  <p></p>
 <li>
  Specify the Netscape LDAP provider as the provider in the context 
  environment created for the initial context;
<pre>
Hashtable env = new Hashtable();
env.put(Context.INITIAL_CONTEXT_FACTORY,
"com.netscape.jndi.ldap.LdapContextFactory");
env.put(...
...
DirContext ctx = new InitialDirContext(env);
</pre>
 <li>
  For storing of Java objects in a LDAP Directory, the JNDI
  java object schema must be added to the directory. To enable the 
  JNDI schema copy the file <em>jndi-object-schema.conf</em> to your 
  <em>&lt;server-root>/slapd-&lt;id>/config</em> directory, and 
  include the file into your 
  <em>&lt;server-root>/slapd-&lt;id>/config/ns-schema.conf</em>
  schema configuration file.
  <p></p>
  For examples of using JNDI please go to the official JNDI site.
</ol>

<h3 id="Env Props">Environment Properties</h3>
<p>The environment properties can be passed directly to the initial 
context as a hash table, or specified as system properties. For 
compatibility reasons, for those environment properties that are 
relevant to LDAP protocol but are not defined in the JNDI, the 
Netscape LDAP provider is using the same property names as the SUN 
LDAP service provided, if a property with the same semantics is 
defined by the SUN provider.</p>

<p>Note: If a new property is added to the context environment, or 
an existing property is changed after the initial context is created, 
the change will be immediately visible unless the changed property 
pertains to the connection. For changes related to connection, in 
order to take effect you'll need to invoke 
<em>LdapContext.reconnect().</em></p>

<p>The following table contains JNDI environment properties are 
relevant for the Netscape LDAP service provider. Properties not 
found in this list are silently ignored.</p>

<dl
 <dt>java.naming.factory.initial</dt>
 <dd>
  This environment property is used to select the LDAP provider. To 
  select the Netscape LDAP provider 
  "<strong>com.netscape.jndi.ldap.LdapContextFactory</strong>" 
  should be specified.
  <p></p>
  <tt>env.put(Context.INITIAL_CONTEXT_FACTORY, "com.netscape.jndi.ldap.LdapContextFactory");</tt>
 </dd>
 <dt>java.naming.provider.url</dt>
 <dd>
  Specifies LDAP server information. For example:
  <p></p>
  <tt>env.put(Context.PROVIDER_URL, "ldap://dilly.mcom.com:389");</tt>
  <p></p>
  If it has not been set then the provider will attempt to access 
  an LDAP server at port 389 on the local host.
 </dd>
 <dt>java.naming.ldap.version</dt>
 <dd>
  Specifies the protocol version for the provider. Two values are possible:
  <ul>
   <li>2 - selects LDAP Version 2 (LDAPv2)
   <li>3 - selects LDAP Version 3 (LDAPv3)
  </ul>
  For example, <tt>env.put("java.naming.ldap.version", "3");</tt>
  <p></p>
  If this environment property has not been set then the provider 
  will attempt to use LDAPv3.
 </dd>
 <dt>java.naming.security.authentication</dt>
 <dd>
  Specifies the authentication mechanism for the provider to use.
  The following values are permitted for this property:
  <ul>
   <li><strong>none</strong> - use no authentication (anonymous)
   <li>
    <strong>simple</strong> - use weak authentication (clear text 
    password)
  </ul>
  <p></p>
  If this environment property has not been set but the 
  java.naming.security.principal environment property has been set 
  then the provider will use 'simple'. If neither have been set then
  the provider will use anonymous bind.
 </dd>
 <dt>java.naming.security.principal</dt>
 <dd>
  Specifies the DN of the principal to be authenticated. For example:
  <p></p>
  <tt>env.put(Context.SECURITY_PRINCIPAL, "cn=Directory manager");</tt>
  <p></p>
  If this environment property has not been set then the provider 
  will use anonymous bind.
 </dd>
 <dt>java.naming.security.credentials</dt>
 <dd>
  Specifies the password of the principal to be authenticated. For 
  example:
  <p></p>
  <tt>env.put(Context.SECURITY_CREDENTIALS, "secret");</tt>
 </dd>
 <dt>java.naming.security.protocol</dt>
 <dd>
  Specifies the security protocol for the provider to use. One 
  possible value is defined: <strong>ssl</strong> - use 
  Secure Socket Layer
  <p></p>
  <tt>env.put(Context.SECURITY_PROTOCOL, "ssl");</tt>
  <p></p>
  When this environment property has been set and the 
  <em>java.naming.ldap.factory.socket</em> property has not been 
  set, then the ldapjdk default socket factory 
  <em>netscape.net.SSLSocket</em> is used. This class is provided 
  with Netscape Communicator 4.05 and higher. If 
  java.naming.ldap.factory.socket property has been set, the socket 
  factory specified therein is used.
 </dd>
 <dt>java.naming.ldap.factory.socket</dt>
 <dd>
  Specifies the class name of a socket factory. This environment 
  property is used to override the default socket factory. For example:
  <p></p>
  <tt>env.put("java.naming.ldap.factory.socket", "crysec.SSL.SSLSocket");</tt>
  <p></p>
  If the security protocol environment property has been set but
  this property has not been set, then this property's value is set 
  to <em>netscape.net.SSLSocket</em>. See ldapjdk documentation for 
  more information for connecting over SSL.
 </dd>
 <dt>java.naming.ldap.ssl.ciphers</dt>
 <dd>
  Specifies the suite of ciphers used for SSL connections made 
  through sockets created by the factory specified with 
  <em>java.naming.ldap.factory.socket</em>. The value of this 
  property is of type <em>java.lang.Object</em>. For example:
<pre>try {
    Class c = Class.forName("crysec.SSL.SSLParams");
    java.lang.reflect.Method m = 
         getMethod("getCipherSuite",new Class[0]);
    Object cipherSuite = m.invoke(null,null);
    if (cipherSuite != null) {
       env.put("java.naming.ldap.ssl.ciphers", cipherSuite);
    }
}
catch (Exception e) {}
</pre>
 </dd>
 <dt>java.naming.batchsize</dt>
 <dd>
  Specifies that search results are to be returned in batches. A 
  setting of zero indicates that the provider should block until 
  all results have been received. If this environment property has 
  not been set then search results are returned in batches of one.
 </dd>
 <dt>java.naming.ldap.maxresults</dt>
 <dd>
  The default maximum number of search results to be returned for a 
  search request. 0 means no limit. If not specified, the ldapjdk 
  default is 1000. This value can be overridden per request with 
  the parameter <em>SearchConstraints</em> in the 
  <em>DirContex.search()</em> method.
 </dd>
 <dt>java.naming.ldap.timelimit</dt>
 <dd>
  The default maximum number of milliseconds to wait for a search 
  operation to complete. If 0, which is the ldapjdk default, there 
  is no maximum time limit for a search operation. This value can 
  be overridden per request with the parameter 
  <em>SearchConstraints</em> in the <em>DirContex.search()</em>
  method.
 </dd>
 <dt>java.naming.referral</dt>
 <dd>
  Specifies how referrals shall be handled by the provider. Three 
  possible values are defined:
  <ul>
   <li><strong>follow</strong> - automatically follow any referrals
   <li>
    <strong>throw</strong> - throw a ReferralException for 
    each referral
   <li>
    <strong>ignore</strong> - ignore referrals if they appear in 
    results and treat them like ordinary attributes if they appear 
    in entries.
  </ul>
  If this environment property has not been set then the LDAP 
  provider by default follows referrals.
 </dd>
 <dt>java.naming.ldap.referral.limit</dt>
 <dd>
  Specifies the maximum number of referrals to follow in a chain of
  referrals. A setting of zero indicates that there is no limit. 
  The default limit is 10.
 </dd>
 <dt>java.naming.ldap.deleteRDN</dt>
 <dd>
  Specifies whether the old RDN is removed during rename(). If the 
  value is "true", the old RDN is removed; otherwise, the RDN is 
  not removed. The default value is true.
 </dd>
 <dt>java.naming.ldap.derefAliases</dt>
 <dd>
  Specifies how aliases are dereferenced during search operations. 
  The possible values are:
  <ul>
   <li><strong>always</strong> always dereference aliases
   <li><strong>never</strong> never dereference aliases
   <li>
    <strong>finding</strong> dereference aliases only during 
    name resolution
   <li>
    <strong>searching</strong> dereference aliases only after 
    name resolution
  </ul>
  NOTE: Netscape LDAP Server 3.x and 4.x do not support aliases
 </dd>
 <dt>java.naming.ldap.typesOnly</dt>
 <dd>
  Specifies whether only attribute types are to be returned during 
  searches and getAttributes(). Its possible values are "true" or 
  "false". The default is false.
 </dd>
 <dt>java.naming.ldap.conntrol.connect</dt>
 <dd>
  An array of <em>Control</em>s to be set on the LDAPConnection 
  before a connection attempt is made to the server.
 </dd>
 <dt>java.naming.ldap.attributes.binary</dt>
 <dd>
  Specifies attributes that have binary syntax. It extends the 
  provider's list of known binary attributes. Its value is a space 
  separated list of attribute names.
  <p></p>
  <tt>env.put("java.naming.ldap.attributes.binary", "mpegVideo");</tt>
  <p></p>
  In contrast to ldapjdk, JNDI does not provide for reading of 
  attribute values as either Strings or byte arrays. All attributes 
  are returned as Strings unless recognized as having binary syntax. 
  The values of attributes that have binary syntax are returned as 
  byte arrays instead of Strings.
  <p></p>
  If this environment property has not been set then, by default, 
  only the following attributes are considered to have binary syntax:
  <ul>
   <li>attribute names containing '<strong>;binary'</strong>
   <li>photo (0.9.2342.19200300.100.1.7)
   <li>personalSignature (0.9.2342.19200300.100.1.53)
   <li>audio (0.9.2342.19200300.100.1.55)
   <li>jpegPhoto (0.9.2342.19200300.100.1.60)
   <li>javaSerializedData (1.3.6.1.4.1.42.2.27.4.1.7)
   <li>thumbnailPhoto (1.3.6.1.4.1.1466.101.120.35)
   <li>thumbnailLogo (1.3.6.1.4.1.1466.101.120.36)
   <li>userPassword (2.5.4.35)
   <li>userCertificate (2.5.4.36)
   <li>cACertificate (2.5.4.37)
   <li>authorityRevocationList (2.5.4.38)
   <li>certificateRevocationList (2.5.4.39)
   <li>crossCertificatePair (2.5.4.40)
   <li>x500UniqueIdentifier (2.5.4.45)
  </ul>
 </dd>
 <dt>java.naming.ldap.ref.separator</dt>
 <dd>
  Specifies the character to use when encoding a RefAddr object in 
  the javaReferenceAddress attribute. This environment property 
  should be used to avoid a conflict in the case where the 
  default separator character appears in the components of a RefAddr 
  object. If unspecified, the default separator is the hash 
  character '#'.
 </dd>
</dl>

<h3 id="Controls">Working with Controls</h3>

<p>JNDI 1.2 adds support for Controls which are fully implemented 
with the Netscape LDAP provider. However, JNDI 1.2 does not define 
interfaces for any of the standard controls, like for example the 
sort control. Instead, the task of defining particular controls and 
their interfaces is left to service providers. Therefore, if using 
controls, you will also need to import the 
<em>com.netscape.jndi.ldap.controls</em> package in your souce in 
addition to the JNDI packages.</p>

<p>Being implemented on the top of ldapjdk, the Netscape LDAP 
provider simply exposes all of the ldapjdk controls as JNDI 
controls. Thus, the control APIs are exactly the same as in ldapjdk. 
The only difference is that for the LDAP provider controls class 
names start with "Ldap" while in ldapjdk the class names start with 
"LDAP". For instance, the ldapjdk control LDAPSortControl is 
LdapSortControl in the Netscape LDAP provider.</p>

<p>Here is an example of how to use the LdapSortControl. Notice that 
you'll need to obtain a LdapContext object as an initial context, 
because controls are not part of the directory context (DirContext). 
That means that instead of calling <em>getInitialDirContext()</em> 
you 'll need to call <em>getInitialLdapContext()</em>.</p>

<pre class="example code">import java.util.Hashtable;
import javax.naming.*;
import javax.naming.directory.*;
import javax.naming.ldap.*;
import com.netscape.jndi.ldap.controls.*;
public class SortReverseOrder {
public static void main(String[] args) {
    Hashtable env = new Hashtable(5, 0.75f);
    /*
     * Specify the initial context implementation to use.
     */
    env.put(Context.INITIAL_CONTEXT_FACTORY,
        "com.netscape.jndi.ldap.LdapContextFactory");
    /* Specify host and port to use for directory service */
    //env.put(Context.PROVIDER_URL, "ldap://localhost:389");
    LdapContext ctx = null;
    try {
        /* get a handle to an Initial DirContext */
        ctx = new InitialLdapContext(env, null);
        /* specify search constraints to search subtree */
        SearchControls cons = new SearchControls();
        cons.setSearchScope(SearchControls.SUBTREE_SCOPE);
        cons.setReturningAttributes(new String[] { "sn" });
        // specify sort control
        ctx.setRequestControls(
           
new Control[] {new LdapSortControl(
               
new LdapSortKey[]{
                  
new LdapSortKey("sn", true,null)},Control.CRITICAL)});
        /* search for all entries with surname of Jensen */
        NamingEnumeration results
           
= ctx.search("o=mcom.com", "(objectclass=person)", cons);
        /* for each entry print out name + all attrs and values */
        while (results != null &amp;&amp; results.hasMore()) {
           
SearchResult si = (SearchResult)results.next();
           
Attributes attrs = si.getAttributes();
           
/* print each attribute */
           
for (NamingEnumeration ae = attrs.getAll(); ae.hasMoreElements();) {
               
Attribute attr = (Attribute)ae.next();
               
String attrId = attr.getID();
                   
/* print each value */
               
for (NamingEnumeration vals = attr.getAll(); vals.hasMore();
                   
System.out.println(attrId + ": " + vals.next()));
               
}
           
System.out.println();
        }
    }
    catch (NamingException e) {
        System.err.println("Search example failed.");
        e.printStackTrace();
    }
    finally {
       // cleanup
       if (ctx != null) {
           try
{ ctx.close(); } catch (Exception e) {}
       }
    }
}
}</pre>

<p>For full documenation on available controls and their interfaces, 
please check the ldapjdk documentation.</p>

<h3 id="Not Impl">What's Not Implemented</h3>

<p>Currently, the following JNDI features are not implemented by the 
Netscape JNDI provider:</p>

<ul>
 <li>Support for federated names
 <li>
  Support for the code base attribute for objects stored in LDAP 
  directory. Therefore, the class name specified with the 
  <em>javaClassName</em> attribute must be available in the local 
  <em>CLASSPATH</em>.
 <li>
  <em>search()</em> and <em>modifyAttribute()</em> methods for 
  schema directory contexts. Instead of <em>DirContext.search()</em>, 
  the <em>Context.lookup()</em> request should be used for a schema 
  directory context. Instead of 
  <em>DirContext.modifyAttribute()</em>, 
  <em>DirContext.deleteSubcontext()</em> followed the 
  <em>DirContext.craeteSubcontext() </em>should be used.
</ul>




<hr class="hide">
</div>
</div>
<div id="footer">
<ul>
<li><a href="../sitemap.html">Site Map</a></li>
<li><a href="../security/">Security Updates</a></li>
<li><a href="../contact/">Contact Us</a></li>
<li><a href="../foundation/donate.html">Donate</a></li>
</ul>
<p class="copyright">
Portions of this content are &copy; 1998&#8211;2009 by individual mozilla.org
contributors; content available under a Creative Commons license | <a
href="http://www.mozilla.org/foundation/licensing/website-content.html">Details</a>.</p>
<p>
<span>Last modified January 10,  2005</span>
<span><a href="http://bonsai-www.mozilla.org/cvslog.cgi?file=mozilla-org/html/directory/javaldapsp-relnotes.html&amp;rev=&amp;root=/www/">Document History</a></span>
</p>
</div>
</div>
</body>
</html>
