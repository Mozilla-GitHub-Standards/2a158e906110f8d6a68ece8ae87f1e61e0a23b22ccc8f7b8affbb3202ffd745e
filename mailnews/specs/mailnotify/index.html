<HTML>
<!--This file created 3/27/02 1:51 PM by Claris Home Page version 3.0-->
<HEAD>
   <TITLE>MachV/Mozilla: Mail &amp; News: Mail Notification</TITLE>
   <META NAME=GENERATOR CONTENT="Claris Home Page 3.0">
   <X-CLARIS-WINDOW TOP=26 BOTTOM=601 LEFT=8 RIGHT=682>
   <X-CLARIS-TAGVIEW MODE=minimal>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1"><!--This file created 7/20/98 10:33 PM by Claris Home Page version 3.0-->
</HEAD>
<BODY BGCOLOR="#FFFFFF">
<P><TABLE BORDER=0 CELLSPACING=0 CELLPADDING=2 WIDTH="100%">
   <TR>
      <TD VALIGN=bottom>
         <P><FONT SIZE="+1">MachV/Mozilla: Mail &amp;
         Newsgroups</FONT></P>
      </TD>
      <TD VALIGN=bottom>
         <P><DIV ALIGN=right><FONT SIZE="+1">UI Specification</FONT></DIV></P>
      </TD>
   </TR>
   <TR BGCOLOR="#66CCCC">
      <TD>
         <P><FONT SIZE="+3"><B>Mail Notification</B></FONT></P>
      </TD>
      <TD>
         <P ALIGN=right><FONT SIZE="-1"><B><I>Last
         Modification:</I></B></FONT> <SCRIPT LANGUAGE=JavaScript>document.write(document.lastModified);</SCRIPT></P>
      </TD>
   </TR>
</TABLE>
 <TABLE BORDER=1 CELLSPACING=0 CELLPADDING=0 WIDTH="100%">
   <TR>
      <TD VALIGN=top WIDTH="49%">
         <P><B>Author:</B> Jennifer Glick&nbsp;<BR>
         <B>Creation Date:</B> 06 Dec 2001</P>
      </TD>
      <TD VALIGN=top>
         <P><B>Status:</B> In Progress</P>
      </TD>
   </TR>
   <TR>
      <TD VALIGN=top WIDTH="49%">
         <P><B>Quicklinks:</B></P>
         
         <BLOCKQUOTE><A HREF="#AccountSet">Account Settings</A><BR>
            <A HREF="#PotentialCases">Potential Cases</A><BR>
            <A HREF="#IndicatorIcon">System Tray Icon</A><BR>
            <A HREF="#Alert">New Mail Alert- Dialog</A><BR>
            <A HREF="#Prefs">New Mail Alert - Prefs</A><BR>
            <A HREF="#Tooltip">Tooltips</A></BLOCKQUOTE>
      </TD>
      <TD VALIGN=top>
         <P><B>Feature Team</B></P>
         
         <BLOCKQUOTE><TABLE BORDER=1 CELLSPACING=0 CELLPADDING=0 WIDTH=227 HEIGHT=125>
               <TR>
                  <TD VALIGN=top WIDTH=69 HEIGHT=30>
                     <P><FONT SIZE="-1">Engineering&nbsp;</FONT></P>
                  </TD>
                  <TD WIDTH=152 HEIGHT=30>
                     <P><FONT SIZE="-1">&nbsp;Scott Putterman, Scott
                     MacGregor</FONT></P>
                  </TD>
               </TR>
               <TR>
                  <TD WIDTH=69 HEIGHT=15>
                     <P><FONT SIZE="-1">Marketing</FONT></P>
                  </TD>
                  <TD WIDTH=152 HEIGHT=15>
                     <P><FONT SIZE="-1">&nbsp;Gregg Landskov , Kevin
                     Murray</FONT></P>
                  </TD>
               </TR>
               <TR>
                  <TD WIDTH=69 HEIGHT=19>
                     <P><FONT SIZE="-1">QA</FONT></P>
                  </TD>
                  <TD WIDTH=152 HEIGHT=19>
                     <P><FONT SIZE="-1">&nbsp;Gayatri Rimola,, Gary
                     Chan</FONT></P>
                  </TD>
               </TR>
               <TR>
                  <TD WIDTH=69 HEIGHT=15>
                     <P><FONT SIZE="-1">Docs</FONT></P>
                  </TD>
                  <TD WIDTH=152 HEIGHT=15>
                     <P><FONT SIZE="-1">&nbsp;Robin Foster
                     Clark</FONT></P>
                  </TD>
               </TR>
               <TR>
                  <TD WIDTH=69 HEIGHT=15>
                     <P><FONT SIZE="-1">UE</FONT></P>
                  </TD>
                  <TD WIDTH=152 HEIGHT=15>
                     <P><FONT SIZE="-1">&nbsp;Jennifer
                     Glick</FONT></P>
                  </TD>
               </TR>
               <TR>
                  <TD WIDTH=69 HEIGHT=19>
                     <P><FONT SIZE="-1">&nbsp;</FONT></P>
                  </TD>
                  <TD WIDTH=152 HEIGHT=19>
                     <P>&nbsp;</P>
                  </TD>
               </TR>
            </TABLE>
         </BLOCKQUOTE>
         
         <P><B>Please post all comments and suggestions regarding
         this spec to the newsgroup,
         netscape.public.mozilla.mail-news.</B></P>
      </TD>
   </TR>
</TABLE>
</P>

<P><FONT COLOR="#FF0000"><B>*</B></FONT><B>Note:</B> "Check for new
mail when Mail is not running" feature is not yet implemented. Mail
must be running (but Quick Launch does not have to be enabled) in
order for mail notification to work.&nbsp;</P>

<H1>Bugs</H1>

<OL>
   <LI>Bug 18729 - Windows integration for new mail notification</LI>
   
   <LI>Bug 97326 - Turbo and new mail notification should use the
   same tray icon</LI>
   
   <LI>71105 - If there is new mail, update biff icon on the browser
   toolbox without having to start messenger&nbsp;</LI>
   
   <LI>Bug 122626 - New Mail Notification</LI>
   
   <LI>Bug 123104 - Mail notification tooltip shows wrong count</LI>
</OL>

<P>&nbsp;</P>

<H1>Open Issues</H1>

<OL>
   <LI>Turbo starts up, we don't know which profile user wants to use
   yet. Do we show a dialog making user pick a profile? Does it
   default to first profile, last used profile? Can we easily flush
   out profile info?&nbsp;</LI>
   
   <LI>How do we handle multiple accounts in the UI? Tooltips with
   info for each account.&nbsp;<B>128 char max for regular tooltip.
   Use default account only? Last account to write into
   tooltip?</B></LI>
   
   <LI>What should be the tooltip for the tray icon? What if more
   than 1 account has new messages? What if char max for tooltip is
   surpassed? <B>"&lt;Username&gt; has X new messages".</B></LI>
   
   <LI>Account Settings dialogs. Is checkbox with red star still
   valid?</LI>
</OL>

<P>&nbsp;</P>

<H2><B>Open Issues Popup Alerts</B></H2>

<OL>
   <LI>Default display time. <B>Stick with existing time (3 secs) for
   now and see how folks respond. Maybe increase it slightly if
   necessary.&nbsp; 3/18/02.</B></LI>
   
   <LI>Should the alert use the "user name" or "account name"?
   Account name is unique but user name is much shorter (and space is
   an issue). <B>Use "User Name" for now. See if it becomes a
   problem. Default account name is the email address.&nbsp;
   3/18/02.</B></LI>
   
   <LI>What if two or more accounts get new messages at the same
   time? Does one alert with multiple lines appear or do separate
   alerts appear one after the other?<B> Currently, we check one
   account after another, so each the first account checked would
   trigger the alert. If one acct receives new mail first, and you
   don't click any accounts, bif won't go off again for the next
   account. Or should it be once per account?&nbsp;</B></LI>
   
   <LI>Visual design of alert and tray icons.<B> "Get Messages"
   toolbar icon or masthead icon for alert. Should tray icons be
   "Modern" or more generic? Stick with modern theme across all
   themes or per theme alert and tray icon? Marlon to decide. Width
   of alert can now be dynamic (yeah!). Resize as necessary to fit
   width of user name.&nbsp; 3/18/02.</B></LI>
</OL>

<P>&nbsp;</P>

<P>&nbsp;

<HR SIZE=4 WIDTH="60%" ALIGN=left color="#000000">

</P>

<H1>Summary</H1>

<H2>Goals</H2>

<OL>
   <LI>Provide a method of informing users they have new messages
   available when they are currently running the Mail
   application.</LI>
   
   <LI>Provide a method of informing users they have new messages
   available when they are currently Not running the Mail
   application, but are running another Mozilla
   application.&nbsp;</LI>
   
   <LI>Provide a method of informing users they have new messages
   available when they are currently Not running the Mail application
   Or any other Mozilla application.</LI>
   
   <LI>Allow users to enable notification for some accounts and not
   for others.</LI>
</OL>

<P>&nbsp;</P>

<H2>Assumptions</H2>

<OL>
   <LI>If No Netscape applications are running, Quick Launch must be
   running for Mail Notification to work.</LI>
   
   <LI>If Mail is not running but another Netscape application Is
   running (any, or only the browser?), Mail Notification will work.
   Quick Launch does not need to be running. Single profile
   user.</LI>
   
   <LI>Separate system tray icons (Windows) for Mail Notification and
   Quick Launch.</LI>
   
   <LI>Mail Notification when Mail is not running, is Off by default.
   If the user enables the feature, the are prompted for their
   Account password on startup. Password dialog should tell them why
   being prompted. If password saved with Master Password, they are
   prompted for MP.</LI>
   
   <LI>Don't worry about multiple profiles for now.</LI>
   
   <LI>Mail Notification will work for any account except news. IMAP,
   POP, AOL, WebMail.</LI>
</OL>

<P>&nbsp;</P>

<P>

<HR SIZE=4 WIDTH="60%" ALIGN=left color="#000000">

</P>

<H1>Design Details</H1>

<H2><A NAME=AccountSet></A>1. Account Settings&nbsp;</H2>

<H3>a. IMAP</H3>

<P><IMG SRC="images/Imap.gif" WIDTH=628 HEIGHT=477 BORDER=0 ALIGN=bottom></P>

<P><I>Or, "Check for messages when Mail is not running (you will be
asked for your mail password when you start your computer)".</I></P>

<P>&nbsp;</P>

<H3>b. POP</H3>

<P><IMG SRC="images/pop.gif" WIDTH=628 HEIGHT=477 BORDER=0 ALIGN=bottom></P>

<P>&nbsp;</P>

<P>&nbsp;</P>

<P>

<HR WIDTH="50%" ALIGN=left NOSHADE color="#000000">

</P>

<H2><A NAME=PotentialCases></A>2. Potential Cases</H2>

<P>Note: Currently, alerts do not work when user is not running Mail,
but is running Quick Launch.&nbsp;</P>

<H3>a. Mail is Not Running. No Mozilla/NS App Running</H3>

<UL>
   <LI>Quick Launch Must be enabled for Mail Notification to
   work.</LI>
   
   <LI>Quick Launch is enabled, "Check for New message every X
   minutes" is enabled, "Check for messages when mail is not running"
   is disabled. <B>No Mail Notification.</B></LI>
   
   <LI>Quick Launch is enabled, "Check for New message every X
   minutes" is enabled, "Check for messages when mail is not running"
   is enabled.&nbsp; <B>Mail Notification icon will appear</B> in
   system tray as appropriate.</LI>
</UL>

<P>&nbsp;</P>

<H3>b. Mail is Not Running. A Mozilla/NS App Running</H3>

<UL>
   <LI>Quick Launch does Not need to be enabled for Mail Notification
   to work</LI>
   
   <LI>"Check for New message every X minutes" and "Check for
   messages when mail is not running" Must be enabled for Quick
   Launch to work.&nbsp;</LI>
</UL>

<P>&nbsp;</P>

<H3>c. Mail is Running</H3>

<UL>
   <LI>Quick Launch does Not need to be enabled.</LI>
   
   <LI>"Check for messages when mail is not running" does Not need to
   be enabled.</LI>
   
   <LI>If "Check for new mail every X minutes" is enabled. <B>Mail
   Notification icon will appear</B> in system tray as
   appropriate.</LI>
   
   <LI>"Check for new mail every X minutes" is not enabled. <B>No
   Mail Notification.</B></LI>
   
   <LI><I>User clicks "Get Msgs"</I><B><I>, No Mail
   Notification.</I></B></LI>
</UL>

<P>&nbsp;</P>

<P>In cases a and b, the user's account password must be saved for
Mail Notification to work. If the user is using Password Manager,
they will be prompted for their master password.</P>

<P>&nbsp;</P>

<P>

<HR WIDTH="50%" ALIGN=left NOSHADE color="#000000">

</P>

<H2><A NAME=IndicatorIcon></A>3. Indicator Icon</H2>

<P>The Mail Notification system tray icon is separate from the Quick
Launch icon. It only appears in the tray when the feature is
correctly enabled (see section 2 above) and when new messages are
available. Once the user has acknowledged the new mail, the icon is
removed from the system tray.<I>&nbsp;</I></P>

<P>Double clicking on the Mail Notification tray icon will launch the
Mail application if it is not currently running, or give it focus if
it is already running.&nbsp;</P>

<P>The system tray icon should only be displayed if biff went off and
not when the user manually requested new mail ("Get Msg"
button).&nbsp;</P>

<P>&nbsp;</P>

<H3>a. Quick Launch Enabled</H3>

<H2><IMG SRC="images/Tray2.gif" WIDTH=266 HEIGHT=29 BORDER=0 ALIGN=bottom></H2>

<P>&nbsp;</P>

<H3>b. Quick Launch Enabled and Mail Notification Goes Off</H3>

<P><IMG SRC="images/Tray1.gif" WIDTH=266 HEIGHT=29 BORDER=0 ALIGN=bottom></P>

<P>&nbsp;</P>

<H3>c. Quick Launch Not Enabled and Mail Notification Goes Off</H3>

<P><IMG SRC="images/Tray3.gif" WIDTH=266 HEIGHT=29 BORDER=0 ALIGN=bottom></P>

<P>&nbsp;</P>

<H3>d. Quick Launch Enabled. Unable to Connect to Mail Server</H3>

<P><IMG SRC="images/Tray4.gif" WIDTH=266 HEIGHT=29 BORDER=0 ALIGN=bottom></P>

<P>&nbsp;</P>

<H3>e. "Modern" Look Icons</H3>

<P><IMG SRC="images/Tray5.gif" WIDTH=281 HEIGHT=85 BORDER=0 ALIGN=bottom></P>

<P>&nbsp;</P>

<P>

<HR WIDTH="50%" ALIGN=left NOSHADE color="#000000">

</P>

<H2><A NAME=Alert></A>4. New Mail Alert - Dialog</H2>

<P>New Mail Notification feature in which a sliding alert dialog,
appearing above the system tray in the lower right corner, is used to
notify users that new messages have been received.&nbsp;It does not
take focus away from the user's current task. The alert slowly slides
open, pauses, and then slowly slides close. Alert only appears when
the New Mail Notification system tray has gone off. See "<A HREF="#PotentialCases">Potential
Cases</A>" section above.</P>

<P>The alert is global and applies to all accounts for which biff is
currently enabled. It is triggered at the same interval as the biff
setting for each account. Once the alert has been triggered, it
doesn't appear again until the user has acknowledged the existing
mail.</P>

<P>Clicking the link on the alert brings the Mail window into focus
with the appropriate account selected.&nbsp;&nbsp;</P>

<P>&nbsp;</P>

<P><IMG SRC="images/Alert1.gif" WIDTH=601 HEIGHT=118 BORDER=0 ALIGN=bottom></P>

<P>&nbsp;</P>

<H3>Alternate Designs</H3>

<P><IMG SRC="images/Alert2.gif" WIDTH=360 HEIGHT=600 BORDER=0 ALIGN=bottom></P>

<P>&nbsp;</P>

<P>

<HR WIDTH="50%" ALIGN=left NOSHADE color="#000000">

</P>

<H2><A NAME=Prefs></A>5. New Mail Alert - Preferences&nbsp;</H2>

<P>Alert preference is global. It applies to all accounts for which
biff is enabled. On by default.</P>

<H3><IMG SRC="images/Prefs1.gif" WIDTH=562 HEIGHT=462 BORDER=0 ALIGN=bottom></H3>

<P>&nbsp;</P>

<P>&nbsp;</P>

<P>

<HR WIDTH="50%" ALIGN=left NOSHADE color="#000000">

</P>

<H2><A NAME=Tooltip></A>6. Tooltips</H2>

<P>Hovering over the New Mail Notification icon in the system tray
displays the following tooltip:&nbsp; "&lt;UserName&gt; has X new
message(s)".&nbsp; If more than one account has new messages, the
tooltip has multiple lines, one per account.</P>

<P>&nbsp;</P>

<P>

<HR WIDTH="50%" ALIGN=left NOSHADE color="#000000">

</P>

<H1>Issues</H1>

<UL>
   <LI>Is this a global pref setting (and user can select accounts to
   be affected), or is it a per account setting? <B> Global setting.
   1/9/02.</B></LI>
   
   <LI>Does the Mail Notification "Check for new mail every X
   minutes" conflict with the per account "Check for new mail every X
   minutes"? <B>Yes.&nbsp; Only show per account item, not in global
   nsnotify. 1/9/02.</B></LI>
   
   <LI>Separate icons for Mail Notification and Turbo or combined?
   <B>Combined. Icon only visible when new mail is available. Goes
   away otherwise. 1/9/02.</B></LI>
   
   <LI>Is Mail Notification enabled by default? <B>No.
   1/9/02.</B></LI>
   
   <LI>What if user not connected to ISP?&nbsp;<B>Try to connect
   (just like browser does). 1/9/02.</B></LI>
   
   <LI>Mail already running, feedback in system tray as well (as
   Launch Mail icon). <B>Yes. 1/9/02.</B></LI>
   
   <LI>Multiple profiles. <B>Future. 1/9/02.</B></LI>
   
   <LI>Notification of new mail when Mail IS running? <B>Yes, info in
   system tray. 1/9/02.</B></LI>
   
   <LI>Info about how many mail message are waiting when you startup
   the Browser only. <B>Yes. 1/9/02.</B></LI>
   
   <LI>Created a new profile (fred) in 4.x with a invalid Mail
   account. Launched NsNotify. Tray icon appears with a big red X
   across it. Double clicking on tray icon launches the Profile
   Selection dialog with new profile as default in dropdown.
   Selecting "Run Mail Now" launches the Profile Selection dialog as
   well. Select my original profile (jglick) and launch Mail. Tray
   icon still showing icon with red X. Select "Check Now". NsNotify
   now appears to be working with jglick profile. Quit Mail. Start
   Communicator. Selection Profile dialog. jglick profile selected by
   default. Quit Communicator. Run NsNotify. It is working correctly
   so it using my jglick profile (last used profile). Launch Mail
   from tray icon. Select Profile dialog. Select fred profile
   (invalid mail acct). Mail launches with Fred. But NsNotify is
   waving flag on icon so it must be still checking my jglick
   account. Quit Mail. Launch Communicator. Select Profile dialog.
   fred is default profile. Quit app. Run NsNotify. Animated flag is
   showing (fred mail account is invalid so it must still be checking
   jglick, even though fred is last used profile). Launch mail from
   tray icon. Select Profile dialog. fred as default in
   dropdown.</LI>
   
   <LI>Popup alert prefs. What is global and what is per account?
   <B>Prefs will be global, for all accounts. Doesn't take away focus
   from what you're doing. Same interval as bif indicator. Comes up
   once, doesn't come up again until you've addressed existing mail.
   3/18/02.</B></LI>
   
   <LI>Do we want to give users the options to leave the alert up
   until they close it? Option to leave dialog open with "X" to
   close. <B>No. No Title bar, no Close box. 3/18/02.</B></LI>
   
   <LI>Can user turn off the alert?&nbsp;<B>Yes. No timer pref (allow
   user to set alert display time). 3/18/02.</B></LI>
   
   <LI>Can user turn of the system tray icon? <B>No. That's connected
   to bif enable/disable prefs already.&nbsp; 3/18/02.</B></LI>
   
   <LI>Should title be "New Mail" or "New Messages"? "<B>New
   Message". 3/18/02.</B></LI>
   
   <LI>What should be in the context menu for tray icon? Should it
   have a menu? <B>No context menu for now. Not much to put in it
   really. 3/19/02.</B></LI>
   
   <LI>Can Quick Launch be off and alerts still be running? <B>Yes,
   if Mail app is running. 3/18/02.</B><BR>
   </LI>
</UL>
</BODY>
</HTML>
