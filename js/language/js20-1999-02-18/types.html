<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>
<TITLE>JavaScript 2.0 Types</TITLE>
<LINK rel=stylesheet href="../styles.css">
<LINK rel=Start href="index.html">
<LINK rel=Contents href="index.html">
<LINK rel=Prev href="motivation.html">
<LINK rel=Next href="declarations.html">
<SCRIPT type="text/javascript" language="JavaScript1.2" src="../unicodeCompatibility.js"></SCRIPT>
</HEAD>

<BODY>
<TABLE width="100%" border=0 cellspacing=2 cellpadding=0>
<TR>
  <TD valign=TOP nowrap>
    <DIV class=title2><SPAN class=draft-title>February 1999 Draft</SPAN></DIV>
    <DIV class=title2><SPAN class=draft-title>JavaScript 2.0</SPAN></DIV>
    <DIV class=title1>Types</DIV>
  </TD>
  <TD valign=TOP nowrap align=RIGHT><A href="motivation.html"><IMG src="../arrows/left.gif" align=BOTTOM width=37 height=37 alt="previous"></A><A href="index.html"><IMG src="../arrows/up.gif" align=BOTTOM width=37 height=37 alt="up"></A><A href="declarations.html"><IMG src="../arrows/right.gif" align=BOTTOM width=37 height=37 alt="next"></A></TD>
</TR>
</TABLE>

<P class=mod-date>Wednesday, February 17, 1999</P>

<H1>Type Declarations</H1>

<H2>Primitive Types</H2>

<P>The following primitive types are predefined in JavaScript 2.0:</P>

<DIV class=indent>
  <TABLE border=0 cellspacing=2 cellpadding=0>
  <TR>
    <TH valign=TOP nowrap align=LEFT>
      <DIV align=LEFT>
        <P>Type</P>

      </DIV>
    </TH>
    <TH valign=TOP align=LEFT>
      <DIV align=LEFT>
        <P>Values</P>

      </DIV>
    </TH>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>void</CODE></TD>
    <TD valign=TOP><CODE>undefined</CODE></TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>null_t</CODE></TD>
    <TD valign=TOP><CODE>null</CODE></TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>boolean&nbsp;&nbsp;</CODE></TD>
    <TD valign=TOP><CODE>true</CODE> and <CODE>false</CODE></TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>byte</CODE></TD>
    <TD valign=TOP>Integers between -128 and 127 inclusive</TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>ubyte</CODE></TD>
    <TD valign=TOP>Integers between 0 and 255 inclusive</TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>short</CODE></TD>
    <TD valign=TOP>Integers between -32768 and 32767 inclusive</TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>ushort</CODE></TD>
    <TD valign=TOP>Integers between 0 and 65535 inclusive</TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>int</CODE></TD>
    <TD valign=TOP>Integers between -2147483648 and 2147483647 inclusive</TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>uint</CODE></TD>
    <TD valign=TOP>Integers between 0 and 4294967295 inclusive</TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>long</CODE></TD>
    <TD valign=TOP>Integers between -9223372036854775808 and 9223372036854775807 inclusive</TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>ulong</CODE></TD>
    <TD valign=TOP>Integers between 0 and 18446744073709551615 inclusive</TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>integer</CODE></TD>
    <TD valign=TOP>All integers (of arbitrary size)</TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>float</CODE></TD>
    <TD valign=TOP>Single-precision IEEE floating-point numbers, including positive and negative zeroes and infinities and
      NaN</TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>double</CODE></TD>
    <TD valign=TOP>Double-precision IEEE floating-point numbers, including positive and negative zeroes and infinities and
      NaN</TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>real</CODE></TD>
    <TD valign=TOP>Any <CODE>integer</CODE> or <CODE>double</CODE></TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>string</CODE></TD>
    <TD valign=TOP>Immutable strings of unicode characters</TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>funct</CODE></TD>
    <TD valign=TOP>Any function or method</TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>type</CODE></TD>
    <TD valign=TOP>Any type</TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>any</CODE></TD>
    <TD valign=TOP>Any value</TD>
  </TR>
  </TABLE>

</DIV>
<P>Integers are distinct values from floating-point numbers. A literal number that contains a decimal point or exponent is
considered to be a floating-point number; otherwise it's an integer. This distinction does not matter much to most scripts
because integers and floating-point numbers coerce freely to each other, but there are subtle differences between integers
and floating-point numbers in the handling of negative zero and values beyond &plusmn;2<SUP>53</SUP>.</P>

<P>The above type names are <I>not</I> reserved words. They become available at the top level once a script imports the <CODE>Types</CODE>
library.</P>

<H3>User-Defined Types</H3>


<P>Any class defined using the <CODE>class</CODE> declaration is also a type that denotes the set of all of its and its descendants'
instances. These include the predefined classes, so <CODE>Object</CODE>, <CODE>Date</CODE>, etc. are all types. Note that
<CODE>null</CODE> is not an instance of any class.</P>

<H2>Compound Types</H2>

<P>We can use the following operators to construct more complex types. <VAR>t</VAR> is a type expression in the expressions
below.</P>

<DIV class=indent>
  <TABLE border=0 cellspacing=2 cellpadding=0>
  <TR>
    <TH valign=TOP nowrap align=LEFT>Type&nbsp;&nbsp;</TH>
    <TH valign=TOP align=LEFT>Values</TH>
  </TR>
  <TR>
    <TD valign=TOP nowrap><VAR>t</VAR> <CODE>!</CODE></TD>
    <TD valign=TOP><CODE>null</CODE> or any value of type <VAR>t</VAR></TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><VAR>t</VAR> <CODE>~</CODE></TD>
    <TD valign=TOP><CODE>undefined</CODE> or any value of type <VAR>t</VAR></TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap align=left><VAR>t</VAR> <CODE>[]</CODE></TD>
    <TD valign=TOP>any array of values of type <VAR>t</VAR></TD>
  </TR>
  </TABLE>

</DIV>
<P>In addition to the above, a type expression can use any value operators. Except for parentheses, most of them are not very
useful, though.</P>

<H1>Subtyping</H1>

<P>We write <VAR>a</VAR> <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <VAR>b</VAR> to denote that <VAR>a</VAR>
is a subtype of <VAR>b</VAR>. Subtyping is transitive, so if <VAR>a</VAR> <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT>
<VAR>b</VAR> and <VAR>b</VAR> <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <VAR>c</VAR> then <VAR>a</VAR>
<SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <VAR>c</VAR> is also true. Subtyping is also reflexive: <VAR>a</VAR>
<SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <VAR>a</VAR>.</P>

<P>The following subtype relations hold on the basic types:</P>

<DIV class=indent>
  <TABLE border=0 cellspacing=2 cellpadding=0>
  <TR>
    <TD valign=TOP nowrap><CODE>byte</CODE> <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <CODE>short</CODE>
      <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <CODE>int</CODE> <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT>
      <CODE>long</CODE> <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <CODE>integer</CODE></TD>
    <TD valign=TOP></TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>ubyte</CODE> <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <CODE>ushort</CODE>
      <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <CODE>uint</CODE> <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT>
      <CODE>ulong</CODE> <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <CODE>integer</CODE></TD>
    <TD valign=TOP></TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>ubyte</CODE> <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <CODE>short</CODE></TD>
    <TD valign=TOP></TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>ushort</CODE> <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <CODE>int</CODE></TD>
    <TD valign=TOP></TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>uint</CODE> <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <CODE>long</CODE></TD>
    <TD valign=TOP></TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>integer</CODE> <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <CODE>real</CODE></TD>
    <TD valign=TOP></TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>float</CODE> <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <CODE>double</CODE>
      <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <CODE>real</CODE></TD>
    <TD valign=TOP></TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><VAR>c</VAR> <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <CODE>Object</CODE></TD>
    <TD valign=TOP>for any class <VAR>c</VAR></TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><VAR>c</VAR> <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <VAR>d</VAR></TD>
    <TD valign=TOP>for any class <VAR>c</VAR> and subclass <VAR>d</VAR> of <VAR>c</VAR></TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><VAR>t</VAR> <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <CODE>any</CODE></TD>
    <TD valign=TOP>for any type <VAR>t</VAR></TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><VAR>t</VAR><CODE>~</CODE> <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <CODE>void</CODE></TD>
    <TD valign=TOP>for any type <VAR>t</VAR></TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><VAR>t</VAR><CODE>!</CODE> <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <CODE>null_t</CODE></TD>
    <TD valign=TOP>for any type <VAR>t</VAR></TD>
  </TR>
  </TABLE>

</DIV>
<P>Every other subtype relation can be derived from the above by applying the transitivity and reflexivity rules.</P>

<P>We write <VAR>v</VAR> <SCRIPT type="text/javascript">document.write(U_isin)</SCRIPT> <VAR>t</VAR> to indicate that <VAR>v</VAR>
is a value that is a member of type <VAR>t</VAR>. The following subtyping rule holds: if <VAR>v</VAR> <SCRIPT type="text/javascript">document.write(U_isin)</SCRIPT>
<VAR>t</VAR> and <VAR>t</VAR> <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <VAR>s</VAR>, then <VAR>v</VAR>
<SCRIPT type="text/javascript">document.write(U_isin)</SCRIPT> <VAR>s</VAR> holds as well. Thus any particular value <VAR>v</VAR>
is simultaneously a member of many types.</P>

<P>A JavaScript 2.0 <I>value</I> does not have an intrinsic most specific type -- one can ask whether the value <VAR>v</VAR>
is a member of a given type <VAR>t</VAR>, but this does not prevent the value <VAR>v</VAR> from also being a member of some
unrelated type <VAR>s</VAR>. For example, <CODE>3</CODE> is a member of type <CODE>byte</CODE> as well as type <CODE>ubyte</CODE>,
but neither <CODE>byte</CODE> nor <CODE>ubyte</CODE> is a subtype of the other. Thus it is meaningless to talk about <I>the</I>
type of a <I>value</I> -- a value has many types.</P>

<P>On the other hand, a <I>variable</I> does have a particular type. If one declares a variable <VAR>x</VAR> of type <CODE>byte</CODE>,
then whatever value is held in <VAR>x</VAR> is guaranteed to have type <CODE>byte</CODE>, and one can assign any value of
type <CODE>byte</CODE> to <VAR>x</VAR>.</P>

<H1>Operations on Types</H1>

<P>Types are generally used to restrict the set of objects that can be held in a variable or passed as a function argument.
For example, the declaration</P>

<PRE>var integer x;</PRE>

<P>restricts the values that can be held in variable <CODE>x</CODE> to be integers.</P>

<P>A type declaration <I>never</I> affects the semantics of reading the variable or accessing one of its members. Thus,
as long as expression <CODE>new MyType()</CODE> returns a value of type <CODE>MyType</CODE>, the following two code snippets
are equivalent:</P>

<PRE>var MyType x = new MyType();
x.foo();</PRE>

<PRE>var x = new MyType();
x.foo();</PRE>

<P>This equivalence always holds, even if these snippets are inside the declaration of class <CODE>MyType</CODE> and <CODE>foo</CODE>
is a private field of that class. As a corollary, adding true type annotations does not change the meaning of a program.</P>

<H2>Type Expressions</H2>

<P>A type is also a value (whose type is <CODE>type</CODE>) and can be used in expressions, assigned to variables, passed
to functions, etc. For example, the code</P>

<PRE>const type Z = integer;
function abs_val(Z i) Z {
  return i&lt;0 ? -i : i;
}</PRE>
<P>is equivalent to:</P>

<PRE>function abs_val(integer i) integer {
  return i&lt;0 ? -i : i;
}</PRE>
<P>As another example, the following method takes a type and returns an instance of that type:</P>

<P class=syntax><CODE>method QueryInterface(type t) t {</CODE> ... <CODE>}</CODE></P>

<H2><A name="coercion"></A>Type Coercions</H2>

<P>Coercions can take place in the following situations:</P>

<UL>
  <LI>Assigning a value <VAR>v</VAR> to a variable or field of type <VAR>t</VAR></LI>
  <LI>Passing an argument <VAR>v</VAR> to a function whose corresponding parameter has type <VAR>t</VAR></LI>
  <LI>Returning a result <VAR>v</VAR> from a function declared to return a value of type <VAR>t</VAR></LI>
</UL>
<P>In any of these cases, if <VAR>v</VAR> <SCRIPT type="text/javascript">document.write(U_isin)</SCRIPT> <VAR>t</VAR>, then
<VAR>v</VAR> is passed unchanged. However, if <VAR>v</VAR> <SCRIPT type="text/javascript">document.write(U_notin)</SCRIPT>
<VAR>t</VAR>, then <VAR>v</VAR> is sometimes coerced to type <VAR>t</VAR>. The following coercions are predefined:</P>

<DIV class=indent>
  <TABLE border=0 cellspacing=2 cellpadding=0>
  <TR valign=top>
    <TH nowrap align=LEFT><VAR>t</VAR></TH>
    <TH nowrap align=LEFT><VAR>v</VAR></TH>
    <TH nowrap align=LEFT>Result</TH>
  </TR>
  <TR valign=top>
    <TD><CODE>byte</CODE>, <CODE>ubyte</CODE></TD>
    <TD><VAR>v</VAR> <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <CODE>integer</CODE></TD>
    <TD>The unique integer <VAR>w</VAR> <SCRIPT type="text/javascript">document.write(U_isin)</SCRIPT> <VAR>t</VAR> that satisfies
      the congruence <VAR>w</VAR>&nbsp;=&nbsp;<VAR>v</VAR>&nbsp;(mod&nbsp;256)</TD>
  </TR>
  <TR valign=top>
    <TD><CODE>short</CODE>, <CODE>ushort</CODE>&nbsp;&nbsp;</TD>
    <TD><VAR>v</VAR> <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <CODE>integer</CODE></TD>
    <TD>The unique integer <VAR>w</VAR> <SCRIPT type="text/javascript">document.write(U_isin)</SCRIPT> <VAR>t</VAR> that satisfies
      the congruence <VAR>w</VAR>&nbsp;=&nbsp;<VAR>v</VAR>&nbsp;(mod&nbsp;65536)</TD>
  </TR>
  <TR valign=top>
    <TD><CODE>int</CODE>, <CODE>uint</CODE></TD>
    <TD><VAR>v</VAR> <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <CODE>integer</CODE></TD>
    <TD>The unique integer <VAR>w</VAR> <SCRIPT type="text/javascript">document.write(U_isin)</SCRIPT> <VAR>t</VAR> that satisfies
      the congruence <VAR>w</VAR>&nbsp;=&nbsp;<VAR>v</VAR>&nbsp;(mod&nbsp;4294967296)</TD>
  </TR>
  <TR valign=top>
    <TD><CODE>long</CODE>, <CODE>ulong</CODE></TD>
    <TD><VAR>v</VAR> <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <CODE>integer</CODE></TD>
    <TD>The unique integer <VAR>w</VAR> <SCRIPT type="text/javascript">document.write(U_isin)</SCRIPT> <VAR>t</VAR> that satisfies
      the congruence <VAR>w</VAR>&nbsp;=&nbsp;<VAR>v</VAR>&nbsp;(mod&nbsp;2<SUP>64</SUP>)</TD>
  </TR>
  <TR valign=top>
    <TD><VAR>t</VAR> <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <CODE>integer</CODE>&nbsp;&nbsp;</TD>
    <TD><VAR>v</VAR> <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <CODE>double</CODE></TD>
    <TD>If <VAR>v</VAR> has no fractional part, <VAR>v</VAR> is reinterpreted as an integer. &plusmn;0.0 become the integer
      0.<BR>
      If <VAR>v</VAR> has a fractional part or is &plusmn;<SCRIPT type="text/javascript">document.write(U_infin)</SCRIPT>
      or a NaN, the coercion fails.</TD>
  </TR>
  <TR valign=top>
    <TD><CODE>float</CODE>, <CODE>double</CODE>&nbsp;&nbsp;</TD>
    <TD><VAR>v</VAR> <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <CODE>integer</CODE></TD>
    <TD>The floating-point number <VAR>w</VAR> <SCRIPT type="text/javascript">document.write(U_isin)</SCRIPT> <VAR>t</VAR>
      mathematically closest to <VAR>v</VAR> using IEEE round-to-nearest semantics. 0 becomes +0.0.</TD>
  </TR>
  <TR valign=top>
    <TD><CODE>float</CODE>&nbsp;&nbsp;</TD>
    <TD><VAR>v</VAR> <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <CODE>double</CODE></TD>
    <TD>The floating-point number <VAR>w</VAR> <SCRIPT type="text/javascript">document.write(U_isin)</SCRIPT> <VAR>t</VAR>
      mathematically closest to <VAR>v</VAR> using IEEE round-to-nearest semantics.</TD>
  </TR>
  <TR valign=top>
    <TD><CODE>null_t</CODE>&nbsp;&nbsp;</TD>
    <TD><CODE>undefined</CODE></TD>
    <TD><CODE>null</CODE></TD>
  </TR>
  <TR valign=top>
    <TD><CODE>boolean</CODE>&nbsp;&nbsp;</TD>
    <TD><CODE>undefined</CODE></TD>
    <TD><CODE>false</CODE></TD>
  </TR>
  <TR valign=top>
    <TD><VAR>t</VAR> <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <CODE>integer</CODE>&nbsp;&nbsp;</TD>
    <TD><CODE>undefined</CODE></TD>
    <TD>0</TD>
  </TR>
  <TR valign=top>
    <TD><VAR>t</VAR> <SCRIPT type="text/javascript">document.write(U_sube)</SCRIPT> <CODE>double</CODE>&nbsp;&nbsp;</TD>
    <TD><CODE>undefined</CODE></TD>
    <TD>+0.0</TD>
  </TR>
  <TR valign=top>
    <TD><CODE>string</CODE>&nbsp;&nbsp;</TD>
    <TD><CODE>undefined</CODE></TD>
    <TD><CODE>""</CODE></TD>
  </TR>
  </TABLE>

</DIV>
<P>If several coercions apply, the one earlier in the list is selected (this will not happen unless some language extension
defines a type that multiply inherits from several predefined types).</P>

<H2>Type Casts</H2>

<P>A type cast performs more aggressive transformations than a type coercion. To cast a value to a given type, we use the
type as a function, passing it the value as an argument:</P>

<P class=syntax><VAR>type</VAR><CODE>(</CODE><VAR>value</VAR><CODE>)</CODE></P>

<P>For example, <CODE>byte(258.1)</CODE> returns the byte <CODE>2</CODE>, and <CODE>string(2+2==4)</CODE> returns the string
<CODE>"true"</CODE>.</P>

<P class=issue>Need to specify the semantics of type casts. They are intended to mimic the current ToNumber, ToString, etc.
methods.</P>

<HR>
<TABLE width="100%" border=0 cellspacing=2 cellpadding=0>
  <TR>
    <TD valign=BOTTOM nowrap>
      <ADDRESS><A href="mailto:waldemar@netscape.com">Waldemar Horwat</A><BR>
      Last modified Wednesday, February 17, 1999</ADDRESS>
    </TD>
    <TD valign=TOP nowrap align=RIGHT><A href="motivation.html"><IMG src="../arrows/left.gif" align=BOTTOM width=37 height=37 alt="previous"></A><A href="index.html"><IMG src="../arrows/up.gif" align=BOTTOM width=37 height=37 alt="up"></A><A href="declarations.html"><IMG src="../arrows/right.gif" align=BOTTOM width=37 height=37 alt="next"></A></TD>
  </TR>
</TABLE>
</BODY>
</HTML>
