<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>
<TITLE>JavaScript 2.0 Variables</TITLE>
<LINK rel=stylesheet href="../../styles.css">
<LINK rel=Start href="../index.html">
<LINK rel=Contents href="../index.html">
<LINK rel=Prev href="definitions.html">
<LINK rel=Next href="functions.html">
<SCRIPT type="text/javascript" language="JavaScript1.2" src="../../unicodeCompatibility.js"></SCRIPT>
</HEAD>

<BODY>
<TABLE width="100%" border=0 cellspacing=2 cellpadding=0>
<TR>
  <TD valign=TOP nowrap>
    <DIV class=title2><SPAN class=draft-title>July 2000 Draft</SPAN></DIV>
    <DIV class=title2><SPAN class=draft-title>JavaScript 2.0</SPAN></DIV>
    <DIV class=title2>Core Language</DIV>
    <DIV class=title1>Variables</DIV>
  </TD>
  <TD valign=TOP nowrap align=RIGHT><A href="definitions.html"><IMG src="../../arrows/left.gif" align=BOTTOM width=37 height=37 alt="previous"></A><A href="../index.html"><IMG src="../../arrows/up.gif" align=BOTTOM width=37 height=37 alt="up"></A><A href="functions.html"><IMG src="../../arrows/right.gif" align=BOTTOM width=37 height=37 alt="next"></A></TD>
</TR>
</TABLE>

<P class=mod-date>Monday, May 8, 2000</P>

<H2>Variable Definitions</H2>

<DIV class=grammar-rule>
  <DIV class=grammar-lhs><A name="N-VariableDefinition"></A><SPAN class=nonterminal>VariableDefinition</SPAN>&nbsp;<SCRIPT type="text/javascript">document.write(U_rArr)</SCRIPT>&nbsp;<A href="#N-VariableDefinitionKind" class=nonterminal>VariableDefinitionKind</A>&nbsp;<SPAN class=nonterminal><A href="#N-VariableBindingList">VariableBindingList</A><SUP class=nonterminal-attribute>allowIn</SUP></SPAN></DIV>
</DIV>
<DIV class=grammar-rule>
  <DIV class=grammar-lhs><A name="N-VariableDefinitionKind"></A><SPAN class=nonterminal>VariableDefinitionKind</SPAN>&nbsp;<SCRIPT type="text/javascript">document.write(U_rArr)</SCRIPT></DIV>
  <DIV class=grammar-rhs>&nbsp;&nbsp;&nbsp;<CODE class=terminal-keyword>var</CODE></DIV>
  <DIV class=grammar-rhs>|&nbsp;&nbsp;<CODE class=terminal-keyword>const</CODE></DIV>
</DIV>
<DIV class=grammar-rule>
  <DIV class=grammar-lhs><A name="N-VariableBindingList"></A><SPAN class=nonterminal>VariableBindingList<SUP class=nonterminal-argument><SCRIPT type="text/javascript">document.write(U_beta)</SCRIPT></SUP></SPAN>&nbsp;<SCRIPT type="text/javascript">document.write(U_rArr)</SCRIPT></DIV>
  <DIV class=grammar-rhs>&nbsp;&nbsp;&nbsp;<SPAN class=nonterminal><A href="#N-VariableBinding">VariableBinding</A><SUP class=nonterminal-argument><SCRIPT type="text/javascript">document.write(U_beta)</SCRIPT></SUP></SPAN></DIV>
  <DIV class=grammar-rhs>|&nbsp;&nbsp;<SPAN class=nonterminal><A href="#N-VariableBindingList">VariableBindingList</A><SUP class=nonterminal-argument><SCRIPT type="text/javascript">document.write(U_beta)</SCRIPT></SUP></SPAN>&nbsp;<CODE class=terminal-keyword>,</CODE>&nbsp;<SPAN class=nonterminal><A href="#N-VariableBinding">VariableBinding</A><SUP class=nonterminal-argument><SCRIPT type="text/javascript">document.write(U_beta)</SCRIPT></SUP></SPAN></DIV>
</DIV>
<DIV class=grammar-rule>
  <DIV class=grammar-lhs><A name="N-VariableBinding"></A><SPAN class=nonterminal>VariableBinding<SUP class=nonterminal-argument><SCRIPT type="text/javascript">document.write(U_beta)</SCRIPT></SUP></SPAN>&nbsp;<SCRIPT type="text/javascript">document.write(U_rArr)</SCRIPT></DIV>
  <DIV class=grammar-rhs>&nbsp;&nbsp;&nbsp;<SPAN class=nonterminal><A href="#N-TypedVariable">TypedVariable</A><SUP class=nonterminal-argument><SCRIPT type="text/javascript">document.write(U_beta)</SCRIPT></SUP></SPAN></DIV>
  <DIV class=grammar-rhs>|&nbsp;&nbsp;<SPAN class=nonterminal><A href="#N-TypedVariable">TypedVariable</A><SUP class=nonterminal-argument><SCRIPT type="text/javascript">document.write(U_beta)</SCRIPT></SUP></SPAN>&nbsp;<CODE class=terminal-keyword>=</CODE>&nbsp;<SPAN class=nonterminal><A href="expressions.html#N-AssignmentExpression">AssignmentExpression</A><SUP class=nonterminal-argument><SCRIPT type="text/javascript">document.write(U_beta)</SCRIPT></SUP></SPAN></DIV>
</DIV>
<DIV class=grammar-rule>
  <DIV class=grammar-lhs><A name="N-TypedVariable"></A><SPAN class=nonterminal>TypedVariable<SUP class=nonterminal-argument><SCRIPT type="text/javascript">document.write(U_beta)</SCRIPT></SUP></SPAN>&nbsp;<SCRIPT type="text/javascript">document.write(U_rArr)</SCRIPT></DIV>
  <DIV class=grammar-rhs>&nbsp;&nbsp;&nbsp;<A href="expressions.html#N-QualifiedIdentifier" class=nonterminal>QualifiedIdentifier</A></DIV>
  <DIV class=grammar-rhs>|&nbsp;&nbsp;<A href="expressions.html#N-QualifiedIdentifier" class=nonterminal>QualifiedIdentifier</A>&nbsp;<CODE class=terminal-keyword>:</CODE>&nbsp;<SPAN class=nonterminal><A href="expressions.html#N-TypeExpression">TypeExpression</A><SUP class=nonterminal-argument><SCRIPT type="text/javascript">document.write(U_beta)</SCRIPT></SUP></SPAN></DIV>
</DIV>

<P>A variable defined with <CODE class=terminal-keyword>var</CODE> can be modified, while one defined with <CODE class=terminal-keyword>const</CODE>
is read-only. <A href="expressions.html#N-Identifier" class=nonterminal>Identifier</A> is the name of the variable
and <A href="expressions.html#N-TypeExpression" class=nonterminal>TypeExpression</A> is its type. <A href="expressions.html#N-Identifier" class=nonterminal>Identifier</A>
can be any non-reserved identifier. <A href="expressions.html#N-TypeExpression" class=nonterminal>TypeExpression</A>
is evaluated at the time the variable definition is evaluated and should evaluate to a type <VAR>t</VAR>.</P>

<P>If provided, <A href="expressions.html#N-AssignmentExpression" class=nonterminal>AssignmentExpression</A> gives
the variable's initial value <VAR>v</VAR>. If <A href="expressions.html#N-AssignmentExpression" class=nonterminal>AssignmentExpression</A>
is not provided in a <CODE class=terminal-keyword>var</CODE> definition, then <CODE>undefined</CODE> is assumed. <A href="expressions.html#N-AssignmentExpression" class=nonterminal>AssignmentExpression</A>
is evaluated just after the <A href="expressions.html#N-TypeExpression" class=nonterminal>TypeExpression</A> is
evaluated. The value <VAR>v</VAR> is then <A href="../libraries/types.html#coercion">coerced</A> to the variable's type <VAR>t</VAR>
and stored in the variable. If the variable is defined using <CODE class=terminal-keyword>var</CODE>, any values subsequently
assigned to the variable are also coerced to type <VAR>t</VAR> at the time of each such assignment. If the variable is an
instance variable of a class or interface, then the value <VAR>v</VAR> is saved and subsequently used to initialize a slot
in each instance constructed.</P>

<P>Multiple variables separated by commas can be defined in the same <A href="#N-VariableDefinition" class=nonterminal>VariableDefinition</A>.
The values of earlier variables are available in the <A href="expressions.html#N-TypeExpression" class=nonterminal>TypeExpression</A>s
and <A href="expressions.html#N-AssignmentExpression" class=nonterminal>AssignmentExpression</A>s of later variables.
The <A href="definitions.html#static-extent">static extent</A> of a variable begins immediately after its <A href="expressions.html#N-AssignmentExpression" class=nonterminal>AssignmentExpression</A>.</P>

<P>If omitted, <A href="expressions.html#N-TypeExpression" class=nonterminal>TypeExpression</A> defaults to type
<CODE>any</CODE>. Thus, the definition</P>

<PRE>var a, b=3, c:Integer=7, d, e:Type=Boolean, f:Number, g:e, h:int;</PRE>

<P>is equivalent to:</P>

<PRE>var a:any=undefined;
var b:any=3;
var c:Integer=7;
var d:Integer=undefined;  // coerced to NaN
var e:Type=Boolean;
var f:Number=undefined;   // coerced to NaN
var g:Boolean=undefined;  // coerced to false
var h:int=undefined;      // coerced to int(0)</PRE>

<H2>Constant Definitions</H2>

<P><CODE class=terminal-keyword>const</CODE> means that assignments to <A href="expressions.html#N-Identifier" class=nonterminal>Identifier</A>
are not allowed (unless a setter for <A href="expressions.html#N-Identifier" class=nonterminal>Identifier</A> is
also defined). Multiple <CODE>const</CODE> declarations of the same variable are allowed, but only one of them can be a definition
(i.e. have an <A href="expressions.html#N-AssignmentExpression" class=nonterminal>AssignmentExpression</A>). If
multiple <A href="expressions.html#N-TypeExpression" class=nonterminal>TypeExpression</A>s are provided, they must
evaluate to the same type. If a <A href="expressions.html#N-TypeExpression" class=nonterminal>TypeExpression</A>
is not provided by the time the <A href="expressions.html#N-AssignmentExpression" class=nonterminal>AssignmentExpression</A>
is evaluated, the type defaults to <CODE>any</CODE>. Any attempt to read the constant prior to writing its value will result
in an error. For example:</P>

<PRE>const c:Integer;

function f(x) {return x+c}

f(3);  // error: c's value is not defined
const c = 5;
f(3);  // returns 8
const c = 5; // error: redefining c</PRE>

<P>Just like any other definition, a constant may be rebound after leaving its scope. For example, the following is legal;
<CODE>j</CODE> is local to the block, so a new <CODE>j</CODE> binding is created each time through the loop:</P>

<PRE>var k = 0;
for (var i = 0; i &lt; 10; i++) {
  local const j = i;
  k += j;
}</PRE>

<H2>Getters and Setters</H2>

<P>A definition <CODE>var</CODE>&nbsp;<VAR>x</VAR><CODE>:</CODE><VAR>t</VAR>&nbsp;<CODE>=</CODE>&nbsp;<VAR>v</VAR> internally
creates a hidden variable and defines a getter and a setter to access that variable:</P>

<UL>
  <LI>Evaluate <VAR>t</VAR>, which should evaluate to a type.</LI>
  <LI>Create an anonymous variable <VAR><SCRIPT type="text/javascript">document.write(U_xi)</SCRIPT></VAR>.</LI>
  <LI>Coerce <CODE>undefined</CODE> to type <VAR>t</VAR> (such a coercion must exist for every type) and assign the result
    to <VAR><SCRIPT type="text/javascript">document.write(U_xi)</SCRIPT></VAR>.</LI>
  <LI>Define a getter <CODE>function</CODE>&nbsp;<CODE>get</CODE>&nbsp;<VAR>x</VAR><CODE>():</CODE><VAR>t</VAR>&nbsp;<CODE>{return</CODE>&nbsp;<VAR><SCRIPT type="text/javascript">document.write(U_xi)</SCRIPT></VAR><CODE>}</CODE>.</LI>
  <LI>Define a setter <CODE>function</CODE>&nbsp;<CODE>set</CODE>&nbsp;<VAR>x</VAR><CODE>(a:</CODE><VAR>t</VAR><CODE>):</CODE><VAR>t</VAR>&nbsp;<CODE>{</CODE><VAR><SCRIPT type="text/javascript">document.write(U_xi)</SCRIPT></VAR>&nbsp;<CODE>=</CODE>&nbsp;<CODE>a;</CODE>&nbsp;<CODE>return</CODE>&nbsp;<VAR><SCRIPT type="text/javascript">document.write(U_xi)</SCRIPT></VAR><CODE>}</CODE>.</LI>
  <LI>Evaluate <VAR>v</VAR>, coerce it to type <VAR>t</VAR>, and assign the result to <VAR><SCRIPT type="text/javascript">document.write(U_xi)</SCRIPT></VAR>.</LI>
</UL>

<P>A definition <CODE>const</CODE>&nbsp;<VAR>x</VAR><CODE>:</CODE><VAR>t</VAR>&nbsp;<CODE>=</CODE>&nbsp;<VAR>v</VAR> internally
creates a hidden variable and defines a getter to access that variable:</P>

<UL>
  <LI>Evaluate <VAR>t</VAR>, which should evaluate to a type.</LI>
  <LI>Create an anonymous variable <VAR><SCRIPT type="text/javascript">document.write(U_xi)</SCRIPT></VAR>.</LI>
  <LI>Coerce <CODE>undefined</CODE> to type <VAR>t</VAR> (such a coercion must exist for every type) and assign the result
    to <VAR><SCRIPT type="text/javascript">document.write(U_xi)</SCRIPT></VAR>.</LI>
  <LI>Define a getter <CODE>function</CODE>&nbsp;<CODE>get</CODE>&nbsp;<VAR>x</VAR><CODE>():</CODE><VAR>t</VAR>&nbsp;<CODE>{return</CODE>&nbsp;<VAR><SCRIPT type="text/javascript">document.write(U_xi)</SCRIPT></VAR><CODE>}</CODE>.</LI>
  <LI>Define a setter <CODE>function</CODE>&nbsp;<CODE>set</CODE>&nbsp;<VAR>x</VAR><CODE>(a:</CODE><VAR>t</VAR><CODE>):</CODE><VAR>t</VAR>&nbsp;<CODE>{throw</CODE>&nbsp;<VAR>ConstWriteError</VAR><CODE>}</CODE>.</LI>
  <LI>Evaluate <VAR>v</VAR>, coerce it to type <VAR>t</VAR>, and assign the result to <VAR><SCRIPT type="text/javascript">document.write(U_xi)</SCRIPT></VAR>.</LI>
</UL>
<P>This relationship between a variable and its getter and setter is normally transparent but can be exploited occasionally.
For instance, a variable can be declared that is <CODE>private</CODE> for writing but <CODE>public</CODE> for reading:</P>

<PRE>private var name:String;
public export get name;</PRE>

<P>A subclass may override a variable's getter or setter. To do this the original variable has to be declared non-<CODE>final</CODE>
because variables are <CODE>final</CODE> by default:</P>

<PRE>class C {
  virtual var x:Integer;
  var y:Integer;
}

class D extends C {
  override function set x(a:Integer):Integer {return y = a*2}
}

var c = new C;
c.x = 5;
c.x;       // Returns 5
c.y;       // Returns NaN (the default value for an Integer variable)
var d = new D;
d.x = 5;
d.x;       // Returns NaN
d.y;       // Returns 10</PRE>

<HR>
<TABLE width="100%" border=0 cellspacing=2 cellpadding=0>
  <TR>
    <TD valign=BOTTOM nowrap>
      <ADDRESS><A href="mailto:waldemar@netscape.com">Waldemar Horwat</A><BR>
      Last modified Monday, May 8, 2000</ADDRESS>
    </TD>
    <TD valign=TOP nowrap align=RIGHT><A href="definitions.html"><IMG src="../../arrows/left.gif" align=BOTTOM width=37 height=37 alt="previous"></A><A href="../index.html"><IMG src="../../arrows/up.gif" align=BOTTOM width=37 height=37 alt="up"></A><A href="functions.html"><IMG src="../../arrows/right.gif" align=BOTTOM width=37 height=37 alt="next"></A></TD>
  </TR>
</TABLE>
</BODY>
</HTML>
