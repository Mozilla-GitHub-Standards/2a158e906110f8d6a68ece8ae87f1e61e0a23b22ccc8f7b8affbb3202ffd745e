<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>
<TITLE>JavaScript 2.0 Types</TITLE>
<LINK rel=stylesheet href="../../styles.css">
<LINK rel=Start href="../index.html">
<LINK rel=Contents href="../index.html">
<LINK rel=Prev href="index.html">
<LINK rel=Next href="versions.html">
<SCRIPT type="text/javascript" language="JavaScript1.2" src="../../unicodeCompatibility.js"></SCRIPT>
</HEAD>

<BODY>
<TABLE width="100%" border=0 cellspacing=2 cellpadding=0>
<TR>
  <TD valign=TOP nowrap>
    <DIV class=title2><SPAN class=draft-title>July 2000 Draft</SPAN></DIV>
    <DIV class=title2><SPAN class=draft-title>JavaScript 2.0</SPAN></DIV>
    <DIV class=title2>Libraries</DIV>
    <DIV class=title1>Types</DIV>
  </TD>
  <TD valign=TOP nowrap align=RIGHT><A href="index.html"><IMG src="../../arrows/left.gif" align=BOTTOM width=37 height=37 alt="previous"></A><A href="../index.html"><IMG src="../../arrows/up.gif" align=BOTTOM width=37 height=37 alt="up"></A><A href="versions.html"><IMG src="../../arrows/right.gif" align=BOTTOM width=37 height=37 alt="next"></A></TD>
</TR>
</TABLE>

<P class=mod-date>Wednesday, February 16, 2000</P>

<H2>Predefined Types</H2>

<P>The following <A href="../core/concepts.html#type">types</A> are predefined in JavaScript 2.0:</P>

<DIV class=indent>
  <TABLE border=1 cellspacing=2 cellpadding=0>
  <TR>
    <TH valign=TOP nowrap align=LEFT>Type</TH>
    <TH valign=TOP align=LEFT>Set of Values</TH>
    <TH valign=TOP align=LEFT>Coercions</TH>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>none</CODE></TD>
    <TD valign=TOP>No values</TD>
    <TD valign=TOP>None</TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>void</CODE></TD>
    <TD valign=TOP><CODE>undefined</CODE></TD>
    <TD valign=TOP>Any value <SCRIPT type="text/javascript">document.write(U_rarr)</SCRIPT> <CODE>undefined</CODE></TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>Null</CODE></TD>
    <TD valign=TOP><CODE>null</CODE></TD>
    <TD valign=TOP><CODE>undefined</CODE> <SCRIPT type="text/javascript">document.write(U_rarr)</SCRIPT> <CODE>null</CODE></TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>Boolean&nbsp;&nbsp;</CODE></TD>
    <TD valign=TOP><CODE>true</CODE> and <CODE>false</CODE></TD>
    <TD valign=TOP><CODE>undefined</CODE> <SCRIPT type="text/javascript">document.write(U_rarr)</SCRIPT> <CODE>false</CODE></TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>Integer</CODE></TD>
    <TD valign=TOP>Double-precision IEEE floating-point numbers that are mathematical integers, including positive and negative
      zeroes, infinities, and NaN</TD>
    <TD valign=TOP><CODE>undefined</CODE> <SCRIPT type="text/javascript">document.write(U_rarr)</SCRIPT> NaN</TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>Number</CODE></TD>
    <TD valign=TOP>Double-precision IEEE floating-point numbers, including positive and negative zeroes, infinities, and NaN</TD>
    <TD valign=TOP><CODE>undefined</CODE> <SCRIPT type="text/javascript">document.write(U_rarr)</SCRIPT> NaN</TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>Character&nbsp;&nbsp;</CODE></TD>
    <TD valign=TOP>Single 16-bit unicode characters</TD>
    <TD valign=TOP>None</TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>String</CODE></TD>
    <TD valign=TOP>Immutable strings of unicode characters</TD>
    <TD valign=TOP><CODE>undefined</CODE> <SCRIPT type="text/javascript">document.write(U_rarr)</SCRIPT> ""</TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>Function</CODE></TD>
    <TD valign=TOP>All functions</TD>
    <TD valign=TOP>None</TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>Array</CODE></TD>
    <TD valign=TOP>All arrays</TD>
    <TD valign=TOP><CODE>undefined</CODE> <SCRIPT type="text/javascript">document.write(U_rarr)</SCRIPT> <CODE>[]</CODE></TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>Type</CODE></TD>
    <TD valign=TOP>All types</TD>
    <TD valign=TOP><CODE>undefined</CODE> <SCRIPT type="text/javascript">document.write(U_rarr)</SCRIPT> <CODE>any</CODE></TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>any</CODE></TD>
    <TD valign=TOP>All values</TD>
    <TD valign=TOP>None</TD>
  </TR>
  </TABLE>

</DIV>
<P>Unlike in JavaScript 1.5, there is no distinction between objects and primitive values. All values can have methods. Some
values can be sealed, which disallows addition of ad-hoc properties. User-defined classes can be made to behave like primitives.</P>

<P>The above type names are <I>not</I> reserved words. They are considered to be defined in a scope that encloses a package's
global scope, so a package could use these type names as identifiers. However, defining these identifiers for other uses might
be confusing because it would shadow the corresponding type names (the types themselves would continue to exist, but they
could not be accessed by name).</P>

<P><CODE>any</CODE> is the supertype of all types. <CODE>none</CODE> is the subtype of all types. <CODE>none</CODE> is useful
to describe the return type of a function that cannot return normally because it either falls into an infinite loop or always
throws an exception. <CODE>void</CODE> is useful to describe the return type of a function that can return but that does not
produce a useful value.</P>

<P>A literal number is a member of the type <CODE>Number</CODE>; if that literal has an integral value, then it is also a
member of type <CODE>Integer</CODE>. A literal string is a member of the type <CODE>String</CODE>; if that literal has exactly
one 16-bit unicode character, then it is also a member of type <CODE>Character</CODE>.</P>

<H2>Predefined Type Constructors</H2>

<P>We can use the following operators to construct more complex types. <VAR>t</VAR> is a type expression and <VAR>u</VAR>
is a value expression in the table below.</P>

<DIV class=indent>
  <TABLE border=1 cellspacing=2 cellpadding=0>
  <TR>
    <TH valign=TOP nowrap align=LEFT>Type&nbsp;&nbsp;</TH>
    <TH valign=TOP align=LEFT>Values</TH>
    <TH valign=TOP align=LEFT>Coercions</TH>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>+</CODE> <VAR>t</VAR></TD>
    <TD valign=TOP><CODE>null</CODE> or any value belonging to type <VAR>t</VAR></TD>
    <TD valign=TOP><CODE>null</CODE> <SCRIPT type="text/javascript">document.write(U_rarr)</SCRIPT> <CODE>null</CODE>; <CODE>undefined</CODE>
      <SCRIPT type="text/javascript">document.write(U_rarr)</SCRIPT> <CODE>null</CODE> (if <CODE>undefined</CODE> is not a
      member of <VAR>t</VAR>); any other coercions already defined for <VAR>t</VAR></TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>~</CODE> <VAR>t</VAR></TD>
    <TD valign=TOP><CODE>undefined</CODE> or any value belonging to type <VAR>t</VAR></TD>
    <TD valign=TOP><CODE>undefined</CODE> <SCRIPT type="text/javascript">document.write(U_rarr)</SCRIPT> <CODE>undefined</CODE>;
      any other coercions already defined for <VAR>t</VAR></TD>
  </TR>
  <TR>
    <TD valign=TOP nowrap><CODE>singleton(</CODE><VAR>u</VAR><CODE>)</CODE></TD>
    <TD valign=TOP>Only the value <VAR>u</VAR></TD>
    <TD valign=TOP>None</TD>
  </TR>
  </TABLE>

</DIV>
<P>The language cannot syntactically distinguish type expressions from value expressions, so a type expression can also use
any other value operators such as <CODE>!</CODE>, <CODE>|</CODE>, and <CODE>.</CODE> (member access). Except for parentheses,
most of them are not very useful, though. <SPAN class=issue>See also the <A href="../rationale/syntax.html#type-expressions">type
expression syntax rationale</A> for other possible type constructors.</SPAN></P>

<H2>User-Defined Types</H2>

<P>Any class defined using the <CODE>class</CODE> declaration is also a type that denotes the set of all of its and its descendants'
instances. These include the predefined classes, so <CODE>Object</CODE>, <CODE>Date</CODE>, etc. are all types. <CODE>null</CODE>
is not an instance of a user-defined class.</P>

<H2>Meaning of Types</H2>

<P>Types are generally used to restrict the set of objects that can be held in a variable or passed as a function argument.
For example, the declaration</P>

<PRE>var x:Integer;</PRE>

<P>restricts the values that can be held in variable <CODE>x</CODE> to be integers.</P>

<P class=issue>Type declarations use the Pascal-style colon syntax. See the <A href="../rationale/syntax.html#type-declarations">type
declaration syntax rationale</A> for an alternative.</P>

<P>A type declaration does not affect the semantics of reading the variable or accessing one of its members. Thus, as long
as expression <CODE>new MyType()</CODE> returns a value of type <CODE>MyType</CODE>, the following two code snippets are equivalent:</P>

<PRE>var x:MyType = new MyType();
x.foo();</PRE>

<PRE>var x = new MyType();
x.foo();</PRE>

<P>This equivalence always holds, even if these snippets are inside the declaration of class <CODE>MyType</CODE> and <CODE>foo</CODE>
is a private field of that class. As a corollary, adding true type annotations does not change the meaning of a program.</P>

<H2>Type Expressions</H2>

<P>A type is also a value (whose type is <CODE>type</CODE>) and can be used in expressions, assigned to variables, passed
to functions, etc. For example, the code</P>

<PRE>const Z:Type = Integer;
function abs_val(i:Z):Z {
  return i&lt;0 ? -i : i;
}</PRE>

<P>is equivalent to:</P>

<PRE>function abs_val(i:Integer):Integer {
  return i&lt;0 ? -i : i;
}</PRE>

<P>As another example, the following method takes a type and returns an instance of that type:</P>

<P class=syntax><CODE>method QueryInterface(T:Type):T {</CODE> ... <CODE>}</CODE></P>

<H2><A name="coercion"></A>Coercions</H2>

<P>Coercions can take place in the following situations:</P>

<UL>
  <LI>Assigning a value <VAR>v</VAR> to a variable or field of type <VAR>t</VAR></LI>
  <LI>Passing an argument <VAR>v</VAR> to a function whose corresponding parameter has type <VAR>t</VAR></LI>
  <LI>Returning a result <VAR>v</VAR> from a function declared to return a value of type <VAR>t</VAR></LI>
  <LI>Using the <VAR>v</VAR><CODE>@</CODE><VAR>t</VAR> operator.</LI>
</UL>
<P>In any of these cases, if <VAR>v</VAR> <SCRIPT type="text/javascript">document.write(U_isin)</SCRIPT> <VAR>t</VAR>, then
<VAR>v</VAR> is passed unchanged. If <VAR>v</VAR> <SCRIPT type="text/javascript">document.write(U_notin)</SCRIPT> <VAR>t</VAR>,
then if <VAR>t</VAR> defines a mapping for value <VAR>v</VAR> then that mapped <VAR>v</VAR> is used; otherwise an error occurs.</P>

<H3><CODE>@</CODE> Operator</H3>

<P>One can explicitly request a coercion in an expression by using the <CODE>@</CODE> operator. This operator has the same
precedence as <CODE>.</CODE> and coerces its left operand to the right operand, which must be a type. ...&nbsp;<VAR>v</VAR><CODE>@</CODE><VAR>t</VAR>&nbsp;...
can be used in an expression and has the same effect as:</P>

<P class=indent><CODE>function&nbsp;coerce_to_</CODE><VAR>t</VAR><CODE>(a:</CODE><VAR>t</VAR><CODE>):</CODE><VAR>t</VAR><CODE>&nbsp;{return&nbsp;a}&nbsp;&nbsp;&nbsp;//</CODE>
Declared at the top level<BR>
<BR>
...&nbsp;<CODE>coerce_to_</CODE><VAR>t</VAR><CODE>(</CODE><VAR>v</VAR><CODE>)</CODE>&nbsp;...</P>

<P>assuming that <CODE>coerce_to_</CODE><VAR>t</VAR> is an identifier not used anywhere else. The <CODE>@</CODE>
operator is useful as a type assertion as in <CODE>w@Window</CODE>. It's a postfix operator to simplify cascading expressions:</P>

<PRE>w@Window.child@Window.pos</PRE>

<P>is equivalent to:</P>

<PRE>(((w@Window).child)@Window).pos</PRE>

<H2><A name="cast"></A>Casts</H2>

<P>A type cast performs more aggressive transformations than a type coercion. To cast a value to a given type, we use the
type as a function, passing it the value as an argument:</P>

<P class=syntax><VAR>type</VAR><CODE>(</CODE><VAR>value</VAR><CODE>)</CODE></P>

<P>For example, <CODE>Integer(258.1)</CODE> returns the integer <CODE>258</CODE>, and <CODE>String(2+2==4)</CODE> returns
the string <CODE>"true"</CODE>.</P>

<P>If <VAR>value</VAR> is already a member of <VAR>type</VAR>, the type cast returns <VAR>value</VAR> unchanged. If <VAR>value</VAR>
can be coerced to <VAR>type</VAR>, the type cast returns the result of the coercion. Otherwise, the effect of a type cast
depends on <VAR>type</VAR>.</P>

<P class=issue>Need to specify the semantics of type casts. They are intended to mimic the current ToNumber, ToString, etc.
methods.</P>

<HR>
<TABLE width="100%" border=0 cellspacing=2 cellpadding=0>
  <TR>
    <TD valign=BOTTOM nowrap>
      <ADDRESS><A href="mailto:waldemar@netscape.com">Waldemar Horwat</A><BR>
      Last modified Wednesday, February 16, 2000</ADDRESS>
    </TD>
    <TD valign=TOP nowrap align=RIGHT><A href="index.html"><IMG src="../../arrows/left.gif" align=BOTTOM width=37 height=37 alt="previous"></A><A href="../index.html"><IMG src="../../arrows/up.gif" align=BOTTOM width=37 height=37 alt="up"></A><A href="versions.html"><IMG src="../../arrows/right.gif" align=BOTTOM width=37 height=37 alt="next"></A></TD>
  </TR>
</TABLE>
</BODY>
</HTML>
