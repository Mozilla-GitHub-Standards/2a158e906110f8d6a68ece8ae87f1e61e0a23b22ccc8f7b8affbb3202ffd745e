<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<link rel="top" title="Home" href="http://www.mozilla.org/">
<link rel="stylesheet" type="text/css" href="../../css/print.css"  media="print">
<link rel="stylesheet" type="text/css" href="../../css/base/content.css"  media="all">
<link rel="stylesheet" type="text/css" href="../../css/cavendish/content.css" title="Cavendish" media="screen">
<link rel="stylesheet" type="text/css" href="../../css/base/template.css"  media="screen">
<link rel="stylesheet" type="text/css" href="../../css/cavendish/template.css" title="Cavendish" media="screen">
<link rel="icon" href="../../images/mozilla-16.png" type="image/png">

	<title>class PrefWindow</title>
  <link rel="stylesheet" type="text/css" href="wsm.css">
<script src="../../__utm.js" type="text/javascript"></script>
</head>
<body id="www-mozilla-org" class="deepLevel">
<div id="container">
<p class="important">You are currently viewing a snapshot of www.mozilla.org taken on April 21, 2008. Most of this content is
highly out of date (some pages haven't been updated since the project began in 1998) and exists for historical purposes only.  If
there are any pages on this archive site that you think should be added back to www.mozilla.org, please <a
href="https://bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=www.mozilla.org">file a bug</a>.</p>
<p class="skipLink"><a href="#mainContent" accesskey="2">Skip to main content</a></p>
<div id="header">
<h1><a href="/" title="Return to home page" accesskey="1">Mozilla</a></h1>
<ul>
<li id="menu_aboutus"><a href="../../about/" title="Getting the most out of your online experience">About</a></li>
<li id="menu_developers"><a href="../../developer/" title="Using Mozilla's products for your own applications">Developers</a></li>
<li id="menu_store"><a href="http://store.mozilla.org/?r=mozorg1" title="Shop for Mozilla products on CD and other merchandise">Store</a></li>
<li id="menu_support"><a href="../../support/" title="Installation, trouble-shooting, and the knowledge base">Support</a></li>
<li id="menu_products"><a href="../../products/" title="All software Mozilla currently offers">Products</a></li>
</ul>
<form id="searchbox_002443141534113389537:ysdmevkkknw" action="http://www.google.com/cse" title="mozilla.org Search">
<div>
<label for="q" title="Search mozilla.org's sites">search mozilla:</label>
<input type="hidden" name="cx" value="002443141534113389537:ysdmevkkknw">
<input type="hidden" name="cof" value="FORID:0">
<input type="text" id="q" name="q" accesskey="s" size="30">
<input type="submit" id="submit" value="Go">
</div>
</form>
</div>
<hr class="hide">
<div id="mBody">
<div id="side">

<ul id="nav">
<li><a title="Roadmap" href="../../roadmap.html"><strong> Roadmap</strong></a></li>
<li><a title="Projects" href="../../projects/"><strong> Projects</strong></a></li>
<li><a title="For developers" href="../../developer/"><strong> Coding</strong></a>
<ul>
<li><a title="Module Owners" href="../../owners.html"> Module Owners</a></li>
<li><a title="Hacking" href="../../hacking/"> Hacking</a></li>
<li><a title="Get the Source" href="http://developer.mozilla.org/en/docs/Download_Mozilla_Source_Code"> Get the Source</a></li>
<li><a title="Building Mozilla" href="http://developer.mozilla.org/en/docs/Build_Documentation"> Build It</a></li>
</ul>
</li>
<li><a title="Testing" href="../../quality/"><strong> Testing</strong></a>
<ul>
<li><a title="Downloads of mozilla.org software releases" href="../../download.html"> Releases</a></li>
<li><a title="Latest mozilla builds for testers" href="../../developer/#builds"> Nightly Builds</a></li>
<li><a title="For testers to report bugs" href="https://bugzilla.mozilla.org/"> Report A Problem</a></li>
</ul>
</li>
<li><a title="Tools for mozilla developers" href="../../tools.html"><strong> Tools</strong></a>
<ul>
<li><a title="Bug tracking system for mozilla testers." href="https://bugzilla.mozilla.org/"> Bugzilla</a></li>
<li><a title="Latest status of mozilla builds" href="http://tinderbox.mozilla.org/showbuilds.cgi?tree=Firefox"> Tinderbox</a></li>
<li><a title="Latest checkins" href="http://bonsai.mozilla.org/cvsqueryform.cgi"> Bonsai</a></li>
<li><a title="Source cross reference" href="http://lxr.mozilla.org/seamonkey/"> LXR</a></li>
</ul>
</li>
<li><a title="Frequently Asked Questions." href="../../faq.html"><strong> FAQs</strong></a></li>
</ul>

</div>
<hr class="hide">
<div id="mainContent">






<h1 id="header">PrefWindow</h1>
<div id="headerul"></div>
<div align="right" id="contact">
 Contact: <a href="mailto:rgoodger@ihug.co.nz?subject=WidgetStateManager">Ben Goodger</a>
</div>

<h2>Table of Contents</h2>
<table width="100%">
 <tr><td><li>Introduction</td><td>1</td></tr>
 <tr><td><li>Instantiation</td><td>1</td></tr>
 <tr><td><li>Saving Page Data</td><td>1</td></tr>
 <tr><td><li>Retrieving Page Data</td><td>2</td></tr>
 <tr><td><li>Convenience/Utility/Internal Functions</td><td>3</td></tr>
 <tr><td><li>Data Storage Internals</td><td>6</td></tr>
</table>

<h2>Introduction</h2>
<p>PrefWindow is the class used by the Mozilla Preferences window to manage preference 
   saving, retrieval, and page switching. It can be extended to perform any number 
   of other tasks. If you are creating an application using Mozilla technology, 
   rather than assuming that you can place your application preferences in the 
   Mozilla panel, it is probably wise to develop your own prefs system to avoid 
   overcrowding. If your application demands a large number of different prefs panels, 
   then PrefWindow (and the associated XUL) may be useful in developing such a 
   system. PrefWindow relies on the WidgetStateManager class described in a 
   <a href="widgetstatemanager.html">separate document</a>.

<h2>Use &amp; Instantiation</h2>
<p>Rather than describe the instantiation process, as this is a fairly specialised 
   class, I'll point you to the place where it is implemented: chrome://pref/content/pref.xul. 
   This guide will focus on how to make panels that interact with this class.

<h2>Link to Mozilla</h2>
<p>This class is somewhat linked to Mozilla. It loads the default mozilla user 
   profile preferences, and saves to them. You may wish to store preferences in 
   your own file, in your own configuration folder. The interface nsIPref allows 
   you to save and load from different preferences files. For these purposes you 
   should modify the PrefWindow code accordingly. 
   
<h2>Flow Overview of PrefWindow</h2>   
<p>When the PrefWindow object is created, the appropriate interface(s) are initialised, 
   button handlers are set, and any queued page data is loaded (PREF_onload). If 
   the page that is loaded in the IFRAME does not have an entry in the associated 
   WidgetStateManager's DataManager, the page's elements are pre-filled from user 
   preferences (PREF_onpageload). When the user switches panels, the data in the 
   current page is saved, the page changed, and the new page populated either from 
   the DataManager or user preferences. (PREF_SwitchPage). When the user clicks 
   the OK button, the current page data is saved (PREF_onok), then for each element 
   in the Data Manager (PREF_DoSavePrefs) the appropriate pref type is set (PREF_ParsePref).

<h2>Requirements for Prefs Panels</h2>
<p>Each panel must contain the following in the onload event handler for the &lt;window&gt;:
<blockquote>
  <code>onload="if( parent.handle ) parent.handle.onpageload( tag ); else parent.queuedTag = tag;"</code>
</blockquote>
<p>where 'tag' is the string representing the current tag. In the case of the 
   Mozilla implementation of PrefWindow, parent.handle refers to the PrefWindow 
   object itself. If you have instantiated it as another variable, you must use 
   parent.yourVariableName instead.
<p>This piece of code sends a request to the PrefWindow for the data associated 
   with this page, if a PrefWindow object exists in the containing window. This 
   can either be from the WidgetStateManager DataManager, or from user prefs 
   (see description above). This request is sent only if the PrefWindow object 
   exists. As the PrefWindow object is only created once the entire window has 
   loaded, the initial prefs panel has loaded in the IFRAME and makes the population 
   request before the PrefWindow object is created, thus the test for the existence 
   of a PrefWindow object. If a PrefWindow does not exist, the pref panel is "queued" 
   and then initialised when the PrefWindow is initialised.
<p>If you are using the Automatic Data Saving provided by the WidgetStateManager, 
   all your form widgets must contain some extra attributes. In the past, Prefs 
   panel form elements described themselves by their id attribute. Now however 
   the various aspects of a prefs form element are described by these attributes:

 <blockquote>
  <blockquote>
    <table class="paramtable">
     <tr>
      <td valign="top"><code>id</code></td>
      <td>the id of the element. can be anything.</td>
     </tr>
     <tr>
      <td valign="top"><code>pref</code></td>
      <td>true if the element is a pref element. unset otherwise</td>
     </tr>
     <tr> 
      <td valign="top"><code>preftype</code></td>
      <td>either bool, int, color or string. Refers to the type of pref.</td>
     </tr>
     <tr> 
      <td valign="top"><code>prefstring</code></td>
      <td>a string representing the pref in the prefs.js file.</td>
     </tr>
     <tr> 
      <td valign="top"><code>prefindex</code></td>
      <td>a string representing the index of the pref. Used for radiobuttons, 
          where several widgets refer to the same pref, and some distinction 
          between them is required. </td>
     </tr>
    </table>
  </blockquote>
 </blockquote>
 <br>
 <u>Example:</u><br>
 <blockquote>
  <code>
    &lt;html:input id="toolbarStyle2" type="radio" name="toolbarStyle2"
     pref="true" preftype="int" prefindex="2"
     prefstring="browser.toolbar.style" /&gt;
  </code>
  <br>
  Creates a radiobutton with id toolbarStyle2, the third element in the group 
  "toolbarStyle2", and creates the integer pref "browser.toolbar.style"
 </blockquote>

<p> 




<hr class="hide">
</div>
</div>
<div id="footer">
<ul>
<li><a href="../../sitemap.html">Site Map</a></li>
<li><a href="../../security/">Security Updates</a></li>
<li><a href="../../contact/">Contact Us</a></li>
<li><a href="../../foundation/donate.html">Donate</a></li>
</ul>
<p class="copyright">
Portions of this content are &copy; 1998&#8211;2009 by individual mozilla.org
contributors; content available under a Creative Commons license | <a
href="http://www.mozilla.org/foundation/licensing/website-content.html">Details</a>.</p>
<p>
<span>Last modified December 12,  1999</span>
<span><a href="http://bonsai-www.mozilla.org/cvslog.cgi?file=mozilla-org/html/xpapps/components/prefwindow.html&amp;rev=&amp;root=/www/">Document History</a></span>
</p>
</div>
</div>
</body>
</html>
