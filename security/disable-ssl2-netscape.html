<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="top" title="Home" href="http://www.mozilla.org/">
<link rel="stylesheet" type="text/css" href="../css/print.css"  media="print">
<link rel="stylesheet" type="text/css" href="../css/base/content.css"  media="all">
<link rel="stylesheet" type="text/css" href="../css/cavendish/content.css" title="Cavendish" media="screen">
<link rel="stylesheet" type="text/css" href="../css/base/template.css"  media="screen">
<link rel="stylesheet" type="text/css" href="../css/cavendish/template.css" title="Cavendish" media="screen">
<link rel="icon" href="../images/mozilla-16.png" type="image/png">

  <meta content="text/html; charset=ISO-8859-1"  http-equiv="content-type">
  <title>Instructions for Disabling SSL 2 in Netscape Servers</title>
<script src="../__utm.js" type="text/javascript"></script>
</head>
<body id="www-mozilla-org" class="deepLevel">
<div id="container">
<p class="important">You are currently viewing a snapshot of www.mozilla.org taken on April 21, 2008. Most of this content is
highly out of date (some pages haven't been updated since the project began in 1998) and exists for historical purposes only.  If
there are any pages on this archive site that you think should be added back to www.mozilla.org, please <a
href="https://bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=www.mozilla.org">file a bug</a>.</p>
<p class="skipLink"><a href="#mainContent" accesskey="2">Skip to main content</a></p>
<div id="header">
<h1><a href="/" title="Return to home page" accesskey="1">Mozilla</a></h1>
<ul>
<li id="menu_aboutus"><a href="../about/" title="Getting the most out of your online experience">About</a></li>
<li id="menu_developers"><a href="../developer/" title="Using Mozilla's products for your own applications">Developers</a></li>
<li id="menu_store"><a href="http://store.mozilla.org/?r=mozorg1" title="Shop for Mozilla products on CD and other merchandise">Store</a></li>
<li id="menu_support"><a href="../support/" title="Installation, trouble-shooting, and the knowledge base">Support</a></li>
<li id="menu_products"><a href="../products/" title="All software Mozilla currently offers">Products</a></li>
</ul>
<form id="searchbox_002443141534113389537:ysdmevkkknw" action="http://www.google.com/cse" title="mozilla.org Search">
<div>
<label for="q" title="Search mozilla.org's sites">search mozilla:</label>
<input type="hidden" name="cx" value="002443141534113389537:ysdmevkkknw">
<input type="hidden" name="cof" value="FORID:0">
<input type="text" id="q" name="q" accesskey="s" size="30">
<input type="submit" id="submit" value="Go">
</div>
</form>
</div>
<hr class="hide">
<div id="mBody">
<div id="side">

<ul id="nav">
<li><a title="Roadmap" href="../roadmap.html"><strong> Roadmap</strong></a></li>
<li><a title="Projects" href="../projects/"><strong> Projects</strong></a></li>
<li><a title="For developers" href="../developer/"><strong> Coding</strong></a>
<ul>
<li><a title="Module Owners" href="../owners.html"> Module Owners</a></li>
<li><a title="Hacking" href="../hacking/"> Hacking</a></li>
<li><a title="Get the Source" href="http://developer.mozilla.org/en/docs/Download_Mozilla_Source_Code"> Get the Source</a></li>
<li><a title="Building Mozilla" href="http://developer.mozilla.org/en/docs/Build_Documentation"> Build It</a></li>
</ul>
</li>
<li><a title="Testing" href="../quality/"><strong> Testing</strong></a>
<ul>
<li><a title="Downloads of mozilla.org software releases" href="../download.html"> Releases</a></li>
<li><a title="Latest mozilla builds for testers" href="../developer/#builds"> Nightly Builds</a></li>
<li><a title="For testers to report bugs" href="https://bugzilla.mozilla.org/"> Report A Problem</a></li>
</ul>
</li>
<li><a title="Tools for mozilla developers" href="../tools.html"><strong> Tools</strong></a>
<ul>
<li><a title="Bug tracking system for mozilla testers." href="https://bugzilla.mozilla.org/"> Bugzilla</a></li>
<li><a title="Latest status of mozilla builds" href="http://tinderbox.mozilla.org/showbuilds.cgi?tree=Firefox"> Tinderbox</a></li>
<li><a title="Latest checkins" href="http://bonsai.mozilla.org/cvsqueryform.cgi"> Bonsai</a></li>
<li><a title="Source cross reference" href="http://lxr.mozilla.org/seamonkey/"> LXR</a></li>
</ul>
</li>
<li><a title="Frequently Asked Questions." href="../faq.html"><strong> FAQs</strong></a></li>
</ul>

</div>
<hr class="hide">
<div id="mainContent">




<h1>Instructions for Disabling SSL 2 in Netscape Servers</h1>
<h3>Last updated 2004-09-16</h3>
This document describes how to disable SSL 2 and all the SSL 2 cipher
suites in the following Netscape servers.<br>
<ul>
  <li><a href="#NES6">Netscape Enterprise Server NES: versions 6.0 and
later</a></li>
  <li><a href="#NES4">Netscape Enterprise Server NES version 4.x</a><br>
  </li>
  <li><a href="#NDS">Directory Server: versions 6.0, 6.01, 6.02, 6.1,
6.11, and 6.2</a></li>
  <li><a href="#CMS">CMS: versions 4.1, 4.2, 4.5, 6.0, 6.01, 6.1, and
6.2</a></li>
  <li><a href="#Admin">Administration Server:</a> versions contained in
  </li>
  <ul>
    <li>CMS 4.x</li>
    <li>CMS 6.x</li>
    <li>Directory Server 4.x </li>
    <li>Directory Server 6.x<br>
    </li>
  </ul>
</ul>
<hr style="width: 100%; height: 2px;">
<h2><a name="NES6"></a>Netscape Enterprise Server NES 6.0 and later<br>
</h2>
These instructions apply to NES 6.0 and later (including all service
packs).<br>
<br>
To disable SSL 2 via the NES admin server:<br>
<ol>
  <li>Log into admin</li>
  <li>Select the instance you want (or stay in and configure the admin
server)</li>
  <li>Select the Preferences tab</li>
  <li>For the listen socket that has SSL enabled, select Attributes</li>
  <li>Under Ciphers select SSL2</li>
  <li>Uncheck "SSL version 2". One may also disable all of the SSL 2
ciphers here.</li>
  <li>Click Ok, then Quit to get rid of the window</li>
  <li>Click Apply in upper-right of browser</li>
  <li>Click Apply Changes and restart the server</li>
  <li>Enter your SSL password when prompted</li>
</ol>
To disable it manually via the configuration files:<br>
<br>
1. Edit &lt;server-root&gt;/http-&lt;instance&gt;/config/server.xml:<br>
<ul>
  <li>In the SSLPARAMS element there is an ssl2 attribute. Set this to
"off".</li>
  <li>To also disable all of the ssl2 ciphers, replace "+" with "-" in
the ssl2ciphers attribute for all of the ciphers listed.</li>
</ul>
<div style="margin-left: 40px;">Here is an example:<br>
<br>
<code>&lt;SSLPARAMS servercertnickname="Server-Cert" ssl2="off" </code><br>
<code><span style="text-decoration: underline;">ssl2ciphers="-rc4,-rc4export,-rc2,-rc2export,-des,-desede3"</span>
ssl3="on" </code><br>
<code>ssl3tlsciphers="+rsa_rc4_128_md5,+rsa_3des_sha,+rsa_des_sha,+rsa_rc4_40_md5,+rsa_rc2_40_md5,-rsa_null_md5"</code><code>/&gt;</code><br>
<code></code></div>
<br>
2. Stop and restart NES<br>
<br>
<hr style="width: 100%; height: 2px;">
<h2><a name="NES4"></a>Netscape Enterprise Server NES 4.x</h2>
<ol>
  <li>Log into admin</li>
  <li>Select the instance you want (or stay in and configure the admin
server)</li>
  <li>Select the Preferences tab</li>
  <li>Select Encryption Preferences</li>
  <li>Uncheck "SSL version 2". One may also disable all of the SSL 2
ciphers here.</li>
  <li>Click Ok, then Ok again to acknowledge that your changes have
been saved.</li>
  <li>Click&nbsp; "Save and Apply" to apply the changes and restart the
server.</li>
</ol>
<br>
<hr style="width: 100%; height: 2px;">
<h2><a name="NDS"></a>Directory Server: versions 6.0, 6.01, 6.02, 6.1,
6.11, and 6.2</h2>
This applies to Directory Server versions 6.0, 6.01, 6.02, 6.1, 6.11,
and 6.2.&nbsp; <br>
<span style="text-decoration: underline;">These steps are not necessary
on later versions of Directory Server.</span><br>
<br>
If you have enabled SSL on your Administration Server, please also
follow the instructions below to disable SSL 2 ciphers for that server,
also.<br>
<br>
<ol>
  <li>Stop Directory Server.</li>
&lt;&gt;Open the
&lt;server_root&gt;/slapd-&lt;instance&gt;/config/dse.ldif
file in an editor.&nbsp; You need to disable all of the SSL 2 ciphers
in the "dn:cn=encryption,cn=config" entry, by adding the follwing to
the comma separated list of ciphers in the "nsSSL3ciphers" attribute:<code><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-rc4,-rc4export,-rc2,-rc2export,-des,-desede3</code><li>Restart
Directory Server</li>
</ol>
Here's an example of the nsSSL3ciphers attribute with the correct
ciphers disabled:&nbsp; This should be one line, but it is broken into
multiple lines here to be more readable.<br>
<br>
<div style="margin-left: 40px;"><code>nsSSL3Ciphers:
-rsa_null_md5,+rsa_rc4_128_md5,+rsa_rc4_40_md5,+rsa_rc2_40_md5,</code><br>
<code>+rsa_des_sha,+rsa_fips_des_sha,+rsa_3des_sha,+rsa_fips_3des_sha,+fortezza,</code><br>
<code>+fortezza_rc4_128_sha,+fortezza_null,+tls_rsa_export1024_with_rc4_56_sha,</code><br>
<code>+tls_rsa_export1024_with_des_cbc_sha,<span  style="text-decoration: underline;">-rc4,-rc4export,-rc2,-rc2export,-des,-desede3</span></code><br>
</div>
<br>
Notes: <br>
<ul>
  <li>It is important that you include the hyphen character before each
cipher when modifying the "nsSSL3ciphers" attribute.&nbsp; That tells
Directory Server to not enable those ciphers.</li>
  <li>If you modify your cipher preferences through Directory Server
Console again, you will lose these manually added ciphers.&nbsp; You
would then need to go through this procedure of modifying the dse.ldif
file again</li>
</ul>
<br>
<hr style="width: 100%; height: 2px;">
<h2><a name="CMS"></a>CMS: versions 4.1, 4.2, 4.5, 6.0, 6.01, 6.1, and
6.2</h2>
If you have enabled SSL on your Administration Server, please also
follow the instructions under that product to disable SSL 2 ciphers.<br>
<br>
If you have enabled SSL on your Directory Server, please also follow
the instructions under that product to disable SSL 2 ciphers for each
instance of DS.<br>
<br>
To disable SSL 2 ciphers in CMS 4.1, 4.2, 4.5, and all
subsequent 4.x patches/service packs, perform the following steps for
each instance of CMS:<br>
<ol>
  <li><code>cd &lt;server_root&gt;/cert-&lt;instance&gt;/</code></li>
  <li><code>./stop-cert</code></li>
  <li><code>cd &lt;server_root&gt;/cert-&lt;instance&gt;/config/</code></li>
  <li>edit CMS.cfg and change the line "jss.ssl.cipherpref=" to&nbsp; <code>jss.ssl.cipherpref=rsa_rc4_40_md5,rsa_rc4_128_md5,rsa_des_sha,rsa_3des_sha,rsa_fips_3des_sha,rsa_fips_des_sha
    </code> <span style="font-family: monospace;"></span></li>
  <li><code>cd &lt;server_root&gt;/cert-&lt;instance&gt;/</code></li>
  <li><code>./start-cert</code></li>
</ol>
<br>
To disable SSL 2 ciphers in CMS 6.0, 6.01, 6.1, 6.2, and
all subsequent 6.x patches/service packs, disable them manually
via the configuration files, according to the following steps:
<ul>
  <li>To disable SSL 2 for each instance of CMS <span  style="text-decoration: underline;">that has already been
created,</span>&nbsp; for the given &lt;server_root&gt;:
    <ol>
      <li><code>cd &lt;server_root&gt;/cert-&lt;instance&gt;/</code></li>
      <li><code>./stop-cert</code></li>
      <li><code>cd
&lt;server_root&gt;/cert-&lt;instance&gt;/config/</code></li>
      <li>edit
&lt;server_root&gt;/bin/cert-&lt;instance&gt;/config/server.xml:
        <ul>
          <li>In the SSLPARAMS element there is an
ssl2 attribute. Set this to "off".</li>
          <li>To also disable all of the ssl2
ciphers, replace "+" with "-" in the ssl2ciphers attribute
for all of the ciphers listed.</li>
        </ul>
      </li>
      <li><code>cd &lt;server_root&gt;/cert-&lt;instance&gt;/</code></li>
      <li><code>./start-cert<br>
        <br>
        </code></li>
    </ol>
    <div style="margin-left: 40px;">Here is an example:<br>
    </div>
    <br>
    <div style="margin-left: 40px;"><code>&lt;SSLPARAMS
servercertnickname="Server-Cert" ssl2="off" <span  style="text-decoration: underline;">ssl2ciphers="-rc4,-rc4export,-rc2,-rc2export,-des,-desede3"</span></code><br>
    <code>ssl3="on"
ssl3tlsciphers="+rsa_rc4_128_md5,+rsa_3des_sha,+rsa_des_sha,+rsa_rc4_40_md5,+rsa_rc2_40_md5,-rsa_null_md5"/&gt;<br>
    </code><br>
    <code></code></div>
  </li>
  <li>To disable SSL 2 in all <span style="text-decoration: underline;">future</span>
instances of CMS for the given
&lt;server_root&gt;: <br>
    <ol>
      <li><code>cd
&lt;server_root&gt;/bin/cert/templates/https/config/</code></li>
      <li>edit
&lt;server_root&gt;/bin/cert/templates/https/config/server.xml:
        <ul>
          <li>In the SSLPARAMS element there is an ssl2 attribute. Set
this to "off".</li>
          <li>To also disable all of the ssl2 ciphers, replace "+" with
"-" in the ssl2ciphers attribute for all of
the ciphers listed.</li>
        </ul>
      </li>
    </ol>
    <br>
    <div style="margin-left: 40px;">Here is an example:&nbsp; It
has been broken into multiple lines here to be more readable.<br>
    </div>
    <br>
    <div style="margin-left: 40px;"><code>&lt;SSLPARAMS
servercertnickname="Server-Cert" ssl2="off" <span  style="text-decoration: underline;">ssl2ciphers="-rc4,-rc4export,-rc2,-rc2export,-des,-desede3"</span></code><br>
    <code>ssl3="on"
ssl3tlsciphers="+rsa_rc4_128_md5,+rsa_3des_sha,+rsa_des_sha,+rsa_rc4_40_md5,+rsa_rc2_40_md5,-rsa_null_md5"/&gt;<br>
    </code><br>
    <code></code></div>
  </li>
</ul>
<hr style="width: 100%; height: 2px;">
<h2><a name="Admin"></a>Administration Servers for&nbsp; Directory
Server and CMS</h2>
<br>
To disable SSL 2 ciphers in Administration Servers
contained in Directory Server 4.x and CMS 4.x and all subsequent 4.x
patches/service packs, perform the following steps via the
Administration Console:<br>
<ol>
  <li>Launch a console and login</li>
  <li>From the primary Console tab, open the &lt;hostname&gt; by
clicking on the '+' sign immediately preceding it, and then open the
Server Group by clicking on the '+' sign immediately preceding it</li>
  <li>Highlight the Administration Server, and click on the Open button
on the right-hand side of the console</li>
  <li>From the Administration Console, select the Configuration tab</li>
  <li>On the right-hand side of the Configuration frame, select the
Encryption tab</li>
  <li>Presuming that SSL has been enabled, click on the Cipher
Preferences button.&nbsp; A dialog will be displayed containing all of
the ciphers; deselect all checkboxes under SSL 2.0 ciphers including:
    <ul>
      <li>RC4 with 40 bit encryption and MD5 message authentication</li>
      <li>RC2 with 40 bit encryption and MD5 message authentication</li>
      <li>RC4 with 128 bit encryption and MD5 message authentication</li>
      <li>RC2 with 128 bit encryption and MD5 message authentication</li>
      <li>DES with 56 bit encryption and MD5 message authentication</li>
      <li>Triple DES with 168 bit encryption and MD5 message
authentication</li>
    </ul>
  </li>
  <li>Deselect the main SSL 2.0 ciphers checkbox</li>
  <li>Click the OK button</li>
  <li>Click the Save button</li>
  <li>Close the Administration Console</li>
  <li>Close the primary Console</li>
  <li><code>cd &lt;server_root&gt;/</code></li>
  <li><code>./stop-admin</code></li>
  <li><code>./start-admin</code></li>
</ol>
To disable&nbsp; SSL 2 ciphers in Administration Servers
contained in Directory Server 6.x and CMS 6.x and all subsequent 6.x
patches/service packs, perform the following steps via the
Administration Console:<br>
<ol>
  <li>Launch a console and login</li>
  <li>From the primary Console tab, open the &lt;hostname&gt;
by clicking on the '+' sign immediately preceding it, and then
open the Server Group by clicking on the '+' sign immediately preceding
it</li>
  <li>Highlight the Administration Server, and click on the
Open button on the right-hand side of the console</li>
  <li>From the Administration Console, select the
Configuration tab</li>
  <li>On the right-hand side of the Configuration frame,
select the Encryption tab</li>
  <li>Presuming that SSL has been enabled, click on the
Settings button located after the Cipher: label</li>
  <li>A dialog entitled Cipher Preference will be displayed
containing all of the ciphers; select the SSL 2.0 tab</li>
  <li>Deselect all checkboxes under SSL 2.0 ciphers including:
    <ul>
      <li><code>DES&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
56&nbsp;&nbsp;&nbsp;&nbsp; MD5</code></li>
      <li><code>RC2 (Export)&nbsp;&nbsp;
40&nbsp;&nbsp;&nbsp;&nbsp; MD5</code></li>
      <li><code>RC4 (Export)&nbsp;&nbsp;
40&nbsp;&nbsp;&nbsp;&nbsp; MD5</code></li>
      <li><code>DES&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
168&nbsp;&nbsp;&nbsp; MD5</code></li>
      <li><code>RC4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
128&nbsp;&nbsp;&nbsp; MD5</code></li>
      <li><code>RC2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
128&nbsp;&nbsp;&nbsp; MD5</code></li>
    </ul>
  </li>
  <li>Click the OK button</li>
  <li>Click the Save button</li>
  <li>Close the Administration Console</li>
  <li>Close the primary Console</li>
  <li><code>cd &lt;server_root&gt;/</code></li>
  <li><code>./stop-admin</code></li>
  <li><code>./start-admin</code></li>
</ol>
To ensure that the Administration Server has disabled SSL 2.0, check
the following configuration file manually:<br>
<ol>
  <li><code>cd &lt;server_root&gt;/</code></li>
  <li><code>./stop-admin</code></li>
  <li><code>cd &lt;server_root&gt;/admin-serve/config/</code></li>
  <li>edit &lt;server_root&gt;/admin-serv/config/server.xml:
    <ul>
      <li>In the SSLPARAMS element there is an ssl2
attribute. Set this to "off".</li>
      <li>To also disable all of the ssl2 ciphers,
replace "+" with "-" in the ssl2ciphers attribute for all
of the SSl2 ciphers listed.</li>
    </ul>
  </li>
  <li><code>cd &lt;server_root&gt;/</code></li>
  <li><code>./start-admin</code></li>
</ol>
<div style="margin-left: 40px;">Here is an example.&nbsp; (It has been
broken into two lines here for
readability, but should be one line)<br>
</div>
<br>
<div style="margin-left: 40px;"><code>&lt;SSLPARAMS
servercertnickname="Server-Cert" ssl2="off"
<span style="text-decoration: underline;">ssl2ciphers="-rc4,-rc4export,-rc2,-rc2export,-des,-desede3"</span></code><br>
<code>ssl3="on"
ssl3tlsciphers="+rsa_rc4_128_md5,+rsa_3des_sha,+rsa_des_sha,+rsa_rc4_40_md5,+rsa_rc2_40_md5,-rsa_null_md5"/&gt;</code><br>
<code></code></div>
<br>
<hr style="width: 100%; height: 2px;"><br>
<br>



<hr class="hide">
</div>
</div>
<div id="footer">
<ul>
<li><a href="../sitemap.html">Site Map</a></li>
<li><a href="../security/">Security Updates</a></li>
<li><a href="../contact/">Contact Us</a></li>
<li><a href="../foundation/donate.html">Donate</a></li>
</ul>
<p class="copyright">
Portions of this content are &copy; 1998&#8211;2009 by individual mozilla.org
contributors; content available under a Creative Commons license | <a
href="http://www.mozilla.org/foundation/licensing/website-content.html">Details</a>.</p>
<p>
<span>Last modified September 20,  2004</span>
<span><a href="http://bonsai-www.mozilla.org/cvslog.cgi?file=mozilla-org/html/security/disable-ssl2-netscape.html&amp;rev=&amp;root=/www/">Document History</a></span>
</p>
</div>
</div>
</body>
</html>
