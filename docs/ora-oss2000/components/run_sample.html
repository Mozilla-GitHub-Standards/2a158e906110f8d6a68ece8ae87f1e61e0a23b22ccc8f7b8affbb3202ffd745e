<HTML>

<!-- Note: this file (and its associated style sheet) must be installed in your local chrome directory to function correctly. -->

  <HEAD>
    <TITLE>Using a Component</TITLE>
		<LINK REL=StyleSheet HREF="scc.css" TYPE="text/css">

<SCRIPT language="Javascript">
var myComponent = Components.classes['component://netscape/sample'].createInstance();
myComponent = myComponent.QueryInterface(Components.interfaces.nsISample);

function displayMyComponent()
  {
      // 
    var textNode = document.createTextNode(myComponent.value);
    var myDisplayNode = document.getElementById("myDisplayNode");

      // get rid of any extant children
    while ( myDisplayNode.hasChildNodes() )
      myDisplayNode.removeChild(myDisplayNode.firstChild);

      // plug in the new value
    myDisplayNode.appendChild(textNode);
    myDisplayNode.style.color = myComponent.value;
  }

function pokeMyComponent( valueToPokeIn )
  {
    myComponent.poke(valueToPokeIn);
    displayMyComponent();
  }
</SCRIPT>

  </HEAD>

  <BODY>
<H1>Using a Component</H1>
<PRE>
  <FONT color="gray">// Make an instance of our component as a script global...</FONT>
var <FONT color="blue">myComponent</FONT> =
  Components.classes['component://netscape/sample'].createInstance();

  <FONT color="gray">// ...and cast (QI) the interface we want to use</FONT>
<FONT color="blue">myComponent</FONT> =
  <FONT color="blue">myComponent</FONT>.QueryInterface(Components.interfaces.nsISample);
</PRE>

<P>
  Call a member function of myComponent:
</P>
<UL>
<FORM>
  <BUTTON onClick="pokeMyComponent('red');">
    <FONT color="blue">myComponent</FONT>.poke('<font color="red">red</font>')
  </BUTTON>
  <BR>
  <BUTTON onClick="pokeMyComponent('green');">
    <FONT color="blue">myComponent</FONT>.poke('<font color="green">green</font>')
  </BUTTON>
</FORM>
</UL>

<P>
  Examine an attribute of myComponent:
</P>
<UL>
<FONT color="blue">myComponent</FONT>.value ==
<SPAN id="myDisplayNode"></SPAN>
</UL>
  </BODY>
</HTML>
