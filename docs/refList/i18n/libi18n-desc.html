
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<link rel="top" title="Home" href="http://www.mozilla.org/">
<link rel="stylesheet" type="text/css" href="../../../css/print.css"  media="print">
<link rel="stylesheet" type="text/css" href="../../../css/base/content.css"  media="all">
<link rel="stylesheet" type="text/css" href="../../../css/cavendish/content.css" title="Cavendish" media="screen">
<link rel="stylesheet" type="text/css" href="../../../css/base/template.css"  media="screen">
<link rel="stylesheet" type="text/css" href="../../../css/cavendish/template.css" title="Cavendish" media="screen">
<link rel="icon" href="../../../images/mozilla-16.png" type="image/png">

   <META NAME="KeyWords" CONTENT="client, source, documentation, i18n, libi18n">
   <META NAME="Author" CONTENT="Bob Jung">
   <TITLE>libi18n Module Description</TITLE>
<script src="../../../__utm.js" type="text/javascript"></script>
</head>
<body id="www-mozilla-org" class="deepLevel">
<div id="container">
<p class="important">You are currently viewing a snapshot of www.mozilla.org taken on April 21, 2008. Most of this content is
highly out of date (some pages haven't been updated since the project began in 1998) and exists for historical purposes only.  If
there are any pages on this archive site that you think should be added back to www.mozilla.org, please <a
href="https://bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=www.mozilla.org">file a bug</a>.</p>
<p class="skipLink"><a href="#mainContent" accesskey="2">Skip to main content</a></p>
<div id="header">
<h1><a href="/" title="Return to home page" accesskey="1">Mozilla</a></h1>
<ul>
<li id="menu_aboutus"><a href="../../../about/" title="Getting the most out of your online experience">About</a></li>
<li id="menu_developers"><a href="../../../developer/" title="Using Mozilla's products for your own applications">Developers</a></li>
<li id="menu_store"><a href="http://store.mozilla.org/?r=mozorg1" title="Shop for Mozilla products on CD and other merchandise">Store</a></li>
<li id="menu_support"><a href="../../../support/" title="Installation, trouble-shooting, and the knowledge base">Support</a></li>
<li id="menu_products"><a href="../../../products/" title="All software Mozilla currently offers">Products</a></li>
</ul>
<form id="searchbox_002443141534113389537:ysdmevkkknw" action="http://www.google.com/cse" title="mozilla.org Search">
<div>
<label for="q" title="Search mozilla.org's sites">search mozilla:</label>
<input type="hidden" name="cx" value="002443141534113389537:ysdmevkkknw">
<input type="hidden" name="cof" value="FORID:0">
<input type="text" id="q" name="q" accesskey="s" size="30">
<input type="submit" id="submit" value="Go">
</div>
</form>
</div>
<hr class="hide">
<div id="mBody">
<div id="side">

<ul id="nav">
<li><a title="Roadmap" href="../../../roadmap.html"><strong> Roadmap</strong></a></li>
<li><a title="Projects" href="../../../projects/"><strong> Projects</strong></a></li>
<li><a title="For developers" href="../../../developer/"><strong> Coding</strong></a>
<ul>
<li><a title="Module Owners" href="../../../owners.html"> Module Owners</a></li>
<li><a title="Hacking" href="../../../hacking/"> Hacking</a></li>
<li><a title="Get the Source" href="http://developer.mozilla.org/en/docs/Download_Mozilla_Source_Code"> Get the Source</a></li>
<li><a title="Building Mozilla" href="http://developer.mozilla.org/en/docs/Build_Documentation"> Build It</a></li>
</ul>
</li>
<li><a title="Testing" href="../../../quality/"><strong> Testing</strong></a>
<ul>
<li><a title="Downloads of mozilla.org software releases" href="../../../download.html"> Releases</a></li>
<li><a title="Latest mozilla builds for testers" href="../../../developer/#builds"> Nightly Builds</a></li>
<li><a title="For testers to report bugs" href="https://bugzilla.mozilla.org/"> Report A Problem</a></li>
</ul>
</li>
<li><a title="Tools for mozilla developers" href="../../../tools.html"><strong> Tools</strong></a>
<ul>
<li><a title="Bug tracking system for mozilla testers." href="https://bugzilla.mozilla.org/"> Bugzilla</a></li>
<li><a title="Latest status of mozilla builds" href="http://tinderbox.mozilla.org/showbuilds.cgi?tree=Firefox"> Tinderbox</a></li>
<li><a title="Latest checkins" href="http://bonsai.mozilla.org/cvsqueryform.cgi"> Bonsai</a></li>
<li><a title="Source cross reference" href="http://lxr.mozilla.org/seamonkey/"> LXR</a></li>
</ul>
</li>
<li><a title="Frequently Asked Questions." href="../../../faq.html"><strong> FAQs</strong></a></li>
</ul>

</div>
<hr class="hide">
<div id="mainContent">




<H2 ALIGN=CENTER>libi18n Module Description</H2>

<CENTER>
Discussion: <A HREF="news://news.mozilla.org/netscape.public.mozilla.i18n">netscape.public.mozilla.i18n</A> or
<A HREF="mailto:mozilla-i18n@mozilla.org">mozilla-i18n@mozilla.org</A>
<BR><I>Last Update: March 31,1998</I>
<BR>
Contact: Bob Jung &lt;<A HREF="mailto:bobj@netscape.com">bobj@netscape.com</A>&gt;
<H3></CENTER>
Contents</H3>


<UL>
<LI>
<A HREF="#Introduction">Introduction</A></LI>

<LI>
<A HREF="#History">History</A></LI>

<LI>
<A HREF="#HowItWorks">How It Works</A></LI>

<LI>
<A HREF="#WhereItsHeaded">Where It's Headed</A></LI>

<LI>
<A HREF="#KnownIssues">Known Issues</A></LI>

<LI>
<A HREF="#SeeAlso">See Also</A></LI>
</UL>

<H3>
<HR WIDTH="100%"><A NAME="Introduction"></A>Introduction</H3>

The Mozilla family (Navigator and Communicator) is globally enabled.
Globally enabled software shares common source code from which we build
a single binary executable (per platform) that supports a wide variety
of languages.  The initial Mozilla source release supports Western,
Central European, Chinese, Japanese, Korean, Greek, Turkish and Cyrillic
languages. (For an overview of Mozilla Internationalization (I18N) and
Localization (L10N), check out the <A HREF="./">Mozilla Internationalization
&amp; Localization Guidelines</A>.)

<P>Libi18n provides the <I>underlying</I> internationalization utility
functions used in Mozilla to support international Web browsing and Internet
Mail/News functionality.  The emphasis is on <I>underlying</I> because
there is a lot of other code that must be written in order to internationalize
features.

<P>Mozilla programmers should call the libi18n APIs wherever possible,
but should also expect to write module and feature specific I18N aware
code.  Check out the other Mozilla modules to see how this has been
done.  In addition to calling libi18n, significant amount of programming
has been required to internationalize <!-- LINK THIS STUFF TO THE DOC ON LAYOUT -->the
HTML layout engine<!-- -->, <!-- LINK THIS STUFF TO THE DOCS ON THE FES -->the
front end (UI and text rendering) code<!-- -->, and mail/news.

<P>This document only provides an overview of the libi18n module.
For information on general I18N issues and the I18N of other Mozilla modules
see <A HREF="i18n-guidelines.html">I18N Guidelines</A>.

<P>The functions that libi18n provides to other Mozilla modules include:
<BLOCKQUOTE>
<LI>
Character Code Conversion</LI>

<LI>
Finding Character Boundaries</LI>

<LI>
Handling I18N related HTTP Headers</LI>

<LI>
Line/Word Breaking (for text layout support)</LI>

<LI>
Locale Sensitive Operations (collation, date/time formatting)</LI>

<LI>
Mail/News Header Processing</LI>

<LI>
Platform Independent String Resources</LI>

<LI>
String Comparison</LI>

<LI>
Unicode String Functions</LI>
</BLOCKQUOTE>
The corresponding libi18n public API specifications are documented in the
<A HREF="libi18n/">International Library Reference</A>.
<H3>
<HR WIDTH="100%"><A NAME="History"></A>History</H3>

With a very small I18N team and tight product release schedules, our strategy
over the past 3 years has been to incrementally add features -- prioritized
by Netscape's international market needs.

<P>Our initial work for Netscape Navigator (NN) 1.1 focused on adding Japanese
Web browsing capability.  We invented the notion of a document character
set and a window (or font encoding) character set and provided a stream
module to convert incoming text documents from the document charset to
the window charset.  This streams module and various Japanese charset
converters were the first libi18n functions. After the first Beta, we added
the ability in libi18n to auto-detect between the 3 common Japanese charset
encodings: Shift_JIS, JIS and EUC-JP.

<P>NN1.1 was a significant advancement for Japanese Web browsing and was
well received.  However, all of its UI was still in English.
In order to localize NN, we created a special "i-build" (NN1.1i) because
NN1.1 was full of hard-coded strings and other localization unfriendly
coding practices.  We added libi18n APIs to make it easier to resource
user visible strings.  NN1.1i was then localized into Japanese, German
and French -- Netscape's first localized releases!  The localizability
infrastructure created for NN1.1i was then merged back into the mainstream
source code for NN2.x and later releases.

<P>NN2.x extended our charset support beyond Western and Japanese.
Our NN1.1 stream module and charset converter architecture were designed
to be extensible (not Japanese centric) which made it straightforward to
add Chinese, Korean and Central European charset encodings support in the
NN2.0 libi18n.

<P>Other NN2.x libi18n additions included:
<UL>
<LI>
Enhancing the charset concept to be on a per window/context base instead
of globally affecting all windows/contexts</LI>

<LI>
RFC1522 support to handle MIME headers.  (Really these functions should
migrate from libi18n to the libmime library.)</LI>

<LI>
XP locale support (e.g., sorting, time &amp; date)</LI>

<LI>
HTTP Accept-Language header support</LI>
</UL>
NN3.x libi18n added:
<UL>
<LI>
Additional charset converters for Cyrillic, Greek and Turkish</LI>

<LI>
Enhanced line wrapping for Asian languages (kinsoku shori)</LI>
</UL>
NN4.x libi18n added:
<UL>
<LI>
Unicode 2.0 converters</LI>

<LI>
Korean charset auto-detection</LI>

<LI>
HTTP Accept-Charset header support</LI>
</UL>
The overall (not just libi18n) evolution of the Netscape client I18N and
L10N support is highlighted by a table of the <A HREF="i18n-history.html">Netscape
I18N/L10N Client History</A>.
<H3>
<HR WIDTH="100%"><A NAME="HowItWorks"></A>How
It Works</H3>

Libi18n is a collection of fundamental internationalization functions.
So it is difficult to write <I>How It Works</I> because there really are
several "it"s.  In this document, we mention a few of the bigger "it"s
and include links to others.
<H4>Document Charset Conversion</H4>

One of the most important functions provided by libi18n is character set
conversion of the incoming text data.  As each block of text data
is received from the net (or cache), the libi18n stream module heuristically
determines (to the best of its ability) the character set encoding of the
incoming document, then it converts the data block from the "document"
character encoding to the "window" character encoding (usually equivalent
to the font encoding) before passing the data downstream to the HTML parser
and layout engine.

<P>Currently the HTML parser and layout engine assumes HTML special characters
(e.g., '&lt;', '>')  in text data passed downstream to them are encoded
as ASCII values.  Therefore ISO-2022-xx  and other 7-bit encodings
such as UTF-7 and HZ are converted to an ASCII "superset" encoding, and
UCS-2 is converted to UTF-8 by the libi18n conversion module before being
sent downstream to the HTML parser.

<P>The character set converters called by the libi18n stream module must
maintain state because (1) the text data may be stateful or contain multibyte
characters and (2) state is needed in some cases in which libi18n auto-selects
from a few character encodings (e.g., between the 3 common Japanese encodings).

<P>The actual character set conversion functions can be categorized in
three types:
<OL>
<LI>
Algorithmic conversions for Chinese, Japanese and Korean (e.g., Shift_JIS
&lt;-> EUC-JP)</LI>

<LI>
Table driven for 1-byte to 1-byte encodings (e.g., CP1250 &lt;-> ISO8859-2)</LI>

<LI>
Table driven for Unicode conversions</LI>
</OL>
The document character set encodings currently supported by Communicator
are listed in the Netscape <A HREF="http://home.netscape.com/eng/intl/moretips.html#encode1">More
Tips and Technical Information for International Users</A>.

<P>See the documentation on the Mozilla network library in the <A HREF="http://www.mozilla.org/docs/index.html">mozilla.org
list of technical papers</A> for more information on the Mozilla streams
architecture.
<H4>Managing Charset Encodings</H4>

In addition, to doing the initial charset conversion of the text document
data, Mozilla needs to track and manage the charset information, so that
any text input, display or manipulation is performed correctly.  The
charset has significant effect on <!-- LINK THIS STUFF TO THE DOC ON LAYOUT -->layout
and editing<!-- --> including the behavior of line wrapping, selection,
copy and paste.  The behavior of the <!-- LINK THIS STUFF TO THE DOCS ON THE FES -->front
ends (MacFE, WinFE and XFE)<!-- --> is also greatly affected by the charset
information (e.g., how they measure and draw).

<P>There are several types of Mozilla contexts (e.g., Web browsing, HTML
composing, mail reading, mail composing) that need to track and use the
charset information. Libi18n provides the APIs to manage the getting and
setting for information in the charset object.<!-- LINK THIS STUFF TO THE DOC ON THE CSIDS-->
<H4>XP Locale Functions</H4>

The Cross Platform (XP) locale functions provide platform independent APIs
for string collation and date/time formatting.  Because these are
wrappers to the existing locale functions provided by the operating system
the behavior may not be totally consistent across platforms.
<H4>Other libi18n Functions</H4>

There's more functionality provided by libi18n, but this document is intended
to provide a brief overview.  For more info on how to write code using
the libi18n functions see the description of the libi18n public APIs, <A HREF="libi18n/">International
Library Reference</A>.
<H3>
<HR WIDTH="100%"><A NAME="WhereItsHeaded"></A>Where
It's Headed</H3>


<DL>
<DT>
Modularity</DT>

<DD>
The most important next step for the libi18n module is to modularize.
Currently the interfaces are not cleanly separated from the rest of the
client.  This is the highest priority because when we achieve modularity
it will make further development easier and faster.</DD>

<DT>
Extensibility</DT>

<DD>
The second most important step is to make underlying support (e.g., encoding
conversions) easily extensible without modifying the library itself.
Adding a new simple language or character encoding should be simply a matter
of  dropping in a new binary module.</DD>

<DT>
Resource Handling</DT>

<DD>
The localizable resources need to be modularized.  Each component/module
should maintain its own set of localized resources rather than the one
pot (e.g., <!-- LINK THIS STUFF TO THE DOC ON LAYOUT -->allxpstr.h<!-- -->)
of resources for all modules.  This should go hand-in-hand with the
general Mozilla push towards modularization.</DD>

<BR>More utility functionality
<UL>
<LI>
More flexible and powerful message formatting</LI>

<LI>
Enhancements to current string and character processing</LI>

<UL>
<LI>
String creation/destruction</LI>

<LI>
String functions (extract, replace, concatenate...)</LI>

<LI>
Character attributes</LI>
</UL>

<LI>
Platform Independent Locale management</LI>

<LI>
Platform Independent Collation</LI>

<LI>
Enhanced code set detection</LI>

<LI>
Date/Time/Number formatting</LI>

<LI>
Text boundary detection</LI>

<UL>
<LI>
Word, Sentence, Line</LI>
</UL>
</UL>
Please contact us at <A HREF="news://news.mozilla.org/netscape.public.mozilla.i18n">netscape.public.mozilla.i18n</A>
and let us know if you would like to help work on enhancments to libi18n.</DL>

<H3>
<HR WIDTH="100%"><A NAME="KnownIssues"></A>Known
Issues</H3>


<UL>
<LI>
Extending Charsets will become easier:</LI>

<BR>We have been working on making it easier to add additional charset
support, but could not complete this in time for the initial Mozilla source
release on 3/31/98.   Now that the source clean-up is complete,
we will resume working on this.
<LI>
Traditional Chinese charset encoding converters (Big5 to/from CNS 11643)
are missing:</LI>

<BR>In the process of cleaning up the Mozilla sources by 3/31/98 to then
net, we had to remove this code because it was not freely distributable.
This will be fixed soon by implementing an NPL version of this functionality.
If anyone on the net wants to help us, please let us know!</UL>

<H3>
<HR WIDTH="100%"><A NAME="SeeAlso"></A>See
Also</H3>


<UL>
<LI>
<A HREF="libi18n/">International Library Reference</A> describes
libi18n public APIs in more detail</LI>

<LI>
<A HREF="./">Mozilla Internationalization &amp; Localization Guidelines</A>
provides overview and definitions of Mozilla internationalization and localization</LI>

<LI>
<A HREF="i18n-guidelines.html">I18N Guidelines</A> provides programming
guidelines on how to keep Mozilla internationalized</LI>

<LI>
<A HREF="l12yGuidelines.html">Mozilla Localizability Guidelines</A> provides
programming guidelines on how to ensure it stays easy to create localized
versions Mozilla</LI>

<LI>
<A HREF="i18n-history.html">Netscape I18N/L10N Client History</A> outlines
the  the I18N and L10N evolution of the Netscape clients</LI>

<LI>
<A HREF="http://home.netscape.com/eng/intl/">International Users</A>
provides information and tips on using international features of the Netscape
clients</LI>

<LI>
mozilla.org <A HREF="http://www.mozilla.org/docs/index.html">documentation:
browse the technical papers</A> for various technical documents on Mozilla
source code</LI>
</UL>

<HR WIDTH="100%">
<CENTER> Copyright &copy; 1998 <A HREF="http://home.netscape.com/misc/contact_info.html">Netscape
Communications Corporation</A></CENTER>




<hr class="hide">
</div>
</div>
<div id="footer">
<ul>
<li><a href="../../../sitemap.html">Site Map</a></li>
<li><a href="../../../security/">Security Updates</a></li>
<li><a href="../../../contact/">Contact Us</a></li>
<li><a href="../../../foundation/donate.html">Donate</a></li>
</ul>
<p class="copyright">
Portions of this content are &copy; 1998&#8211;2009 by individual mozilla.org
contributors; content available under a Creative Commons license | <a
href="http://www.mozilla.org/foundation/licensing/website-content.html">Details</a>.</p>
<p>
<span>Last modified October  1,  1999</span>
<span><a href="http://bonsai-www.mozilla.org/cvslog.cgi?file=mozilla-org/html/docs/refList/i18n/libi18n-desc.html&amp;rev=&amp;root=/www/">Document History</a></span>
</p>
</div>
</div>
</body>
</html>
