<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
<link rel="top" title="Home" href="http://www.mozilla.org/">
<link rel="stylesheet" type="text/css" href="../../../css/print.css"  media="print">
<link rel="stylesheet" type="text/css" href="../../../css/base/content.css"  media="all">
<link rel="stylesheet" type="text/css" href="../../../css/cavendish/content.css" title="Cavendish" media="screen">
<link rel="stylesheet" type="text/css" href="../../../css/base/template.css"  media="screen">
<link rel="stylesheet" type="text/css" href="../../../css/cavendish/template.css" title="Cavendish" media="screen">
<link rel="icon" href="../../../images/mozilla-16.png" type="image/png">

   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="Author" content="David Epstein">
   <meta name="GENERATOR" content="Mozilla/4.77 [en]C-AOLNSCP  (WinNT; U) [Netscape]">
   <title>nsISHistory</title>
<script src="../../../__utm.js" type="text/javascript"></script>
</head>
<body id="www-mozilla-org" class="deepLevel">
<div id="container">
<p class="important">You are currently viewing a snapshot of www.mozilla.org taken on April 21, 2008. Most of this content is
highly out of date (some pages haven't been updated since the project began in 1998) and exists for historical purposes only.  If
there are any pages on this archive site that you think should be added back to www.mozilla.org, please <a
href="https://bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=www.mozilla.org">file a bug</a>.</p>
<p class="skipLink"><a href="#mainContent" accesskey="2">Skip to main content</a></p>
<div id="header">
<h1><a href="/" title="Return to home page" accesskey="1">Mozilla</a></h1>
<ul>
<li id="menu_aboutus"><a href="../../../about/" title="Getting the most out of your online experience">About</a></li>
<li id="menu_developers"><a href="../../../developer/" title="Using Mozilla's products for your own applications">Developers</a></li>
<li id="menu_store"><a href="http://store.mozilla.org/?r=mozorg1" title="Shop for Mozilla products on CD and other merchandise">Store</a></li>
<li id="menu_support"><a href="../../../support/" title="Installation, trouble-shooting, and the knowledge base">Support</a></li>
<li id="menu_products"><a href="../../../products/" title="All software Mozilla currently offers">Products</a></li>
</ul>
<form id="searchbox_002443141534113389537:ysdmevkkknw" action="http://www.google.com/cse" title="mozilla.org Search">
<div>
<label for="q" title="Search mozilla.org's sites">search mozilla:</label>
<input type="hidden" name="cx" value="002443141534113389537:ysdmevkkknw">
<input type="hidden" name="cof" value="FORID:0">
<input type="text" id="q" name="q" accesskey="s" size="30">
<input type="submit" id="submit" value="Go">
</div>
</form>
</div>
<hr class="hide">
<div id="mBody">
<div id="side">

<ul id="nav">
<li><a title="Roadmap" href="../../../roadmap.html"><strong> Roadmap</strong></a></li>
<li><a title="Projects" href="../../../projects/"><strong> Projects</strong></a></li>
<li><a title="For developers" href="../../../developer/"><strong> Coding</strong></a>
<ul>
<li><a title="Module Owners" href="../../../owners.html"> Module Owners</a></li>
<li><a title="Hacking" href="../../../hacking/"> Hacking</a></li>
<li><a title="Get the Source" href="http://developer.mozilla.org/en/docs/Download_Mozilla_Source_Code"> Get the Source</a></li>
<li><a title="Building Mozilla" href="http://developer.mozilla.org/en/docs/Build_Documentation"> Build It</a></li>
</ul>
</li>
<li><a title="Testing" href="../../../quality/"><strong> Testing</strong></a>
<ul>
<li><a title="Downloads of mozilla.org software releases" href="../../../download.html"> Releases</a></li>
<li><a title="Latest mozilla builds for testers" href="../../../developer/#builds"> Nightly Builds</a></li>
<li><a title="For testers to report bugs" href="https://bugzilla.mozilla.org/"> Report A Problem</a></li>
</ul>
</li>
<li><a title="Tools for mozilla developers" href="../../../tools.html"><strong> Tools</strong></a>
<ul>
<li><a title="Bug tracking system for mozilla testers." href="https://bugzilla.mozilla.org/"> Bugzilla</a></li>
<li><a title="Latest status of mozilla builds" href="http://tinderbox.mozilla.org/showbuilds.cgi?tree=Firefox"> Tinderbox</a></li>
<li><a title="Latest checkins" href="http://bonsai.mozilla.org/cvsqueryform.cgi"> Bonsai</a></li>
<li><a title="Source cross reference" href="http://lxr.mozilla.org/seamonkey/"> LXR</a></li>
</ul>
</li>
<li><a title="Frequently Asked Questions." href="../../../faq.html"><strong> FAQs</strong></a></li>
</ul>

</div>
<hr class="hide">
<div id="mainContent">





<table align="center" width="95%">
<tr>
<td>

<p align="center"><a NAME="Test Plan for nsISHistory"></a><b><font size=+1>Test Plan for nsISHistory & nsIHistoryEntry interfaces</font></b></p>

<br>
<p>The nsISHistory interface has methods to access and update the session history. In order to test the Session History interface, you need to have nsIProfile support in your test driver. See <a href="http://lxr.mozilla.org/seamonkey/source/xpfe/components/shistory/public/nsISHistory.idl">nsISHistory.idl</a> for more information. This test plan will also include the three attribute methods of nsIHistoryEntry interface. See <a href="http://lxr.mozilla.org/seamonkey/source/xpfe/components/shistory/public/nsIHistoryEntry.idl">nsIHistoryEntry.idl</a> for more information. </p>

<p>To access the nsISHistory object, use nsIWebNavigation's sessionHistory attribute. See <a href="http://lxr.mozilla.org/seamonkey/source/docshell/base/nsIWebNavigation.idl"> nsIWebNavigation.idl<a> for more info:</p>
<p>
<pre>
   nsCOMPtr<nsISHistory> theSHistory; //

   // get Session History through web nav iface
   if (qaWebNav)
      qaWebNav->GetSessionHistory(getter_AddRefs(theSHistory));
</pre>
</p>

<p>Now you can call the attributes & methods using the session history object.</p>
<p>To see the test cases click on the desired attributes & methods below.</p>

<p>&nbsp;&nbsp;&nbsp; <i>methods:</i>
<br>&nbsp;&nbsp;&nbsp;<a href="#count"> count attribute</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#index"> index attribute</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#maxLength"> maxLength attribute</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#getEntryAtIndex()"> getEntryAtIndex()</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#SHistoryEnumerator"> SHistoryEnumerator attribute</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#PurgeHistory()"> PurgeHistory()</a>
<br>&nbsp;</p>


<p><a NAME="count"></a><b> count attribute:</b></p>
<p><i>Introduction</i>:
<br>This attribute is used to obtain the number of entries in the history list. It is a readonly attribute. The GetCount() method accepts the integer count parameter: </p>

<p><i>How to use:</i></p>
<pre>
   // use session history object from above (theSHistory)
   PRInt32 *numEntries;
   nsresult rv;

   rv = theSHistory->GetCount(&numEntries);

   // check rv and numEntries values using local methods
</pre>
</p>

<p><i>Note:</i> Call LoadURI() before obtaining the entry count. Here's an example of how its called:</p>
<p>
<pre>
   qaWebNav->LoadURI(NS_ConvertASCIItoUCS2(theUrl).GetUnicode(), 
		     nsIWebNavigation::LOAD_FLAGS_NONE);
</pre>
</p>
<center><table BORDER COLS=5 WIDTH="90%" >
<tr>
<td WIDTH="10%" HEIGHT="100%"><b>Case</b></td>

<td><b>Steps</b></td>

<td><b>Expected Results</b></td>

<td WIDTH="10%"><b>Pass/Fail</b></td>

<td><b>Comments</b></td>
</tr>

<tr>
<td WIDTH="10%" HEIGHT="100%">1</td>

<td>Enter at least one url in your browser. Call GetCount().</td>

<td>The count should return a positive value (number of entries in the history list).</td>

<td>pass</td>

<td>Testing default impl of GetCount()</td>
</tr>

<tr>
<td WIDTH="10%">2</td>

<td>Load a url with bypass history flag. Call GetCount().</td>

<td>The count should not increment.</td>

<td>fail</td>

<td>See nsIWebNavigation::LoadURI(). Use LOAD_FLAGS_BYPASS_HISTORY in LoadURI().</td>
</tr>

<tr>
<td>3</td>

<td>Load a url with bypass history flag. Call GetCount().</td>

<td>The count should not increment.</td>

<td>pass</td>

<td>See nsIWebNavigation::LoadURI(). Use LOAD_FLAGS_REPLACE_HISTORY in LoadURI().</td>
</tr>
</table></center>

<p><a href="#Test Plan for nsISHistory">Back To Top</a> </p>


<p><a NAME="index"></a><b>index attribute:</b></p>
<p><i>Introduction:</i>
<br>This attribute is used to obtain the value of the current history list entry. It's a readonly attribute. The GetIndex() method accepts the integer index parameter:   </p>
<p><i>How to use:</i></p>
<pre>
   // use session history object from above (theSHistory)
   PRInt32 *theIndex;

   rv = theSHistory->GetIndex(&theIndex);

   // check rv and theIndex values using local methods
</pre>
</p>

<p><i>Note:</i>Again, call LoadURI() before obtaining the entry index:
</p>


<center><table BORDER COLS=5 WIDTH="90%" >
<tr>
<td WIDTH="10%" HEIGHT="100%"><b>Case</b></td>

<td><b>Steps</b></td>

<td><b>Expected Results</b></td>

<td WIDTH="10%"><b>Pass/Fail</b></td>

<td><b>Comments</b></td>
</tr>

<tr>
<td WIDTH="10%" HEIGHT="100%">1</td>

<td>Enter two urls in your browser. Call GetIndex().</td>

<td>The returned index value should correspond to the current loaded url (document); in this case, index = 2.</td>

<td>pass</td>

<td>Using the default impl of GetIndex().</td>
</tr>

<tr>
<td WIDTH="10%">2</td>

<td>Load a url with bypass history flag. Call GetIndex().</td>

<td>The index value should not increment.</td>

<td>fail</td>

<td>See nsIWebNavigation::LoadURI(). Use LOAD_FLAGS_BYPASS_HISTORY in LoadURI().</td>
</tr>

<tr>
<td>3</td>

<td>Load a url with replace history flag. Call GetIndex().</td>

<td>The index value should not increment.</td>

<td>pass</td>

<td>See nsIWebNavigation::LoadURI(). Use LOAD_FLAGS_REPLACE_HISTORY in LoadURI().</td>
</tr>
</table></center>

<p> <a href="#Test Plan for nsISHistory">Back To Top</a> </p>


<p><a NAME="maxLength"></a><b>maxLength attribute:</b></p>
<p><i>Introduction:</i></p>
<br>This attribute is used to obtain the maximum number of session history entries per window. The GetMaxLength() and SetMaxLength() methods accepts the integer maxLength parameter:   </p>

<p><i>How to use:</i></p>
<pre>
   // use session history object from above (theSHistory)
   PRInt32 theMaxLength = 3;

   rv = theSHistory->SetMaxLength(theMaxLength);
   // check rv using local method
   rv = theSHistory->GetMaxLength(theMaxLength);
   // check rv and theIndex values using local methods
</pre>
</p>

<center><table BORDER COLS=5 WIDTH="90%" >
<tr>
<td WIDTH="10%" HEIGHT="100%"><b>Case</b></td>

<td><b>Steps</b></td>

<td><b>Expected Results</b></td>

<td WIDTH="10%"><b>Pass/Fail</b></td>

<td><b>Comments</b></td>
</tr>

<tr>
<td WIDTH="10%" HEIGHT="100%">1</td>

<td>Call SetMaxLength() & GetMaxLength().</td>

<td>The returned maxLength value should equal the amount passed to SetMaxLength().</td>

<td>pass</td>

<td>Using the default impl of SetMaxLength() & GetMaxLength().</td>
</tr>

<tr>
<td WIDTH="10%">2</td>

<td>Enter a new maxLength value (e.g. 4) and pass to SetMaxLength(). Then call GetMaxLength().</td>

<td>The returned maxLength should equal the new amount (4).</td>

<td>pass</td>

<td>Using the default impl of SetMaxLength() & GetMaxLength().</td>
</tr>

<tr>
<td>3</td>

<td>Load more urls (5) that allowed by the maxLength. Call GetIndex().</td>

<td>The index should correspond to last allowed url (the 4th one).</td>

<td>?</td>

<td>Using the default impl of SetMaxLength() & GetMaxLength().</td>
</tr>
</table></center>

<p> <a href="#Test Plan for nsISHistory">Back To Top</a> </p>


<p><a NAME="getEntryAtIndex()"></a><b> getEntryAtIndex():</b></p>
<p><i>Introduction</i>:
<br>This method obtains a history entry object for a given index in the history list. It accepts 3 parameters: the index, a boolean modifier, and the history entry object to be returned. </p>

<p><i>How to use:</i></p>
<pre>
   // use session history object from above (theSHistory)
   nsCOMPtr<nsIHistoryEntry> theHistEntry;
   PRInt32 theIndex = 2;

   // get the 2nd entry
   rv = theSHistory->GetEntryAtIndex(theIndex, PR_FALSE, getter_AddRefs(theHistEntry));
   // check rv and numEntries values using local methods
</pre>
</p>

<p><i>Notes:</i>For these tests, run GetCount() and GetIndex() to get respective returned values. Then, put GetEntryAtIndex() in a for loop to obtain each entry in the history list. Within this context, we'll test out the 3 attribute methods of nsIHistoryEntry (GetURI(), GetTitle(), and GetIsSubFrame()):
</p>
<p>Here's how to obtain the url, title, and subFrame value for a given index:<br>
<pre>
   char *uriSpec;	// to store the url
   nsXPIDLString theTitle;  
   const char *  titleCString; // to store the title
   PRBool isSubFrame;		// to store the subFrame value
   nsCOMPtr<nsIURI> theUri;

   theHistEntry->GetURI(getter_AddRefs(theUri));
   theUri->GetSpec(&uriSpec);

   theHistoryEntry->GetTitle(getter_Copies(theTitle));
   titleCString = NS_ConvertUCS2toUTF8(theTitle).get();

   theHistoryEntry->GetIsSubFrame(&isSubFrame)
</pre>
</p>

<center><table BORDER COLS=5 WIDTH="90%" >
<tr>
<td WIDTH="10%" HEIGHT="100%"><b>Case</b></td>

<td><b>Steps</b></td>

<td><b>Expected Results</b></td>

<td WIDTH="10%"><b>Pass/Fail</b></td>

<td><b>Comments</b></td>
</tr>

<tr>
<td WIDTH="10%" HEIGHT="100%">1</td>

<td>Enter a few urls in your browser. Then, in the for loop, pass the index values into GetEntryAtIndex().</td>

<td>The history entry object should exist. Each entry should be accessible.</td>

<td>pass</td>

<td>Testing default impl of GetEntryAtIndex().</td>
</tr>

<tr>
<td WIDTH="10%">2</td>

<td>For each entry in the history list, get the URL.</td>

<td>Verify that you obtain the url for each entry.</td>

<td>pass</td>

<td>See example above, how to get a url (uriSpec).</td>
</tr>

<tr>
<td>3</td>

<td>For each entry in the history list, get the title (i.e. "Netscape").</td>

<td>Verify that you obtain the title for each entry.</td>

<td>pass</td>

<td>See example above, how to get a title (theTitleString).</td>
</tr>

<tr>
<td>4</td>

<td>For each entry in the history list, get the subFrame value (indicating if you've clicked on a link that opens a separate window, without changing the url).</td>

<td>Verify that you obtain the subFrame value for each entry.</td>

<td>pass</td>

<td>See example above, how to get a subFrame (isSubFrame).</td>
</tr>

<tr>
<td>5</td>

<td>Enter another url using bypass history flag.</td>

<td>Verify that the url and title are not updated (the current entry should be the *last* url obtained).</td>

<td>fail</td>

<td>See bypass history examples in GetCount() and GetIndex().</td>
</tr>

<tr>
<td>6</td>

<td>Enter another url using replace history flag.</td>

<td>Verify that the current url and title are updated replace the most recent url & title in the history list.</td>

<td>pass</td>

<td>See replace history examples in GetCount() and GetIndex().</td>
</tr>


</table></center>

<p><a href="#Test Plan for nsISHistory">Back To Top</a> </p>


<p><a NAME="SHistoryEnumerator"></a><b> SHistoryEnumerator attribute:</b></p>
<p><i>Introduction</i>:
<br>This attribute is used to obtain the enumerated entries in the history list. It references the nsISimpleEnumerator object to use 2 methods: HasMoreElements(), which accepts a boolean indicator, and GetNext(), which accepts a nsISupports object.</p>

<p><i>How to use:</i></p>
<pre>
   // use session history object from above (theSHistory)
  PRBool bMore = PR_FALSE;
  nsCOMPtr<nsISupports> nextObj;
  nsCOMPtr<nsIHistoryEntry> nextHistoryEntry;
  nsCOMPtr<nsISimpleEnumerator> theSimpleEnum;

  while (NS_SUCCEEDED(theSimpleEnum->HasMoreElements(&bMore)) && bMore)
  {
     theSimpleEnum->GetNext(getter_AddRefs(nextObj));
     if (!nextObj)
	continue;
     nextHistoryEntry = do_QueryInterface(nextObj);
     if (!nextHistoryEntry)
	continue;
     rv = nextHistoryEntry->GetURI(getter_AddRefs(theUri));
     rv = theUri->GetSpec(&uriSpec);	 
  } 
</pre>
</p>

<center><table BORDER COLS=5 WIDTH="90%" >
<tr>
<td WIDTH="10%" HEIGHT="100%"><b>Case</b></td>

<td><b>Steps</b></td>

<td><b>Expected Results</b></td>

<td WIDTH="10%"><b>Pass/Fail</b></td>

<td><b>Comments</b></td>
</tr>

<tr>
<td WIDTH="10%" HEIGHT="100%">1</td>

<td>Enter a few urls in your browser. Call simple enumerator methods.</td>

<td>The SHistoryEnumerator attribute should reference simple enumerator methods. </td>

<td>fail</td>

<td></td>
</tr>

<tr>
<td WIDTH="10%">2</td>

<td>Obtain a url for each enumerated value (see above).</td>

<td>Verify that the url is returned.</td>

<td>fail</td>

<td></td>
</tr>

</table></center>

<p><a href="#Test Plan for nsISHistory">Back To Top</a> </p>


<p><a NAME="PurgeHistory()"></a><b>PurgeHistory():</b></p>
<p><i>Introduction</i>:
<br>This method is used to remove entries in the history list. It accepts one parameter: number of entries to remove. It will remove the most recent entries in the list.</p>

<p><i>How to use:</i></p>
<pre>
   // use session history object from above (theSHistory)
    theSHistory->PurgeHistory(ory
</pre>
</p>

<center><table BORDER COLS=5 WIDTH="90%" >
<tr>
<td WIDTH="10%" HEIGHT="100%"><b>Case</b></td>

<td><b>Steps</b></td>

<td><b>Expected Results</b></td>

<td WIDTH="10%"><b>Pass/Fail</b></td>

<td><b>Comments</b></td>
</tr>

<tr>
<td WIDTH="10%" HEIGHT="100%">1</td>

<td>Enter a few urls in your browser. Purge all the entries.</td>

<td>Verify that there are no entries in the session history. (The forward & back buttons in your browser app should be disabled. Also, you shouldn't be able to reference any index; verify with GetEntryAtIndex()). </td>

<td>pass</td>

<td></td>
</tr>

<tr>
<td WIDTH="10%">2</td>

<td>Enter a few urls in your browser. Purge a few of the entries.</td>

<td>Verify that the last few entries were removed from the history list. The remaining urls should be in the list (verify this with GetEntryAtIndex()).</td>

<td>pass</td>

<td></td>
</tr>

<tr>
<td WIDTH="10%">2</td>

<td>Enter a few urls in your browser. Purge none of the entries.</td>

<td>Verify that no entries were removed from the history list. All urls should be in the list (verify this with GetEntryAtIndex()).</td>

<td>?</td>

<td></td>
</tr>

</table></center>

<p><a href="#Test Plan for nsISHistory">Back To Top</a> </p>


<p><b>Revision History:</b></p>
<p> Date&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Changed By&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Comments
</p>
<p>06/20/01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Test Plan written by David Epstein.
</p>

</td>
</tr>
</table>



<hr class="hide">
</div>
</div>
<div id="footer">
<ul>
<li><a href="../../../sitemap.html">Site Map</a></li>
<li><a href="../../../security/">Security Updates</a></li>
<li><a href="../../../contact/">Contact Us</a></li>
<li><a href="../../../foundation/donate.html">Donate</a></li>
</ul>
<p class="copyright">
Portions of this content are &copy; 1998&#8211;2009 by individual mozilla.org
contributors; content available under a Creative Commons license | <a
href="http://www.mozilla.org/foundation/licensing/website-content.html">Details</a>.</p>
<p>
<span>Last modified June 25,  2001</span>
<span><a href="http://bonsai-www.mozilla.org/cvslog.cgi?file=mozilla-org/html/quality/embed/plans/nsishistorytp.html&amp;rev=&amp;root=/www/">Document History</a></span>
</p>
</div>
</div>
</body>
</html>
