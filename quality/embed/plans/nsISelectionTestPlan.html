<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
<link rel="top" title="Home" href="http://www.mozilla.org/">
<link rel="stylesheet" type="text/css" href="../../../css/print.css"  media="print">
<link rel="stylesheet" type="text/css" href="../../../css/base/content.css"  media="all">
<link rel="stylesheet" type="text/css" href="../../../css/cavendish/content.css" title="Cavendish" media="screen">
<link rel="stylesheet" type="text/css" href="../../../css/base/template.css"  media="screen">
<link rel="stylesheet" type="text/css" href="../../../css/cavendish/template.css" title="Cavendish" media="screen">
<link rel="icon" href="../../../images/mozilla-16.png" type="image/png">

   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="Author" content="David Epstein">
   <meta name="GENERATOR" content="Microsoft FrontPage 4.0">
   <title>nsIWebNavigation</title>
<script src="../../../__utm.js" type="text/javascript"></script>
</head>
<body id="www-mozilla-org" class="deepLevel">
<div id="container">
<p class="important">You are currently viewing a snapshot of www.mozilla.org taken on April 21, 2008. Most of this content is
highly out of date (some pages haven't been updated since the project began in 1998) and exists for historical purposes only.  If
there are any pages on this archive site that you think should be added back to www.mozilla.org, please <a
href="https://bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=www.mozilla.org">file a bug</a>.</p>
<p class="skipLink"><a href="#mainContent" accesskey="2">Skip to main content</a></p>
<div id="header">
<h1><a href="/" title="Return to home page" accesskey="1">Mozilla</a></h1>
<ul>
<li id="menu_aboutus"><a href="../../../about/" title="Getting the most out of your online experience">About</a></li>
<li id="menu_developers"><a href="../../../developer/" title="Using Mozilla's products for your own applications">Developers</a></li>
<li id="menu_store"><a href="http://store.mozilla.org/?r=mozorg1" title="Shop for Mozilla products on CD and other merchandise">Store</a></li>
<li id="menu_support"><a href="../../../support/" title="Installation, trouble-shooting, and the knowledge base">Support</a></li>
<li id="menu_products"><a href="../../../products/" title="All software Mozilla currently offers">Products</a></li>
</ul>
<form id="searchbox_002443141534113389537:ysdmevkkknw" action="http://www.google.com/cse" title="mozilla.org Search">
<div>
<label for="q" title="Search mozilla.org's sites">search mozilla:</label>
<input type="hidden" name="cx" value="002443141534113389537:ysdmevkkknw">
<input type="hidden" name="cof" value="FORID:0">
<input type="text" id="q" name="q" accesskey="s" size="30">
<input type="submit" id="submit" value="Go">
</div>
</form>
</div>
<hr class="hide">
<div id="mBody">
<div id="side">

<ul id="nav">
<li><a title="Roadmap" href="../../../roadmap.html"><strong> Roadmap</strong></a></li>
<li><a title="Projects" href="../../../projects/"><strong> Projects</strong></a></li>
<li><a title="For developers" href="../../../developer/"><strong> Coding</strong></a>
<ul>
<li><a title="Module Owners" href="../../../owners.html"> Module Owners</a></li>
<li><a title="Hacking" href="../../../hacking/"> Hacking</a></li>
<li><a title="Get the Source" href="http://developer.mozilla.org/en/docs/Download_Mozilla_Source_Code"> Get the Source</a></li>
<li><a title="Building Mozilla" href="http://developer.mozilla.org/en/docs/Build_Documentation"> Build It</a></li>
</ul>
</li>
<li><a title="Testing" href="../../../quality/"><strong> Testing</strong></a>
<ul>
<li><a title="Downloads of mozilla.org software releases" href="../../../download.html"> Releases</a></li>
<li><a title="Latest mozilla builds for testers" href="../../../developer/#builds"> Nightly Builds</a></li>
<li><a title="For testers to report bugs" href="https://bugzilla.mozilla.org/"> Report A Problem</a></li>
</ul>
</li>
<li><a title="Tools for mozilla developers" href="../../../tools.html"><strong> Tools</strong></a>
<ul>
<li><a title="Bug tracking system for mozilla testers." href="https://bugzilla.mozilla.org/"> Bugzilla</a></li>
<li><a title="Latest status of mozilla builds" href="http://tinderbox.mozilla.org/showbuilds.cgi?tree=Firefox"> Tinderbox</a></li>
<li><a title="Latest checkins" href="http://bonsai.mozilla.org/cvsqueryform.cgi"> Bonsai</a></li>
<li><a title="Source cross reference" href="http://lxr.mozilla.org/seamonkey/"> LXR</a></li>
</ul>
</li>
<li><a title="Frequently Asked Questions." href="../../../faq.html"><strong> FAQs</strong></a></li>
</ul>

</div>
<hr class="hide">
<div id="mainContent">





<table align="center" width="95%">
<tr>
<td>

<p align="center"><b><font size=+1><a name="Test Plan Start"></a>Test Plan for
nsISelection interface</font></b></p>

<br>
The nsISelection&nbsp; interface is used <b><i>for manipulating and querying the
current selected range</i>&nbsp;<i> of nodes within the document</i></b>. In order to test the
nsISelection interface, you should have at least one url loaded. See <a href="lxr.mozilla.org/seamonkey/source/content/base/public/nsISelection.idl">nsISelection.idl</a>&nbsp;
for more information.<p>To access the nsISelection object, use&nbsp; GetSelection
method on <a href="http://lxr.mozilla.org/seamonkey/source/dom/public/idl/base/nsIDOMWindow.idl">nsIDOMWindow</a>
object which can be get by using GetContentDOMWindow attribute on <a href="http://lxr.mozilla.org/seamonkey/source/embedding/browser/webBrowser/nsIWebBrowser.idl">nsIWebBrowser</a>
object . See <a href="http://lxr.mozilla.org/seamonkey/source/content/base/public/nsISelection.idl">nsiSelection.idl</a>&nbsp;
<a>for more info:</p>
<pre>        nsresult rv ;</pre>
</a>
<pre>	<a>nsCOMPtr&lt;nsISelection&gt; theSelection ;
	nsCOMPtr&lt;nsIDOMWindow&gt; theDomWindow;

	// Get the nsIDOMWindow interface in order to get nsISelection 
	rv = theWebBrowser-&gt;GetContentDOMWindow(getter_AddRefs(theDomWindow));

	// Now get the nsISelection interface
	rv = theDomWindow-&gt;GetSelection(getter_AddRefs(<b>theSelection</b>));</pre>
<p>All the methods and attributes can be now called using the Selection object.</p>

<p>To see the test cases click on the desired attributes & methods below.</p>

<p><i>Attributes:</i></p>




<p>&nbsp;</a><a href="#AnchorNode attribute:">AnchorNode</a><a>&nbsp;<br>
&nbsp;</a><a href="#AnchorOffset attribute:">AnchorOffset</a><a>&nbsp;<br>
&nbsp;</a><a href="#FocusNode attribute:">FocusNode</a><a>&nbsp;<br>
&nbsp;</a><a href="#FocusOffset attribute:">FocusOffset</a><a>&nbsp;<br>
&nbsp;</a><a href="#IsCollapsed attribute:">IsCollapsed</a><a>&nbsp;<br>
&nbsp;</a><a href="#RangeCount attribute:">Rangecount</a></p>




<a>




<p><i>Methods:</i>
<br><br>
&nbsp;</a><a href="#GetRangeAt():">GetRangeAt()</a><a><br>
&nbsp;</a><a href="#Collapse():">Collapse()</a><a><br>
&nbsp;</a><a href="#Extend():">Extend()</a><a><br>
&nbsp;</a><a href="#CollapseToStart():">CollapseToStart()</a><a>&nbsp;<br>
&nbsp;</a><a href="#CollapseToEnd():">CollapseToEnd()</a><a><br>
&nbsp;</a><a href="#ContainsNode():">ContainsNode()</a><a><br>
&nbsp;</a><a href="#SelectAllChildren():">SelectAllChildren()</a><a><br>
&nbsp;</a><a href="#AddRange():">Addrange()</a><a><br>
&nbsp;</a><a href="#RemoveRange():">RemoveRange()</a><a><br>
&nbsp;</a><a href="#RemoveAllRanges():">RemoveAllRanges()</a><a><br>
&nbsp;</a><a href="#DeleteFromDocument():">DeleteFromDocument()</a><a><br>
&nbsp;</a><a href="#SelectionLanguageChange():">SelectionLanguageChange()</a><a><br>
&nbsp;</a><a href="#ToString():">ToString()</a><a><br>
&nbsp;</a></p>




<p><b> &nbsp;<a name="AnchorNode attribute:"></a>AnchorNode attribute:</b></p>




<p><i>Introduction</i>:
<br>This attribute is used to get the node ( nsIDOMNode )&nbsp; representing one
end of the selection on the web page. It is a readonly attribute. The
GetAnchorNode() method accepts one nsIDOMNode parameter in which it will return
the reference of the DOM node. The function will not return the DOM node if
there is no selection on the web page. </p>

<p><i>How to use:</i></p>
<pre>   // use selection object from above (theSelection)</pre>
<pre>    nsCOMPtr&lt;nsIDOMNode&gt; theDomNode ;</pre>
<pre>    rv = theSelection-&gt;GetAnchorNode(getter_AddRefs(theDomNode));
    if (!theDomNode )
	// No Selection made to get the AnchorNode object </pre>
<pre> // check rv values using local methods. Value of rv will be passed even if the function does not return
  the nsIDomNode object because of no selection made on the web page.
</pre>

<p><i>Note:</i>   anchorNode will return the nsIDOMNode if&nbsp; there is any
selection on the web page, Null if there's not.</p>

<center><table BORDER COLS=5 WIDTH="90%" >
<tr>
<td WIDTH="10%" HEIGHT="100%"><b>Case</b></td>

<td><b>Steps</b></td>

<td><b>Expected Results</b></td>

<td WIDTH="10%"><b>Pass/Fail</b></td>

<td><b>Comments</b></td>
</tr>

<tr>
<td WIDTH="10%" HEIGHT="100%">1</td>

<td>Select any portion of text in your web page in browser and call
  GetAnchorNode().</td>

<td>AnchorNode should return the nsIDOMNode.</td>

<td>pass</td>

<td>Testing default impl of GetAnchorNode()</td>
</tr>

<tr>
<td WIDTH="10%">2</td>

<td>Call GetAnchorNode() without selecting anything on web page.</td>

<td>AnchorNode should not return the nsIDOMNode.</td>

<td>pass</td>

<td>Testing default impl of GetAnchorNode()</td>
</tr>

</table></center>

<p><a href="#Test Plan Start">Back To Top</a> </p>




<p><b><a name="AnchorOffset attribute:"></a>&nbsp;AnchorOffset attribute:</b></p>
<p><i>Introduction</i>:
<br>This attribute is used to get the offset within the (text) node where the
selection begins. It is a readonly attribute. The GetAnchorOffset() method accepts the
long (PRInt32) anchoroffset&nbsp; parameter: </p>

<p><i>How to use:</i></p>
<pre>   // use selection object from above (theSelection)</pre>

<pre>    PRInt32 ancoroffset = 0;

    rv = theSelection-&gt;GetAnchorOffset(&amp;ancoroffset);</pre>
<pre>  // check rv and anchoroffset values using local methods. Value of rv will be passed even if the function  
  returns anchoroffset=0  because of no selection made on the web page.
</pre>

<pre><i>Note:</i> anchoroffset will return the offset within the text if the selection was made, 0 if not.</pre>

<center><table BORDER COLS=5 WIDTH="90%" >
<tr>
<td WIDTH="10%" HEIGHT="100%"><b>Case</b></td>

<td><b>Steps</b></td>

<td><b>Expected Results</b></td>

<td WIDTH="10%"><b>Pass/Fail</b></td>

<td><b>Comments</b></td>
</tr>

<tr>
<td WIDTH="10%" HEIGHT="100%">1</td>

<td>Select any portion of text in your web page in browser and call
  GetAnchorOffset().</td>

<td>AnchorOffset should return the offset within the text</td>

<td>pass</td>

<td>Testing default impl of GetAnchorOffset()</td>
</tr>

<tr>
<td WIDTH="10%">2</td>

<td>Call GetAnchorOffset() without selecting anything on web page.</td>

<td>AnchorOffset should return 0.</td>

<td>pass</td>

<td>Testing default impl of GetAnchorOffset()</td>
</tr>

</table></center>

<p><a href="#Test Plan Start">Back To Top</a> </p>




<p><b> &nbsp;<a name="FocusNode attribute:"></a>FocusNode attribute:</b></p>
<p><i>Introduction</i>:
<br>This attribute returns the nsIDOMNode with the keyboard focus. It is a
readonly attribute. The GetFocusNode() method accepts one nsIDOMNode parameter in which it will return
the reference of the DOM node </p>

<p><i>How to use:</i></p>
<pre>   // use selection object from above (theSelection)</pre>
<pre>    nsCOMPtr&lt;nsIDOMNode&gt; theDomNode ;</pre>
<pre>    rv = theSelection-&gt;GetFocusNode(getter_AddRefs(theDomNode));
    if (!theDomNode )
	// None of the node has keyboard focus to get the FocusNode object </pre>
<pre> // check rv values using local methods. Value of rv will be passed even if the function does not return
  the nsIDomNode object because of no DOM node has keyboard focus on the web page.</pre>

<center><table BORDER="1" COLS=5 WIDTH="810" height="120" >
<tr>
<td WIDTH="67" HEIGHT="19"><b>Case</b></td>

<td width="301" height="19"><b>Steps</b></td>

<td width="156" height="19"><b>Expected Results</b></td>

<td WIDTH="128" height="19"><b>Pass/Fail</b></td>

<td width="124" height="19"><b>Comments</b></td>
</tr>

<tr>
<td WIDTH="67" HEIGHT="45">1</td>

<td width="301" height="45">Select any portion of text in your web page in browser and call
  GetFocusNode().</td>

<td width="156" height="45">FocusNode should return the nsIDOMNode.</td>

<td width="128" height="45">pass</td>

<td width="124" height="45">Testing default impl of GetFocusNode()</td>
</tr>

<tr>
<td WIDTH="67" height="38">2</td>

<td width="301" height="38">Call GetFocusNode() without selecting anything on web page.</td>

<td width="156" height="38">FocusNode should not return the nsIDOMNode.</td>

<td width="128" height="38">pass</td>

<td width="124" height="38">Testing default impl of GetFocusNode()</td>
</tr>

</table></center>

<p><a href="#Test Plan Start">Back To Top</a> </p>




<p><b><a name="FocusOffset attribute:"></a> &nbsp;FocusOffset attribute:</b></p>
<p><i>Introduction</i>:
<br>This attribute returns the offset within the (text) node where focus starts.
It is a readonly attribute. The GetFocusOffset() method accepts the long
(PRInt32) focusoffset&nbsp; parameter: </p>

<p><i>How to use:</i></p>
<pre>
    // use selection object from above (theSelection)
</pre>

<pre>    PRInt32 focusoffset = 0;

    rv = theSelection-&gt;GetFocusOffset(&amp;focusoffset);</pre>

<pre>   check rv and focusoffset values using local methods. Value of rv will be passed even if the function  
   returns focusoffset=0 because of no node has focus on the web page.</pre>

<center><table BORDER COLS=5 WIDTH="90%" >
<tr>
<td WIDTH="10%" HEIGHT="100%"><b>Case</b></td>

<td><b>Steps</b></td>

<td><b>Expected Results</b></td>

<td WIDTH="10%"><b>Pass/Fail</b></td>

<td><b>Comments</b></td>
</tr>

<tr>
<td WIDTH="10%" HEIGHT="100%">1</td>

<td>Select any portion of text in your web page in browser and call
  GetFocusOffset().</td>

<td>FocusOffset should return the offset within the text</td>

<td>pass</td>

<td>Testing default impl of GetFocusOffset()</td>
</tr>

<tr>
<td WIDTH="10%">2</td>

<td>Call GetFocusOffset() with nothing on web page having keyboard focus.&nbsp;</td>

<td>FocusOffset should return 0.</td>

<td>pass</td>

<td>Testing default impl of GetFocusOffset()</td>
</tr>

</table></center>

<p><a href="#Test Plan Start">Back To Top</a> </p>




<p><b><a name="IsCollapsed attribute:"></a>IsCollapsed attribute:</b></p>
<p><i>Introduction</i>:
<br>This attribute indicates if the selection is collapsed or not. It is a
readonly attribute. The&nbsp; GetIsCollapsed() method accepts the boolean
iscollapsed parameter. </p>

<p><i>How to use:</i></p>
<pre>
   // use selection object from above (theSelection)
   PRBool  isCollapsed = false;

   oSelection = GetSelectionObject();

   rv = oSelection-&gt;GetIsCollapsed(&amp;isCollapsed);

   // check rv and isCollapsed using local methods
</pre>

<center><table BORDER COLS=5 WIDTH="90%" >
<tr>
<td WIDTH="10%" HEIGHT="100%"><b>Case</b></td>

<td><b>Steps</b></td>

<td><b>Expected Results</b></td>

<td WIDTH="10%"><b>Pass/Fail</b></td>

<td><b>Comments</b></td>
</tr>

<tr>
<td WIDTH="10%" HEIGHT="100%">1</td>

<td width="301" height="45">Select any portion of text in your web page in browser and call
  GetIsCollapsed().</td>

<td>Should return false</td>

<td>pass</td>

<td>Testing default impl of GetIsCollapsed()</td>
</tr>

<tr>
<td WIDTH="10%">2</td>

<td width="301" height="38">Call GetIsCollapsed() without selecting anything on web page.</td>

<td>Should return true</td>

<td>pass</td>

<td>Testing default impl of GetIsCollapsed()</td>
</tr>

</table></center>

<p><a href="#Test Plan Start">Back To Top</a> </p>





<p><b><a name="RangeCount attribute:"></a> &nbsp;RangeCount attribute:</b></p>
<p><i>Introduction</i>:
<br>This attribute returns the number of ranges in the selection made on a web
page. It is a readonly attribute. The GetRangeCount() method accepts one
long(PRInt32) parameter rangecount.</p>

<p><i>How to use:</i></p>
<pre>
   // use selection object from above (theSelection)

	PRInt32 rangecount = 0;</pre>

<pre>	rv = oSelection-&gt;GetRangeCount(&amp;rangecount);						</pre>

<pre>   // check rv and rangecount using local methods.
</pre>

<center><table BORDER="1" COLS=5 WIDTH="782" >
<tr>
<td WIDTH="72" HEIGHT="100%"><b>Case</b></td>

<td width="288"><b>Steps</b></td>

<td width="160"><b>Expected Results</b></td>

<td WIDTH="72"><b>Pass/Fail</b></td>

<td width="156"><b>Comments</b></td>
</tr>

<tr>
<td WIDTH="72" HEIGHT="100%">1</td>

<td width="288" height="45">Select any portion of text in your web page in browser and call
  GetRangeCount().</td>

<td width="160">Should return&nbsp; number of ranges in the selection</td>

<td width="72">pass</td>

<td width="156">Testing default impl of GetRangeCount()</td>
</tr>
<tr>
<td WIDTH="72">2</td>

<td width="288" height="38">Call GetRangeCount() without selecting anything on web page.</td>

<td width="160">Should return 0</td>

<td width="72">pass</td>

<td width="156">Testing default impl of GetRangeCount()</td>
</tr>
</table></center>

<p><a href="#Test Plan Start">Back To Top</a> </p>




<p><b><a name="GetRangeAt():"></a>GetRangeAt():</b></p>
<p><i>Introduction</i>:
<br>This method returns the range at the specified index from any selection made
on a web page. It accepts two parameters first the PRInt32 index and second the
nsIDOMRange in which it will return the reference to the nsIDOMRange object at
the specified index.</p>

<p><i>How to use:</i></p>
<pre>
   // use selection object from above (theSelection)

	PRInt32 index = 0;</pre>

<pre>	nsCOMPtr&lt;nsIDOMRange&gt; theDOMRange ;

	rv = oSelection-&gt;GetRangeAt(index,getter_AddRefs(theDOMRange ))</pre>

<pre>   // check rv using local methods
</pre>

<center><table BORDER="1" COLS=5 WIDTH="90%" >
<tr>
<td WIDTH="10%" HEIGHT="100%"><b>Case</b></td>

<td><b>Steps</b></td>

<td><b>Expected Results</b></td>

<td WIDTH="10%"><b>Pass/Fail</b></td>

<td><b>Comments</b></td>
</tr>

<tr>
<td WIDTH="72" HEIGHT="100%">1</td>

<td width="288" height="45">Select any portion of text in your web page in browser and call
  GetRangeAt().</td>

<td width="160">Should return&nbsp; the range at the specified index in the
  selection.</td>

<td width="72">pass</td>

<td width="156">Testing default impl of GetRangeAt()</td>
</tr>
<tr>
<td WIDTH="72">2</td>

<td width="288" height="38">Call GetRangeAt() without selecting anything on web page.</td>

<td width="160">Should Fail</td>

<td width="72">Fail</td>

<td width="156">Testing default impl of GetRangeAt()</td>
</tr>
</table></center>

<p><a href="#Test Plan Start">Back To Top</a> </p>




<p><b><a name="Collapse():"></a>Collapse():</b></p>
<p><i>Introduction</i>:
<br>This method collapses the selection to a single point, at the specified
offset&nbsp; in the given DOM node. When the selection is collapsed, and the
content&nbsp; is focused and editable, the caret will blink there. This method
accepts 2 parameters nsIDOMNode on which the selection is to be collapsed and
the PRInt32 index&nbsp; to which the selection is to be collapsed. </p>

<p><i>How to use:</i></p>
<pre>   // use selection object from above (theSelection)</pre>

<pre>   // use the theDOMNode from above Attributes GetAnchorNode() or GetFocusNode().</pre>

<pre>	PRInt32 index = 1;</pre>

<pre>	rv = oSelection-&gt;Collapse(theDOMNode,index) ;
</pre>

<pre>    // check rv using local methods
</pre>

<center><table BORDER="1" COLS=5 WIDTH="788" height="101" >
<tr>
<td WIDTH="72" HEIGHT="19"><b>Case</b></td>

<td width="157" height="19"><b>Steps</b></td>

<td width="307" height="19"><b>Expected Results</b></td>

<td WIDTH="62" height="19"><b>Pass/Fail</b></td>

<td width="156" height="19"><b>Comments</b></td>
</tr>

<tr>
<td WIDTH="72" HEIGHT="26">1</td>

<td width="157" height="26">Call Collapse().</td>

<td width="307" height="26">Should collapse the selection to the specified index
  in the specified node.</td>

<td width="62" height="26">pass</td>

<td width="156" height="26">Testing default impl of Collapse()</td>
</tr>

</table></center>

<p><a href="#Test Plan Start">Back To Top</a> </p>




<p><b><a name="Extend():"></a>Extend():</b></p>
<p><i>Introduction</i>:
<br>This method extends the selection by moving the focus to the specified node
and offset,&nbsp; preserving the anchor position. The new selection end result
will always&nbsp; be from the anchor to the new focus, regardless of direction.
This method accepts 2 parameters nsIDOMNode on which the selection is to be
extended and the PRInt32 index&nbsp; to which the selection is to be collapsed. </p>

<p><i>How to use:</i></p>
<pre>
    // use selection object from above (theSelection)</pre>

<pre>   // use the theDOMNode from above Attributes GetAnchorNode() or GetFocusNode().</pre>

<pre>	PRInt32 index = 10;</pre>

<pre>	rv = oSelection-&gt;Extend(theDOMNode,index) ;
</pre>

<pre>    // check rv using local methods
</pre>

<center><table BORDER="1" COLS=5 WIDTH="90%" >
<tr>
<td WIDTH="10%" HEIGHT="100%"><b>Case</b></td>

<td><b>Steps</b></td>

<td><b>Expected Results</b></td>

<td WIDTH="10%"><b>Pass/Fail</b></td>

<td><b>Comments</b></td>
</tr>

<tr>
<td WIDTH="72" HEIGHT="26">1</td>

<td width="157" height="26">Call Extend().</td>

<td width="307" height="26">Should extend the selection to the specified index
  in the specified node from the anchor node.</td>

<td width="62" height="26">pass</td>

<td width="156" height="26">Testing default impl of Extend()</td>
</tr>

</table></center>

<p><a href="#Test Plan Start">Back To Top</a> </p>




<p><b><a name="CollapseToStart():"></a>CollapseToStart():</b></p>
<p><i>Introduction</i>:
<br>This method collapses the whole selection to a single point at the
start&nbsp; of the current selection (irrespective of direction). If
content&nbsp; is focused and editable, the caret will blink there. This function
does not accept any parameters </p>

<p><i>How to use:</i></p>
<pre>    // use selection object from above (theSelection)</pre>

<pre>    rv = oSelection-&gt;CollapseToStart() ;
</pre>

<pre>   // check rv using local methods
</pre>

<center><table BORDER="1" COLS=5 WIDTH="778" >
<tr>
<td WIDTH="72" HEIGHT="100%"><b>Case</b></td>

<td width="259"><b>Steps</b></td>

<td width="187"><b>Expected Results</b></td>

<td WIDTH="71"><b>Pass/Fail</b></td>

<td width="155"><b>Comments</b></td>
</tr>

<tr>
<td WIDTH="72" HEIGHT="100%">1</td>

<td width="259" height="45">Select any portion of text in your web page in browser and call
  CollapseToStart().</td>

<td width="187">Should collapse the selection to start of the current selection</td>

<td width="71">pass</td>

<td width="155">Testing default impl of CollapseToStart()</td>
</tr>
<tr>
<td WIDTH="72">2</td>

<td width="259" height="38">Call CollapseToStart() without selecting anything on web page.</td>

<td width="187">Should Fail</td>

<td width="71">Fail</td>

<td width="155">Testing default impl of CollapseToStart()</td>
</tr>

</table></center>

<p><a href="#Test Plan Start">Back To Top</a> </p>




<p><b><a name="CollapseToEnd():"></a>CollapseToEnd():</b></p>
<p><i>Introduction</i>:
<br>This method collapses the whole selection to a single point at the end&nbsp;
of the current selection (irrespective of direction). If content&nbsp; is
focused and editable, the caret will blink there. This function does not accept
any parameters </p>

<p><i>How to use:</i></p>
<pre>    // use selection object from above (theSelection)</pre>

<pre>    rv = oSelection-&gt;CollapseToEnd() ;
</pre>

<pre>   // check rv using local methods
</pre>

<center><table BORDER="1" COLS=5 WIDTH="778" >
<tr>
<td WIDTH="72" HEIGHT="100%"><b>Case</b></td>

<td width="259"><b>Steps</b></td>

<td width="187"><b>Expected Results</b></td>

<td WIDTH="71"><b>Pass/Fail</b></td>

<td width="155"><b>Comments</b></td>
</tr>

<tr>
<td WIDTH="72" HEIGHT="100%">1</td>

<td width="259" height="45">Select any portion of text in your web page in browser and call
  CollapseToEnd().</td>

<td width="187">Should collapse the selection to start of the current selection</td>

<td width="71">pass</td>

<td width="155">Testing default impl of CollapseToEnd()</td>
</tr>
<tr>
<td WIDTH="72">2</td>

<td width="259" height="38">Call CollapseToEnd() without selecting anything on web page.</td>

<td width="187">Should Fail</td>

<td width="71">Fail</td>

<td width="155">Testing default impl of CollapseToEnd()</td>
</tr>

</table></center>

<p><a href="#Test Plan Start">Back To Top</a> </p>




<p><b><a name="ContainsNode():"></a>ContainsNode():</b></p>
<p><i>Introduction</i>:
<br>This method determines whether the selection on the web page contains a
nsIDOMNode. This function accepts 2 parameters first the nsIDOMNode to search
and the boolean entirelyContained. The value of entirelyContained determines the
detail of the search to determine if&nbsp; the selection contains the node
entirely. Method returns the true if the selection contains the node else false. </p>

<p><i>How to use:</i></p>
<pre>    // use selection object from above (theSelection)</pre>

<pre>   // use the theDOMNode from above Attributes GetAnchorNode() or GetFocusNode().</pre>

<pre>
     PRBool entirelyContained = false ;	
     PRBool bContains = false ;	</pre>

<pre>     rv = theSelection-&gt;ContainsNode(theDOMNode,entirelyContained, &amp;bContains);</pre>

<pre>   // check value of rv and bContains using local methods
</pre>

<center><table BORDER="1" COLS=5 WIDTH="90%" height="107" >
<tr>
<td WIDTH="10%" HEIGHT="19"><b>Case</b></td>

<td height="19"><b>Steps</b></td>

<td height="19"><b>Expected Results</b></td>

<td WIDTH="10%" height="19"><b>Pass/Fail</b></td>

<td height="19"><b>Comments</b></td>
</tr>

<tr>
<td WIDTH="72" HEIGHT="32">1</td>

<td width="259" height="32">Select any portion of text in your web page in browser and call
  ContainsNode().</td>

<td width="187" height="32">Should return true if the node is found in the
  selection</td>

<td width="71" height="32">pass</td>

<td width="155" height="32">Testing default impl of ContainsNode()</td>
</tr>
<tr>
<td WIDTH="72" height="38">2</td>

<td width="259" height="38">Call ContainsNode() without selecting anything on web page.</td>

<td width="187" height="38">Should return false</td>

<td width="71" height="38">pass</td>

<td width="155" height="38">Testing default impl of ContainsNode()</td>
</tr>

</table></center>

<p><a href="#Test Plan Start">Back To Top</a> </p>



<p><b><a name="SelectAllChildren():"></a>SelectAllChildren():</b></p>
<p><i>Introduction</i>:
<br>This method adds all children of the specified node to the selection. This
method accepts 1 parameter parentnode (nsIDOMNode) whose children are to be
added to the selection.&nbsp; </p>

<p><i>How to use:</i></p>
<pre>  // use selection object from above (theSelection)</pre>

<pre>   // use the theDOMNode from above Attributes GetAnchorNode() or GetFocusNode().</pre>

<pre>    rv = theSelection-&gt;SelectAllChildren(theDOMNode );</pre>

<pre>   // check value of rv using local methods
</pre>

<center><table BORDER="1" COLS=5 WIDTH="90%" >
<tr>
<td WIDTH="10%" HEIGHT="100%"><b>Case</b></td>

<td><b>Steps</b></td>

<td><b>Expected Results</b></td>

<td WIDTH="10%"><b>Pass/Fail</b></td>

<td><b>Comments</b></td>
</tr>

<tr>
<td WIDTH="72" HEIGHT="32">1</td>

<td width="259" height="32">Select any portion of text in your web page in browser.Get
  the anchornode or focus node and call SelectAllChildren().</td>

<td width="187" height="32">Should add all the children of the specified node to
  the selection.</td>

<td width="71" height="32">pass</td>

<td width="155" height="32">Testing default impl of SelectAllChildren()</td>
</tr>
<tr>
<td WIDTH="72" HEIGHT="32">1</td>

<td width="259" height="32">Call SelectAllChildren() without selecting anything on web page.</td>

<td width="187" height="32">Should not change the selection.</td>

<td width="71" height="32">pass</td>

<td width="155" height="32">Testing default impl of SelectAllChildren()</td>
</tr>

</table></center>

<p><a href="#Test Plan Start">Back To Top</a> </p>




<p><b><a name="AddRange():"></a>AddRange():</b></p>
<p><i>Introduction</i>:
<br>This method adds a range to the current selection. This method accepts one
nsIDOMRange range parameters which will be added to the current selection. </p>

<p><i>How to use:</i> </p>

<pre>  // use selection object from above (theSelection)</pre>

<pre>    rv = theSelection-&gt;AddRange(theDOMRange);</pre>

<pre>   // check value of rv using local methods
</pre>

<center><table BORDER="1" COLS=5 WIDTH="90%" >
<tr>
<td WIDTH="10%" HEIGHT="100%"><b>Case</b></td>

<td><b>Steps</b></td>

<td><b>Expected Results</b></td>

<td WIDTH="10%"><b>Pass/Fail</b></td>

<td><b>Comments</b></td>
</tr>

<tr>
<td WIDTH="72" HEIGHT="32">1</td>

<td width="259" height="32">Select any portion of text in your web page in browser call
  AddRange().</td>

<td width="187" height="32">Should add the range to the selection and extend
  selection.</td>

<td width="71" height="32">pass</td>

<td width="155" height="32">Testing default impl of AddRange()</td>
</tr>
<tr>
<td WIDTH="72" HEIGHT="32">1</td>

<td width="259" height="32">Call AddRange() without selecting anything on web page.</td>

<td width="187" height="32">Should only add the specified range to the
  selection.</td>

<td width="71" height="32">pass</td>

<td width="155" height="32">Testing default impl of AddRange()</td>
</tr>

</table></center>

<p><a href="#Test Plan Start">Back To Top</a> </p>




<p><b><a name="RemoveRange():"></a>RemoveRange():</b></p>
<p><i>Introduction</i>:
<br>This method removes a range to the current selection. This method accepts
one nsIDOMRange range parameters which will be removed from&nbsp; the current
selection. </p>

<p><i>How to use:</i> </p>

<pre>  // use selection object from above (theSelection)</pre>

<pre>  // use GetRangeAt() to get the nsIDOMRange object ( See Above)</pre>

<pre>    rv = theSelection-&gt;RemoveRange(theDOMRange);</pre>

<pre>   // check value of rv using local methods
</pre>

<center><table BORDER="1" COLS=5 WIDTH="90%" >
<tr>
<td WIDTH="10%" HEIGHT="100%"><b>Case</b></td>

<td><b>Steps</b></td>

<td><b>Expected Results</b></td>

<td WIDTH="10%"><b>Pass/Fail</b></td>

<td><b>Comments</b></td>
</tr>

<tr>
<td WIDTH="72" HEIGHT="32">1</td>

<td width="259" height="32">Select any portion of text in your web page in browser call
  RemoveRange().</td>

<td width="187" height="32">Should remove the range from the selection.</td>

<td width="71" height="32">pass</td>

<td width="155" height="32">Testing default impl of RemoveRange()</td>
</tr>
<tr>
<td WIDTH="72" HEIGHT="32">1</td>

<td width="259" height="32">Call RemoveRange() without selecting anything on web page.</td>

<td width="187" height="32">Should not change the selection.</td>

<td width="71" height="32">pass</td>

<td width="155" height="32">Testing default impl of RemoveRange()</td>
</tr>

</table></center>

<p><a href="#Test Plan Start">Back To Top</a> </p>




<p>&nbsp;</p>



<p><b><a name="RemoveAllRanges():"></a>RemoveAllRanges():</b></p>
<p><i>Introduction</i>:
<br>This method removes all ranges from the current selection. This method does
not accepts any parameters </p>

<p><i>How to use:</i> </p>

<pre>  // use selection object from above (theSelection)</pre>

<pre>    rv = theSelection-&gt;RemoveAllRanges();</pre>

<pre>   // check value of rv using local methods
</pre>

<center><table BORDER="1" COLS=5 WIDTH="90%" >
<tr>
<td WIDTH="10%" HEIGHT="100%"><b>Case</b></td>

<td><b>Steps</b></td>

<td><b>Expected Results</b></td>

<td WIDTH="10%"><b>Pass/Fail</b></td>

<td><b>Comments</b></td>
</tr>

<tr>
<td WIDTH="72" HEIGHT="32">1</td>

<td width="259" height="32">Select any portion of text in your web page in browser
  call RemoveAllRanges().</td>

<td width="187" height="32">Should remove all the ranges from selection.</td>

<td width="71" height="32">pass</td>

<td width="155" height="32">Testing default impl of RemoveAllRanges()</td>
</tr>
<tr>
<td WIDTH="72" HEIGHT="32">1</td>

<td width="259" height="32">Call RemoveAllRanges() without selecting anything on web page.</td>

<td width="187" height="32">Should not do anything to the web page.</td>

<td width="71" height="32">pass</td>

<td width="155" height="32">Testing default impl of RemoveAllRanges()</td>
</tr>

</table></center>

<p><a href="#Test Plan Start">Back To Top</a> </p>




<p><b><a name="DeleteFromDocument():"></a>DeleteFromDocument():</b></p>
<p><i>Introduction</i>:
<br>This method deletes the selection from document the nodes belong to. This
method does not accepts any parameters </p>

<p><i>How to use:</i> </p>

<pre>  // use selection object from above (theSelection)</pre>

<pre>    rv = theSelection-&gt;DeleteFromDocument();</pre>

<pre>   // check value of rv using local methods
</pre>

<center><table BORDER="1" COLS=5 WIDTH="90%" >
<tr>
<td WIDTH="10%" HEIGHT="100%"><b>Case</b></td>

<td><b>Steps</b></td>

<td><b>Expected Results</b></td>

<td WIDTH="10%"><b>Pass/Fail</b></td>

<td><b>Comments</b></td>
</tr>

<tr>
<td WIDTH="72" HEIGHT="32">1</td>

<td width="259" height="32">Select any portion of text in your web page in browser call
  DeleteFromDocument().</td>

<td width="187" height="32">Should delete the selection from the web page..</td>

<td width="71" height="32">pass</td>

<td width="155" height="32">Testing default impl of DeleteFromDocument()</td>
</tr>
<tr>
<td WIDTH="72" HEIGHT="32">1</td>

<td width="259" height="32">Call DeleteFromDocument() without selecting anything on web page.</td>

<td width="187" height="32">Should not delete from the web page.</td>

<td width="71" height="32">Fail</td>

<td width="155" height="32">Testing default impl of DeleteFromDocument()</td>
</tr>

</table></center>

<p><a href="#Test Plan Start">Back To Top</a> </p>




<p><b><a name="SelectionLanguageChange():"></a>SelectionLanguageChange():</b></p>
<p><i>Introduction</i>:
<br>This method modifies the cursor Bidi level after a change in keyboard
direction. This method accepts 1 parameter PRBool langRTL.&nbsp; langRTL is
PR_TRUE if the new language is right-to-left or&nbsp; PR_FALSE if the new
language is left-to-right. </p>

<p><i>How to use:</i> </p>

<pre>  // use selection object from above (theSelection)</pre>

<pre>    PRBool langRTL = false ;	</pre>

<pre>    rv = theSelection-&gt;SelectLanguageChange(langRTL);</pre>

<pre>   // check value of rv using local methods
</pre>

<center><table BORDER="1" COLS=5 WIDTH="90%" >
<tr>
<td WIDTH="10%" HEIGHT="100%"><b>Case</b></td>

<td><b>Steps</b></td>

<td><b>Expected Results</b></td>

<td WIDTH="10%"><b>Pass/Fail</b></td>

<td><b>Comments</b></td>
</tr>

<tr>
<td WIDTH="72" HEIGHT="32">1</td>

<td width="259" height="32">Call SelectLanguageChange() with langRTL as
  false.&nbsp;</td>

<td width="187" height="32">Change the cursor bidi level for left to right</td>

<td width="71" height="32">pass</td>

<td width="155" height="32">Testing default impl of SelectLanguageChange()</td>
</tr>
<tr>
<td WIDTH="72" HEIGHT="32">1</td>

<td width="259" height="32">Call SelectLanguageChange() with langRTL as True.</td>

<td width="187" height="32">Change the cursor bidi level for right to left</td>

<td width="71" height="32">pass</td>

<td width="155" height="32">Testing default impl of SelectLanguageChange()</td>
</tr>

</table></center>

<p><a href="#Test Plan Start">Back To Top</a> </p>




<p><b><a name="ToString():"></a>ToString():</b></p>
<p><i>Introduction</i>:
<br>This method returns the whole selection into a plain text string. This
method accepts 1 parameter nsXPIDLString szText, which will have the text of the
selection after the function is executed. </p>

<p><i>How to use:</i> </p>

<pre>  // use selection object from above (theSelection)</pre>

<pre>	nsXPIDLString szText;</pre>
<pre>
	rv = oSelection-&gt;ToString(getter_Copies(szText));
</pre>
<pre>   // check value of rv and szText  using local methods
</pre>

<center><table BORDER="1" COLS=5 WIDTH="90%" >
<tr>
<td WIDTH="10%" HEIGHT="100%"><b>Case</b></td>

<td><b>Steps</b></td>

<td><b>Expected Results</b></td>

<td WIDTH="10%"><b>Pass/Fail</b></td>

<td><b>Comments</b></td>
</tr>

<tr>
<td WIDTH="72" HEIGHT="32">1</td>

<td width="259" height="32">Select any portion of text in your web page in browser call
  ToString().</td>

<td width="187" height="32">Should return the text string for the selection on
  the web page..</td>

<td width="71" height="32">pass</td>

<td width="155" height="32">Testing default impl of ToString()</td>
</tr>
<tr>
<td WIDTH="72" HEIGHT="32">1</td>

<td width="259" height="32">Call ToString() without selecting anything on web page.</td>

<td width="187" height="32">should return empty string</td>

<td width="71" height="32">pass</td>

<td width="155" height="32">Testing default impl of ToString()</td>
</tr>

</table></center>

<p><a href="#Test Plan Start">Back To Top</a> </p>




<p>&nbsp; </p>




<p><b>Revision History:</b></p>
<p> Date&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Changed By&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Comments
</p>
<p>08/27/01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Test Plan written by Ashish Bhatt
</p>

</td>
</tr>
</table>



<hr class="hide">
</div>
</div>
<div id="footer">
<ul>
<li><a href="../../../sitemap.html">Site Map</a></li>
<li><a href="../../../security/">Security Updates</a></li>
<li><a href="../../../contact/">Contact Us</a></li>
<li><a href="../../../foundation/donate.html">Donate</a></li>
</ul>
<p class="copyright">
Portions of this content are &copy; 1998&#8211;2009 by individual mozilla.org
contributors; content available under a Creative Commons license | <a
href="http://www.mozilla.org/foundation/licensing/website-content.html">Details</a>.</p>
<p>
<span>Last modified August 27,  2001</span>
<span><a href="http://bonsai-www.mozilla.org/cvslog.cgi?file=mozilla-org/html/quality/embed/plans/nsISelectionTestPlan.html&amp;rev=&amp;root=/www/">Document History</a></span>
</p>
</div>
</div>
</body>
</html>
