<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<link rel="top" title="Home" href="http://www.mozilla.org/">
<link rel="stylesheet" type="text/css" href="../../../css/print.css"  media="print">
<link rel="stylesheet" type="text/css" href="../../../css/base/content.css"  media="all">
<link rel="stylesheet" type="text/css" href="../../../css/cavendish/content.css" title="Cavendish" media="screen">
<link rel="stylesheet" type="text/css" href="../../../css/base/template.css"  media="screen">
<link rel="stylesheet" type="text/css" href="../../../css/cavendish/template.css" title="Cavendish" media="screen">
<link rel="icon" href="../../../images/mozilla-16.png" type="image/png">


  <meta name="generator" content=
  "HTML Tidy for Windows (vers 25 January 2008), see http://tidy.sourceforge.net/">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta http-equiv="Content-Language" content="en">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <meta name="authors" content="Karen Huang">

  <title>Feature Test Specification: Mail &amp; News: IMAP Commands and
  Implementation</title>

  <link rel="contents" href="./" title=
  "Mozilla MailNews Functional / UI Tests">
  <link rel="up" href="./" title="Mozilla MailNews Functional / UI Tests">
  <link rel="previous" href="sea-mn-imap.html" title=
  "Feature test spec: Mail &amp; News: IMAP">
  <link rel="next" href="machv-mn-imap-shared-folders.html" title=
  "Feature test spec: Mail &amp; News: IMAP Shared Folders">

  <style type="text/css">
  ol.uppCase {list-style-type: upper-alpha;}
  ol.lowCase {list-style-type: lower-alpha;}
  span.c1 {color: red;}
  </style>

<script src="../../../__utm.js" type="text/javascript"></script>
</head>
<body id="www-mozilla-org" class="deepLevel">
<div id="container">
<p class="important">You are currently viewing a snapshot of www.mozilla.org taken on April 21, 2008. Most of this content is
highly out of date (some pages haven't been updated since the project began in 1998) and exists for historical purposes only.  If
there are any pages on this archive site that you think should be added back to www.mozilla.org, please <a
href="https://bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=www.mozilla.org">file a bug</a>.</p>
<p class="skipLink"><a href="#mainContent" accesskey="2">Skip to main content</a></p>
<div id="header">
<h1><a href="/" title="Return to home page" accesskey="1">Mozilla</a></h1>
<ul>
<li id="menu_aboutus"><a href="../../../about/" title="Getting the most out of your online experience">About</a></li>
<li id="menu_developers"><a href="../../../developer/" title="Using Mozilla's products for your own applications">Developers</a></li>
<li id="menu_store"><a href="http://store.mozilla.org/?r=mozorg1" title="Shop for Mozilla products on CD and other merchandise">Store</a></li>
<li id="menu_support"><a href="../../../support/" title="Installation, trouble-shooting, and the knowledge base">Support</a></li>
<li id="menu_products"><a href="../../../products/" title="All software Mozilla currently offers">Products</a></li>
</ul>
<form id="searchbox_002443141534113389537:ysdmevkkknw" action="http://www.google.com/cse" title="mozilla.org Search">
<div>
<label for="q" title="Search mozilla.org's sites">search mozilla:</label>
<input type="hidden" name="cx" value="002443141534113389537:ysdmevkkknw">
<input type="hidden" name="cof" value="FORID:0">
<input type="text" id="q" name="q" accesskey="s" size="30">
<input type="submit" id="submit" value="Go">
</div>
</form>
</div>
<hr class="hide">
<div id="mBody">
<div id="side">

<ul id="nav">
<li><a title="Roadmap" href="../../../roadmap.html"><strong> Roadmap</strong></a></li>
<li><a title="Projects" href="../../../projects/"><strong> Projects</strong></a></li>
<li><a title="For developers" href="../../../developer/"><strong> Coding</strong></a>
<ul>
<li><a title="Module Owners" href="../../../owners.html"> Module Owners</a></li>
<li><a title="Hacking" href="../../../hacking/"> Hacking</a></li>
<li><a title="Get the Source" href="http://developer.mozilla.org/en/docs/Download_Mozilla_Source_Code"> Get the Source</a></li>
<li><a title="Building Mozilla" href="http://developer.mozilla.org/en/docs/Build_Documentation"> Build It</a></li>
</ul>
</li>
<li><a title="Testing" href="../../../quality/"><strong> Testing</strong></a>
<ul>
<li><a title="Downloads of mozilla.org software releases" href="../../../download.html"> Releases</a></li>
<li><a title="Latest mozilla builds for testers" href="../../../developer/#builds"> Nightly Builds</a></li>
<li><a title="For testers to report bugs" href="https://bugzilla.mozilla.org/"> Report A Problem</a></li>
</ul>
</li>
<li><a title="Tools for mozilla developers" href="../../../tools.html"><strong> Tools</strong></a>
<ul>
<li><a title="Bug tracking system for mozilla testers." href="https://bugzilla.mozilla.org/"> Bugzilla</a></li>
<li><a title="Latest status of mozilla builds" href="http://tinderbox.mozilla.org/showbuilds.cgi?tree=Firefox"> Tinderbox</a></li>
<li><a title="Latest checkins" href="http://bonsai.mozilla.org/cvsqueryform.cgi"> Bonsai</a></li>
<li><a title="Source cross reference" href="http://lxr.mozilla.org/seamonkey/"> LXR</a></li>
</ul>
</li>
<li><a title="Frequently Asked Questions." href="../../../faq.html"><strong> FAQs</strong></a></li>
</ul>

</div>
<hr class="hide">
<div id="mainContent">








  <p class="crumbs"><em>You are here:</em> <a href="./">Mozilla MailNews
  Functional / UI Tests</a> &gt; <strong>Mail &amp; News: IMAP Commands and
  Implementation</strong></p>

  <h1>Feature Test Spec: Mail and News Component</h1>

  <h2>Mail and News Component: IMAP Commands and Implementation</h2>

  <address class="author">
    Written by <a href="mailto:huang@netscape.com">Karen Huang</a>
  </address>

  <h3>References</h3>

  <p><strong>IMAP4rel RFC 2060</strong><br>
  <strong>IMAP4 Implementation Recommendations</strong><br>
  <strong>UI Specification: TBD</strong></p>

  <h3>Description</h3>

  <p>This Test Spec describes the IMAP Command Execution and
  Implementation.</p>

  <p>Table of Contents</p>

  <ul class="toc">
    <li><a href="#Server">Server Priorization</a></li>

    <li><a href="#IMAP-Log-File">IMAP Log File Setup</a></li>

    <li>
      <a href="#IMAP-Command">IMAP Commands and Execution</a>

      <ul>
        <li><a href="#CAPABILITY">CAPABILITY</a></li>

        <li><a href="#LOGIN-AUTHENTICATE:">LOGIN/AUTHENTICATE</a></li>

        <li><a href="#NAMESPACE">NAMESPACE</a></li>

        <li><a href=
        "#SELECT-initial-FETCH-fetch-flags">SELECT /
        initial FETCH</a></li>

        <li><a href="#FETCH-Body">FETCH (body)</a></li>

        <li><a href="#FETCH-Biff">FETCH (biff)</a></li>

        <li><a href="#STORE">STORE</a></li>

        <li><a href="#UID:">UID</a></li>

        <li><a href="#UIDVALIDITY">UIDVALIDITY</a></li>

        <li><a href="#LIST">LIST</a></li>

        <li><a href="#LSUB">LSUB</a></li>

        <li><a href="#CREATE">CREATE</a></li>

        <li><a href="#DELETE">DELETE</a></li>

        <li><a href="#RENAME">RENAME</a></li>

        <li><a href="#APPEND">APPEND</a></li>

        <li><a href="#NOOP">NOOP</a></li>

        <li><a href="#CHECK">CHECK</a></li>

        <li><a href="#EXPUNGE">EXPUNGE</a></li>

        <li><a href="#COPY">COPY</a></li>

        <li><a href="#SUBSCRIBE">SUBSCRIBE</a></li>

        <li><a href="#UNSUBSCRIBE">UNSUBSCRIBE</a></li>

        <li><a href="#SEARCH">SEARCH</a></li>

        <li><a href="#LOGOUT">LOGOUT</a></li>
      </ul>
    </li>

    <li><a href="#Additional-Special">Additional Special Tests</a></li>
  </ul>

  <h3><a name="Server" id="Server">Server Prioritization</a></h3>

  <table border="1">
    <tbody>
      <tr>
        <th></th>

        <th>IMAP servers</th>

        <th>Version</th>

        <th>Notes</th>
      </tr>

      <tr>
        <td>1</td>

        <td>Netscape Messaging Server</td>

        <td>4.1</td>

        <td>Internal Server Name: dredd/nsmail-2 or tintin/nsmail-5
        (Aug.99~current)</td>
      </tr>

      <tr>
        <td>2</td>

        <td>Microsoft Exchange</td>

        <td>v5.5</td>

        <td>Internal Server Name: poisonoak (2/3/99~current )</td>
      </tr>

      <tr>
        <td>3</td>

        <td>University of Washington</td>

        <td>v12.250</td>

        <td>Internal Server Name: sspitzer</td>
      </tr>

      <tr>
        <td>4</td>

        <td>Cyrus</td>

        <td>v1.5.2</td>

        <td>Internal Server Name: buggy (2/3/99~current )</td>
      </tr>

      <tr>
        <td>*</td>

        <td>SIMS/IMS</td>

        <td>4.0/5.0</td>

        <td>SUN Microsystems covered this test already</td>
      </tr>
    </tbody>
  </table>

  <h3><a name="IMAP-Log-File">IMAP Log File Setup</a></h3>

  <p>The log is written over every time you re-launch Communicator for all
  the following platforms:</p>

  <ul>
    <li>
      <strong><em>Windows 95/98 :</em></strong>

      <ul>
        <li>Create "c:\tmp" for IMAP log file reside if there is no such
        directory</li>

        <li>Insert the following line into your
        <strong>autoexec.bat</strong> file:<br>
        <strong>Set NSPR_LOG_MODULES=IMAP:5</strong><br>
        <strong>Set NSPR_LOG_FILE=c:\tmp\[filename]</strong><br>
        (filename can be defined by you)</li>

        <li>Reboot your system</li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <strong><em>WinNT:</em></strong>

      <ul>
        <li>Create "c:\tmp" for IMAP log file reside if there is no such
        directory</li>

        <li>Use the control panel | System | Environment tool to set the
        PRLOG env variable:<br>
        Varibles: <strong>NSPR_LOG_MODULES</strong> Value:
        <strong>IMAP:5</strong><br>
        Varibles: <strong>NSPR_LOG_FILE</strong> Value:
        <strong>c:\tmp\[filename]</strong><br>
        (filename can be defined by you)</li>

        <li>Reboot your system</li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <strong><em>Unix:</em></strong>

      <ul>
        <li>Add a line to ~/.cshrc file of the csh shell as following:<br>
        <strong>Set NSPR_LOG_MODULES IMAP:5</strong><br>
        <strong>Set NSPR_LOG_FILE /u/[unix
        userlogin]/tmp/[filename]</strong><br>
        (filename can be defined by you)</li>

        <li>Add a line to ~/.bashrc file of the csh shell as following:<br>

          <strong>NSPR_LOG_MODULES="IMAP:5"</strong><br>
          <strong>NSPR_LOG_FILE="/u/[unix
          userlogin]/tmp/[filename]</strong><br>
          <strong>export NSPR_LOG_MODULES</strong><br>
          <strong>export NSPR_LOG_FILE</strong><br>
          (filename can be defined by you)

          <p>Please Note: /u/[unix userlogin] is just Netscape setup UNIX
          environment for each user. It could be /home/[unix userlogin] or
          /[unix userlogin] depend on how your users environment setup.</p>
        </li>
      </ul>
    </li>

    <li>
      <strong>Mac:</strong>

      <p>Create a text file that contains the following lines in a text
      editor (ex: BBEdit) After save this file, drag and drop this file on
      the Netscape/Mozilla application icon, the log file will be created
      from the seamonkey folder.<br>
      <strong>ARGS:-mail</strong><br>
      <strong>ENV:NSPR_LOG_MODULES=IMAP:5</strong><br>
      <strong>ENV:NSPR_LOG_FILE=[filename]</strong></p>
    </li>
  </ul>

  <h3><a name="IMAP-Command">IMAP Commands and Execution</a></h3>

    <ol class="uppCase">
      <li>
        <a name="CAPABILITY" id=
        "CAPABILITY"><strong>CAPABILITY</strong></a><br>
        Server MUST send a single untagged CAPABILITY response with
        "IMAP4rel1" as one of the listed capabilities before the (tagged)
        OK response

        <ol>
          <li>Confirm that on initial connect, a CAPABILITY command is
          issued by the client =&gt; IMAP log shows CAPABILITY
          command/listing and its response from the server</li>

          <li>Respect lack of NAMESPACE response

            <ul>
              <li>(Note: Don't ask for namespaces if the server has told us
              they don't support namespaces. <span class="c1">Old Netscape
              servers don't send this response)</span></li>

              <li>=&gt; If the server has not returned "NAMESPACE" in their
              reply, we don't follow up with a "namespace" command shortly
              after connecting.</li>
            </ul>
          </li>

          <li>Respect lack of X-NETSCAPE response

            <ul>
              <li><span class="c1">(Note: Recent Netscape servers send us
              the XSERVERINFO response. I think that's what triggers us to
              know that we can offer client-based server
              admin.)</span></li>

              <li>=&gt; If the server has not sent us the XSERVERINFO in
              the capability response,we shouldn't ask for "XSERVERINFO
              MANAGEACCOUNTURL MANAGELISTSURL MANAGEFILTERSURL."</li>
            </ul>
          </li>
        </ol>
      </li>

      <li>
        <a name=
        "LOGIN-AUTHENTICATE:"><strong>LOGIN/AUTHENTICATE:</strong></a>

        <ol>
          <li>Login when the sever is down. =&gt; Appropriate timeout/error
          message/note and confirmation</li>

          <li>Cancel login before entering the username and the password.
          =&gt; Shold drop the connection to the server</li>

          <li>Username/Password combination:

            <ol class="lowCase">
              <li>Correct password =&gt; IMAP log shows LOGIN OK</li>

              <li>Incorrect password</li>
            </ol>
          </li>
        </ol>
      </li>

      <li>
        <a name="NAMESPACE" id="NAMESPACE"><strong>NAMESPACE</strong></a>

        <ol>
          <li>(If the server responded with NAMESPACE in its capability
          statement) issue a namespace command.(Note: I THINK we're
          supporting multiple namespaces in mail5, UI TBD for all of this
          stuff) =&gt; Check the IMAP log for the namespace command which
          followed by the server's response - IMAP log should show
          namespace request</li>

          <li>LSUB additional namespaces on connect (for servers that
          support namespaces): (Note: We should show an LSUB in the IMAP
          log for each namespace that the server has told us about) =&gt;
          LSUB for each namespace - Confirm that the folders that exist in
          each namespace appear in the folder pane and are
          selectable/usable by the user.</li>

          <li>Load a folder that's in a non-default namespace. (Note:
          Supported namespace types in mail5 TBD. I think we're still going
          to offer other user's and shared namespaces. More granularity of
          test cases after a spec comes out)</li>

          <li>Create a new folder in a non-default namespace.</li>

          <li>Delete a folder in a non-default namespace.</li>

          <li>Copy a message to a folder in a non-default namespace from
          the default namespace.</li>

          <li>Copy a message to a folder in a non-default namespace from
          the default namespace.</li>

          <li>Drag and drop a folder from the default namespace to a
          non-default namespace.</li>

          <li>Drag and drop a folder from a non-default namespace to the
          default namespace.</li>

          <li>Change namespace settings =&gt; Change may require a restart,
          but should be successful. Note steps necessary for success; if
          not very easy, confirm requirement w/eng.</li>

          <li>Make personal namespace be something other than the user's
          server home</li>
        </ol>
      </li>

      <li>
        <a name="SELECT-initial-FETCH-fetch-flags"><strong>SELECT /
        initial FETCH (fetch flags, headers)</strong></a>

        <ol>
          <li>Inbox:

            <ul>
              <li>When a user selects a folder, the server will return the
              following information:<br>
              * select "INBOX"<br>
              * FLAGS (\Answered \Flagged\Draft \Deleted \Seen $Forwarded
              $MDNSent)<br>
              * OK [PERMANENTFLAGS(\Answered \Flagged \Draft\Deleted \Seen
              $Forwarded $MDNSent \*)]<br>
              * 4 EXISTS<br>
              * 0 RECENT<br>
              * OK [UIDVALIDITY 904023909]<br>
              * OK [READ-WRITE] Completed</li>

              <li>
                <p>Note: To the user, selecting is performed by clicking on
                a folder. The IMAP log will show the client running an URL,
                e.g., URL: Loading IMAP://tintin?select&gt;/INBOX &gt;.
                (This test case will actually test SELECT and several
                different forms of FETCH executed by that URL.)</p>

                <p>Being, in order, a listing of the defined types of flag
                for that folder; a listing of the types of permanent flag
                that are possible; how many messages exist; how many of
                those messages are recent (ones the user has not yet seen
                the headers of); the UIDVALIDITY (must be sent by the
                server for all FETCH responses,but we don't do anything
                with it to the best of my knowledge; and the success of
                selecting the folder in, hopefully, read-write mode. After
                the Select returns OK, we do a UID fetch 1* (FLAGS), which
                causes the server to return the flags and UIDs for each of
                the messages in that folder. Next, we do a fetch for all of
                the headers for all of the messages in the folder, in order
                to have to information to populate the thread pane.
                (However, if the summary file already contains that
                information for some of the messages, the request tothe
                server is only made for those messages that are unknown to
                it, as in "11 UID fetch 11564:11572 (UID RFC822.SIZE FLAGS
                BODY.PEEK[HEADER.FIELDS</p>

                <p>(From To Cc Subject Date Priority X-Priority Message-ID
                References Newsgroups Return-Receipt-To
                Disposition-Notification-To)])"</p>

                <p>Finally (if the first message is to be automatically
                loaded upon folder selection), we fetch the body for the
                first message, as in</p>

                <p>" 19 UID fetch 11550 (XSENDER UID RFC822.SIZE BODY[])"
                When testing, confirm that all of the headers and flags are
                displayed in the UI as expected.</p>
              </li>
            </ul>
          </li>

          <li>Default folders

            <ol class="lowCase">
              <li>Sent folder. (Note: If not specified, the folder named is
              presumed to be in a subscribed state)</li>

              <li>Trash folder.</li>

              <li>Drafts folder</li>

              <li>Templates folder</li>
            </ol>
          </li>

          <li>Generic top-level folder</li>

          <li>NoSelect top-level folder (Note:NoSelect folders shouldn't be
          selectable)</li>

          <li>Subscribed folder</li>

          <li>Unsubscribed folder (Not yet defined whether we'll be
          displaying unsubscribed folders

            <ol class="lowCase">
              <li>Subscribed subfolder where parent folder isn't
              subscribed</li>
            </ol>
          </li>

          <li>Top-level folder in a specified IMAP directory (off of the
          user's home directory on the server)</li>

          <li>Second-level folder:

            <ol class="lowCase">
              <li>Subfolder of Inbox <span class="c1">(No such thing with
              Messaging server)</span></li>

              <li>Subfolder in a specified IMAP directory</li>
            </ol>
          </li>

          <li>Empty folder =&gt; All expected communications between server
          and folder should appear in the IMAP log, though there are no
          messages.</li>

          <li>Folders Stress Test:

            <ol class="lowCase">
              <li>Folder 20 levels deep</li>

              <li>Folder that has been deleted by another client that has a
              concurrent session open to this account =&gt; Appropriate
              error message (folder does not exist). We may choose to
              remove this folder from the display immediately, or at the
              next restart. That issue is covered more specifically in the
              DELETE section.</li>

              <li>Folder containing 10k messages =&gt; Note time taken.
              Confirm appropriateness of behavior w/development.</li>

              <li>Folder containing 500 message-containing subfolders.</li>

              <li>Folder that is selected by another client that has a
              concurrent session open to this folder =&gt; No error; I
              think the folder will be opened as read-only, though, not
              read-write. Check log, try to delete message while folder is
              selected to see if its contents can be modified. Confirm
              appropriateness of behavior w/development.</li>
            </ol>
          </li>
        </ol>
      </li>

      <li>
        <a name="FETCH-Body" id="FETCH-Body"><strong>FETCH (body):</strong></a>

          <ol class="uppCase">
            <li>Plain text message (Note: Fetching a message body is also
            initiated with an URL. This one looks like: URL: Loading
            IMAP://tintin?fetch&gt;UID&gt;/INBOX&gt;11501)<br>
            =&gt; The IMAP log will show a line that looks like: 12 UID
            fetch 11501 (XSENDER<br>
            UID RFC822.SIZE BODY[]. At the end of the message, there will
            appear<br>
            something like: "tintin:S-INBOX:STREAM:CLOSE: Normal Message
            End Download Stream STREAM: Normal End Message Download Stream
            Event<br>
            12 OK Completed" Make sure there are no errors in the log, and
            that the message view pane.</li>

            <li>HTML message</li>

            <li>Message with vcard</li>

            <li>Message with sig</li>

            <li>Signed message</li>

            <li>Encrypted message</li>

            <li>Signed and encrypted message</li>

            <li>Message with attached web page</li>

            <li>Message with base64 attachment</li>

            <li>Message with unencoded attachment</li>

            <li>Message with extremely long subject line (300 chars?)</li>

            <li>Message with extremely long to: list</li>

            <li>(rows left to add cases related tovarious TBD preferences
            that may affect fetching)</li>

            <li>Message Stress Test:

              <ol class="lowCase">
                <li>Message with large attachment (5MB) (Note: Some mail
                servers are set up to limit the size of attachments that it
                routes. If this test fails, first check the server
                settingsto see if it has imposed a limit.</li>

                <li>Message with base64 attachment (Note: I don't think the
                form of encoding would make any difference to FETCHING it,
                but it can't hurt to include these tests; it might turn up
                other problems, anyway.</li>
              </ol>
            </li>
          </ol>
      </li>

      <li>
        <a name="FETCH-Biff" id="FETCH-Biff"><strong>FETCH (biff)</strong></a>

        <ol>
          <li>You've got mail! (Note: When we check for new mail, we do
          this by trying to fetch any messages with a message ID of the
          next expected one and higher. =&gt; An example that shows the
          client finding out about one new message, then asking for its
          headers:<br>
          21 UID fetch 11573:<br>
          * (FLAGS)<br>
          * 14 FETCH (FLAGS (\Recent) UID 11573) 21 OK Completed<br>
          22 UID fetch 11573 (UID RFC822.SIZE FLAGS BODY.PEEK[HEADER.FIELDS
          (From To Cc Subject Date Priority X-Priority Message-ID
          References Newsgroups Return-Receipt-To
          Disposition-Notification-To)])</li>

          <li>No new mail. =&gt; An example that shows the client finding
          out that there are no new messages. The server tells us that the
          last message is the one we already know about:<br>
          24 UID fetch 11574:* (FLAGS)<br>
          * 14 FETCH (FLAGS (\Recent) UID 11573)<br>
          24 OK Completed</li>

          <li>Multiple new messages =&gt; Example follows. Note the format
          of the message header fetch for multiple UIDs.<br>
          30 UID fetch 11615:* (FLAGS)<br>
          * 9 FETCH (FLAGS (\Recent) UID 11615)<br>
          * 10 FETCH (FLAGS (\Recent) UID 11616)<br>
          * 11 FETCH (FLAGS (\Recent) UID 11617)<br>
          30 OK Completed<br>
          31 UID fetch 11615:11617(UID RFC822.SIZE<br>
          FLAGS BODY.PEEK[HEADER.FIELDS<br>
          (From To Cc Subject Date Priority X-Priority<br>
          Message-ID References Newsgroups<br>
          Return-Receipt-To<br>
          Disposition-Notification-To)])</li>

          <li>A new message that was already marked read by another client
          with a concurrent connection to the account =&gt; [get log
          example...pretty much the same, except there won't be a \Recent
          flag.]</li>
        </ol>
      </li>

      <li>
        <a name="STORE" id="STORE"><strong>STORE</strong></a>

        <ol>
          <li>Add \Answered flag: (Note: Store is used to add flags to a
          message. This flag can be added by responding to a message. It's
          also initiated with an URL, such as URL: Loading
          IMAP://tintin?addmsgflags&gt;UID&gt;/INBOX&gt;11602&gt;2<br>
          =&gt; The next time the folder is selected, it should show an
          /Answered flag<br>
          with the message. The actual store will look something like
          this:<br>
          20 uid store 11602 +Flags (\Answered) * 5 FETCH (FLAGS
          (\Recent\Answered \Seen) UID 11602) 20 OK Completed IMHO, for all
          of<br>
          these STORE tests, it's best to do a full restart when
          checkingthem...that will show not only that the flag was added,
          but that the addition successfully carries over between
          sessions.[note: check temp flag info in RFC]</li>

          <li>Add \Flagged: (Note: This flag can be added by flagging a
          message.)</li>

          <li>Add \Draft : (Note: [check])</li>

          <li>Add \Deleted: (Note: This flag can be added by deleting a
          message with either the IMAP or move-to-trash delete models.)
          =&gt; If mail5 automatically expunges at exit, permanence of this
          flag may not be able to be checked after a restart.</li>

          <li>Add \Seen: (Note: This flag can be added by displaying a
          message.)</li>

          <li>Add $Forwarded (Note: This flag can be added by forwarding a
          message.)</li>

          <li>Add $MDNSent (Note: This flag can be added by responding to a
          message.)</li>

          <li>Remove\Flagged (Note: Use whatever UI mech is available to
          unflag.) =&gt; Remove flags actions are just like flag additions,
          except for the value of the sign: 20 uid store 11602 -Flags
          (\Flagged)</li>

          <li>Remove\Deleted (Note: Use undo, assuming there is one in the
          UI )</li>

          <li>Remove \Seen (Note:Mark message as unread)</li>

          <li>Add multiple flags to the same messagein the same session
          (Note: There's no reason you couldn't add them all in a session.)
          =&gt; All flags should be successfully added.</li>

          <li>Remove multiple flags in the same session (Note: All of the
          removable flags should be able to be deleted in a given
          session.</li>
        </ol>
      </li>

      <li><a name="UID:" id="UID:"><strong>UID:</strong></a> (Note: Test
      cases for the UID command are inherent in the tests written for
      FETCH, STORE, COPY, and SEARCH test cases.)</li>

      <li>
        <a name="UIDVALIDITY" id=
        "UIDVALIDITY"><strong>UIDVALIDITY</strong></a>

        <ol>
          <li>Any change of unique identifiers between sessions MUST be
          detectable using the UIDVALIDITY mechanism.

            <ol class="lowCase">
              <li>The next unique identifer value will not change unless
              new messages are added to the mailbox.</li>

              <li>The next unique identifer value will change whenever new
              message are added to the mailbox, even if those new messages
              are subsequently expunged</li>

              <li>The unique identifer validity value is sent in an
              UIDVALIDITY response code in an OK untagged response at
              mailbox selection time. If unique identifer from an earlier
              session fail to persist to this session, the unique identifer
              validity value MUST be greater than the one used in the
              earlier session.

                <ul>
                  <li>Test for one IMAP client</li>

                  <li>Test for IMAP Multiple-clients</li>
                </ul>
              </li>
            </ol>
          </li>
        </ol>
      </li>

      <li>
        <a name="LIST" id="LIST"><strong>LIST</strong></a>

        <ol>
          <li>LIST a specific folder (Note: The LIST command returns
          information about a folder or about a subset of folders, based on
          what was passed in as a parameter. In its simplest form, we ask
          it about a particular folder. LISTing the INBOX happens every
          time we connect, near the beginning of the log.) =&gt; 7 list ""
          "INBOX" The server passes back<br>
          information about the folder's name attributes, hierarchy
          delimiter, and name:<br>
          * LIST (\NoInferiors) "/" INBOX 7 OK Completed</li>

          <li>List a subfolder of a regular folder =&gt; 5 list ""
          "personal/sub_of_personal" , followed by the server response:<br>
          * LIST (\HasNoChildren) "/" personal/sub_of_personal 5 OK
          Completed</li>

          <li>LIST a /NoSelect folder (Note: Have a /NoSelect folder in
          your top-level hierarchy. Collapse and expand your server
          hierarchy (if such an action is supported by the UI) The
          /NoSelect folder will be LISTed.) =&gt; 6 list "" "noselect" No
          detailed information will be<br>
          returned, only the "OK." 6 OK Completed.</li>

          <li>LIST a subfolder of a /NoSelect folder (Note: Create a folder
          and subfolder simultaneously, i.e., "folderone/foldertwo". The
          higher-level one will be created as a /NoSelect folder.
          Immediately after the subfolder is created, it will be
          LISTed.)<br>
          =&gt; 5 list "" "noselect/subfolder" Same type of result as for a
          subfolder of a regular folder:<br>
          * LIST (\HasNoChildren) "/" noselect/subfolder 5 OK
          Completed</li>

          <li>LIST with subscription turned off (Note: This list will be
          preceded by the URL "URL:Loading
          IMAP://[servername]?discoverallboxes"<br>
          =&gt; 18 list "" "%" This will return information for all
          top-level folders, then an OK. Immediatly after that, we'll
          request information for the next level of the hierarchy
          down:</li>

          <li>19 list "" "%/%", which will cause to be returned all folder
          information for the second level of folders in the
          hierarchy.</li>
        </ol>
      </li>

      <li>
        <a name="LSUB" id="LSUB"><strong>LSUB</strong></a>

        <ol>
          <li>Initial LSUB on connection to an account<br>
          (Note: LSUB shows which folders are subscribed to by the user. It
          shouldn't matter if the folder was subscribed to by any
          particular client; the folder is either subscribed or it's
          not.)<br>
          =&gt; 5 lsub "" "*" followed by the server's list of all
          subscribed mailboxes.</li>

          <li>Subscription turned off =&gt; No LSUBs should appear in the
          log.</li>

          <li>LSUB when subscribe window is opened.<br>
          (Note: [subscribe window may be totally different in mail5]<br>
          We begin with the URL: URL: Loading
          IMAP://tintin?discoverallandsubscribedboxes)<br>
          =&gt; 8 lsub "" "*" [server responds with list of all
          subscribed]<br>
          9 list "" "%" [server responds with list of all top-level
          folders]</li>

          <li>folders] 10 list "" "%/%" [server responds with list of all
          second-level folders]</li>
        </ol>
      </li>

      <li>
        <a name="CREATE" id="CREATE"><strong>CREATE</strong></a>

        <ol>
          <li>CREATE single top-level folder =&gt; Folder should be created
          and subscribed.</li>

          <li>CREATE container folder &amp; subfolder simultaneously =&gt;
          Folders should be created, and the non-NoSelect folder should be
          subscribed.</li>

          <li>CREATE folder with subscription turned off<br>
          (Note: I think I remember some controversy over this.
          Double-check bug database.) =&gt; Folder should not be
          subscribed?</li>

          <li>CREATE subfolder of a folder that already contains messages
          =&gt; Subfolder should be created and subscribed.</li>

          <li>Stress Test:

            <ol>
              <li>CREATE folder 20 levels deep =&gt; Folder should be
              created and subscribed.</li>
            </ol>
          </li>
        </ol>
      </li>

      <li>
        <a name="DELETE" id="DELETE"><strong>DELETE</strong></a>

        <ol>
          <li>DELETE single top-level folder when the folder is
          selected<br>
          (Note: This section is for deletion of folders. Deletion of
          messages is<br>
          handled through the use of the /Deleted flag (see STORE section
          of test) =&gt; Successful delete.</li>

          <li>DELETE container folder &amp; subfolder simultaneously when
          the subfolder is selected =&gt; Successful delete.</li>

          <li>DELETE subfolder of a folder that already contains messages
          when the folder is selected =&gt; Successful delete.</li>

          <li>DELETE parent folder with multiple subfolders =&gt;
          Successful delete.</li>

          <li>DELETE subscribed folder =&gt; Successful delete.<br>
          DELETE unsubscribed folder (Note: Subscription will probably have
          to be turned off in order to see the folder, but that's really a
          UI issue, and TBD) =&gt; Successful delete.</li>
        </ol>
      </li>

      <li>
        <a name="RENAME" id="RENAME"><strong>RENAME</strong></a>

        <ol>
          <li>RENAME single top-level folder when the folder is selected
          =&gt; Successful delete.</li>
        </ol>

        <ol>
          <li>RENAME parent folder containing a subfolder with
          messages</li>

          <li>RENAME parent folder with multiple subfolders</li>

          <li>RENAME subfolder</li>

          <li>RENAME a subscribed folder</li>

          <li>RENAME an unsubscribed folder (Note: Subscription will
          probably have to be turned off in order to see the folder, but
          that's really a UI issue, and TBD)</li>

          <li>Stress test:<br>
          RENAME a folder 20 levels deep</li>
        </ol>
      </li>

      <li>
        <a name="APPEND" id="APPEND"><strong>APPEND</strong></a>

        <ol>
          <li>APPEND message to INBOX (Note: Ensure that flags, time, date
          are preserved.) =&gt; Successful Append</li>

          <li>APPEND message to non-inbox, top-level folder</li>

          <li>APPEND message to subfolder of NoSelect folder</li>

          <li>APPEND message to subfolder of dual-use folder</li>

          <li>APPEND message to NoSelect folder (Note: UI may not allow
          attempting this) =&gt; Appropriate error message.</li>

          <li>APPEND large message (5MB) to a folder.</li>

          <li>APPEND message to folder from another server</li>

          <li>Stress Test:</li>

          <li>APPEND message to folder 20 levels deep.</li>
        </ol>
      </li>

      <li>
        <a name="NOOP" id="NOOP"><strong>NOOP</strong></a>

        <ol>
          <li>Note: Noop is performed to synch mailbox states; it doesn't
          do anything, though other IMAP commands may be spurred by it.
          There isn't much to test with it except to check and make sure
          that we're not using them excessively (which is a subjective
          call). If there are a lot of noops in the log, check with a
          developer.</li>
        </ol>
      </li>

      <li>
        <a name="CHECK" id="CHECK"><strong>CHECK</strong></a>

        <ol>
          <li>Note: This command is similar to NOOP. I'm not positive why
          we use it...it might be related to synching mailbox state to
          resolve issues related to multiple clients using one account.
          Will add test cases</li>

          <li>if/when it becomes necessary. In any case, it's a
          housekeeping command not related to the success or failure of
          performing the manual actions that the user initiates.</li>
        </ol>
      </li>

      <li>
        <a name="EXPUNGE" id="EXPUNGE"><strong>EXPUNGE</strong></a>

        <ol>
          <li>Expunge automatically; threshold-triggered<br>
          (Note: This command purges folders of deleted messages. This test
          case focuses on the automatic purge of every folder that occurs
          when a folder is opened and it has more than the allowed limit of
          deleted messages) =&gt; The folder EXPUNGE is done, then the
          folder is normally selected and the first message loaded.</li>

          <li>Expunge inbox at exit (Note:This may be a preference in
          mail5. If it's a settable preference, check both positive and
          negativ) =&gt; The INBOX is expunged at application exit.</li>

          <li>Expunge manually (Note:There may be some sort of
          "expunge/compress/compact folder" menu item. It may be
          context-sensitive, allowing more than one folder to be selected
          when it is used. Test whatever makes sense when the UI is
          developed)</li>

          <li>Expunge a folder while another client has a connection to it
          =&gt; Successful expunge. Other client should notice on next
          NOOP, CHECK, or biff (FETCH)</li>

          <li>Empty trash should expunge trash folder (Note: Only relevant
          for trash delete model) =&gt; Successful expunge</li>

          <li>Empty trash while trash folder is selected =&gt; Successful
          expunge</li>
        </ol>
      </li>

      <li>
        <a name="COPY" id="COPY"><strong>COPY</strong></a>

        <ol>
          <li>COPY message from one top-level folder to another (Note:
          Ensure that flags, time, date are preserved) =&gt; Successful
          copy</li>

          <li>COPY message into a subfolder of the source folder</li>

          <li>COPY message into the parent folder of the source folder</li>

          <li>Stress Test:

            <ol>
              <li>COPY message into a folder 20 levels deep</li>
            </ol>
          </li>

          <li>COPY message into each of the special folders (inbox, trash,
          sent, templates, drafts)</li>

          <li>COPY message from one IMAP server to another</li>

          <li>COPY message to nonexistent folder (Note: Delete the folder
          with another client attached to the account) =&gt; Appropriate
          error message.</li>

          <li>COPY large message (5MB) from one folder to another</li>
        </ol>
      </li>

      <li>
        <a name="SUBSCRIBE" id="SUBSCRIBE"><strong>SUBSCRIBE</strong></a>

        <ol>
          <li>Subscribe to a top-level folder that is currently
          unsubscribed (Note: Many of the possibilities of this component
          will be defined by the yet to-be-designed UI)</li>

          <li>Try to subscribe to a NoSelect folder =&gt; Should not be
          possible</li>

          <li>Subscribe to a subfolder when the parent folder is
          subscribed</li>

          <li>Subscribe to a subfolder when the parent folder is not
          subscribed</li>

          <li>Subscribe to a folder three levels down when all parent
          folders are not subscribed</li>

          <li>Subscribe to a folder when subscription is turned off (Note:
          This may or may not be possible)</li>

          <li>Subscribe to a folder (when subscription is turned off) and
          the folder is currently selected</li>

          <li>Subscribe to a empty folder</li>

          <li>Subscribe to a folder with 10k messages</li>

          <li>Stress Test:

            <ol class="lowCase">
              <li>Subscribe to a folder twenty levels deep</li>
            </ol>
          </li>
        </ol>
      </li>

      <li>
        <a name="UNSUBSCRIBE" id=
        "UNSUBSCRIBE"><strong>UNSUBSCRIBE</strong></a>

        <ol>
          <li>Unsubscribe from a top-level folder that is currently
          subscribed</li>

          <li>Try to unsubscribe from a NoSelect folder =&gt; Shouldn't be
          possible</li>

          <li>Unsubscribe from a subfolder when the parent folder is
          subscribed</li>

          <li>Unsubscribe from a subfolder when the parent folder is not
          subscribed</li>

          <li>Unsubscribe from a folder three levels down when all parent
          folders are not subscribed</li>

          <li>Unsubscribe froma folder when subscription is turned off</li>

          <li>Unsubscribe from a folder when the folder is currently
          selected</li>

          <li>Unsubscribe from an empty folder</li>

          <li>Unsubscribe from a folder with 10k messages</li>

          <li>Unsubscribe froma folder twenty levels deep</li>
        </ol>
      </li>

      <li>
        <a name="SEARCH" id="SEARCH"><strong>SEARCH</strong></a>

        <ol>
          <li>SEARCH one folder (Note: Many of these test cases will be
          influenced by the formation of the UI)</li>

          <li>SEARCH multiple folders (in a hierarchy)</li>

          <li>SEARCH a NoSelect folder =&gt; Shouldn't be possible</li>

          <li>SEARCH an unsubscribed folder (Note: May need to have
          subscription turned off to do this)</li>

          <li>SEARCH for non-ascii characters</li>

          <li>SEARCH a folder with 10k messages</li>

          <li>Stress Test:

            <ol class="lowCase">
              <li>SEARCH a folder twenty levels deep</li>
            </ol>
          </li>
        </ol>
      </li>

      <li>
        <a name="LOGOUT" id="LOGOUT"><strong>LOGOUT</strong></a>

        <ol>
          <li>At application exit (Note: Logging out will occur at the end
          of a session and whenever a connection to an inbox is
          intentionally stopped, as when the user doesn't want to wait for
          a large message to finish downloading, and presses Stop. This
          test case is to make sure that we logout when the application
          exits. Check the end of the IMAP log.) =&gt; Last lines should be
          something like:<br>
          HOST?:S-INBOX:NET:WR: xxxx logout<br>
          mozilla IMAP stdout:<br>
          HOST?:S-INBOX:CONTROL:From<br>
          TellThreadToDie: LOGOUT</li>

          <li>During folder load (Note: Press Stop while a folder's headers
          are downloading (after selecting it, before all of the threads
          have displayed. This may be easiest to do the first time loading
          a folder after filing a lot of messages to it, like Trash, or by
          exiting, deleting the summary file, restarting, then selecting
          the folder. =&gt; INTERRUPT Entered</li>

          <li>tintin:S-Trash:NET:WR: xxxx logout</li>
        </ol>
      </li>
    </ol>


  <h3><a name="Additional-Special">Additional Special Tests</a></h3>

    <ol>
      <li>Upgrade to mail5 with an account that had been used with a client
      that supports subscription, such as 4.5 (Note: No "subscription
      wizard" kind of thing has been designed yet for mail5) =&gt; TBD</li>

      <li>Upgrade to mail5 with an account that had been used with a client
      that does not support subscription, such as 4.0x. =&gt; TBD</li>

      <li>Stop actions while they're being performed. =&gt; Mail should
      work fine, new summary files generated.</li>

      <li>Delete local summary files and start mail. =&gt; Mail should work
      fine, new summary files generated.</li>

      <li>Use mail5 in a perfectly clean setup...no local mailfiles, brand
      new server account. =&gt; Mail should work fine.</li>

      <li>Send and receive unusual-content mail.</li>

      <li>(Note: Include vcards, signed &amp; encrypted mails, and mails
      with different attachment types.) =&gt; Mail should work fine.</li>
    </ol>



<hr class="hide">
</div>
</div>
<div id="footer">
<ul>
<li><a href="../../../sitemap.html">Site Map</a></li>
<li><a href="../../../security/">Security Updates</a></li>
<li><a href="../../../contact/">Contact Us</a></li>
<li><a href="../../../foundation/donate.html">Donate</a></li>
</ul>
<p class="copyright">
Portions of this content are &copy; 1998&#8211;2009 by individual mozilla.org
contributors; content available under a Creative Commons license | <a
href="http://www.mozilla.org/foundation/licensing/website-content.html">Details</a>.</p>
<p>
<span>Last modified March 26,  2008</span>
<span><a href="http://bonsai-www.mozilla.org/cvslog.cgi?file=mozilla-org/html/quality/mailnews/tests/sea-mn-imap-commands.html&amp;rev=&amp;root=/www/">Document History</a></span>
</p>
</div>
</div>
</body>
</html>
