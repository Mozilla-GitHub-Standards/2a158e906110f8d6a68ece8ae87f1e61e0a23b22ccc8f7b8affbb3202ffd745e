<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="top" title="Home" href="http://www.mozilla.org/">
<link rel="stylesheet" type="text/css" href="../css/print.css"  media="print">
<link rel="stylesheet" type="text/css" href="../css/base/content.css"  media="all">
<link rel="stylesheet" type="text/css" href="../css/cavendish/content.css" title="Cavendish" media="screen">
<link rel="stylesheet" type="text/css" href="../css/base/template.css"  media="screen">
<link rel="stylesheet" type="text/css" href="../css/cavendish/template.css" title="Cavendish" media="screen">
<link rel="icon" href="../images/mozilla-16.png" type="image/png">

  <meta http-equiv="content-type"
 content="text/html; charset=ISO-8859-1">
  <title>Mozilla Static Build</title>
<script src="../__utm.js" type="text/javascript"></script>
</head>
<body id="www-mozilla-org" class="deepLevel">
<div id="container">
<p class="important">You are currently viewing a snapshot of www.mozilla.org taken on April 21, 2008. Most of this content is
highly out of date (some pages haven't been updated since the project began in 1998) and exists for historical purposes only.  If
there are any pages on this archive site that you think should be added back to www.mozilla.org, please <a
href="https://bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=www.mozilla.org">file a bug</a>.</p>
<p class="skipLink"><a href="#mainContent" accesskey="2">Skip to main content</a></p>
<div id="header">
<h1><a href="/" title="Return to home page" accesskey="1">Mozilla</a></h1>
<ul>
<li id="menu_aboutus"><a href="../about/" title="Getting the most out of your online experience">About</a></li>
<li id="menu_developers"><a href="../developer/" title="Using Mozilla's products for your own applications">Developers</a></li>
<li id="menu_store"><a href="http://store.mozilla.org/?r=mozorg1" title="Shop for Mozilla products on CD and other merchandise">Store</a></li>
<li id="menu_support"><a href="../support/" title="Installation, trouble-shooting, and the knowledge base">Support</a></li>
<li id="menu_products"><a href="../products/" title="All software Mozilla currently offers">Products</a></li>
</ul>
<form id="searchbox_002443141534113389537:ysdmevkkknw" action="http://www.google.com/cse" title="mozilla.org Search">
<div>
<label for="q" title="Search mozilla.org's sites">search mozilla:</label>
<input type="hidden" name="cx" value="002443141534113389537:ysdmevkkknw">
<input type="hidden" name="cof" value="FORID:0">
<input type="text" id="q" name="q" accesskey="s" size="30">
<input type="submit" id="submit" value="Go">
</div>
</form>
</div>
<hr class="hide">
<div id="mBody">
<div id="side">

<ul id="nav">
<li><a title="Roadmap" href="../roadmap.html"><strong> Roadmap</strong></a></li>
<li><a title="Projects" href="../projects/"><strong> Projects</strong></a></li>
<li><a title="For developers" href="../developer/"><strong> Coding</strong></a>
<ul>
<li><a title="Module Owners" href="../owners.html"> Module Owners</a></li>
<li><a title="Hacking" href="../hacking/"> Hacking</a></li>
<li><a title="Get the Source" href="http://developer.mozilla.org/en/docs/Download_Mozilla_Source_Code"> Get the Source</a></li>
<li><a title="Building Mozilla" href="http://developer.mozilla.org/en/docs/Build_Documentation"> Build It</a></li>
</ul>
</li>
<li><a title="Testing" href="../quality/"><strong> Testing</strong></a>
<ul>
<li><a title="Downloads of mozilla.org software releases" href="../download.html"> Releases</a></li>
<li><a title="Latest mozilla builds for testers" href="../developer/#builds"> Nightly Builds</a></li>
<li><a title="For testers to report bugs" href="https://bugzilla.mozilla.org/"> Report A Problem</a></li>
</ul>
</li>
<li><a title="Tools for mozilla developers" href="../tools.html"><strong> Tools</strong></a>
<ul>
<li><a title="Bug tracking system for mozilla testers." href="https://bugzilla.mozilla.org/"> Bugzilla</a></li>
<li><a title="Latest status of mozilla builds" href="http://tinderbox.mozilla.org/showbuilds.cgi?tree=Firefox"> Tinderbox</a></li>
<li><a title="Latest checkins" href="http://bonsai.mozilla.org/cvsqueryform.cgi"> Bonsai</a></li>
<li><a title="Source cross reference" href="http://lxr.mozilla.org/seamonkey/"> LXR</a></li>
</ul>
</li>
<li><a title="Frequently Asked Questions." href="../faq.html"><strong> FAQs</strong></a></li>
</ul>

</div>
<hr class="hide">
<div id="mainContent">




<h1 style="text-align: center;">Mozilla Static Build<br>
</h1>
<hr style="width: 100%; height: 2px;">
<h2><a href="#s1">1. Introduction</a></h2>
<ul>
  <li><a href="#s1.1">1.1 What is a "static build"?</a></li>
  <li><a href="#s1.2">1.2 What is a "Mozilla static build"?</a></li>
  <li><a href="#s1.3">1.3 Why do I want a static build?</a></li>
</ul>
<h2><a href="#s2">2. Mozilla static build variations</a></h2>
<ul>
  <li><a href="#s2.1">2.1 Traditional Mozilla static build</a></li>
  <li><a href="#s2.2">2.2 Embedding static build</a></li>
  <li><a href="#s2.3">2.3 Meta-components static build</a></li>
  <li><a href="#s2.4">2.4 Mozcomps meta-component static build</a></li>
</ul>
<hr style="width: 100%; height: 2px;">
<h2><a name="s1">1. Introduction</a></h2>
<p>This document explains the concept of a Mozilla static build.<br>
</p>
<h3><a name="s1.1"></a>1.1 What is a "static build"?</h3>
<p>Traditionally, a static build refers to the act of linking shared or
dynamic libraries directly into the program executable so that the
executable has no external dependencies upon those libraries. </p>
<h3><a name="s1.2"></a>1.2 What is a "Mozilla static build"?</h3>
<p>In the early days of Mozilla development, Mozilla consisted of
hundreds of shared libraries which represented the individual modules
used by Mozilla.  In mid-2000, an <a
 href="http://bugzilla.mozilla.org/show_bug.cgi?id=46775">effort</a> was
started to allow Mozilla to be built as a static application.  Over the
course of this effort, mozilla.org's definition of a static build
diverged from the traditional definition.  First, the term "static"
refers to the static linking of Mozilla's internal libraries into the
application executable, not the system libraries.  Second, not all of
the internal libraries are statically linked into the executable.
Necessity has dictated that <a
 href="http://bugzilla.mozilla.org/show_bug.cgi?id=46775#c78">certain
libraries</a> remain dynamic.<br>
</p>
<h3><a name="s1.3"></a>1.3 Why do I want a static build?</h3>
<p>Traditional static builds provide a number of advantages.  First,
you can distribute a static executable without needing to worry about
system library dependencies.  Next, by linking the libraries into the
executable, you have eliminated the overhead of shared library calls
which increases the performance of the application.  Finally, static
libraries are usually not compiled as position independent code (PIC)
which signficantly decreases the footprint of the library and your
application when you link against the library. The traditional static
build has one primary disadvantage;&nbsp; you will signficantly increase
the footprint of the application overall when you statically link
portions of the system library into it.<br>
</p>
<p>The Mozilla static build has many of the same advantages as the
traditional static build, including the reduction of shared library
overhead and footprint.  The Mozilla static build also avoids the major
disadvantage of a traditional static build by leaving the system
libraries out of the equation.<br>
</p>
<hr style="width: 100%; height: 2px;">
<h2><a name="s2"></a>2. Mozilla static build variations</h2>
There are a number of variations to the Mozilla static builds.  Each
variation requires that you use the <a
 href="http://lxr.mozilla.org/seamonkey/source/xpcom/components/nsStaticComponent.h">static
component loader</a> to register the statically linked components in
your application.  See <a class="moz-txt-link-freetext"
 href="http://lxr.mozilla.org/seamonkey/source/xpfe/bootstrap/nsAppRunner.cpp#1547">http://lxr.mozilla.org/seamonkey/source/xpfe/bootstrap/nsAppRunner.cpp#1547</a>
and the file generated from <a class="moz-txt-link-freetext"
 href="http://lxr.mozilla.org/seamonkey/source/xpfe/bootstrap/nsStaticComponents.cpp.in">http://lxr.mozilla.org/seamonkey/source/xpfe/bootstrap/nsStaticComponents.cpp.in</a>
. <br>
<h3><a name="s2.1"></a>2.1 Traditional Mozilla static build</h3>
<p>In the traditional Mozilla static build, all of the internal
libraries are linked into the application executable, with the exception
of the aforementioned forced shared libraries.  You can use the standard
configure flags to disable certain modules (ie mailnews) so that they
aren't compiled or linked into the application. <br>
</p>
<p>To build the traditional static build, you need to use the following
configure options:<br>
</p>
<ul>
  <li><code>--disable-shared</code></li>
  <li><code>--enable-static</code></li>
</ul>
<h3><a name="s2.2"></a>2.2 Embedding static build</h3>
<p>With this configuration, you build everything in the tree as you
would for a traditional Mozilla static build but you only link a
pre-defined list of components into your test app.  Generally, this list
comes from the <a
 href="http://lxr.mozilla.org/seamonkey/source/embedding/config/">embedding
manifest files</a>.  This is actually how we link the TestGtkEmbed
application in a traditional Mozilla static build.  If you look at <a
 class="moz-txt-link-freetext"
 href="http://lxr.mozilla.org/seamonkey/source/embedding/browser/gtk/src/Makefile.in#128">http://lxr.mozilla.org/seamonkey/source/embedding/browser/gtk/src/Makefile.in#128</a>
, you'll see some makefile code to work backwards from the traditional
embedding manifest to link only specific libraries into the test
application. You will need to reproduce that makefile code to build your
own embedding applications using this method.<br>
</p>
<h3><a name="s2.3"></a>2.3 Meta-components static build</h3>
<p>There were some features which span multiple libraries and could be
considered runtime optional.  For those features, we created an option
to allow you to merge the individual libraries that compose those groups
of features into a single dynamic library which could be added onto the
static build. Those definitions are stored in <a
 class="moz-txt-link-freetext"
 href="http://lxr.mozilla.org/seamonkey/source/config/config.mk#332">http://lxr.mozilla.org/seamonkey/source/config/config.mk#332</a>
. At the time of this writting, we only support the mail &amp; crypto
meta-components. <br>
</p>
<p>To build the meta-components static build, you need to use the
following configure options:<br>
</p>
<ul>
  <li><code>--disable-shared</code></li>
  <li><code>--enable-static</code></li>
  <li><code>--enable-meta-components=mail,crypto</code></li>
</ul>
<h3><a name="s2.4"></a>2.4 Mozcomps meta-component build</h3>
<p>For every shared library that is created by the build system, there
is an approximately 20k of code overhead for that library.&nbsp; We can
reduce the overall footprint of the application as well as speed up the
loading of component shared libraries by combining those component
shared libraries into a single meta-component shared library.&nbsp; <br>
</p>
<p><span style="font-weight: bold;">Note:</span> This build variant is
different from the previous static builds in that it does <span
 style="font-weight: bold;">NOT</span> statically link the components
against the application binaries.<br>
</p>
<p>To build the mozcomps meta-components static build, you need to use
the following configure options:<br>
</p>
<ul>
  <li><code>--disable-shared</code></li>
  <li><code>--enable-static</code></li>
  <li><code>--enable-meta-components=mozcomps</code></li>
</ul>
<p>You can also combine the meta-components options.&nbsp; Any
components placed into the other meta-components will not end up inside
the mozcomps meta-component.<code></code><br>
</p>
<hr style="width: 100%; height: 2px;"><br>
<p> </p>



<hr class="hide">
</div>
</div>
<div id="footer">
<ul>
<li><a href="../sitemap.html">Site Map</a></li>
<li><a href="../security/">Security Updates</a></li>
<li><a href="../contact/">Contact Us</a></li>
<li><a href="../foundation/donate.html">Donate</a></li>
</ul>
<p class="copyright">
Portions of this content are &copy; 1998&#8211;2009 by individual mozilla.org
contributors; content available under a Creative Commons license | <a
href="http://www.mozilla.org/foundation/licensing/website-content.html">Details</a>.</p>
<p>
<span>Last modified April 24,  2003</span>
<span><a href="http://bonsai-www.mozilla.org/cvslog.cgi?file=mozilla-org/html/build/static-build.html&amp;rev=&amp;root=/www/">Document History</a></span>
</p>
</div>
</div>
</body>
</html>
