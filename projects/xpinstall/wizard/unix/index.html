<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="top" title="Home" href="http://www.mozilla.org/">
<link rel="stylesheet" type="text/css" href="../../../../css/print.css"  media="print">
<link rel="stylesheet" type="text/css" href="../../../../css/base/content.css"  media="all">
<link rel="stylesheet" type="text/css" href="../../../../css/cavendish/content.css" title="Cavendish" media="screen">
<link rel="stylesheet" type="text/css" href="../../../../css/base/template.css"  media="screen">
<link rel="stylesheet" type="text/css" href="../../../../css/cavendish/template.css" title="Cavendish" media="screen">
<link rel="icon" href="../../../../images/mozilla-16.png" type="image/png">

                                                                        
  <meta http-equiv="content-type"
 content="text/html; charset=ISO-8859-1">
  <title>XPInstall :: Install Wizard :: Unix :: Debugging</title>
<script src="../../../../__utm.js" type="text/javascript"></script>
</head>
<body id="www-mozilla-org" class="deepLevel">
<div id="container">
<p class="important">You are currently viewing a snapshot of www.mozilla.org taken on April 21, 2008. Most of this content is
highly out of date (some pages haven't been updated since the project began in 1998) and exists for historical purposes only.  If
there are any pages on this archive site that you think should be added back to www.mozilla.org, please <a
href="https://bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=www.mozilla.org">file a bug</a>.</p>
<p class="skipLink"><a href="#mainContent" accesskey="2">Skip to main content</a></p>
<div id="header">
<h1><a href="/" title="Return to home page" accesskey="1">Mozilla</a></h1>
<ul>
<li id="menu_aboutus"><a href="../../../../about/" title="Getting the most out of your online experience">About</a></li>
<li id="menu_developers"><a href="../../../../developer/" title="Using Mozilla's products for your own applications">Developers</a></li>
<li id="menu_store"><a href="http://store.mozilla.org/?r=mozorg1" title="Shop for Mozilla products on CD and other merchandise">Store</a></li>
<li id="menu_support"><a href="../../../../support/" title="Installation, trouble-shooting, and the knowledge base">Support</a></li>
<li id="menu_products"><a href="../../../../products/" title="All software Mozilla currently offers">Products</a></li>
</ul>
<form id="searchbox_002443141534113389537:ysdmevkkknw" action="http://www.google.com/cse" title="mozilla.org Search">
<div>
<label for="q" title="Search mozilla.org's sites">search mozilla:</label>
<input type="hidden" name="cx" value="002443141534113389537:ysdmevkkknw">
<input type="hidden" name="cof" value="FORID:0">
<input type="text" id="q" name="q" accesskey="s" size="30">
<input type="submit" id="submit" value="Go">
</div>
</form>
</div>
<hr class="hide">
<div id="mBody">
<div id="side">

<ul id="nav">
<li><a title="Roadmap" href="../../../../roadmap.html"><strong> Roadmap</strong></a></li>
<li><a title="Projects" href="../../../../projects/"><strong> Projects</strong></a></li>
<li><a title="For developers" href="../../../../developer/"><strong> Coding</strong></a>
<ul>
<li><a title="Module Owners" href="../../../../owners.html"> Module Owners</a></li>
<li><a title="Hacking" href="../../../../hacking/"> Hacking</a></li>
<li><a title="Get the Source" href="http://developer.mozilla.org/en/docs/Download_Mozilla_Source_Code"> Get the Source</a></li>
<li><a title="Building Mozilla" href="http://developer.mozilla.org/en/docs/Build_Documentation"> Build It</a></li>
</ul>
</li>
<li><a title="Testing" href="../../../../quality/"><strong> Testing</strong></a>
<ul>
<li><a title="Downloads of mozilla.org software releases" href="../../../../download.html"> Releases</a></li>
<li><a title="Latest mozilla builds for testers" href="../../../../developer/#builds"> Nightly Builds</a></li>
<li><a title="For testers to report bugs" href="https://bugzilla.mozilla.org/"> Report A Problem</a></li>
</ul>
</li>
<li><a title="Tools for mozilla developers" href="../../../../tools.html"><strong> Tools</strong></a>
<ul>
<li><a title="Bug tracking system for mozilla testers." href="https://bugzilla.mozilla.org/"> Bugzilla</a></li>
<li><a title="Latest status of mozilla builds" href="http://tinderbox.mozilla.org/showbuilds.cgi?tree=Firefox"> Tinderbox</a></li>
<li><a title="Latest checkins" href="http://bonsai.mozilla.org/cvsqueryform.cgi"> Bonsai</a></li>
<li><a title="Source cross reference" href="http://lxr.mozilla.org/seamonkey/"> LXR</a></li>
</ul>
</li>
<li><a title="Frequently Asked Questions." href="../../../../faq.html"><strong> FAQs</strong></a></li>
</ul>

</div>
<hr class="hide">
<div id="mainContent">



  
          
<div align="center">     
<h2>The Unix Stub Installer</h2>
     Original author: Samir Gehani &lt;<a
 href="mailto:sgehani@netscape.com">sgehani@netscape.com</a>&gt;<br>
   Modified 7/27/02 by Curt Patrick &lt;<a
 href="mailto:curt@netscape.com">curt@netscape.com</a>&gt;<br>
     $Id: debugging.html,v 1.1 2001/06/29 22:27:32 sgehani%netscape.com Exp 
 $<br>
          
<hr align="left" width="100%" size="2">     
<div align="left"><br>
  <a href="#where_does_the_code_reside">Where does the unix stub installer
 code reside?</a><br>
      <a href="#How_do_we_get_setup_to_debug_the_unix">How do we get setup
 to   debug the unix installer?</a><br>
      <a href="#How_we_get_setup_to_debug_the_XPInstall">How we get setup 
to  debug    the XPInstall engine from the unix installer?</a><br>
      <br>
  <a href="#how_do_i_add_a_package">How do I add an installer package to
the  Unix installer?</a><br>
  <br>
  <a href="../index.html#what_do_we_mean_by_installer_package">What do we 
mean by installer package?</a><br>
  <a href="../index.html#What_do_we_mean_by_engine_code">What do we mean
by  engine code?</a><a
 href="../index.html#What_do_we_mean_by_stub_installer_code"><br>
   What do we mean by stub    installer code?</a><br>
      <br>
          
<hr align="left" width="100%" size="2">     
<h3> </h3>
 
<h3><a name="where_does_the_code_reside"></a><small>Where does the unix stub
 installer code reside?</small></h3>
                 The unix stub installer project resides at:<br>
   &lt;<a
 href="http://lxr.mozilla.org/seamonkey/source/xpinstall/wizard/unix/src2/">http://lxr.mozilla.org/seamonkey/source/xpinstall/wizard/unix/src2/</a>&gt; 
 <br>
  <br>
   <br>
    
<h3><a name="How_do_we_get_setup_to_debug_the_unix"></a>How do we get setup 
    to debug the unix stub installer?</h3>
          
<ol>
           <li>Build the unix installer (debug or non-debug target) by typing 
 "make"   in the <a
 href="http://lxr.mozilla.org/seamonkey/source/xpinstall/wizard/unix/src2/">
    src2</a> directory      </li>
           <li>Grab a nightly build, say from &lt;<a
 href="http://ftp.mozilla.org/pub/mozilla/nightly/latest/mozilla-i686-pc-linux-gnu-installer.tar.gz">http://ftp.mozilla.org/pub/mozilla/nightly/latest/mozilla-i686-pc-linux-gnu-installer.tar.gz</a>&gt;</li>
           <li>Gunzip and untar the build to some temporary location like 
/tmp.</li>
           <li>Copy the installer.ini and config.ini files over into the
src2  directory.   &nbsp;&nbsp;</li>
           <li>If you don't want the installer to download then grab a nightly 
 "full"   installer, say from &lt;<a
 href="ftp://ftp.mozilla.org/pub/mozilla/nightly/latest/mozilla-i686-pc-linux-gnu-sea.tar.gz">ftp://ftp.mozilla.org/pub/mozilla/nightly/latest/mozilla-i686-pc-linux-gnu-sea.tar.gz</a>&gt;. 
   &nbsp;Then untar and gunzip this to /tmp. &nbsp;Copy the xpi directory 
  into the src2 directory you are debugging from.<br>
        </li>
           <li>Run the installer from the src2 directory by either using
the  mozilla-installer   shell script or the mozilla-installer-bin binary
with  the appropriate flags.   &nbsp;</li>
           <li>If you need to use gdb to debug the installer run it by typing 
 "gdb   mozilla-installer-bin" on the shell prompt.<br>
        </li>
          
</ol>
          
<h3><a name="How_we_get_setup_to_debug_the_XPInstall"></a>How we get setup 
    to debug the XPInstall engine from the unix stub installer?</h3>
          
<ol>
           <li>Build your entire mozilla tree (which should build the installer 
 in   the src2 directory as well).</li>
           <li>Go to mozilla/xpinstall/packager/unix.</li>
           <li>On the shell prompt type "perl deliver.pl".</li>
           <li>Now you will find an installer *and* the xpcom.xpi and other 
 debug xpis  delivered to mozilla/installer/raw.</li>
           <li>Debug using "gdb mozilla-installer-bin" and set a breakpoint 
 at <tt>   XPI_Init()</tt>.</li>
           <li>You can step into the XPInstall engine through the xpistub 
once  the   xpistub dll is loaded.<br>
        </li>
          
</ol>
          
<hr width="100%" size="2">  
<h3><a name="how_do_i_add_a_package"></a>How do I add an installer package
 to the unix installer?</h3>
 Adding a package involves a few steps:<br>
        
<ol>
    <li>Add a section named for your &lt;component&gt; to the <a
 href="http://lxr.mozilla.org/seamonkey/source/xpinstall/packager/packages-unix"> 
   packages-unix</a> manifest that describes which files from dist belong
 to   which module. &nbsp;For example, see the <a
 href="http://lxr.mozilla.org/seamonkey/source/xpinstall/packager/packages-unix#35"> 
   xpcom section</a> that lists all the shared libraries as seen in dist.
 &nbsp;These   are eventually zipped with the directory structure preserved.
 &nbsp;Read the  top of the packages-unix file for it's simple syntax and
semantics.</li>
    <li>Add an &lt;component&gt;.jst install script template file (the jst
 extension  stands for javascript template indicating this is a template
for  the final  install.js for the &lt;component&gt;.xpi. &nbsp;Checkin the
&lt;component&gt;.jst    to the:&nbsp; &lt;<a
 href="http://lxr.mozilla.org/seamonkey/source/xpinstall/packager/unix">http://lxr.mozilla.org/seamonkey/source/xpinstall/packager/unix</a>&gt;
 directory.   &nbsp;Note that there are two macro strings in the .jsts:&nbsp;</li>
       
  <ol>
      <li><tt>$Version$</tt> which is replaced at packages time with the
browser    version.</li>
      <li><tt>$SpaceRequired$</tt> which is replaced at package time with 
the   amount of space in KB required for the package when it is fully extracted.</li>
       
  </ol>
    <li>Add a [ComponentX] section to the config.ini template file named
config.it    found at: &lt;<a
 href="http://lxr.mozilla.org/seamonkey/source/xpinstall/packager/unix/config.it">http://lxr.mozilla.org/seamonkey/source/xpinstall/packager/unix/config.it</a>&gt;.
   &nbsp;Then add the ComponentX into the appropriate Setup Types so the
   installer module installs it when users select the Setup Types you choose 
it   to be in.</li>
    <li>Finally add a call to generate the xpi at package time by adding
a       <tt>MakeXpiFile("&lt;component&gt;");</tt> call at: &lt;<a
 href="http://lxr.mozilla.org/seamonkey/source/xpinstall/packager/unix/makeall.pl#75"> 
  http://lxr.mozilla.org/seamonkey/source/xpinstall/packager/unix/makeall.pl#75</a>&gt;</li>
    <li>You can test it by changing your current working directory to mozilla/xpinstall/packager/unix 
  and running "<tt>perl deliver.pl</tt>" on the shell prompt. &nbsp;The resulting 
  stub and full installers will be delivered to "mozilla/installer/{stub,sea}".</li>
   
</ol>
  <br>
      </div>
      </div>
       <br>
   <br>
  <br>
 <br>



<hr class="hide">
</div>
</div>
<div id="footer">
<ul>
<li><a href="../../../../sitemap.html">Site Map</a></li>
<li><a href="../../../../security/">Security Updates</a></li>
<li><a href="../../../../contact/">Contact Us</a></li>
<li><a href="../../../../foundation/donate.html">Donate</a></li>
</ul>
<p class="copyright">
Portions of this content are &copy; 1998&#8211;2009 by individual mozilla.org
contributors; content available under a Creative Commons license | <a
href="http://www.mozilla.org/foundation/licensing/website-content.html">Details</a>.</p>
<p>
<span>Last modified August  5,  2002</span>
<span><a href="http://bonsai-www.mozilla.org/cvslog.cgi?file=mozilla-org/html/projects/xpinstall/wizard/unix/index.html&amp;rev=&amp;root=/www/">Document History</a></span>
</p>
</div>
</div>
</body>
</html>
