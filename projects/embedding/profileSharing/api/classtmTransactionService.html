<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<link rel="top" title="Home" href="http://www.mozilla.org/">
<link rel="stylesheet" type="text/css" href="../../../../css/print.css"  media="print">
<link rel="stylesheet" type="text/css" href="../../../../css/base/content.css"  media="all">
<link rel="stylesheet" type="text/css" href="../../../../css/cavendish/content.css" title="Cavendish" media="screen">
<link rel="stylesheet" type="text/css" href="../../../../css/base/template.css"  media="screen">
<link rel="stylesheet" type="text/css" href="../../../../css/cavendish/template.css" title="Cavendish" media="screen">
<link rel="icon" href="../../../../images/mozilla-16.png" type="image/png">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>tmTransactionService class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<script src="../../../../__utm.js" type="text/javascript"></script>
</head>
<body id="www-mozilla-org" class="deepLevel">
<div id="container">
<p class="important">You are currently viewing a snapshot of www.mozilla.org taken on April 21, 2008. Most of this content is
highly out of date (some pages haven't been updated since the project began in 1998) and exists for historical purposes only.  If
there are any pages on this archive site that you think should be added back to www.mozilla.org, please <a
href="https://bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=www.mozilla.org">file a bug</a>.</p>
<p class="skipLink"><a href="#mainContent" accesskey="2">Skip to main content</a></p>
<div id="header">
<h1><a href="/" title="Return to home page" accesskey="1">Mozilla</a></h1>
<ul>
<li id="menu_aboutus"><a href="../../../../about/" title="Getting the most out of your online experience">About</a></li>
<li id="menu_developers"><a href="../../../../developer/" title="Using Mozilla's products for your own applications">Developers</a></li>
<li id="menu_store"><a href="http://store.mozilla.org/?r=mozorg1" title="Shop for Mozilla products on CD and other merchandise">Store</a></li>
<li id="menu_support"><a href="../../../../support/" title="Installation, trouble-shooting, and the knowledge base">Support</a></li>
<li id="menu_products"><a href="../../../../products/" title="All software Mozilla currently offers">Products</a></li>
</ul>
<form id="searchbox_002443141534113389537:ysdmevkkknw" action="http://www.google.com/cse" title="mozilla.org Search">
<div>
<label for="q" title="Search mozilla.org's sites">search mozilla:</label>
<input type="hidden" name="cx" value="002443141534113389537:ysdmevkkknw">
<input type="hidden" name="cof" value="FORID:0">
<input type="text" id="q" name="q" accesskey="s" size="30">
<input type="submit" id="submit" value="Go">
</div>
</form>
</div>
<hr class="hide">
<div id="mBody">
<div id="side">

<ul id="nav">
<li><a title="Roadmap" href="../../../../roadmap.html"><strong> Roadmap</strong></a></li>
<li><a title="Projects" href="../../../../projects/"><strong> Projects</strong></a></li>
<li><a title="For developers" href="../../../../developer/"><strong> Coding</strong></a>
<ul>
<li><a title="Module Owners" href="../../../../owners.html"> Module Owners</a></li>
<li><a title="Hacking" href="../../../../hacking/"> Hacking</a></li>
<li><a title="Get the Source" href="http://developer.mozilla.org/en/docs/Download_Mozilla_Source_Code"> Get the Source</a></li>
<li><a title="Building Mozilla" href="http://developer.mozilla.org/en/docs/Build_Documentation"> Build It</a></li>
</ul>
</li>
<li><a title="Testing" href="../../../../quality/"><strong> Testing</strong></a>
<ul>
<li><a title="Downloads of mozilla.org software releases" href="../../../../download.html"> Releases</a></li>
<li><a title="Latest mozilla builds for testers" href="../../../../developer/#builds"> Nightly Builds</a></li>
<li><a title="For testers to report bugs" href="https://bugzilla.mozilla.org/"> Report A Problem</a></li>
</ul>
</li>
<li><a title="Tools for mozilla developers" href="../../../../tools.html"><strong> Tools</strong></a>
<ul>
<li><a title="Bug tracking system for mozilla testers." href="https://bugzilla.mozilla.org/"> Bugzilla</a></li>
<li><a title="Latest status of mozilla builds" href="http://tinderbox.mozilla.org/showbuilds.cgi?tree=Firefox"> Tinderbox</a></li>
<li><a title="Latest checkins" href="http://bonsai.mozilla.org/cvsqueryform.cgi"> Bonsai</a></li>
<li><a title="Source cross reference" href="http://lxr.mozilla.org/seamonkey/"> LXR</a></li>
</ul>
</li>
<li><a title="Frequently Asked Questions." href="../../../../faq.html"><strong> FAQs</strong></a></li>
</ul>

</div>
<hr class="hide">
<div id="mainContent">


<!-- Generated by Doxygen 1.3-rc3 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; </center>
<hr><h1>tmTransactionService Class Reference</h1><code>#include &lt;<a class="el" href="tmTransactionService_8h-source.html">tmTransactionService.h</a>&gt;</code>
<p>
<a href="classtmTransactionService-members.html">List of all members.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Public Member Functions</h2></td></tr>
<tr><td nowrap align=right valign=top>virtual&nbsp;</td><td valign=bottom><a class="el" href="classtmTransactionService.html#a0">~tmTransactionService</a> ()</td></tr>
<tr><td nowrap align=right valign=top>NS_DECL_ISUPPORTS NS_IMETHOD&nbsp;</td><td valign=bottom><a class="el" href="classtmTransactionService.html#a1">OnMessageAvailable</a> (const nsID &amp;aTarget, const PRUint8 *aData, PRUint32 aDataLength)</td></tr>
<tr><td nowrap align=right valign=top>NS_IMETHOD&nbsp;</td><td valign=bottom><a class="el" href="classtmTransactionService.html#a2">Init</a> (const nsACString &amp;aProfileName)</td></tr>
<tr><td nowrap align=right valign=top>NS_IMETHOD&nbsp;</td><td valign=bottom><a class="el" href="classtmTransactionService.html#a3">Attach</a> (const nsACString &amp;aQueueName, tmITransactionObserver *aObserver)</td></tr>
<tr><td nowrap align=right valign=top>NS_IMETHOD&nbsp;</td><td valign=bottom><a class="el" href="classtmTransactionService.html#a4">Detach</a> (const nsACString &amp;aQueueName)</td></tr>
<tr><td nowrap align=right valign=top>NS_IMETHOD&nbsp;</td><td valign=bottom><a class="el" href="classtmTransactionService.html#a5">Flush</a> (const nsACString &amp;aQueueName)</td></tr>
<tr><td nowrap align=right valign=top>NS_IMETHOD&nbsp;</td><td valign=bottom><a class="el" href="classtmTransactionService.html#a6">PostTransaction</a> (const nsACString &amp;aQueueName, const PRUint8 *aData, PRUint32 aDataLen)</td></tr>
<tr><td colspan=2><br><h2>Protected Member Functions</h2></td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="classtmTransactionService.html#b0">SendMessage</a> (<a class="el" href="classtmTransaction.html">tmTransaction</a> *aTrans)</td></tr>
<tr><td nowrap align=right valign=top>nsresult&nbsp;</td><td valign=bottom><a class="el" href="classtmTransactionService.html#b1">OnAttachReply</a> (<a class="el" href="classtmTransaction.html">tmTransaction</a> *aTrans)</td></tr>
<tr><td nowrap align=right valign=top>nsresult&nbsp;</td><td valign=bottom><a class="el" href="classtmTransactionService.html#b2">OnDetachReply</a> (<a class="el" href="classtmTransaction.html">tmTransaction</a> *aTrans)</td></tr>
<tr><td nowrap align=right valign=top>nsresult&nbsp;</td><td valign=bottom><a class="el" href="classtmTransactionService.html#b3">OnFlushReply</a> (<a class="el" href="classtmTransaction.html">tmTransaction</a> *aTrans)</td></tr>
<tr><td nowrap align=right valign=top>nsresult&nbsp;</td><td valign=bottom><a class="el" href="classtmTransactionService.html#b4">OnPost</a> (<a class="el" href="classtmTransaction.html">tmTransaction</a> *aTrans)</td></tr>
<tr><td nowrap align=right valign=top>nsresult&nbsp;</td><td valign=bottom><a class="el" href="classtmTransactionService.html#b5">DispatchStoredMessages</a> (queue_mapping *aQMapping)</td></tr>
<tr><td nowrap align=right valign=top>PRUint32&nbsp;</td><td valign=bottom><a class="el" href="classtmTransactionService.html#b6">GetQueueID</a> (const nsACString &amp;aQueueName)</td></tr>
<tr><td nowrap align=right valign=top>char *&nbsp;</td><td valign=bottom><a class="el" href="classtmTransactionService.html#b7">GetJoinedQueueName</a> (PRUint32 aQueueID)</td></tr>
<tr><td nowrap align=right valign=top>queue_mapping *&nbsp;</td><td valign=bottom><a class="el" href="classtmTransactionService.html#b8">GetQueueMap</a> (PRUint32 aQueueID)</td></tr>
<tr><td colspan=2><br><h2>Protected Attributes</h2></td></tr>
<tr><td nowrap align=right valign=top><a name="n0" doxytag="tmTransactionService::mProfileName"></a>
nsCString&nbsp;</td><td valign=bottom><b>mProfileName</b></td></tr>
<tr><td nowrap align=right valign=top><a name="n1" doxytag="tmTransactionService::mObservers"></a>
PLHashTable *&nbsp;</td><td valign=bottom><b>mObservers</b></td></tr>
<tr><td nowrap align=right valign=top><a name="n2" doxytag="tmTransactionService::mQueueMaps"></a>
<a class="el" href="classtmVector.html">tmVector</a>&nbsp;</td><td valign=bottom><b>mQueueMaps</b></td></tr>
<tr><td nowrap align=right valign=top><a name="n3" doxytag="tmTransactionService::mWaitingMessages"></a>
<a class="el" href="classtmVector.html">tmVector</a>&nbsp;</td><td valign=bottom><b>mWaitingMessages</b></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
The client side piece of the entire Transaction Service. Code interested in sharing information with other running processes connect through this service and send transactions that will be broadcast out to any processes that have hooked into the Transaction Manager (a module for the IPC daemon) as listeners for the particular profile and domain the sender is broadcasting information for. 
<p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a name="a0" doxytag="tmTransactionService::~tmTransactionService"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> virtual tmTransactionService::~tmTransactionService </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp;          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Reclaim all the memory allocated: PL_hashtable, nsvoidarrays     </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a name="a3" doxytag="tmTransactionService::Attach"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NS_IMETHOD tmTransactionService::Attach </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const nsACString &amp;&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>aQueueName</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>tmITransactionObserver *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>aObserver</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Sends a message to attach to the queue named by the arg passed in and link those transactions to the observer passed in.<p>
<dl compact><dt><b>Returns:</b></dt><dd>NS_OK if everything goes well and the attach message is sent <p>
TM_ERROR_QUEUE_EXISTS if the queue already exists which means someone has already attached to it. <p>
NS_ERROR_OUT_OF_MEMORY if any of the various allocations fail <p>
NS_ERROR_INVALID_ARG if there was a problem creating the transaction </dd></dl>
    </td>
  </tr>
</table>
<a name="a4" doxytag="tmTransactionService::Detach"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NS_IMETHOD tmTransactionService::Detach </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const nsACString &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>aQueueName</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Sends a message to remove the listener from the queue named by the arg passed in. Actual detachment locally doesn't happen until the DETACH_REPLY message is recieved. If the queue named has not been attached to yet this message is queued until the ATTACH_REPLY is received for that queue.<p>
<dl compact><dt><b>Returns:</b></dt><dd>NS_OK if everything goes well and the detach message is sent <p>
NS_ERROR_OUT_OF_MEMORY if any of the various allocations fail <p>
NS_ERROR_INVALID_ARG if there was a problem creating the transaction </dd></dl>
    </td>
  </tr>
</table>
<a name="b5" doxytag="tmTransactionService::DispatchStoredMessages"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> nsresult tmTransactionService::DispatchStoredMessages </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">queue_mapping *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>aQMapping</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Cycle through the collection of transactions waiting to go out and send any that are waiting on an ATTACH_REPLY from the queue specified by the queue_mapping passed in.<p>
<dl compact><dt><b>Returns:</b></dt><dd>NS_OK <p>
NS_ERROR_INVALID_ARG if the queue_mapping passed in is null </dd></dl>
    </td>
  </tr>
</table>
<a name="a5" doxytag="tmTransactionService::Flush"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NS_IMETHOD tmTransactionService::Flush </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const nsACString &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>aQueueName</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Sends a message to flush the queue named by the arg, removing all transactions from that queue. A client should not assume the queue has been flushed until receiving the FLUSH_REPLY message. If the queue named has not been attached to yet this message is queued until the ATTACH_REPLY is received for that queue.<p>
<dl compact><dt><b>Returns:</b></dt><dd>NS_OK if everything goes well and the detach message is sent <p>
NS_ERROR_OUT_OF_MEMORY if any of the various allocations fail <p>
NS_ERROR_INVALID_ARG if there was a problem creating the transaction </dd></dl>
    </td>
  </tr>
</table>
<a name="b7" doxytag="tmTransactionService::GetJoinedQueueName"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> char* tmTransactionService::GetJoinedQueueName </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PRUint32&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>aQueueID</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Returns:</b></dt><dd>the joined queue name - profile name + domain (prefs, cookies etc) corresponding to the ID passed in.  nsnull if the ID is not found. </dd></dl>
    </td>
  </tr>
</table>
<a name="b6" doxytag="tmTransactionService::GetQueueID"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PRUint32 tmTransactionService::GetQueueID </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const nsACString &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>aQueueName</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Returns:</b></dt><dd>the ID corresponding to the queue name passed in <p>
TM_INVALID_ID if the name is not found. </dd></dl>
    </td>
  </tr>
</table>
<a name="b8" doxytag="tmTransactionService::GetQueueMap"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> queue_mapping* tmTransactionService::GetQueueMap </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PRUint32&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>aQueueID</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Returns:</b></dt><dd>the queue_mapping object that contains the ID passed in. <p>
nsnull if the ID is not found. </dd></dl>
    </td>
  </tr>
</table>
<a name="a2" doxytag="tmTransactionService::Init"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NS_IMETHOD tmTransactionService::Init </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const nsACString &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>aProfileName</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This gets the IPC Service and registers as a listener for transaction IPC messages. Some internal storage is created and the profile name that we are interested in is cached.<p>
<dl compact><dt><b>Returns:</b></dt><dd>NS_OK if all goes well <p>
NS_ERROR_FAILURE if we are unable to get the IPC Service or if we fail to initialize the hashtable </dd></dl>
    </td>
  </tr>
</table>
<a name="b1" doxytag="tmTransactionService::OnAttachReply"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> nsresult tmTransactionService::OnAttachReply </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classtmTransaction.html">tmTransaction</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>aTrans</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Pulls the queueID out of the ATTACH_REPLY message and stores it in the proper queue_mapping object. Calls <a class="el" href="classtmTransactionService.html#b5">DispatchStoredMessages()</a> to make sure we send any messages that have been waiting on the ATTACH_REPLY. Also calls the <a class="el" href="classtmTransactionService.html#b1">OnAttachReply()</a> method for the observer of the queue.<p>
<dl compact><dt><b>Returns:</b></dt><dd>NS_OK </dd></dl>
    </td>
  </tr>
</table>
<a name="b2" doxytag="tmTransactionService::OnDetachReply"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> nsresult tmTransactionService::OnDetachReply </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classtmTransaction.html">tmTransaction</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>aTrans</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Removes the queue_mapping object and calls the <a class="el" href="classtmTransactionService.html#b2">OnDetachReply()</a> method on the observer of the queue detached.<p>
<dl compact><dt><b>Returns:</b></dt><dd>NS_OK </dd></dl>
    </td>
  </tr>
</table>
<a name="b3" doxytag="tmTransactionService::OnFlushReply"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> nsresult tmTransactionService::OnFlushReply </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classtmTransaction.html">tmTransaction</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>aTrans</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Calls the OnFlushReply method of the observer of the queue.<p>
<dl compact><dt><b>Returns:</b></dt><dd>NS_OK </dd></dl>
    </td>
  </tr>
</table>
<a name="a1" doxytag="tmTransactionService::OnMessageAvailable"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NS_DECL_ISUPPORTS NS_IMETHOD tmTransactionService::OnMessageAvailable </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const nsID &amp;&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>aTarget</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const PRUint8 *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>aData</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>PRUint32&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>aDataLength</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The transaction is constructed from the raw data and passed on to the proper handler.<p>
<dl compact><dt><b>Returns:</b></dt><dd>NS_OK if everything was successful <p>
NS_ERROR_INVALID_ARG if there was a problem creating the transaction <p>
NS_ERROR_OUT_OF_MEMORY if allocation of space for the copy of the message fails. </dd></dl>
    </td>
  </tr>
</table>
<a name="b4" doxytag="tmTransactionService::OnPost"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> nsresult tmTransactionService::OnPost </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classtmTransaction.html">tmTransaction</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>aTrans</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Calls the OnPost method of the observer of the queue.<p>
<dl compact><dt><b>Returns:</b></dt><dd>NS_OK </dd></dl>
    </td>
  </tr>
</table>
<a name="a6" doxytag="tmTransactionService::PostTransaction"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NS_IMETHOD tmTransactionService::PostTransaction </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const nsACString &amp;&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>aQueueName</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const PRUint8 *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>aData</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>PRUint32&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>aDataLen</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
A transaction is created to add to the queue named in the arg. The Transaction Manager will send a POST_REPLY message to indicate the success of posting the message to the queue. If the queue named has not been attached to yet this message is queued until the ATTACH_REPLY is received for that queue.<p>
<dl compact><dt><b>Returns:</b></dt><dd>NS_OK if everything goes well and the post is sent. <p>
NS_ERROR_OUT_OF_MEMORY if any of the various allocations fail <p>
NS_ERROR_INVALID_ARG if there was a problem creating the transaction </dd></dl>
    </td>
  </tr>
</table>
<a name="b0" doxytag="tmTransactionService::SendMessage"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void tmTransactionService::SendMessage </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classtmTransaction.html">tmTransaction</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>aTrans</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap><code> [protected]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Pulls the raw message out of the transaction and sends it to the IPC service to be delivered to the TM.     </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="tmTransactionService_8h-source.html">tmTransactionService.h</a></ul>
<hr><address style="align: right;"><small>Generated on Mon Feb 24 10:22:51 2003 for transaction manager by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.3-rc3 </small></address>



<hr class="hide">
</div>
</div>
<div id="footer">
<ul>
<li><a href="../../../../sitemap.html">Site Map</a></li>
<li><a href="../../../../security/">Security Updates</a></li>
<li><a href="../../../../contact/">Contact Us</a></li>
<li><a href="../../../../foundation/donate.html">Donate</a></li>
</ul>
<p class="copyright">
Portions of this content are &copy; 1998&#8211;2009 by individual mozilla.org
contributors; content available under a Creative Commons license | <a
href="http://www.mozilla.org/foundation/licensing/website-content.html">Details</a>.</p>
<p>
<span>Last modified February 24,  2003</span>
<span><a href="http://bonsai-www.mozilla.org/cvslog.cgi?file=mozilla-org/html/projects/embedding/profileSharing/api/classtmTransactionService.html&amp;rev=&amp;root=/www/">Document History</a></span>
</p>
</div>
</div>
</body>
</html>
