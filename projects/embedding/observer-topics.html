<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<link rel="top" title="Home" href="http://www.mozilla.org/">
<link rel="stylesheet" type="text/css" href="../../css/print.css"  media="print">
<link rel="stylesheet" type="text/css" href="../../css/base/content.css"  media="all">
<link rel="stylesheet" type="text/css" href="../../css/cavendish/content.css" title="Cavendish" media="screen">
<link rel="stylesheet" type="text/css" href="../../css/base/template.css"  media="screen">
<link rel="stylesheet" type="text/css" href="../../css/cavendish/template.css" title="Cavendish" media="screen">
<link rel="icon" href="../../images/mozilla-16.png" type="image/png">

<title>nsIObserver Topics</title>
<script src="../../__utm.js" type="text/javascript"></script>
</head>
<body id="www-mozilla-org" class="deepLevel">
<div id="container">
<p class="important">You are currently viewing a snapshot of www.mozilla.org taken on April 21, 2008. Most of this content is
highly out of date (some pages haven't been updated since the project began in 1998) and exists for historical purposes only.  If
there are any pages on this archive site that you think should be added back to www.mozilla.org, please <a
href="https://bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=www.mozilla.org">file a bug</a>.</p>
<p class="skipLink"><a href="#mainContent" accesskey="2">Skip to main content</a></p>
<div id="header">
<h1><a href="/" title="Return to home page" accesskey="1">Mozilla</a></h1>
<ul>
<li id="menu_aboutus"><a href="../../about/" title="Getting the most out of your online experience">About</a></li>
<li id="menu_developers"><a href="../../developer/" title="Using Mozilla's products for your own applications">Developers</a></li>
<li id="menu_store"><a href="http://store.mozilla.org/?r=mozorg1" title="Shop for Mozilla products on CD and other merchandise">Store</a></li>
<li id="menu_support"><a href="../../support/" title="Installation, trouble-shooting, and the knowledge base">Support</a></li>
<li id="menu_products"><a href="../../products/" title="All software Mozilla currently offers">Products</a></li>
</ul>
<form id="searchbox_002443141534113389537:ysdmevkkknw" action="http://www.google.com/cse" title="mozilla.org Search">
<div>
<label for="q" title="Search mozilla.org's sites">search mozilla:</label>
<input type="hidden" name="cx" value="002443141534113389537:ysdmevkkknw">
<input type="hidden" name="cof" value="FORID:0">
<input type="text" id="q" name="q" accesskey="s" size="30">
<input type="submit" id="submit" value="Go">
</div>
</form>
</div>
<hr class="hide">
<div id="mBody">
<div id="side">

<ul id="nav">
<li><a title="Roadmap" href="../../roadmap.html"><strong> Roadmap</strong></a></li>
<li><a title="Projects" href="../../projects/"><strong> Projects</strong></a></li>
<li><a title="For developers" href="../../developer/"><strong> Coding</strong></a>
<ul>
<li><a title="Module Owners" href="../../owners.html"> Module Owners</a></li>
<li><a title="Hacking" href="../../hacking/"> Hacking</a></li>
<li><a title="Get the Source" href="http://developer.mozilla.org/en/docs/Download_Mozilla_Source_Code"> Get the Source</a></li>
<li><a title="Building Mozilla" href="http://developer.mozilla.org/en/docs/Build_Documentation"> Build It</a></li>
</ul>
</li>
<li><a title="Testing" href="../../quality/"><strong> Testing</strong></a>
<ul>
<li><a title="Downloads of mozilla.org software releases" href="../../download.html"> Releases</a></li>
<li><a title="Latest mozilla builds for testers" href="../../developer/#builds"> Nightly Builds</a></li>
<li><a title="For testers to report bugs" href="https://bugzilla.mozilla.org/"> Report A Problem</a></li>
</ul>
</li>
<li><a title="Tools for mozilla developers" href="../../tools.html"><strong> Tools</strong></a>
<ul>
<li><a title="Bug tracking system for mozilla testers." href="https://bugzilla.mozilla.org/"> Bugzilla</a></li>
<li><a title="Latest status of mozilla builds" href="http://tinderbox.mozilla.org/showbuilds.cgi?tree=Firefox"> Tinderbox</a></li>
<li><a title="Latest checkins" href="http://bonsai.mozilla.org/cvsqueryform.cgi"> Bonsai</a></li>
<li><a title="Source cross reference" href="http://lxr.mozilla.org/seamonkey/"> LXR</a></li>
</ul>
</li>
<li><a title="Frequently Asked Questions." href="../../faq.html"><strong> FAQs</strong></a></li>
</ul>

</div>
<hr class="hide">
<div id="mainContent">




<h1>nsIObserver Topics</h1>
You can register as an observer of many different events.&nbsp; To
handle these events, you object must implement the <a
 href="http://lxr.mozilla.org/seamonkey/source/xpcom/ds/nsIObserver.idl">nsIObsever</a>
interface.&nbsp; The common way to registry an nsIObserver object is
using the <a
 href="http://lxr.mozilla.org/seamonkey/source/xpcom/ds/nsIObserverService.idl">nsIObserverService</a>
interface.&nbsp; <br>
<br>
These
are the public events outlined below. <br>
<h2>XPCOM Topics</h2>
<table cellpadding="2" cellspacing="2" border="1"
 style="text-align: left; width: 1275px; height: 284px;">
  <tbody>
    <tr>
      <td style="vertical-align: top; font-weight: bold;">Topic Name<br>
      </td>
      <td style="vertical-align: top; font-weight: bold;">Description<br>
      </td>
      <td style="vertical-align: top; font-weight: bold;">How To
Register<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">xpcom-startup<br>
      </td>
      <td style="vertical-align: top;">This notificaiton is sent out
when XPCOM in initally started up.<br>
      </td>
      <td style="vertical-align: top;">You can register for this event
either by using the nsIObserver Service or by adding a <a
 href="http://lxr.mozilla.org/seamonkey/source/xpcom/components/nsICategoryManager.idl">category</a>
entry
under the category of the topic name.&nbsp; The category entry and
value must be the contract id associcated with the object to be
notified.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">xpcom-shutdown<br>
      </td>
      <td style="vertical-align: top;">This notification is sent out
when XPCOM is shutting down.&nbsp; It allows components to
finalize.&nbsp; XPCOM services at that point are no longer available<br>
      </td>
      <td style="vertical-align: top;">You can register for this event
either by using the nsIObserver Service or by adding a <a
 href="http://lxr.mozilla.org/seamonkey/source/xpcom/components/nsICategoryManager.idl">category</a>
entry
under the category of the topic name.&nbsp; The category entry and
value
must be the contract id associcated with the object to be notified.</td>
    </tr>
    <tr>
      <td style="vertical-align: top;">xpcom-autoregistration (start
and end)<br>
      </td>
      <td style="vertical-align: top;">This notification sends out two
topics.&nbsp; When XPCOM beings to registering components in what is
know as auto-registration, a topic with the name of "start" will be
fired.&nbsp; Then when XPCOM completes its auto-registration, a topic
with the name of "stop" will be fired.<br>
      </td>
      <td style="vertical-align: top;">You can register for this event
by using the nsIObserver Service.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">memory-pressure</td>
      <td style="vertical-align: top;">This notification is sent when
the available memory passes some threashold.&nbsp; Clients are expected
to release any nonessential resources.&nbsp; The data parameter will
include information as to why the notification occured.&nbsp; Known
reasons are "low-memory", "alloc-failure", and "heap-minimize".<br>
      </td>
      <td style="vertical-align: top;">You can register for this event
by using the nsIObserver Service.</td>
    </tr>
  </tbody>
</table>
<h2>Profile Topics</h2>
See nsIProfileChangeStatus.idl for more information.&nbsp; Note that
this inteface isn't frozen at the moment.&nbsp; <br>
<table cellpadding="2" cellspacing="2" border="1"
 style="text-align: left; width: 1275px; height: 284px;">
  <tbody>
    <tr>
      <td style="vertical-align: top; font-weight: bold;">Topic Name<br>
      </td>
      <td style="vertical-align: top; font-weight: bold;">Description<br>
      </td>
      <td style="vertical-align: top; font-weight: bold;">How To
Register<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">profile-approve-change<br>
      </td>
      <td style="vertical-align: top;">Called before a profile change
is attempted. Typically, the application level observer will ask the
user if he/she wants to stop all network activity, close all open
windows, etc. If the user says NO, the observer should call the
subject's vetoChange(). If any observer does this, the profile will not
be changed.</td>
      <td style="vertical-align: top;">You can register for this event
by using the nsIObserver Service. </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">profile-change-teardown<br>
      </td>
      <td style="vertical-align: top;">All async activity must be
stopped in this phase. Typically, the application level observer will
close all open windows. This is the last phase in which the subject's
vetoChange() method may still be called. The next notification will be
either profile-change-teardown-veto or profile-before-change.<br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">profile-change-teardown-veto<br>
      </td>
      <td style="vertical-align: top;">This notification will only be
sent, if the profile change&nbsp; was vetoed during the
profile-change-teardown phase. This allows components to bring back
required resources, that were tore down on profile-change-teardown.<br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">profile-before-change</td>
      <td style="vertical-align: top;">Called before the profile has
changed. Use this notification to prepare for the profile going away.
If a component is holding any state which needs to be flushed to a
profile-relative location, it should be done here.<br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">profile-do-change<br>
      </td>
      <td style="vertical-align: top;">Called after the profile has
changed. Do the work to respond to having a new profile. Any change
which affects others must be done in this phase.<br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">profile-after-change<br>
      </td>
      <td style="vertical-align: top;">Called after the profile has
changed. Use this notification to make changes that are dependent on
what some other listener did during its profile-do-change. For example,
to respond to new preferences. <br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">profile-initial-state<br>
      </td>
      <td style="vertical-align: top;">Called after all phases of a
change have completed. Typically in this phase, an application level
observer will open a new window.<br>
      </td>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
  </tbody>
</table>
<h4>Notes:</h4>
Contexts for profile changes. These are passed as the someData param to
the observer's Observe() method.<br>
&nbsp;&nbsp;&nbsp; <br>
"startup"<br>
&nbsp; Going from no profile to a profile. The following topics happen
in this context:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; profile-do-change<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; profile-after-change<br>
"shutdown-persist"<br>
&nbsp; The user is logging out and whatever data the observer stores<br>
&nbsp; for the current profile should be released from memory and<br>
&nbsp; saved to disk.<br>
<br>
"shutdown-cleanse"<br>
&nbsp; The user is logging out and whatever data the observer stores<br>
&nbsp; for the current profile should be released from memory and<br>
&nbsp; deleted from disk.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The following topics happen in
both shutdown contexts:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; profile-approve-change<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; profile-change-teardown<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; profile-before-change<br>
&nbsp;&nbsp;&nbsp;&nbsp; "switch"<br>
<br>
Going from one profile to another.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; All of the above topics happen in
a profile switch.<br>
<h4>Single Profile</h4>
Even with single-profile build, a subset of these notifications are
sent out. <br>
<br>
On startup, in a single-profile build, "profile-do-change" and <br>
"profile-after-change" are sent out when the embedding app calls <br>
nsProfileDirectoryServiceProvider::SetProfileDir(). <br>
<br>
On shutdown, when the embedding app calls
nsProfileDirectoryServiceProvider::Shutdown(), <br>
"profile-before-change" is sent out. This is to allow components which <br>
need to initialize/cleanup to be able to work properly whether <br>
single-profile or not.<br>
<br>
<br>



<hr class="hide">
</div>
</div>
<div id="footer">
<ul>
<li><a href="../../sitemap.html">Site Map</a></li>
<li><a href="../../security/">Security Updates</a></li>
<li><a href="../../contact/">Contact Us</a></li>
<li><a href="../../foundation/donate.html">Donate</a></li>
</ul>
<p class="copyright">
Portions of this content are &copy; 1998&#8211;2009 by individual mozilla.org
contributors; content available under a Creative Commons license | <a
href="http://www.mozilla.org/foundation/licensing/website-content.html">Details</a>.</p>
<p>
<span>Last modified April  5,  2006</span>
<span><a href="http://bonsai-www.mozilla.org/cvslog.cgi?file=mozilla-org/html/projects/embedding/observer-topics.html&amp;rev=&amp;root=/www/">Document History</a></span>
</p>
</div>
</div>
</body>
</html>
