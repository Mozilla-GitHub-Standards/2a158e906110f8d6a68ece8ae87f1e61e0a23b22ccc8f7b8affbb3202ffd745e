
<html>
<head>
<link rel="top" title="Home" href="http://www.mozilla.org/">
<link rel="stylesheet" type="text/css" href="../../../../css/print.css"  media="print">
<link rel="stylesheet" type="text/css" href="../../../../css/base/content.css"  media="all">
<link rel="stylesheet" type="text/css" href="../../../../css/cavendish/content.css" title="Cavendish" media="screen">
<link rel="stylesheet" type="text/css" href="../../../../css/base/template.css"  media="screen">
<link rel="stylesheet" type="text/css" href="../../../../css/cavendish/template.css" title="Cavendish" media="screen">
<link rel="icon" href="../../../../images/mozilla-16.png" type="image/png">

<title>Pluglet Examples</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<script language="JavaScript">
<!--
function MM_openBrWindow(theURL,winName,features) { //v2.0
  window.open(theURL,winName,features);
}

function MM_timelineGoto(tmLnName, fNew, numGotos) { //v2.0
  //Copyright 1997 Macromedia, Inc. All rights reserved.
  var i,j,tmLn,props,keyFrm,sprite,numKeyFr,firstKeyFr,lastKeyFr,propNum,theObj;
  if (document.MM_Time == null) MM_initTimelines(); //if *very* 1st time
  tmLn = document.MM_Time[tmLnName];
  if (numGotos != null)
    if (tmLn.gotoCount == null) tmLn.gotoCount = 1;
    else if (tmLn.gotoCount++ >= numGotos) {tmLn.gotoCount=0; return}
  jmpFwd = (fNew > tmLn.curFrame);
  for (i = 0; i < tmLn.length; i++) {
    sprite = (jmpFwd)? tmLn[i] : tmLn[(tmLn.length-1)-i]; //count bkwds if jumping back
    if (sprite.charAt(0) == "s") {
      numKeyFr = sprite.keyFrames.length;
      firstKeyFr = sprite.keyFrames[0];
      lastKeyFr = sprite.keyFrames[numKeyFr - 1];
      if ((jmpFwd && fNew<firstKeyFr) || (!jmpFwd && lastKeyFr<fNew)) continue; //skip if untouchd
      for (keyFrm=1; keyFrm<numKeyFr && fNew>=sprite.keyFrames[keyFrm]; keyFrm++);
      for (j=0; j<sprite.values.length; j++) {
        props = sprite.values[j];
        if (numKeyFr == props.length) propNum = keyFrm-1 //keyframes only
        else propNum = Math.min(Math.max(0,fNew-firstKeyFr),props.length-1); //or keep in legal range
        if (sprite.obj != null) {
          if (props.prop2 == null) sprite.obj[props.prop] = props[propNum];
          else        sprite.obj[props.prop2][props.prop] = props[propNum];
      } }
    } else if (sprite.charAt(0)=='b' && fNew == sprite.frame) eval(sprite.value);
  }
  tmLn.curFrame = fNew;
  if (tmLn.ID == 0) eval('MM_timelinePlay(tmLnName)');
}

function MM_timelinePlay(tmLnName, myID) { //v1.2
  //Copyright 1997 Macromedia, Inc. All rights reserved.
  var i,j,tmLn,props,keyFrm,sprite,numKeyFr,firstKeyFr,propNum,theObj,firstTime=false;
  if (document.MM_Time == null) MM_initTimelines(); //if *very* 1st time
  tmLn = document.MM_Time[tmLnName];
  if (myID == null) { myID = ++tmLn.ID; firstTime=true;}//if new call, incr ID
  if (myID == tmLn.ID) { //if Im newest
    setTimeout('MM_timelinePlay("'+tmLnName+'",'+myID+')',tmLn.delay);
    fNew = ++tmLn.curFrame;
    for (i=0; i<tmLn.length; i++) {
      sprite = tmLn[i];
      if (sprite.charAt(0) == 's') {
        if (sprite.obj) {
          numKeyFr = sprite.keyFrames.length; firstKeyFr = sprite.keyFrames[0];
          if (fNew >= firstKeyFr && fNew <= sprite.keyFrames[numKeyFr-1]) {//in range
            keyFrm=1;
            for (j=0; j<sprite.values.length; j++) {
              props = sprite.values[j]; 
              if (numKeyFr != props.length) {
                if (props.prop2 == null) sprite.obj[props.prop] = props[fNew-firstKeyFr];
                else        sprite.obj[props.prop2][props.prop] = props[fNew-firstKeyFr];
              } else {
                while (keyFrm<numKeyFr && fNew>=sprite.keyFrames[keyFrm]) keyFrm++;
                if (firstTime || fNew==sprite.keyFrames[keyFrm-1]) {
                  if (props.prop2 == null) sprite.obj[props.prop] = props[keyFrm-1];
                  else        sprite.obj[props.prop2][props.prop] = props[keyFrm-1];
        } } } } }
      } else if (sprite.charAt(0)=='b' && fNew == sprite.frame) eval(sprite.value);
      if (fNew > tmLn.lastFrame) tmLn.ID = 0;
  } }
}

function MM_displayStatusMsg(msgStr) { //v2.0
  //status=msgStr;
  document.form1.textfield.value = msgStr;
  document.MM_returnValue = true;
}

function MM_initTimelines() {
    //MM_initTimelines() Copyright 1997 Macromedia, Inc. All rights reserved.
    var ns = navigator.appName == "Netscape";
    document.MM_Time = new Array(1);
    document.MM_Time[0] = new Array(16);
    document.MM_Time["Timeline1"] = document.MM_Time[0];
    document.MM_Time[0].MM_Name = "Timeline1";
    document.MM_Time[0].fps = 5;
    document.MM_Time[0][0] = new String("sprite");
    document.MM_Time[0][0].slot = 1;
    if (ns)
        document.MM_Time[0][0].obj = document["Image1"];
    else
        document.MM_Time[0][0].obj = document["Image1"];
    document.MM_Time[0][0].keyFrames = new Array(1, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140);
    document.MM_Time[0][0].values = new Array(1);
    document.MM_Time[0][0].values[0] = new Array("images2/g1_2.gif","images2/g2_2.gif","images2/g3_2.gif","images2/g4_2.gif","images2/g5_2.gif","images2/g6_2.gif","images2/g7_2.gif","images2/g8_2.gif","images2/g9_2.gif","images2/g10_2.gif","images2/g11_2.gif","images2/g12_2.gif","images2/g13_2.gif","images2/g14_2.gif","images2/g15_2.gif");
    document.MM_Time[0][0].values[0].prop = "src";
    document.MM_Time[0][1] = new String("behavior");
    document.MM_Time[0][1].frame = 10;
    document.MM_Time[0][1].value = "MM_displayStatusMsg('Background color value changed')";
    document.MM_Time[0][2] = new String("behavior");
    document.MM_Time[0][2].frame = 20;
    document.MM_Time[0][2].value = "MM_displayStatusMsg('Background color set')";
    document.MM_Time[0][3] = new String("behavior");
    document.MM_Time[0][3].frame = 1;
    document.MM_Time[0][3].value = "MM_displayStatusMsg('Background color value displayed')";
    document.MM_Time[0][4] = new String("behavior");
    document.MM_Time[0][4].frame = 30;
    document.MM_Time[0][4].value = "MM_displayStatusMsg('Border value displayed')";
    document.MM_Time[0][5] = new String("behavior");
    document.MM_Time[0][5].frame = 40;
    document.MM_Time[0][5].value = "MM_displayStatusMsg('Border value changed')";
    document.MM_Time[0][6] = new String("behavior");
    document.MM_Time[0][6].frame = 50;
    document.MM_Time[0][6].value = "MM_displayStatusMsg('Border value set')";
    document.MM_Time[0][7] = new String("behavior");
    document.MM_Time[0][7].frame = 60;
    document.MM_Time[0][7].value = "MM_displayStatusMsg('Height value displayed')";
    document.MM_Time[0][8] = new String("behavior");
    document.MM_Time[0][8].frame = 70;
    document.MM_Time[0][8].value = "MM_displayStatusMsg('Height value changed')";
    document.MM_Time[0][9] = new String("behavior");
    document.MM_Time[0][9].frame = 80;
    document.MM_Time[0][9].value = "MM_displayStatusMsg('Height value set')";
    document.MM_Time[0][10] = new String("behavior");
    document.MM_Time[0][10].frame = 90;
    document.MM_Time[0][10].value = "MM_displayStatusMsg('Width value dislayed')";
    document.MM_Time[0][11] = new String("behavior");
    document.MM_Time[0][11].frame = 100;
    document.MM_Time[0][11].value = "MM_displayStatusMsg('Width value changed')";
    document.MM_Time[0][12] = new String("behavior");
    document.MM_Time[0][12].frame = 110;
    document.MM_Time[0][12].value = "MM_displayStatusMsg('Width value set')";
    document.MM_Time[0][13] = new String("behavior");
    document.MM_Time[0][13].frame = 120;
    document.MM_Time[0][13].value = "MM_displayStatusMsg('Align value displayed')";
    document.MM_Time[0][14] = new String("behavior");
    document.MM_Time[0][14].frame = 130;
    document.MM_Time[0][14].value = "MM_displayStatusMsg('Align value changed')";
    document.MM_Time[0][15] = new String("behavior");
    document.MM_Time[0][15].frame = 140;
    document.MM_Time[0][15].value = "MM_displayStatusMsg('Align value set')";
    document.MM_Time[0].lastFrame = 140;
    for (i=0; i<document.MM_Time.length; i++) {
        document.MM_Time[i].ID = null;
        document.MM_Time[i].curFrame = 0;
        document.MM_Time[i].delay = 1000/document.MM_Time[i].fps;
    }
}
//-->
</script>
<script src="../../../../__utm.js" type="text/javascript"></script>
</head>
<body id="www-mozilla-org" class="deepLevel">
<div id="container">
<p class="important">You are currently viewing a snapshot of www.mozilla.org taken on April 21, 2008. Most of this content is
highly out of date (some pages haven't been updated since the project began in 1998) and exists for historical purposes only.  If
there are any pages on this archive site that you think should be added back to www.mozilla.org, please <a
href="https://bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=www.mozilla.org">file a bug</a>.</p>
<p class="skipLink"><a href="#mainContent" accesskey="2">Skip to main content</a></p>
<div id="header">
<h1><a href="/" title="Return to home page" accesskey="1">Mozilla</a></h1>
<ul>
<li id="menu_aboutus"><a href="../../../../about/" title="Getting the most out of your online experience">About</a></li>
<li id="menu_developers"><a href="../../../../developer/" title="Using Mozilla's products for your own applications">Developers</a></li>
<li id="menu_store"><a href="http://store.mozilla.org/?r=mozorg1" title="Shop for Mozilla products on CD and other merchandise">Store</a></li>
<li id="menu_support"><a href="../../../../support/" title="Installation, trouble-shooting, and the knowledge base">Support</a></li>
<li id="menu_products"><a href="../../../../products/" title="All software Mozilla currently offers">Products</a></li>
</ul>
<form id="searchbox_002443141534113389537:ysdmevkkknw" action="http://www.google.com/cse" title="mozilla.org Search">
<div>
<label for="q" title="Search mozilla.org's sites">search mozilla:</label>
<input type="hidden" name="cx" value="002443141534113389537:ysdmevkkknw">
<input type="hidden" name="cof" value="FORID:0">
<input type="text" id="q" name="q" accesskey="s" size="30">
<input type="submit" id="submit" value="Go">
</div>
</form>
</div>
<hr class="hide">
<div id="mBody">
<div id="side">

<ul id="nav">
<li><a title="Roadmap" href="../../../../roadmap.html"><strong> Roadmap</strong></a></li>
<li><a title="Projects" href="../../../../projects/"><strong> Projects</strong></a></li>
<li><a title="For developers" href="../../../../developer/"><strong> Coding</strong></a>
<ul>
<li><a title="Module Owners" href="../../../../owners.html"> Module Owners</a></li>
<li><a title="Hacking" href="../../../../hacking/"> Hacking</a></li>
<li><a title="Get the Source" href="http://developer.mozilla.org/en/docs/Download_Mozilla_Source_Code"> Get the Source</a></li>
<li><a title="Building Mozilla" href="http://developer.mozilla.org/en/docs/Build_Documentation"> Build It</a></li>
</ul>
</li>
<li><a title="Testing" href="../../../../quality/"><strong> Testing</strong></a>
<ul>
<li><a title="Downloads of mozilla.org software releases" href="../../../../download.html"> Releases</a></li>
<li><a title="Latest mozilla builds for testers" href="../../../../developer/#builds"> Nightly Builds</a></li>
<li><a title="For testers to report bugs" href="https://bugzilla.mozilla.org/"> Report A Problem</a></li>
</ul>
</li>
<li><a title="Tools for mozilla developers" href="../../../../tools.html"><strong> Tools</strong></a>
<ul>
<li><a title="Bug tracking system for mozilla testers." href="https://bugzilla.mozilla.org/"> Bugzilla</a></li>
<li><a title="Latest status of mozilla builds" href="http://tinderbox.mozilla.org/showbuilds.cgi?tree=Firefox"> Tinderbox</a></li>
<li><a title="Latest checkins" href="http://bonsai.mozilla.org/cvsqueryform.cgi"> Bonsai</a></li>
<li><a title="Source cross reference" href="http://lxr.mozilla.org/seamonkey/"> LXR</a></li>
</ul>
</li>
<li><a title="Frequently Asked Questions." href="../../../../faq.html"><strong> FAQs</strong></a></li>
</ul>

</div>
<hr class="hide">
<div id="mainContent">




<center>
<h1>Pluglet Developers Guide</h1>
<h2>Pluglet Examples</h2></center>
 
<div align="center">
<p>
     <a href="index.html">overview</a>
   | <a href="mime_manifest.html">MIME types</a>
   | <a href="display.html"> display modes </a>
   | <a href="../api/index.html">API index</a></font></p></div>

<h2>Java Media Player (JMPlayer) Example</h2>
<h4>Overview</h4>
<p>This is an example of a Pluglet that is a media player. It uses 
   the MediaPlayer 
   <a href="http://www.javasoft.com/docs/books/tutorial/javabeans/index.html">
   bean</a> from the Java Media Framework. Note that a similar example 
   could be given for an applet using the MediaPlayer, but there is an 
   advantage here: the Pluglet is installed in the browser and ready to 
   play, whereas the applet would have to download class files, causing 
   considerable delay in playing the media.</p>

<h4>Using Java Media Framework</h4>

<p>The example uses one bean from the Java Media Framework 
   (<code>javax.media.bean.playerbean.MediaPlayer</code>) 
   and one interface (<code>javax.media.ControllerListener</code>). 
   MediaPlayer provides player capability for a range of media types 
   (<code>.avi</code>, <code>.mpeg</code>, <code>.swf</code>,<code> .
   mov</code> ....) Typically the <code>ControllerListener</code> i
   interface is implemented by a class whose objects want to be listeners to 
   events occurring on objects of another class; it has one method, 
   <code>controllerUpdate(ControllerEvent event)</code> that can be used 
   to respond in some way to a <code>Controller</code> event. A <
   code>ControllerListener</code> is added to a <code>Controller</code> v
   ia the <code>addControllerListener
   (ControllerListener listener)</code> method of the <
   code>Controller</code>. 
   (In our example, <code>MediaPlayer</code> is a <code>Controller</code>, s
   since it extends <code>javax.media.Controller</code>, and <
   code>Player</code> is the class that implements 
   <code>ControllerListener</code>. Thus a <code>Player</code> 
   object gets notification of events from a <code>MediaPlayer</code> b
   bean.)</p>

<p>For more information about the Java Media Framework, see 
   <a href="http://jsp.java.sun.com/products/java-media/jmf/">
   http://jsp.java.sun.com/products/java-media/jmf/</a></p>

<h4>JMPlayer Pluglet</h4>
<p>The following is meant to provide an overview of how this Pluglet 
  works. </p>

<p>Press the button to view the source code: 
<form name="View Source">
  <div align="left"> 
    <input type="button" name="Button" value="View JMPlayer.java" 
    onClick="MM_openBrWindow('example_source/JMPlayer.html','',
    'scrollbars=yes,resizable=yes,width=800,height=600')">
  </div>
</form>
  
<p>When the browser encounters a <a href="mime_manifest.html">MIME type</a> 
   for this Pluglet, <code>PlugletEngine</code> creates an instance o
   of <code>JMPlayer</code>. 
   (Here the <code>PlugletFactory</code> implementation is 
   <code>JMPlayer</code>; the <code>Pluglet</code> implementation 
  is <code>Player</code>; and the <code>PlugletStreamListener</code> 
  implementation is<code> JMPlayerStreamListener</code>.) </p>

<p>The browser then calls the <code>initialize()</code> method of 
  <code>JMPlayer</code>, passing it an instance of 
  <code>PlugletManager</code>. Then it calls the <code>createPluglet()
  </code> method of <code>JMPlayer</code>, returning an instance of 
  <code>Pluglet</code>, i.e., an instance of <code>Player</code>. 
  Note that <code>Player</code> implements <code>ControllerListener</code> 
  in addition to <code>Pluglet</code>.</p>
  
<p>The browser then initializes the <code>Player</code> instance, passing 
   it an instance of <code>PlugletPeer</code>, provides it with a frame 
   by calling <code>setWindow(Frame frame)</code>, and calls <code>start()
   </code>. <code>start()</code> creates the <code>MediaPlayer</code> 
   object called <code>player</code> (not to be confused with the 
   <code>Player</code> class), creates a new <code>Panel </code>object 
   called <code>panel</code>, and adds <code>player</code> to <code>panel
   </code>. The stage is now set for action.</p>

<p>When data is ready to be read, the browser calls the <code>newStream()
   </code> method of <code>Player</code>, returning <code>listener</code>, 
   an instance of <code>JMPlayerStreamListener</code>. <code>newStream()
   </code> also calls <code>listener.setPlayer()</code> and passes a 
   reference to the current <code>Player</code> object to it. (This would 
   be the new <code>Player</code> created by the factory.) This method sets 
   the variable <code>jmp</code> (of type <code>Player</code>) of 
   <code>JMPlayerStreamListener</code> to the <code>Player</code> that is 
   passed. </p>

<p>When the media begins loading and the brower calls <code>onStartBinding()
   </code>, <code>jmp.PlayFile()</code> is called with the URL for the data 
   stream. (The <code>boolean</code> returned is checked and an error is 
   indicated if the value is <code>false</code>; i.e., if <code>player
   </code> is unable to handle the MIME type of the URL.) <code>PlayFile()
   </code> sets the location of the media (URL), and if all is well it 
   then adds the <code>Player</code> (<code>jmp</code> of 
   <code>JMPlayerStreamListener</code> which called <code>playFile()</code>) 
   as a listener to the <code>MediaPlayer</code> (<code>player</code>). 
   Finally, it calls <code>realize()</code> on <code>player</code>. 
   (<code>realize()</code> constructs the media-dependent portions of the 
   <code>Controller</code>.)</p>

<p>(Note that <code>jmp</code> mentioned above was set in 
   <code>JMPlayerStreamListener</code> when the <code>Player</code> 
   object was passed to <code>listener.setPlayer()</code> in the 
   <code>newStream()</code> method of <code>Player</code>. Thus 
   <code>jmp</code> is the new <code>Player</code> object created 
   initially by the factory, <code>JMPlayer</code>.)</p>

<p>Since the <code>Player</code>, <code>jmp</code>, is now a listener 
  (<code>ControllerListener</code>) to <code>player</code>, 
  <code>jmp</code> gets notification when <code>RealizeCompleteEvent</code> 
  occurs, and <code>controllerUpdate()</code> then calls 
  <code>player.prefetch()</code>. When prefetching is complete, a 
  <code>PrefetchCompleteEvent</code> is generated, indicating that the 
  controller has preloaded media data and acquired the exclusive-use 
  resources it needs to start. When a <code>PrefetchCompleteEvent</code> 
  occurs, dimensions are set for the <code>Panel</code>, 
  <code>player.start()</code> is called (not to be confused with the 
  <code>start()</code> method of <code>Player</code>), and the frame  appears.
   </p>

<p>If all goes well, the media is played.</p>

<h2>Java DOM Viewer Example</h2>
<h4 align="left">Overview</h4>

<p>The Java 
   <a href="http://www.w3.org/TR/2000/PR-DOM-Level-2-Core-20000927/introduction.html">
   DOM</a> Viewer (<code>DOMViewer</code>) Pluglet allows you 
   to view a document as a tree structure of object nodes that compose 
   the document. It is an application launched as a Pluglet when a page 
   is loaded containing an <code>EMBED</code> or <code>OBJECT</code> 
   element specifying <code>TYPE=&quot;application/dom-viewer&quot;</code>.</p>

<p>The <code>EMBED</code> or <code>OBJECT</code> element is embedded 
  in the page as the first child element of the <code>BODY</code> element.</p>

<p>This Pluglet depends on the Java DOM implementation, i.e., it acquires access to the DOM via the 
   implementation of the w3c Java Bindings to the DOM. Thus you must h
   have built the Java DOM for this example to work, and 
   you must have the <code>org.w3c.dom</code> classes in your 
   <code>CLASSPATH</code>.</p>
   
<p>The example uses three files with a total of six classes and one 
  interface:</p>

<p></b>file: <code>DOMViewFactory.java</code></b></p>
<blockquote> 
  <p><code>class DOMViewerFactory<br>
    interface DOMTreeNotifier<br>
    class DOMTreeModel<br>
    class DOMCellRenderer<br>
    class DOMViewer</code></p>
</blockquote>

<p><b>file: <code>DOMAccessPanel.java</code></b></p>
<blockquote> 
  <p><code>class DOMAccessPanel</code></p>
</blockquote>
<p><b>file: <code>DOMTreeDumper.java</code></b></p>
<blockquote> 
  <p><code>class DOMTreeDumper</code></p>
</blockquote>
<p>To view the source code, select:</p>
<form method="post" action="">
  <input type="button" name="Button" value="View DOMViewerFactory.java" onClick="MM_openBrWindow('example_source/DOMViewerFactory.html','','scrollbars=yes,resizable=yes,width=800,height=600')">
  <input type="button" name="Submit2" value="View DOMAccessPanel.java" onClick="MM_openBrWindow('example_source/DOMAccessPanel.html','','scrollbars=yes,resizable=yes,width=800,height=600')">
  <input type="button" name="Submit3" value="View DOMTreeDumper.java" onClick="MM_openBrWindow('example_source/DOMTreeDumper.html','','scrollbars=yes,resizable=yes,width=800,height=600')">
</form>
<p>Note: The information that follows provides an overview of 
   the code. </p>

<h4>DOMViewerFactory.java</h4>
<p>The <code>DOMViewerFactory</code> class, which this file contains, 
   implements <code>Pluglet Factory</code>. Thus it creates an instance 
   of <code>DOMViewer</code>, which implements <code>Pluglet</code>.</p>

<p>The <code>initialize()</code> method of <code>DOMViewer</code> does 
   much of the work in two code blocks: </p>

<p>In the first code block, the goal is to set the root node for the 
   DOM tree. This is accomplished by getting the <code>PlugletTagInfo<
   </code> 
   for the <code>PlugletPeer</code>, next getting the DOM element for 
   the <code>Pluglet</code> via the <code>getDOMElement()</code> 
   method of <code>PlugletTagInfo</code>, then getting the 
   <code>Document (doc object)</code> for the element via the element's 
   <code>getOwnerDocument()</code> method. Finally, the element for 
   <code>Document doc</code> is obtained via the <code>getDocumentElement()
   </code> method of <code>Document</code>. This element is then set as 
   the root node (<code>rootNode</code>).</p>

<p>In the second code block, an instance of <code>DOMTreeModel</code> is 
   created with <code>rootNode</code> passed as <code>node</code>. 
   (<code>DOMTreeModel </code>implements <code>javax.swing.tree.TreeModel 
   </code>and the <code>DOMTreeNotifier</code> interface that is defined 
   in <code>DOMViewerFactory.java</code>. <code>TreeModel</code> includes 
   methods for adding listeners and obtaining basic information about 
   a tree; <code>DOMTreeNotifier</code> includes methods for notification 
   when a tree has changed.) The instance is <code>treeModel</code>. 
   <code>treeModel</code> is then passed to a new instance of 
   <code>DOMAccessPanel</code> called <code>elementPanel</code>, so that 
   the tree can be manipulated. (<code>DOMAccessPanel</code> is discussed 
   in the next section.) It is also passed to a new instance of 
   <code>JTree</code> called <code>tree</code> so that it can be viewed. 
   <code>tree</code> adds <code>elementPanel</code> as a selection listener 
   and sets a cell renderer. <code>tree</code> is then added to a new 
   <code>JScrollPane</code> and then the <code>JScrollPane</code> instance 
   (<code>treePane</code>) is added to a new <code>JPanel</code> 
   (<code>panel</code>). </p>
   
<p>The <code>setWindow()</code> method of the <code>Pluglet</code> then 
   adds <code>panel</code> and <code>elementPanel</code> to a 
   <code>JFrame</code> object (<code>frame</code>) via a vertical 
   <code>JSplitPane</code> object, displaying <code>panel</code> on the 
   top (with the tree structure) and the various buttons, fields, and 
   combo boxes of <code>elementPanel</code> below for manipulation.</p>

<p>Below is the <code>DOMViewer</code> for<code> test.html</code>, which is 
   included in the <code>Pluglet</code> <code>examples/dom</code> 
   directory: </p>
   
<p align="center"><img src="images/DOMViewer.gif" width="216" height="550">
</p>

<p>Note that the <code>newStream()</code> method returns a <code>null</code> 
   object; there is no data stream involved in this example. <code>start()
   </code>, <code>stop()</code>, and <code>destroy()</code> are included 
   but have neither variables nor methods defined.</p>
   
<h4>DOMAccessPanel.java</h4>

<p><code>DOMAccessPanel.java</code> extends <code>JPanel</code> and 
   implements three listener interfaces:</p>
<ul>
  <li><code>ActionListener</code></li>
  <li><code>ItemListener</code></li>
  <li><code>TreeSelectionListener</code></li>
</ul>

<p>The constructor sets up the various panels, text areas, and buttons 
   used to manipulate the DOM.</p>
   
<p>An instance of <code>DOMTreeNotifier</code> is passed to the 
   constructor, which allows an instance of <code>DOMAccessPanel</code> 
   to discover if the tree has changed in some way.</p>
   
<h4>ActionListener</h4>
<p>To implement <code>ActionListener</code>, <code>DOMAccessPanel</code> 
   implements <code>actionPerformed(ActionEvent e)</code>. 
   <code>actionPerformed(...) </code>responds to the various  button-
   accessible events on the panel (<b>Set</b>, <b>Remove</b>, <b>New</b>, 
   <b>Insert</b> ...).</p>

<h4>ItemListener</h4>
<p>To implement <code>ItemListener</code>, <code>DOMAccessPanel</code> 
   implements <code>itemStateChanged(ItemEvent e)</code>. An 
   <code>ItemEvent</code> occurs when an item -- in this case a node -- 
   is selected or deselected.<code> itemStateChanged()</code> then 
   responds to that event.</p>

<p align="center"><img src="images/itemStateChanges2.gif" width="450" height="550">
   </p>
   
<p>If <code>node</code> is not <code>null</code> and there is a selected 
   item in the Attributes combo box (bottom left <code>JComboBox</code> 
   as shown above highlighted in yellow), then the <b>Set</b> button 
   (type <code>JButton</code>) is enabled. If <code>node.getAttributes()
   </code> returns a <code>NamedNodeMap</code> (e.g., not <code>null</code>) 
   and the index of the selected named attribute is 0 or greater 
   (<code>aName.getSelectedIndex() &gt;= 0</code>), then the value 
   of the attribute is set as follows:</p>

<p><code>aValue.setText(attrMap.item(aName.getSelectedIndex()).getNodeValue()
   );</code></p>

<p>where <code>attrMap = node.getAttributes()</code></p>

<p>Thus the text for the value (<code>aValue</code> of the 
   <code>JTextField</code>) is set by (1) getting the index of the name 
   (<code>aName</code>); (2) passing that to the<code> item()</code> 
   method of the <code>NamedNodeList</code> (of attributes), which returns 
   the node (attribute-node); (3) then applying the <code>getNodeValue()
   </code> method of<code> node</code> to the attribute-node. The user 
   can also enter a new value, and with the <b>Set</b> button enabled, 
  the <code>actionPerformed()</code> method will update the value when 
  <b>Set</b> is pressed.</p>
  
<h4>TreeSelectionListener</h4>

<p>To implement <code>TreeSelectionListener</code>, <code>DOMAccessPanel
   </code> implement the <code>valueChanged(TreeSelectionEvent e)</code> 
   method. Then, when a <code>TreeSelectionEvent</code> occurs on the tree, 
   <code>valueChanged()</code> is passed the event and checks if a path 
   has been added via <code>e.isAddedPath()</code>. If so, the node 
   information for the last node in the path is updated. 
   <code>valueChanged()</code> then sets <code>nodePath</code> to the 
   new node path, and from the event it sets <code>tree</code> to the 
   source of the event.</p>
   
<p>The <code>DOMAccessPanel</code> class also contains methods to 
   update node information, create, insert, append, and remove a node, 
   as well as save the changes to a document. The <code>saveDoc()</code> 
   method uses the <code>DOMTreeDumper</code> class, which is discussed 
   next.</p>
   
<h4>DOMTreeDumper.java</h4>

<p><code>saveDoc()</code> in <code>DOMAccessPanel</code> creates an 
   instance of <code>DOMTreeDumper</code> (if there isn't one already) 
   and calls the <code>dumpToFile()</code> method of <code>DOMTreeDumper
   </code>, passing a file name and the document associated with the 
   node.</p>
   
<p><code>dumpToFile()</code> then creates a new file output stream 
   (<code>fos</code>) and print stream (<code>ps</code>) and calls 
   <code>dumpDocument()</code>, passing to it the document 
   (<code>doc</code>). <code>dumpDocument()</code> then gets the document 
   element -- i.e., the root element of the document via the 
   <code>doc.getDocumentElement()</code> -- and calls <code>dumpNode()
   </code>, passing the document element to it.</p>
   
<p><code>dumpNode()</code> then gets the node type, as well as the node 
   name and value. type is <code>ELEMENT_NODE</code> (the element is 
   <code>HTML</code> element), so control is transferred to <code>case 
   Node.ELEMENT_NODE</code> and <code>dumpAttribute(node)</code> and 
   <code>dumpChildren(node)</code>get called.</p>
   
<p>The first method calls <code>dumpNode()</code> for each attribute of 
   the <code>HTML</code> element; the second method calls 
   <code>dumpNode()</code> for the children. If the children have 
   children, then the children will call <code>dumpNode()</code> 
   for all their children. Eventually, every node of every type in the 
   tree will be dumped.</p>
   
<h3>DOM Demo</h3>

<p>Below is a demonstation you can run showing how DOMViewer can change 
   DOM element attribute values on a web page. The demo here uses a 
   page containing a table with a single row and column that initally 
   has a background color of red (<code>bgcolor=#ff6666</code>), no 
   border (<code>border=0</code>), table height and width of 125 
   (<code>height=125</code>, <code>width=125</code>, and that is aligned 
   in the center of the page (<code>align=center</code>).</p>

<p>The demo shows the table attribute values being changed. First the value is 
  highlighted in yellow as it is changed, then the <b>Set</b> button is highlighted 
  as it is pushed, causing the new valued to take effect in the Mozilla browser. 
  The <b>Description</b> field above the <b>Start Demo</b> button tells you what 
  is happening. </p>
<p>&nbsp;</p>
<p align="center"><img src="images2/g1_2.gif" width="800" height="450" name="Image1" border="3" align="middle"></p>
<form method="post" action="" name=form1>
  <div align="center"><b><font size="3" face="Arial, Helvetica, sans-serif">Description:</font></b> 
    <input type="text" name="textfield" size="30" value="">
  </div>
</form>
<form method="post" action="" name=form2>
  <div align="center">
    <input type="button" name="Button" value="Start Demo" onClick="MM_timelineGoto('Timeline1','1');MM_timelinePlay('Timeline1')">
  </div>
</form>

<SCRIPT LANGUAGE="JavaScript">
document.form1.textfield.value="";
</SCRIPT>
<HR>
<H5>Blackwood Release 0.9/Netscape PR3  Last modified 2/05/2001</H5>




<hr class="hide">
</div>
</div>
<div id="footer">
<ul>
<li><a href="../../../../sitemap.html">Site Map</a></li>
<li><a href="../../../../security/">Security Updates</a></li>
<li><a href="../../../../contact/">Contact Us</a></li>
<li><a href="../../../../foundation/donate.html">Donate</a></li>
</ul>
<p class="copyright">
Portions of this content are &copy; 1998&#8211;2009 by individual mozilla.org
contributors; content available under a Creative Commons license | <a
href="http://www.mozilla.org/foundation/licensing/website-content.html">Details</a>.</p>
<p>
<span>Last modified February 20,  2001</span>
<span><a href="http://bonsai-www.mozilla.org/cvslog.cgi?file=mozilla-org/html/projects/blackwood/java-plugins/guide/examples.html&amp;rev=&amp;root=/www/">Document History</a></span>
</p>
</div>
</div>
</body>
</html>
