<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<link rel="top" title="Home" href="http://www.mozilla.org/">
<link rel="stylesheet" type="text/css" href="../../../css/print.css"  media="print">
<link rel="stylesheet" type="text/css" href="../../../css/base/content.css"  media="all">
<link rel="stylesheet" type="text/css" href="../../../css/cavendish/content.css" title="Cavendish" media="screen">
<link rel="stylesheet" type="text/css" href="../../../css/base/template.css"  media="screen">
<link rel="stylesheet" type="text/css" href="../../../css/cavendish/template.css" title="Cavendish" media="screen">
<link rel="icon" href="../../../images/mozilla-16.png" type="image/png">

    <title>Extension Versioning</title>
    <link rel="stylesheet" type="text/css" href="http://www.mozilla.org/css/base/content.css">
  <script src="../../../__utm.js" type="text/javascript"></script>
</head>
<body id="www-mozilla-org" class="deepLevel">
<div id="container">
<p class="important">You are currently viewing a snapshot of www.mozilla.org taken on April 21, 2008. Most of this content is
highly out of date (some pages haven't been updated since the project began in 1998) and exists for historical purposes only.  If
there are any pages on this archive site that you think should be added back to www.mozilla.org, please <a
href="https://bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=www.mozilla.org">file a bug</a>.</p>
<p class="skipLink"><a href="#mainContent" accesskey="2">Skip to main content</a></p>
<div id="header">
<h1><a href="/" title="Return to home page" accesskey="1">Mozilla</a></h1>
<ul>
<li id="menu_aboutus"><a href="../../../about/" title="Getting the most out of your online experience">About</a></li>
<li id="menu_developers"><a href="../../../developer/" title="Using Mozilla's products for your own applications">Developers</a></li>
<li id="menu_store"><a href="http://store.mozilla.org/?r=mozorg1" title="Shop for Mozilla products on CD and other merchandise">Store</a></li>
<li id="menu_support"><a href="../../../support/" title="Installation, trouble-shooting, and the knowledge base">Support</a></li>
<li id="menu_products"><a href="../../../products/" title="All software Mozilla currently offers">Products</a></li>
</ul>
<form id="searchbox_002443141534113389537:ysdmevkkknw" action="http://www.google.com/cse" title="mozilla.org Search">
<div>
<label for="q" title="Search mozilla.org's sites">search mozilla:</label>
<input type="hidden" name="cx" value="002443141534113389537:ysdmevkkknw">
<input type="hidden" name="cof" value="FORID:0">
<input type="text" id="q" name="q" accesskey="s" size="30">
<input type="submit" id="submit" value="Go">
</div>
</form>
</div>
<hr class="hide">
<div id="mBody">
<div id="side">

<ul id="nav">
<li><a title="Roadmap" href="../../../roadmap.html"><strong> Roadmap</strong></a></li>
<li><a title="Projects" href="../../../projects/"><strong> Projects</strong></a></li>
<li><a title="For developers" href="../../../developer/"><strong> Coding</strong></a>
<ul>
<li><a title="Module Owners" href="../../../owners.html"> Module Owners</a></li>
<li><a title="Hacking" href="../../../hacking/"> Hacking</a></li>
<li><a title="Get the Source" href="http://developer.mozilla.org/en/docs/Download_Mozilla_Source_Code"> Get the Source</a></li>
<li><a title="Building Mozilla" href="http://developer.mozilla.org/en/docs/Build_Documentation"> Build It</a></li>
</ul>
</li>
<li><a title="Testing" href="../../../quality/"><strong> Testing</strong></a>
<ul>
<li><a title="Downloads of mozilla.org software releases" href="../../../download.html"> Releases</a></li>
<li><a title="Latest mozilla builds for testers" href="../../../developer/#builds"> Nightly Builds</a></li>
<li><a title="For testers to report bugs" href="https://bugzilla.mozilla.org/"> Report A Problem</a></li>
</ul>
</li>
<li><a title="Tools for mozilla developers" href="../../../tools.html"><strong> Tools</strong></a>
<ul>
<li><a title="Bug tracking system for mozilla testers." href="https://bugzilla.mozilla.org/"> Bugzilla</a></li>
<li><a title="Latest status of mozilla builds" href="http://tinderbox.mozilla.org/showbuilds.cgi?tree=Firefox"> Tinderbox</a></li>
<li><a title="Latest checkins" href="http://bonsai.mozilla.org/cvsqueryform.cgi"> Bonsai</a></li>
<li><a title="Source cross reference" href="http://lxr.mozilla.org/seamonkey/"> LXR</a></li>
</ul>
</li>
<li><a title="Frequently Asked Questions." href="../../../faq.html"><strong> FAQs</strong></a></li>
</ul>

</div>
<hr class="hide">
<div id="mainContent">


  
  
    <h1>Extension Versioning, Update and Compatibility</h1>
    <h4>or, How to Handle Firefox Version Upgrades</h4>
    <p><em>Ben Goodger, 07/20/2004</em>
    <p>This document is <span style="color: red"><strong>Preliminary</strong></span>
       - that is, it is not final and not everything here has been implemented. As 
       soon as it is, this notice will be removed.
    <h3>Firefox Versioning</h3>
    <p>The Firefox Version Format (FVF) is:
    <pre class="code">major.minor.release.build[+]</pre>
    <p>Every field after major is optional, so 2.0, 2.5.1 and 7 are all valid version
       numbers, as is 5.0.0.2004072315</p>
    <p><strong>Firefox and all Extensions and Themes that work with Firefox must be 
        versioned in this way in order for compatibility checking and Update to work</strong>
    <p>If you are not versioning this way now, <strong>start now</strong>. Versions 
       like "2.0b" or "4.2 Preview" are <em>not valid</em>. If you want to display any 
       additional information, use the <code>em:name</code> property.
    <h3>How Firefox Determines Compatibility</h3>
    <p>Firefox uses the pref <code>app.extensions.version</code> to determine 
       Extension compatibility for this release. When an Extension is installed, 
       Firefox makes sure that <code>app.extensions.version</code> lies within the 
       range set up by the Extension's install.rdf file using minVersion and 
       maxVersion. If <code>app.extensions.version</code>
       is less than minVersion, a newer version of Firefox is required to install the 
       Extension, if it is greater than maxVersion, Firefox is too new to install the 
       extension.
    <p>If this basic compatibility check fails, Firefox will then attempt to "phone 
       home" and obtain newer compatibility information for the Extension. If the 
       Extension's install.rdf file specifies an update RDF file, this will be loaded 
       and newer information discovered there (see below for format). If none is 
       supplied, Firefox will check the generic update service running on 
       addons.mozilla.org, and if the Extension is hosted there and has newer
       compatibility information it will be read and the local information updated.
    <p>If all of these methods fail, Firefox will show a message to the user saying 
       that the Extension is incompatible and cannot be installed.
    <h4>app.extensions.version</h4>
    <p>The app.extensions.version pref will be incremented every time there are 
       changes that might break extension authors, or every minor release, i.e. 0.9, 
       1.0, 1.1, etc. If a point release contains changes (heaven forbid) that might 
       break extensions, we'll rev it then too. Every time we rev this pref, we will 
       publically announce our intent to do so.
    <p>In most cases, this pref will stay the same between minor versions. For 
       example, Firefox 1.1 ships, with app.extensions.version set to "1.1". 
       Hypothetical security firedrills cause 1.1.1 and 1.1.2 releases, but both of 
       these follow-ons still have app.extensions.version set to "1.1" - since there 
       are no changes in the subminor releases that cause extension incompatibility, 
       we don't want to break Extensions compatible with 1.1.
    <h4>Footnote: Application Updates</h4>
    <p>In Firefox 0.9, Firefox used a single pref <code>app.version</code> to 
       determine extension compatibility as described above <em>and</em> to use when 
       comparing against newer available versions of Firefox. This caused some 
       problems when the 0.9.1 release came out, because we held <code>app.version</code>
       at 0.9 to prevent breaking Extensions, but because we did so we ended up 
       causing spurious update notifications appearing in people's clients because the 
       Application software update file on update.mozilla.org (now aus.mozilla.org)
       kept broadcasting there
       was a newer version (0.9.1) available. So to prevent this from 1.0RC1 onwards
       <code>app.version</code> is used strictly for Application versioning <em>only</em> (and 
       it is reved every subminor release) - <code>app.extensions.version</code> is 
       now the pref used for Extensions versioning.
    <h4>Power Tip: Installing Extensions You Know Are Compatible</h4>
    <p>This is <strong>only</strong> for people who <em>know what they're doing</em>. 
       To install an Extension that is incompatible with the build you're using, open
       <code>about:config</code> and type <code>app.extensions.version</code>
       - and set the value of this pref to a version number that is compatible with 
       the Extension. Now try installing the Extension. For safety's sake, reset the 
       pref to its default value (Right click on the pref in about:config and choose 
       "Reset Pref") so that you don't inadvertedly install incompatible Extensions at 
       a later point. Firefox allows Extension sites to see what Extension version it 
       is running with, so if you change this and forget to reset it then browse to an 
       Extension site, you may install incompatible Extensions that mess up your 
       browser.
    <p><strong>If you mess things up doing this</strong> read the next section about 
       using the Safe Mode to recover.
    <h4>IMPORTANT: Recovering From Bad Extensions</h4>
    <p>In the Program Group the Firefox installer created in your Start menu you will 
       find an item called, "Firefox (Safe Mode)" - if you run into problems, such as 
       the browser not starting, performance being degraded, etc, try running by using 
       this shortcut instead of your usual one, if things improve try uninstalling the 
       last Extension(s) you installed.
    <p>If you did not install the Start Menu Program Group, or you're on Linux, start 
       Firefox with the <code>-safe-mode</code> command line switch:
    <pre class="code">./firefox -safe-mode</pre>
    <p>Mac OS X users should do the following:
    <pre class="code">cd Firefox.app/Contents/MacOS<br>./firefox-bin -safe-mode</pre>
    <p>When run in Safe Mode, Firefox disables all Extensions and reverts to the 
       Default Theme.
    <h3>Automatic Extension Update Checking</h3>
    <p>Firefox periodically checks for updates not only to itself, but to your 
       installed Extensions and Themes. If your Extension specified a custom update 
       RDF file in its install.rdf manifest, then this will be checked, if not, 
       Firefox will try and look for updates to it on addons.mozilla.org. If Firefox
       discovers a newer version available for any of your Extensions/Themes, it will 
       display an indicator in the lower right corner of the browser window. You can 
       also check manually by double clicking this indicator, or clicking the "Check 
       Now" button in the Advanced section of Tools, Options.
    <p>If Firefox finds that minVersion and maxVersion have changed remotely for the 
       same version of an Extension that you have installed, it will apply these 
       changes into your local Extensions datasource to ensure ongoing compatibility 
       when you update Firefox to a newer version. For rationale see the "Updating 
       maxVersion" section below.
    <h3>Choosing minVersion and maxVersion</h3>
    <p>You should set minVersion to the minimum version you want to support and test 
       your extension with. There is no shame in this being the latest version of 
       Firefox. <strong>If you do not plan on testing your Extension with a given 
       version, minVersion must be set to the newest version you are willing to test 
       with.</strong> You should never set maxVersion greater than the current 
       Firefox release. You do <strong>not</strong> know what we're planning to do 
       with the app in the future, and so you cannot reliably say that your Extension 
       will be compatible. Mozilla's API set is not completely frozen, and parts of 
       the Browser front end where you integrate UI with overlays may change. As 
       usual, the more you rely on the <em>browser</em>
       and its unfrozen APIs to behave a certain way, the more likely you are to be 
       broken in an update. It's fine for you to do this, you just need to appreciate 
       that work will be required to update to support a newer version.
    <p>For this reason, addons.mozilla.org will not accept Extensions with maxVersion
       set to a version newer than the newest Firefox release.
    <h3>Updating maxVersion</h3>
    <p>Say you create FooExtension 2.2, the long awaited update to critically 
       acclaimed FooExtension 2.1. You're interested in supporting it with Firefox 0.9 
       only, so you set minVersion and maxVersion to 0.9 to support the single 
       version.
    <p>Now suppose Firefox 1.0 comes out. You have a lot of users using FooExtension 
       2.2 on 0.9, and you suppose many of those users will upgrade to Firefox 1.0, 
       but when that happens they'll all find their treasured FooExtension 2.2 will no 
       longer work, right? Not necessarily. Assuming you don't need to make any 
       changes to FooExtension 2.2 to make it work with 1.0 (this can be a pretty big 
       assumption, and you should not assume - you should test, when you assume you 
       make an ASS out of U and ME. ha ha.) - you can update your maxVersion to 
       include 1.0, either on addons.mozilla.org through the UI if you're hosted
       there, or via your update RDF file (see format below). The next time Firefox 
       checks for updates, it will apply any remote changes to the maxVersion into its 
       local datasource so that functionality is preserved.
    <h3>Supporting Multiple Versions</h3>
    <p>Suppose all of the previous is true, but at or around the same time you 
       release FooExtension 2.3. FooExtension 2.3 is where your development effort is 
       focused, and it is the one you intend to support from Firefox 1.0 onward - 
       Firefox 1.0 might be the last release supported FooExtension 2.2, <em>but</em>
       you want your FooExtension 2.2 users to be able to upgrade to Firefox 1.0 and 
       still use 2.2, if they have it.
    <p>If your Extension is hosted on addons.mozilla.org, you can store multiple
       versions of the same Extension in the database and you'll be fine because the 
       automatic update service will take care of the details. If you're using a 
       Custom update RDF file, you can add update info for several versions of a 
       single Extension to the file in the format described below.
    <h3>Custom Update RDF Format</h3>
    <p>This is only applicable if you're using the custom RDF system and not the 
       generic system provided by addons.mozilla.org. To use the generic system
       provided by addons.mozilla.org you need to be hosted there.
    <p>
      <pre class="code">
&lt;RDF:RDF xmlns:RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:em="http://www.mozilla.org/2004/em-rdf#"&gt;

  &lt;RDF:Description about="urn:mozilla:extension:{8be6949b-76b9-4da7-b453-b5f69a11c76e}"&gt;
    &lt;em:updates&gt;
      &lt;!-- This is a list of all available updates. They must have unique 
              URIs, per RDF Grammar rules, I've tacked the version number onto
              the end to differentiate versions --&gt;
      &lt;RDF:Seq&gt;
        &lt;RDF:li resource="urn:mozilla:extension:{8be6949b-76b9-4da7-b453-b5f69a11c76e}:2.2"/&gt;
        &lt;RDF:li resource="urn:mozilla:extension:{8be6949b-76b9-4da7-b453-b5f69a11c76e}:2.3"/&gt;
      &lt;/RDF:Seq&gt;
    &lt;/em:updates&gt;

    &lt;!-- Firefox 0.9 did not support the above RDF grammar, only the following
            two simple properties, so we also provide them here for people 
            upgrading from Firefox 0.9. Note that we've used the larger of the two 
            updates here, since Firefox 0.9 was not smart enough to have any of the 
            logic to patch its Extensions datasource with information about existing 
            Extensions that are <em>also</em> compatible with newer versions of 
            the app. --&gt;
    &lt;em:version&gt;2.3&lt;/em:version&gt;
    &lt;em:updateLink&gt;http://www.mysite.com/fooextension2.3.xpi&lt;/em:updateLink&gt;
  &lt;/RDF:Description&gt;

  &lt;!-- This Description describes updates available to version 2.2 of 
          FooExtension - it defines a new maxVersion for the Firefox
          targetApplication (format of the targetApplication object is the
          same as for the install.rdf file, with the exception of the
          em:updateLink property, which contains a URL to the updated XPI) --&gt;
  &lt;RDF:Description about="urn:mozilla:extension:{8be6949b-76b9-4da7-b453-b5f69a11c76e}:2.2"&gt;
    &lt;em:version&gt;2.2&lt;/em:version&gt;
    &lt;em:targetApplication&gt;
      &lt;Description&gt;
        &lt;em:id&gt;{ec8030f7-c20a-464f-9b0e-13a3a9e97384}&lt;/em:id&gt;
        &lt;em:minVersion&gt;0.9&lt;/em:minVersion&gt;
        &lt;em:maxVersion&gt;1.0&lt;/em:maxVersion&gt;
        &lt;em:updateLink&gt;http://www.mysite.com/fooextension2.2.xpi&lt;/em:updateLink&gt;
      &lt;/Description&gt;
    &lt;/em:targetApplication&gt;
  &lt;/RDF:Description&gt;  

  &lt;!-- This Description describes updates available to version 2.3 of 
          FooExtension - (format of the targetApplication object is the
          same as for the install.rdf file, with the exception of the
          em:updateLink property, which contains a URL to the updated XPI) --&gt;
  &lt;RDF:Description about="urn:mozilla:extension:{8be6949b-76b9-4da7-b453-b5f69a11c76e}:2.3"&gt;
    &lt;em:version&gt;2.3&lt;/em:version&gt;
    &lt;em:targetApplication&gt;
      &lt;Description&gt;
        &lt;em:id&gt;{ec8030f7-c20a-464f-9b0e-13a3a9e97384}&lt;/em:id&gt;
        &lt;em:minVersion&gt;1.0&lt;/em:minVersion&gt;
        &lt;em:maxVersion&gt;1.0&lt;/em:maxVersion&gt;
        &lt;em:updateLink&gt;http://www.mysite.com/fooextension2.3.xpi&lt;/em:updateLink&gt;
      &lt;/Description&gt;
    &lt;/em:targetApplication&gt;
  &lt;/RDF:Description&gt;  

&lt;/RDF:RDF&gt;</pre>

    <h3>How Firefox Determines what Update to Offer</h3>
    <p>There are several events that cause Firefox to check for updates:
      <ol>
        <li>User generated events (user double clicks on status bar indicator, 
            clicks "Check Now" in Options, selects an Extension or Theme and 
            clicks "Update", etc)
        <li>Background events (Firefox's 24 hour update check timer)
        <li>Mismatch events (A new version of Firefox is installed, and Firefox 
            has to check for updates to determine if newer versions of 
            incompatible Extensions are available).</li>
      </ol>
    <p>Depending on the type of event, Firefox may be interested in seeing the newest 
       version of a given Extension, or only in updating the local datasource with 
       more up to date min/maxVersion info. Here's a breakdown.
    <p>For (1) - User Generated events, Firefox checks the addons.mozilla.org update
       service or the custom RDF file for each Extension first to see if the 
       minVersion/maxVersion metadata is up to date. It updates this metadata 
       silently. Then it checks to see if there really is a newer version available - 
       and shows UI that presents these newer versions to give users a chance to 
       upgrade.
    <p>For (2) - Background events, Firefox does basically the same as for (1).
    <p>For (3) - Firefox checks for updates, but does not present UI if compatibility 
       is satisfied by simply updating minVersion/maxVersion. i.e. in the FooExtension 
       example given, if a Firefox 0.9 user moves to 1.0, the first time he or she 
       starts 1.0, Firefox will check the custom RDF file and silently patch the 
       compatibility info for the installed FooExtension 2.2, and <em>not</em> show 
       the "Incompatible Extensions" UI presenting 2.3 - since an upgrade to 2.3 is <em>not 
       strictly required</em> for the user to update. The emphasis here is on 
       presenting a simplified user experience. Users will learn about 2.3 when 
       Firefox does a subsequent update check.
    <h3>What Does All This Mean?</h3>
    <p>What this means is that <em>if your extension is compatible with a newer version 
       of Firefox</em> and the version number of that compatible version has not changed, when the 
       newer version of Firefox comes out, all you need to do is update your listing 
       in addons.mozilla.org or your custom RDF file to indicate this compatibility
       change, and existing and new users of that version of your extension will be 
       able to use it in the newer version of Firefox. Existing users because Firefox 
       will check with the update service/RDF either in the background or when they 
       upgrade and patch their local datasource, and new users because when they 
       install the XPI and Firefox deems it incompatible based on the information in 
       the install.rdf file, Firefox will check with the update service/RDF at that 
       time to determine whether or not it really is compatible.
    <p>This implies that you do <em>not</em> need to release an updated XPI with an 
       ammended install.rdf file as long as you keep the remote metadata up to date, 
       although you may like to anyway if you believe there's a chance users will want 
       to install that XPI when they don't have an internet connection (since clearly 
       the update checking will not work in that case).
    <h3>Themes</h3>
    <p>Almost everywhere I say "Extensions" I could also say "Themes" - for brevity I 
       only say the former.
    <h3>Thunderbird</h3>
    <p>All of this applies to Thunderbird too.</p>
  


<hr class="hide">
</div>
</div>
<div id="footer">
<ul>
<li><a href="../../../sitemap.html">Site Map</a></li>
<li><a href="../../../security/">Security Updates</a></li>
<li><a href="../../../contact/">Contact Us</a></li>
<li><a href="../../../foundation/donate.html">Donate</a></li>
</ul>
<p class="copyright">
Portions of this content are &copy; 1998&#8211;2009 by individual mozilla.org
contributors; content available under a Creative Commons license | <a
href="http://www.mozilla.org/foundation/licensing/website-content.html">Details</a>.</p>
<p>
<span>Last modified December 16,  2004</span>
<span><a href="http://bonsai-www.mozilla.org/cvslog.cgi?file=mozilla-org/html/projects/firefox/extensions/update.html&amp;rev=&amp;root=/www/">Document History</a></span>
</p>
</div>
</div>
</body>
</html>
