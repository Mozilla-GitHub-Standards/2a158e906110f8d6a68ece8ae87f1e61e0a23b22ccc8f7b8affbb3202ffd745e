
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<link rel="top" title="Home" href="http://www.mozilla.org/">
<link rel="stylesheet" type="text/css" href="../../../../css/print.css"  media="print">
<link rel="stylesheet" type="text/css" href="../../../../css/base/content.css"  media="all">
<link rel="stylesheet" type="text/css" href="../../../../css/cavendish/content.css" title="Cavendish" media="screen">
<link rel="stylesheet" type="text/css" href="../../../../css/base/template.css"  media="screen">
<link rel="stylesheet" type="text/css" href="../../../../css/cavendish/template.css" title="Cavendish" media="screen">
<link rel="icon" href="../../../../images/mozilla-16.png" type="image/png">

<TITLE>Encoding MathFonts for Mozilla</TITLE>
<STYLE>
<!--
pre {
  /* font-family: Lucida Console; */
  font-size: smaller;
}
-->
</STYLE>
<script src="../../../../__utm.js" type="text/javascript"></script>
</head>
<body id="www-mozilla-org" class="deepLevel">
<div id="container">
<p class="important">You are currently viewing a snapshot of www.mozilla.org taken on April 21, 2008. Most of this content is
highly out of date (some pages haven't been updated since the project began in 1998) and exists for historical purposes only.  If
there are any pages on this archive site that you think should be added back to www.mozilla.org, please <a
href="https://bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=www.mozilla.org">file a bug</a>.</p>
<p class="skipLink"><a href="#mainContent" accesskey="2">Skip to main content</a></p>
<div id="header">
<h1><a href="/" title="Return to home page" accesskey="1">Mozilla</a></h1>
<ul>
<li id="menu_aboutus"><a href="../../../../about/" title="Getting the most out of your online experience">About</a></li>
<li id="menu_developers"><a href="../../../../developer/" title="Using Mozilla's products for your own applications">Developers</a></li>
<li id="menu_store"><a href="http://store.mozilla.org/?r=mozorg1" title="Shop for Mozilla products on CD and other merchandise">Store</a></li>
<li id="menu_support"><a href="../../../../support/" title="Installation, trouble-shooting, and the knowledge base">Support</a></li>
<li id="menu_products"><a href="../../../../products/" title="All software Mozilla currently offers">Products</a></li>
</ul>
<form id="searchbox_002443141534113389537:ysdmevkkknw" action="http://www.google.com/cse" title="mozilla.org Search">
<div>
<label for="q" title="Search mozilla.org's sites">search mozilla:</label>
<input type="hidden" name="cx" value="002443141534113389537:ysdmevkkknw">
<input type="hidden" name="cof" value="FORID:0">
<input type="text" id="q" name="q" accesskey="s" size="30">
<input type="submit" id="submit" value="Go">
</div>
</form>
</div>
<hr class="hide">
<div id="mBody">
<div id="side">

<ul id="nav">
<li><a title="Roadmap" href="../../../../roadmap.html"><strong> Roadmap</strong></a></li>
<li><a title="Projects" href="../../../../projects/"><strong> Projects</strong></a></li>
<li><a title="For developers" href="../../../../developer/"><strong> Coding</strong></a>
<ul>
<li><a title="Module Owners" href="../../../../owners.html"> Module Owners</a></li>
<li><a title="Hacking" href="../../../../hacking/"> Hacking</a></li>
<li><a title="Get the Source" href="http://developer.mozilla.org/en/docs/Download_Mozilla_Source_Code"> Get the Source</a></li>
<li><a title="Building Mozilla" href="http://developer.mozilla.org/en/docs/Build_Documentation"> Build It</a></li>
</ul>
</li>
<li><a title="Testing" href="../../../../quality/"><strong> Testing</strong></a>
<ul>
<li><a title="Downloads of mozilla.org software releases" href="../../../../download.html"> Releases</a></li>
<li><a title="Latest mozilla builds for testers" href="../../../../developer/#builds"> Nightly Builds</a></li>
<li><a title="For testers to report bugs" href="https://bugzilla.mozilla.org/"> Report A Problem</a></li>
</ul>
</li>
<li><a title="Tools for mozilla developers" href="../../../../tools.html"><strong> Tools</strong></a>
<ul>
<li><a title="Bug tracking system for mozilla testers." href="https://bugzilla.mozilla.org/"> Bugzilla</a></li>
<li><a title="Latest status of mozilla builds" href="http://tinderbox.mozilla.org/showbuilds.cgi?tree=Firefox"> Tinderbox</a></li>
<li><a title="Latest checkins" href="http://bonsai.mozilla.org/cvsqueryform.cgi"> Bonsai</a></li>
<li><a title="Source cross reference" href="http://lxr.mozilla.org/seamonkey/"> LXR</a></li>
</ul>
</li>
<li><a title="Frequently Asked Questions." href="../../../../faq.html"><strong> FAQs</strong></a></li>
</ul>

</div>
<hr class="hide">
<div id="mainContent">





<table align='right' width='300' border='1'>
<tr>
<th align='center' bgcolor='#c0c0c0'>
Default Recommended MathFonts
</th></tr>
<tr><td>
<center>
Computerized mathematical typesetting requires professional
<a href="../">fonts</a>.
Thanks to these organizations and individuals for allowing
their fonts to be downloadable freely.
</center>
<hr width="50%" size="1" align="center">
<ul>
<li><b><a href="http://www.ams.org/">AMS</a></b><br>
(<a href="license-ams.txt">License</a>)
<ul>
<li><a href="cmr.html" >CMR10</a>  - Type1
<li><a href="cmmi.html">CMMI10</a> - Type1
<li><a href="cmsy.html">CMSY10</a> - Type1
<li><a href="cmex.html">CMEX10</a> - Type1<br><br>
</ul>

<li><b>Basil K. Malyshev (BaKoMa)</b><br>
(<a href="license-bakoma.txt">License</a>)
<ul>
<li><a href="cmr.html" >CMR10</a>  - TrueType
<li><a href="cmmi.html">CMMI10</a> - TrueType
<li><a href="cmsy.html">CMSY10</a> - TrueType
<li><a href="cmex.html">CMEX10</a> - TrueType<br><br>
</ul>

<li><b><a href="http://www.dessci.com/">Design Science, Inc</a></b><br>
(<a href="http://www.mathtype.com/support/licenses/mtextralic.stm">License</a>)
<ul>
<li><a href="mtextra.html">MT Extra</a> - TrueType<br><br>
</ul>

<li><b><a href="http://www.wolfram.com/">Wolfram Research, Inc</a></b><br>
(<!-- a href="license-wri.txt" -->License<!-- /a -->)
<ul>
<li><a href="math1.html">Math1</a> - TrueType &amp; Type1
<li><a href="math2.html">Math2</a> - TrueType &amp; Type1
<li><a href="math3.html">Math3</a> - TrueType &amp; Type1
<li><a href="math4.html">Math4</a> - TrueType &amp; Type1
<li><a href="math5.html">Math5</a> - TrueType &amp; Type1<br><br>
</ul>

<li><b>Other pre-installed fonts</b>
<ul>
<li><a href="symbol.html">Symbol</a><br><br>
</ul>

</ul>
</td></tr>
</table>

<H2 align="center">Encoding MathFonts for Mozilla</H2>

<p> Fonts aimed at representing 
<a href="http://www.langbox.com/codeset.html">standardized codesets</a> 
(a.k.a. charsets) such as ASCII or the 
<a href="http://www.czyborra.com/charsets/iso8859.html">ISO-8859-x series</a>
are expected to encode a list of glyphs of <i>known characters</i> at <i>known 
positions</i>. Depending on the technology being used, the font data 
file can be made self-contained, with this encoding metadata implicit 
(i.e., easy to infer) or embedded in the font, especially when it 
supports several codesets. From this it follows that standardization 
enables processing such fonts in a consistent and optimized manner.</p>

<p>Other special purpose fonts that are not geared toward these
standardized codesets can have any 'glyphshape' at any position.
Consequently, applications wishing to access the glyphshapes need
separate encoding tables that provide a mapping from characters to the
indices of the desired glyphshapes. Such fonts are known as 'symbol
fonts', though other terminologies like 'symbolic fonts' are sometimes
used to avoid confusion with the 'Symbol' font which is just an example
of many such fonts. Dingbats and scientific fonts are other noteworthy
examples. Generally, mathematical typesetting packages embed pre-built
<a href="http://www.mathtype.com/support/tech/default.stm#encodings">font encoding tables</a> for fonts that they intent to support.
In particular, this is done in Mozilla using the <i>ucvmath</i> module in
conjunction with <i>MathFont Property Files</i> in a way that
essentially allows supporting any mathematical font( <a
href="#ccm">*</a> ). Assumptions about fonts are not hard-coded at the
core of the MathML engine. Even the set of stretchy characters is
extensible externally. By following the scheme to be described later, it
would be possible for you to setup additional fonts to be used to render
<a href="../../">MathML in Mozilla</a>.</p>

<p>An important outcome of the MathML specification has been the 
enlisting of a wide array of 
<a href="http://www.w3.org/TR/MathML2/chapter6.html">mathematical and 
technical symbols</a> in the Unicode set. The fact that <i>imath</i> has 
a single code point whereas <i>jmath</i> requires a combined pair of 
code points is enigmatic, but that could be illustrative of the 
difficulties in securing those code points. The universality of the 
approved code points is key to producing, processing, and interchanging 
portable scientific and technical documents in contexts other than, and 
beyond MathML itself. As for fonts, it now becomes technically possible 
to produce a single portable Unicode font that could contain the most 
widely used characters in computerized scientific typesetting. It might 
nevertheless be the case that consideration for legacy software packages 
(e.g., TeX) that expect smaller partitioned sets may hold back the 
production of unified font sets for quite some time. Besides, there is 
an underlying complication in mathematical typesetting with respect to 
the so-called <i>stretchy characters</i>. These are characters that can 
be rendered differently depending on their surrounding context. There is 
a one-to-many mapping between a stretchy character and its associated 
glyphshapes, and in fact, the final rendering of a stretchy character 
may require assembling several glyphshapes at once. Since Unicode only 
assigns one slot per character, the  one-to-many relationship needs 
special handling by software. The extra glyphshapes are usually assigned 
to the PUA (the Unicode's Private Use Area 0xE000-0xF8FF which is exempted
from receiving any official assignments and is left to applications for
their internal use). These observations make it likely that mapping tables
are still going to be around for some time -- at least until such a time 
where advanced built-in font technologies enable embedding the subtle 
and delicate mechanism of stretching math symbols within the font.</p>

<h2>MathFont Encoding Tables</h2>

<p>
For Mozilla to support an existing symbolic mathematical font, the first 
step is to setup a MathFont Encoding Table. This is essentially a lookup 
table that provides a mapping from characters to the indices of the 
desired glyphshapes within the font. As a result, building such a table 
requires visualizing the font's character map. We shall 
illustrate this building process through a representative example. 
Consider the character map of the Symbol font given below.
</p>

<p align="center">
<img src="symbol.gif"
     width="418" height="334"
     alt="Symbol Encoding">
</p>

The resulting encoding table is listed as
(see <a href="symbol.html">full listing</a>):

<pre>
 <font color="darkblue">0x20  0x0020</font>  <font color="green">#Space</font>
 <font color="darkblue">0x21  0x0021</font>  <font color="green">#Exclamation mark</font>
 <font color="darkblue">0x22  0x2200</font>  <font color="green">#For all</font>
 ...etc
</pre>

That is useful and necessary, but not really interesting. The interesting parts are those associated
to stretchy characters such as that inside block 0xE0-0xEF:
<pre>
 <font color="darkblue">0xE0  0x22C4</font>  <font color="green">#Diamond operator</font>
 <font color="darkblue">0xE1  0x2329</font>  <font color="green">#Left-pointing angle bracket</font>
 <font color="darkblue">0xE2  0xF8E8</font>  <font color="green">#Registered sign sans serif</font> [?entity]
 <font color="darkblue">0xE3  0xF8E9</font>  <font color="green">#Copyright sign sans serif</font> [?entity]
 <font color="darkblue">0xE4  0xF8EA</font>  <font color="green">#Trade mark sign sans serif</font> [?entity]
 <font color="darkblue">0xE5  0x2211</font>  <font color="green">#N-ary summation</font>
 <font color="darkblue">0xE6  0x0028</font>:<font color="brown">T</font>  <font color="green">#Left parenthesis top</font>
 <font color="darkblue">0xE7  0x0028</font>:<font color="brown">G</font>  <font color="green">#Left parenthesis extender</font>
 <font color="darkblue">0xE8  0x0028</font>:<font color="brown">B</font>  <font color="green">#Left parenthesis bottom</font>
 <font color="darkblue">0xE9  0x005B</font>:<font color="brown">T</font>  <font color="green">#Left square bracket top</font>
 <font color="darkblue">0xEA  0x005B</font>:<font color="brown">G</font>  <font color="green">#Left square bracket extender</font>
 <font color="darkblue">0xEB  0x005B</font>:<font color="brown">B</font>  <font color="green">#Left square bracket bottom</font>
 <font color="darkblue">0xEC  0x007B</font>:<font color="brown">T</font>  <font color="green">#Left curly bracket top</font>
 <font color="darkblue">0xED  0x007B</font>:<font color="brown">M</font>  <font color="green">#Left curly bracket mid</font>
 <font color="darkblue">0xEE  0x007B</font>:<font color="brown">B</font>  <font color="green">#Left curly bracket bottom</font>
 <font color="darkblue">0xEF  0x007B</font>:<font color="brown">G</font>, <font color="darkblue">0x007D</font>:<font color="brown">G</font>  <font color="green">#Curly bracket extender</font>
</pre>

The letters 'T', 'L', 'M', 'B', 'R', and 'G' stand, respectively, for
'T'op, 'L'eft, 'M'iddle, 'B'ottom, 'R'ight, and 'G'lue. These are
annotations used to indicate glyphs that should be assembled in order
to build larger variants of a character. For instance lines 0xE6-0xE8 mean
that a larger left parenthesis can be obtained by the vertical
juxtaposition of the 'T'op, zero or many 'G'lue, and the 'B'ottom'. This
is outlined below:

<p>
<table border="0" cellpadding="0" cellspacing="2">
 <tr><td><img src="symbol-leftparenthesis-top.gif"></td><td nowrap><tt>
 <font color="darkblue">0xE6  0x0028</font>:<font color="brown">T</font>  <font color="green">#Left parenthesis top</font>
</tt></td>
<td rowspan=3>&nbsp;&nbsp;&nbsp;
Combining without spacing yields:
</td>
<td rowspan=3">
<img src="symbol-leftparenthesis-top.gif"><br><img src="symbol-leftparenthesis-glue.gif"><br><img src="symbol-leftparenthesis-bot.gif"></td>
</tr>
 <tr><td><img src="symbol-leftparenthesis-glue.gif"></td><td nowrap><tt>
 <font color="darkblue">0xE7  0x0028</font>:<font color="brown">G</font>  <font color="green">#Left parenthesis extender</font>
</tt></td></tr>
 <tr><td><img src="symbol-leftparenthesis-bot.gif"></td><td nowrap><tt>
 <font color="darkblue">0xE8  0x0028</font>:<font color="brown">B</font>  <font color="green">#Left parenthesis bottom</font>
</tt></td></tr>
</table>
</p>

<p>
When 'M'iddle is specified (as in line 0xED), the repeatable glue simply has 
to be inserted between both ends. Sometimes glyphs may not fit at their full 
extent in the required space and depending on their shape, Mozilla' stretching
code may clip to tolerate a small amount of overlap between the parts. 
In general the 'T'op of one character could be labeled as the 'B'ottom
of another one, and so on.
The <a href="symbol.html">full listing</a> shows how extensible
arrows and curly brackets are defined according to these principles. For
consistency of appearance, extensible characters are defined with
glyphs purposely designed to be used to that effect. There is therefore
an intrinsic limitation on the possible combinations within a single font.
In some circumstances, though rare, font designers put the glyphs needed
to stretch a character in different families. But this is a matter of no
concern here -- this additional information should instead be specified
in the MathFont Property Files to be introduced below.</p>

<p>
A MathFont Encoding Table is meant to be processed automatically.
It is a set of lines, each with space-separated fields. The full
format is as follows:

<ol>

<li>The first column is used as a marker. If the dash '-' is present, 
the entry is skipped. Explicitly listing some empty slots in the 
character map and flagging them with the dash '-' can be of great help 
when inspecting a table for verification.<br><br>

<li>The second field is the desired glyph index (i.e., encoding 
point).<br><br>

<li>The third field is either:
<ul>

<li>the keyword '<font color="darkblue">&gt;PUA</font>' to indicate that 
there is no approved Unicode point for that glyph, and so it should be 
made accessible via an assignment to the PUA, or

<li>a comma-separated list of one or more annotated Unicode points:
<font color="darkblue">0xNNNN</font>:<font color="brown">x</font> {,
<font color="darkblue">0xNNNN</font>:<font color="brown">x</font> ...}.
The list can be split over many lines provided that
each preceding line is ended with a comma.
The expected annotations are:
<ul>
<li>Annotations to distinguish variants of larger sizes:
<font color="darkblue">0xNNNN</font>:<font color="brown">0</font>,
<font color="darkblue">0xNNNN</font>:<font color="brown">1</font>, ....
An annotation with digit '<font color="brown">0</font>' means
that the glyph is of normal-size and can be used in a normal text run.
This is the default, i.e., it is assumed when no annotation is specified.
An annotation with
digit '<font color="brown">1</font>' means 'big' (in the terminology of TeX),
digit '<font color="brown">2</font>' means 'Big',
digit '<font color="brown">3</font>' means 'bigg',
digit '<font color="brown">4</font>' means 'Bigg', ....
The ordering is relative to the font family.

<li>Annotations for the parts:
<font color="darkblue">0xNNNN</font>:<font color="brown">T</font>,
<font color="darkblue">0xNNNN</font>:<font color="brown">L</font>,
<font color="darkblue">0xNNNN</font>:<font color="brown">M</font>,
<font color="darkblue">0xNNNN</font>:<font color="brown">B</font>,
<font color="darkblue">0xNNNN</font>:<font color="brown">R</font>, and
<font color="darkblue">0xNNNN</font>:<font color="brown">G</font>.
They respectively mean that the glyph should be used as
'T'op, 'L'eft, 'M'iddle, 'B'ottom, 'R'ight, or as
the repeatable 'G'lue when assembling the character by parts.
In reality, 'T'op is synonym with 'L'eft while 'B'ottom is
synonym with 'R'ight. However, they are used in their respective
situation to draw attention on the direction of the stretching.<br><br>
</ul>
</ul>

<li>The fourth field is an optional descriptive comment about the 
character. But if the third field has been marked as 
'<font color="darkblue">&gt;PUA</font>', this comment field becomes 
<i>significant</i>. The comment is <i>searched</i> for any 
'&amp;entity;' that should be associated to the assignment that will be 
made to the PUA for that glyph. This is also the case for Unicode points 
in plane 1. Since Mozilla doesn't yet support plane 1 characters like
<a href="http://www.w3.org/TR/MathML2/1D5.html">script and fraktur 
characters</a>, the necessary glyphs are made accessible via assignments 
to the PUA and these are, in their turn, exposed to users via the 
entity references of those characters. Ditto for characters with 
combining diacritical marks. The assignments to the PUA are meant to be 
kept private within Mozilla and can be (automatically) changed anytime by 
the script that processes the MathFont Encoding Tables. Searching the 
code in view of directly using the assignments is strongly discouraged. 
</ol> </p>

<h2>MathFont Property Files</h2>

<p>Upon setting up a MathFont Encoding Table, the next step is to run 
the Perl script, <i>encode.pl</i>, to process and convert the table in 
the compact format expected internally. The script is available in the 
<i>mathml/tools</i> directory. It is possible to construct the compact 
format by hand, but this is a tedious and error-prone process. So it is 
preferable to use the automatic tool and add specific customization to 
the resulting file afterwards. The Perl script will produce the data 
needed by the ucvmath module (the ultimate mapping between glyph indices 
and code points), as well as the data needed by the stretching code
(the metadata to guide the stretching process). Additionally, the script will
pretty-print its resulting <a href="symbol-encoding.html">visual encoding map</a>
for subsequent verification.</p>

<p>
There exists different types of MathFont Property Files.
Since more details can be found in these files, only a brief
description is provided here.

<ul>
<li><b><a href="http://lxr.mozilla.org/seamonkey/source/layout/mathml/base/src/mathfont.properties">mathfont.properties</a></b><br>
This file contains the Operator Dictionary which lists, amongst
other things, the characters that are entitled to be stretched.
The file also gives the default order of fonts with which to attempt 
the stretching process (this order can be overridden with CSS). 
The preferred fonts that should be used for particular characters 
can also be supplied. Other
<a href="http://groups.google.com/groups?hl=en&lr=&group=netscape.public.mozilla.mathml&safe=off&ic=1&th=3a8c2e24a034123b&seekd=935108173#935108173">details</a>
are available in the file.<br><br>

<li><b><a href="http://lxr.mozilla.org/seamonkey/source/layout/mathml/base/src/mathfontPUA.properties">mathfontPUA.properties</a></b><br>
This is a central repository to keep track of MathML assignments to the 
PUA. The repository achieves the dual purpose of keeping track of the 
mappings associated to the extra glyphs of stretchy characters as well 
as the mappings of non supported Unicode points such as plane 1 
characters. This way, the MathML DTD used by Mozilla can be 
automatically customized so that the entity references map to the 
internal PUA code points, thereby allowing users to transparently access 
the underlying glyphs of the unsupported Unicode points.<br><br>

<li><b><a href="http://lxr.mozilla.org/seamonkey/find?string=mathfont">mathfont<i>FontFamily</i>.properties</a></b><br>

Here <i>FontFamily</i> is the name of the font associated to the file.
The font property file is a set of all the stretchy MathML characters
that can be rendered with that font using larger and/or partial glyphs.
This is where the annotations are combined together in a much compact
manner suitable for efficient handling by the stretching code.

Each stretchy character in the font is listed with the four partial glyphs:
top (or left), middle, bottom (or right), glue; and the variants of
bigger sizes (if any). The essential observation is that direct and indirect
references can be used. Looking at
<a href="http://lxr.mozilla.org/seamonkey/source/layout/mathml/base/src/mathfontSymbol.properties">mathfontSymbol.properties</a>
for example, the first few lines show:

<pre>
#        [ T/L |  M  | B/R |  G  | size0 ... size{N-1} ]
\u0028 = \uF8FF\uFFFD\uF8FF\uF8FF\u0028 # (
</pre>

<p>The code point \uFFFD is a flag used to indicate a position
that is not relevant to a character.</p>

<p>The code point \uF8FF is another flag. It means that the needed
glyphs are referenced via assignments to the PUA, and the actual
assignments can be retrieved in the
<a href="http://lxr.mozilla.org/seamonkey/source/layout/mathml/base/src/mathfontPUA.properties">mathfontPUA.properties</a>
file using the keys '\u0028.T', '\u0028.B', and '\u0028.G' respectively. The
important remark here is therefore that, the assignments corresponding
to glyphs of identical rank are the same, regardless the fonts where
they come from. There is no risk of mismatch because the stretching code
will select the appropriate font in the device context. If there were
glyphs of larger sizes in the font, the code point \uF8FF would have
been placed again at their positions, and this would have instructed the
stretching code to retrieve the assignments using the keys '\u0028.1',
'\u0028.2', .... With this scheme, the number of assignments to the PUA
are kept minimum and the overall process can scale remarkably well to
accommodate many stretchy characters and fonts. Of course, this scheme
also applies if direct glyph indices are instead use. But because
Mozilla doesn't have cross-platform rendering APIs based on glyph
indices, this alternative hasn't been pursued.</p>

<p>
In addition to using the generic indirect reference to the PUA as
indicated above, it is also possible to use the annotated keys '\uNNNN.T',
etc., themselves, as well as a direct fixed code point '\uNNNN'. Here
each key prefix \uNNNN could then be chosen arbitrarily. Using
annotated keys allows mixing pieces from different characters without
having to create (and worry about) a dependence with the actual values
assigned to the PUA for the pieces being mixed. For example, the larger
variants of (left/right)ceil/floor in the 
<a href="http://lxr.mozilla.org/seamonkey/source/layout/mathml/base/src/mathfontSymbol.properties">mathfontSymbol.properties</a>
file are obtained by combining the pieces of leftbracket '[' (\u005B)
and rightbracket ']' (\u005D) as shown below:
<pre>
\u2308 = \u005B.T\uFFFD\uFFFD\u005B.G\u2308 # LeftCeiling, lceil
\u2309 = \u005D.T\uFFFD\uFFFD\u005D.G\u2309 # RightCeiling, rceil
\u230A = \uFFFD\uFFFD\u005B.B\u005B.G\u230A # LeftFloor, lfloor
\u230B = \uFFFD\uFFFD\u005D.B\u005D.G\u230B # RightFloor, rfloor
</pre>
</p>

<p>Characters that need to be recursively built from other characters
are also supported. For example, characters like overbrace and
underbrace in cmex10 have to be built from two half stretchy chars and
joined in the middle (TeXbook, p.225). The stretching code can compose
several (i.e., 2 or more) child characters in order to render another
character. To specify such characters, their list of glyphs in the
property file should be given as space-separated segments of glyphs.
Each segment gives the four partial glyphs with which to build the child
character that will be joined with its other siblings. The 
<a href="http://lxr.mozilla.org/seamonkey/source/layout/mathml/base/src/mathfontCMEX10.properties">mathfontCMEX10.properties</a>
file intentionally uses the following slightly different definitions of overbrace and 
underbrace to exemplify the indications given earlier:
<pre>
\uFE37 = \uFE37.L\uFFFD\uFE38.R\uFFFD \uFE38.L\uFFFD\uFE37.R\uFFFD # OverBrace
\uFE38 = \uF8FF\uFFFD\uFE37.R\uFFFD \uFE37.L\uFFFD\uF8FF\uFFFD # UnderBrace
</pre>
</p>

<p>Building stretchy characters by mixing glyphs from several fonts 
is also possible as we now explain. The key idea is that the code points 
in the MathFont Property Files are really in the format 'code@font',
where 'font' is a numeric identifier given to the font. The primary 
font associated to the encoding table is '0', so continuing with
the example of the Symbol font, the entry given above really read:
<pre>
\u0028 = \uF8FF@0\uFFFD\uF8FF@0\uF8FF@0\u0028@0 # (
</pre>
However, 'code@0' is assumed by default and this annotation is optional.
If additional fonts are needed, the MathFont Property File
will include, for example, a line with:
<pre>
external.1 = cmr10
</pre>
and the desired matching glyph that should be taken from there will 
be annotated as 
<font color="darkblue">\uNNNN</font>@<font color="brown">1</font>.
This will instruct the stretching code to fetch the glyph from that 
specific font. The numbering of 'external' fonts is local to the 
MathFont Property File.
More relevant details about the general setup can be found in the
documentation at the bottom of the mathfont.properties file.</p>

</ul>
</p>

<hr size="1" noshade width="100" align="left">
<font size="-1">
<a name="ccm">
(*) The ucvmath module relies upon Mozilla's Charset Converter Manager
which was designed in the spirit of a fixed number of standardized
charsets, and this layer is expected by the GFX font-subsystem where
the actual rendering happens. Hence the mapping tables are hard-coded
and additions of brand new fonts unfortunately requires updating and
re-compiling the ucvmath module.
</font>

<BR><BR><BR>
<p align="right"><font size="-1">Roger B. Sidje 
&lt;<i><a href="mailto:rbs@maths.uq.edu.au">rbs@maths.uq.edu.au</a></i>&gt;
</font>
</p>



<hr class="hide">
</div>
</div>
<div id="footer">
<ul>
<li><a href="../../../../sitemap.html">Site Map</a></li>
<li><a href="../../../../security/">Security Updates</a></li>
<li><a href="../../../../contact/">Contact Us</a></li>
<li><a href="../../../../foundation/donate.html">Donate</a></li>
</ul>
<p class="copyright">
Portions of this content are &copy; 1998&#8211;2009 by individual mozilla.org
contributors; content available under a Creative Commons license | <a
href="http://www.mozilla.org/foundation/licensing/website-content.html">Details</a>.</p>
<p>
<span>Last modified October 23,  2005</span>
<span><a href="http://bonsai-www.mozilla.org/cvslog.cgi?file=mozilla-org/html/projects/mathml/fonts/encoding/index.html&amp;rev=&amp;root=/www/">Document History</a></span>
</p>
</div>
</div>
</body>
</html>
