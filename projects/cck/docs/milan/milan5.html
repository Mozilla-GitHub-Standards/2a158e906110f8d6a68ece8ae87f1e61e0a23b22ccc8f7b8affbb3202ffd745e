<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<link rel="top" title="Home" href="http://www.mozilla.org/">
<link rel="stylesheet" type="text/css" href="../../../../css/print.css"  media="print">
<link rel="stylesheet" type="text/css" href="../../../../css/base/content.css"  media="all">
<link rel="stylesheet" type="text/css" href="../../../../css/cavendish/content.css" title="Cavendish" media="screen">
<link rel="stylesheet" type="text/css" href="../../../../css/base/template.css"  media="screen">
<link rel="stylesheet" type="text/css" href="../../../../css/cavendish/template.css" title="Cavendish" media="screen">
<link rel="icon" href="../../../../images/mozilla-16.png" type="image/png">

<TITLE>Guide to Online Internet Account Creation</TITLE>
<META="AUTHOR" CONTENT="Greg Potter and Kimberly Haeger; Robyn Nace">
<META="OPERATOR" CONTENT="Kimberly Haeger">
<script src="../../../../__utm.js" type="text/javascript"></script>
</head>
<body id="www-mozilla-org" class="deepLevel">
<div id="container">
<p class="important">You are currently viewing a snapshot of www.mozilla.org taken on April 21, 2008. Most of this content is
highly out of date (some pages haven't been updated since the project began in 1998) and exists for historical purposes only.  If
there are any pages on this archive site that you think should be added back to www.mozilla.org, please <a
href="https://bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=www.mozilla.org">file a bug</a>.</p>
<p class="skipLink"><a href="#mainContent" accesskey="2">Skip to main content</a></p>
<div id="header">
<h1><a href="/" title="Return to home page" accesskey="1">Mozilla</a></h1>
<ul>
<li id="menu_aboutus"><a href="../../../../about/" title="Getting the most out of your online experience">About</a></li>
<li id="menu_developers"><a href="../../../../developer/" title="Using Mozilla's products for your own applications">Developers</a></li>
<li id="menu_store"><a href="http://store.mozilla.org/?r=mozorg1" title="Shop for Mozilla products on CD and other merchandise">Store</a></li>
<li id="menu_support"><a href="../../../../support/" title="Installation, trouble-shooting, and the knowledge base">Support</a></li>
<li id="menu_products"><a href="../../../../products/" title="All software Mozilla currently offers">Products</a></li>
</ul>
<form id="searchbox_002443141534113389537:ysdmevkkknw" action="http://www.google.com/cse" title="mozilla.org Search">
<div>
<label for="q" title="Search mozilla.org's sites">search mozilla:</label>
<input type="hidden" name="cx" value="002443141534113389537:ysdmevkkknw">
<input type="hidden" name="cof" value="FORID:0">
<input type="text" id="q" name="q" accesskey="s" size="30">
<input type="submit" id="submit" value="Go">
</div>
</form>
</div>
<hr class="hide">
<div id="mBody">
<div id="side">

<ul id="nav">
<li><a title="Roadmap" href="../../../../roadmap.html"><strong> Roadmap</strong></a></li>
<li><a title="Projects" href="../../../../projects/"><strong> Projects</strong></a></li>
<li><a title="For developers" href="../../../../developer/"><strong> Coding</strong></a>
<ul>
<li><a title="Module Owners" href="../../../../owners.html"> Module Owners</a></li>
<li><a title="Hacking" href="../../../../hacking/"> Hacking</a></li>
<li><a title="Get the Source" href="http://developer.mozilla.org/en/docs/Download_Mozilla_Source_Code"> Get the Source</a></li>
<li><a title="Building Mozilla" href="http://developer.mozilla.org/en/docs/Build_Documentation"> Build It</a></li>
</ul>
</li>
<li><a title="Testing" href="../../../../quality/"><strong> Testing</strong></a>
<ul>
<li><a title="Downloads of mozilla.org software releases" href="../../../../download.html"> Releases</a></li>
<li><a title="Latest mozilla builds for testers" href="../../../../developer/#builds"> Nightly Builds</a></li>
<li><a title="For testers to report bugs" href="https://bugzilla.mozilla.org/"> Report A Problem</a></li>
</ul>
</li>
<li><a title="Tools for mozilla developers" href="../../../../tools.html"><strong> Tools</strong></a>
<ul>
<li><a title="Bug tracking system for mozilla testers." href="https://bugzilla.mozilla.org/"> Bugzilla</a></li>
<li><a title="Latest status of mozilla builds" href="http://tinderbox.mozilla.org/showbuilds.cgi?tree=Firefox"> Tinderbox</a></li>
<li><a title="Latest checkins" href="http://bonsai.mozilla.org/cvsqueryform.cgi"> Bonsai</a></li>
<li><a title="Source cross reference" href="http://lxr.mozilla.org/seamonkey/"> LXR</a></li>
</ul>
</li>
<li><a title="Frequently Asked Questions." href="../../../../faq.html"><strong> FAQs</strong></a></li>
</ul>

</div>
<hr class="hide">
<div id="mainContent">




<H1 ALIGN=CENTER><FONT SIZE=+4>G</FONT>uide to <FONT SIZE=+4>O</FONT>nline <FONT SIZE=+4>I</FONT>nternet <FONT SIZE=+4>A</FONT>ccount <FONT SIZE=+4>C</FONT>reation</H1>
<H2 ALIGN=CENTER>Netscape Communicator 4.0</H2>
<H2 ALIGN = CENTER>Milan 4.0 Client - Server</H2>

<CENTER><P><IMG SRC="dialup.gif" HEIGHT=71 WIDTH=75></P></CENTER>

<P><FONT SIZE=-1><B><I>Disclaimer:</I></B> </FONT></P>
<P><FONT SIZE=-1>Netscape provides this document solely as additional information. No technical support obligation is implied. A sample Internet account server can be found on the Mission Control CD. This software is supplied by <A HREF = "http://www.solect.com">Solect Technology</A>. This document simply contains advice about the generic account-creation process, based on internal experience with the Netscape Communicator Dial-Up Edition and Netscape's own Internet Account Server. This information is subject to change at any time and without prior notice. If you are unable to implement an account server application, your options are limited to those available through the Dial-Up Edition itself as documented in the <I>Netscape Mission Control Guide</I>. </FONT></P>

<CENTER><P><FONT SIZE=-1>&copy; 1996, 1997 Netscape Communications Corporation <BR>
All Rights Reserved. </FONT></P></CENTER>

<CENTER><P><FONT SIZE=-1>Netscape Communications, Netscape, Netscape Navigator, Netscape Communicator, 
<BR>
and the Netscape Communications logo are trademarks <BR>
of Netscape Communications Corporation. </FONT></P></CENTER>

<CENTER><P><FONT SIZE=-1>All other brand and product names mentioned herein
<BR>
are trademarks or registered trademarks <BR>
of their respective owners. </FONT></P></CENTER>

<H1>Introduction</H1>

<P>This document describes the generic interaction between Netscape Navigator (the client) and an Internet account server during the online account creation process. You can also find described here specific client-to-server (request) and server-to-client (reply) protocols available to support this process. For more information about the client side of the account creation process, see the <I>Netscape Mission Control Guide</I>. </P>

<H3>Purpose of This Document</H3>
<P>You can use this document to help you plan and build a custom online account creation process for your Internet service customers and to help you acquire subscribers for your access services.</P>

<H3>What This Document Doesn't Cover </H3>
<P>This document doesn't explain how to customize the client, nor does it cover how to create or implement a server-side account creation application.
</P>

<P>See the <I>Netscape Mission Control Guide</I> for information about customizing the account creation process on the client. The Dial-Up Edition documentation offers specific information you can use to customize the client to interact with your account-creation application. </P>
<P>

<H1>Overview</H1>
<P>The purpose of an Internet account server is to receive customer information, create a new service account based on that information, and to configure the client for access by sending the necessary new account configuration information back to the client. </P>

<P>Ordinarily, Netscape Communicator Dial-Up Edition users have two paths they can take during installation: "create an account online" or "create an account offline." This document advises ISPs who want to offer users an online, direct path to an account creation server of their own design. </P>

<P>The standard Netscape Communicator Dial-Up Edition package includes three components with which users interact: </P>

<UL>
<UL>
<LI><I>The Installation Program</I> </LI>
<LI><I>Account Setup</I></LI>
<LI><I>Netscape Navigator</I></LI>
</UL>
</UL>

<P>The Installation Program installs Account Setup and Netscape Communicator. After installation, the user runs Account Setup to establish an account with an Internet Service Provider - in this case, your service.</P>

<P>Account Setup guides the user through the information-collection and server-contact processes. It leverages information you've pre-configured in the <A HREF = "samples.html">ACCTSET.INI</A>, <A HREF = "samples.html">SAMPLE.IAS</A>, and <A HREF = "samples.html">REGISTER.HTM</A> files. These steps include running the dialer and Account Setup and establishing a PPP connection to your server for account creation. </P>

<P>Netscape Navigator passes the user's registration data to your account-server application (as an HTTP or HTTPS POST Request). The account server processes this data as appropriate, and walks the user through your registration screens, which usually includes creating a user account and packaging the final configuration information necessary to connect this client to your service. The overall flow of information is as follows:</P> 

<P>
Navigator is started with a special flag, forcing it into kiosk mode. (On the Macintosh platform, an Apple Event is used to accomplish this.) A user goes through the screens which collect data and set up the modem. Navigator connects to the server and passes along the information collected plus the contents of the <A HREF = "samples.html">REGISTER.HTM</A> file.

<P><B>Note</B>: Some information is overwritten by the client regardless of the content of the <A HREF = "samples.html">REGISTER.HTM</A> file. These fields are located in the values set by JavaScript section of <A HREF = "samples.html">REGISTER.HTM</A>. 

<P>
The server sends back any forms necessary to account creation and finishes by sending back a MIME stream as described <A HREF = "#ISPConfig">below</A>. When all of this is completed successfully, Account Setup will catch the MIME stream, interpret it, and configure the dialer and TCP/IP software for connecting to your service based on the information returned from the server. A copy of the MIME stream information is stored in ACCTINFO.TXT in the new profile directory. </P>

<H1>Process and protocols</H1>

<P>Here's the generic account-creation process in more detail. The available creation protocols appear with the steps they support. </P>

<H2>Overview of Account Creation &amp; Configuration</H2>
<P>
The following steps must occur for a successful installation and account creation/configuration: 
<OL>
<LI><A HREF = "#installation">User runs installation program</A>
<LI><A HREF = "#acct_setup">User runs Account Setup</A>
<LI><A HREF = "#ASW_acct">Account Setup collects account data</A> 
<UL>
<LI>from forms presented to the user 
<LI>from the SAMPLE.IAS file
<LI>from the <A HREF = "samples.html">REGISTER.HTM</A> file 
<LI>some values are reserved to Account Setup 
</UL>
<LI><A HREF = "#ASW_ISP">Account Setup dials the ISP's account server</A> 
<LI><A HREF = "#navigator">Navigator passes the account data to the server</A>
<UL>
<LI>Account Setup sends a form POST to the ISP's RegCGI URL containing all of the collected data.
</UL>
<LI><A HREF = "#server">The ISP's server passes configuration data back to Navigator</A>
<UL>
<LI>The ISP server gets control of a frame to display any forms needed in the server's registration process.
</UL>
<LI><A HREF = "#ISPconfig">ISP configuration data is returned</A>
<UL>
<LI>When all data is collected and the account is successfully created, the ISP server returns the MIME encoded data.
</UL>
<LI><A HREF = "#ASW_config">Account Setup puts configuration data in local files</A>
<UL>
<LI>Account Setup intercepts the MIME stream, configures the computer and finishes up.
</UL>
</OL> 

<H2><A NAME = "installation">Process: User Runs Installation Program</A></H2>

<P>The user runs the Install program from a CD or from Disk 1 of the Netscape Communicator installation diskettes. The installer places all of the necessary files on the user's hard disk. </P>

<H2><A NAME = "acct_setup">Process: User Runs Account Setup</A></H2>

<P>The user starts Account Setup which runs inside Navigator.

<P><B>Note</B>: You must test Account Setup using the exact customized version of the client that you intend to distribute to customers.

<H2><A NAME = "ASW_acct">Process: Account Setup Collects Account Data</A></H2>

<P>Account Setup gathers the user's information.</P>

<H2>Protocol: Essential Account Data</H2>

<P>There are two possible sources for the initial package of customer data that passes from client to server. The first is <A HREF = "samples.html">REGISTER.HTM</A>. In <A HREF = "samples.html">REGISTER.HTM</A>, there are two types of values - those that can be overwritten and those that can't. The values that can be overwritten are set by JavaScript.  The values that can't be overwritten are set by changing the VALUE item. </P>

<P>The second source of customer data that passes from client to server is done so by the client's HTTP header.

<H3>Values set by JavaScript in <A HREF = "samples.html">REGISTER.HTM</A></H3>

<TABLE BORDER=1 >

<TR align=center>
<TH><B>Data Element</B> </TH>
<TH><B>Data Element Name</B> </TH>
<TH><B>Type</B> </TH>
<TH><B>Length</B> </TH>
<TH><B>Accepted Values</B></TH>
</TR>

<TR>
<TD>Last Name (See <I>Note 1</I>)</TD>
<TD>CST_LAST_NAME</TD>
<TD>String</TD>
<TD>30</TD>
<TD>Free form, not null </TD>
</TR>

<TR><TD>First Name (See <I>Note 1</I>)</TD>
<TD>CST_FIRST_NAME</TD>
<TD>String</TD>
<TD>30</TD>
<TD>Free form, not null</TD>
</TR>

<TR>
<TD>Organization Name</TD>
<TD>CST_ORGANIZATION_NAME</TD>
<TD>String</TD>
<TD>30</TD>
<TD>Free form</TD>
</TR>

<TR>
<TD>Address, Line 1</TD>
<TD>CST_STREET_1</TD>
<TD>String</TD>
<TD>30</TD>
<TD>Free form, not null</TD>
</TR>

<TR>
<TD>Address, Line 2</TD>
<TD>CST_STREET_2</TD>
<TD>String</TD>
<TD>30</TD>
<TD>Free form</TD>
</TR>

<TR>
<TD>City</TD>
<TD>CST_CITY</TD>
<TD>String</TD>
<TD>20</TD>
<TD>Free form, not null</TD>
</TR>

<TR>
<TD>State or Province</TD>
<TD>CST_STATE_PROVINCE</TD>
<TD>String</TD>
<TD>10</TD>
<TD>Free form, not null</TD>
</TR>

<TR>
<TD>Postal Code</TD>
<TD>CST_POSTAL_CODE</TD>
<TD>String</TD>
<TD>10</TD>
<TD>Free form, not null</TD>
</TR>

<TR>
<TD>Country</TD>
<TD>CST_COUNTRY</TD>
<TD>String</TD>
<TD>30</TD>
<TD>Free form, not null</TD>
</TR>

<TR>
<TD>Phone (see <I>Note 2</I>)</TD>
<TD>CST_PHONE</TD>
<TD>String</TD>
<TD>25</TD>
<TD>TAPI canonical form, not null</TD>
</TR>

<TR>
<TD>Credit Card Number</TD>
<TD>CST_CC_NO</TD>
<TD>String</TD>
<TD>25</TD>
<TD>Credit card number (digits,spaces,dashes)</TD>
</TR>

<TR>
<TD>Credit Card Type</TD>
<TD>CST_CC_TYPE</TD>
<TD>String</TD>
<TD>2</TD>
<TD>MC=MasterCard, VI=VISA, AX=American Express, DC=Discover Card</TD>
</TR>

<TR>
<TD>Expiration Month</TD>
<TD>CST_CC_MTH_EXPIRE</TD>
<TD>String</TD>
<TD>2</TD>
<TD>01-12</TD>
</TR>

<TR>
<TD>Expiration Year</TD>
<TD>CST_CC_YEAR_EXPIRE</TD>
<TD>String</TD>
<TD>2</TD>
<TD>00-99</TD>
</TR>

<TR>
<TD>Name on Card</TD>
<TD>CST_CC_CARDHOLDER</TD>
<TD>String</TD>
<TD>30</TD>
<TD>Free form, not null</TD>
</TR>

<TR>
<TD>Can we share your information with other vendors?</TD>
<TD>CST_JUNK_MAIL</TD>
<TD>String</TD>
<TD>3</TD>
<TD>YES, NO</TD>
</TR>
</TABLE>

<P>Further explanation for the columns above: </P>

<UL>
<LI><I>Data Element</I> - Describes the data element collected. </LI>
<LI><I>Data Element Name</I> - The name of the element as it will be used by CGI scripts, HTML forms, INI files, and customer database fields. </LI>
<LI><I>Type</I> - The type of data contained in the element, as it corresponds to database table definitions. </LI>
<LI><I>Length</I> - The byte length of the data element as it corresponds to database table definitions and validation. </LI>
<LI><I>Accepted Values</I> - The format or valid contents for the data element. </LI>
</UL>

<P><I>Note 1: </I>Since Account Setup Wizard asks for first and last names together in one field, you can have your Internet account server double check the CST_FIRST_NAME field whenever the CST_LAST_NAME field is missing. If there are two names there, then reparse the CST_FIRST_NAME.</P>

<P><I>Note 2</I>: TAPI canonical form is defined as "+CountryCode Space [(AreaCode) Space] Subscriber Number." Subscriber Number can include periods (.), spaces ( ), and dashes (-). For example, Netscape's receptionist is +1 (415) 254-1900. </P>

<H4>URL Escaping</H4>

<P>All of the data element values passed between the client and the account server are encoded according to RFC 1738 -- Universal Resource Locators (URLs).</P>

<H3>Values set by changing the VALUE item in <A HREF = "samples.html">REGISTER.HTM</A></H3>

<TABLE BORDER=1 >
<TR>
<TH>Data Element</TH>
<TH>Data Element Name</TH>
<TH>Type</TH>
<TH>Length</TH>
<TH>Accepted Values</TH>
</TR>

<TR>
<TD>Account Setup Version</TD>
<TD>REG_SIGNUP_VERSION</TD>
<TD>String</TD>
<TD>30</TD>
<TD>Version of the sign-up application. </TD>
</TR>

<TR>
<TD>Distribution Name (see <I>Note 3</I>)</TD>
<TD>REG_SOURCE</TD>
<TD>String</TD>
<TD>30</TD>
<TD>Distribution name. Element only included if not null. </TD>
</TR>

<TR>
<TD>OS Platform of Client (see <I>Note 1</I>)</TD>
<TD>REG_PLATFORM</TD>
<TD>String</TD>
<TD>30</TD>
<TD>Platform identifier (i.e., WIN31 or WIN95). Element only included if not null.</TD>
</TR>

<TR>
<TD>Distribution ID (See <I>Note 3</I>)</TD>
<TD>REG_CHANNEL</TD>
<TD>String</TD>
<TD>30</TD>
<TD>A distribution identification string passed through to ISP.</TD>
</TR>

<TR>
<TD>PPP Login Scripting Supported by Client?</TD>
<TD>REG_SCRIPTING</TD>
<TD>String</TD>
<TD>3</TD>
<TD>YES, NO</TD>
</TR>

<TR>
<TD>Name for Account Setup program on client (See <I>Note 4</I>)</TD>
<TD>REG_SETUP_NAME</TD>
<TD>String</TD>
<TD>30</TD>
<TD>This can be anything the ISP sets on the client. The Macintosh client defaults to "Account Setup."</TD>
</TR>

<TR>
<TD>HTML publishing supported on the client?</TD>
<TD>REG_PUBLISHING</TD>
<TD>String</TD>
<TD>3</TD>
<TD>YES, NO. Element only included if not null. If not sent, assume NO.</TD>
</TR>

<TR>
<TD>Lock File</TD>
<TD>AS_LCK_SUPPORT</TD>
<TD>String</TD>
<TD>3</TD>
<TD>YES, NO</TD>
</TR>

<TR>
<TD>Bookmark File</TD>
<TD>AS_BOOKMARK_SUPPORT</TD>
<TD>String</TD>
<TD>3</TD>
<TD>YES, NO</TD>
</TR>

<TR>
<TD>Windows Animation File</TD>
<TD>AS_WIN_ANIMATION_SUPPORT</TD>
<TD>String</TD>
<TD>3</TD>
<TD>YES, NO</TD>
</TR>

<TR>
<TD>Macintosh Animation File</TD>
<TD>AS_MAC_ANIMATION_SUPPORT</TD>
<TD>String</TD>
<TD>3</TD>
<TD>YES, NO</TD>
</TR>
</TABLE>

<P>Any information defined in this section is simply sent as-is, and is optional.</P>

<P><I>Note 1</I>: Optionally, you can use REG_PLATFORM to have your server tailor its account-creation process to the client's operating system. </P>

<P><I>Note 2</I>: REG_PUBLISHING is valid only in Netscape Navigator 3.0 and later versions. </P>

<P><I>Note 3</I>: REG_SOURCE and REG_CHANNEL can be used to uniquely identify different versions for different distribution channels. </P>

<P><I>Note 4:</I> This is useful if the Account Setup program is referred to by your Internet account server and has different names on the client.</P>

<H3>From the client's HTTP header </H3>

<P>The Internet account server can collect the following information about the client from the HTTP header it receives: </P>

<TABLE BORDER=1 >
<TR>
<TH>Data Element</TH>
<TH>Data Element Name</TH>
<TH>Type</TH>
<TH>Length</TH>
<TH>Accepted Values</TH>
</TR>

<TR>
<TD>Client Type (Navigator version and platform information)</TD>
<TD>REG_USER_AGENT</TD>
<TD>String</TD>
<TD>100</TD>
<TD>Use "user-agent" HTTP header line; can be accessed by a CGI script using the HTTP_USER_AGENT environment variable.</TD>
</TR>

<TR>
<TD>IP address of connecting client (used for debugging)</TD>
<TD>REG_REMOTE_ADDR</TD>
<TD>String</TD>
<TD>20</TD>
<TD>Standard IP address in xxx.xxx.xxx.xxx format.</TD>
</TR>
</TABLE>

<HR WIDTH = "100%">

<H2>Protocol: REGISTER.HTM File Format </H2>

In Communicator 4.0, Account Setup stores the information it gathers in an HTML file, <A HREF = "samples.html">REGISTER.HTM</A>, in the following format:


<PRE>
<TT>&lt;!-- The following values can be set by changing the VALUE item --&gt;
&lt;INPUT NAME="<I>name</I>" TYPE = "hidden" VALUE = "<I>value</I>"&gt;
</TT>
</PRE>

<PRE>
<TT>&lt;!-- The following values are set via JavaScript --&gt;
&lt;INPUT NAME="<I>name</I>" TYPE="hidden"&gt;
</TT>
</PRE>

<P>The first set of values may be modified or supplemented. The values set by JavaScript must be left untouched for proper operation.

<H2><A NAME = "ASW_ISAP">Process: Account Setup Dials ISP's Phone Number</A></H2>

<P>Once it has collected the data, Account Setup uses information in the <A HREF = "samples.html">SAMPLE.IAS</A> file to run the dialer, which dials your Internet account server's phone number. The dialer establishes a PPP connection. </P>

<P>The dialer handles user verification with the PAP protocol using a fixed user name and password, which is also set in the <A HREF = "samples.html">SAMPLE.IAS</A> file. For more information on the .IAS file format, see the Netscape Mission Control Guide. The IAS password tool in the \Tools directory of the Dial-Up Edition CD should be used to create the encrypted password in the <A HREF = "samples.html">SAMPLE.IAS</A> file. However, if you're using the Account Setup Editor, the passwords are automatically encrypted.</P>

<H2><A NAME = "navigator">Process: Navigator Passes Account Data to Server</A></H2>

<P>All of the data collected is used to build a form which is then HTTP POSTed to the RegCGI URL you have provided in the <A HREF = "samples.html">SAMPLE.IAS</A> file. Navigator uses the URL you've stored in the <A HREF = "samples.html">SAMPLE.IAS</A> file as the target of the form. This behavior is the same as if you had entered the following HTML syntax:
<P>
<TT>&lt;form action = "https://SERVER.ISP.COM/REG.CGI"&gt;</TT>
<BR>where <I>SERVER</I> is the name of your registration server, <I>ISP</I> is your company name, and <I>regcgi</I> is the CGI script to be used.

<P>Because account information is confidential (especially credit card numbers), you should implement your account-creation application with an SSL-capable web server such as Netscape's Enterprise Server. Note that the <A HREF = "samples.html">REGISTER.HTM</A> file format example above specifies the HTTPS protocol to enable Secure Sockets Layer (SSL) encryption. However, you can change the protocol to HTTP.</P>

<H2>Process: Server Interacts with User</H2>

<P>Account Setup provides a frame in which server generated forms may be displayed to the user to gather account creation data. These forms are generated by your server using standard CGI protocols.
 

<H2><A NAME = "server">Process: Server Passes Configuration Data Back to Navigator</A></H2>

<P>Your account server application should create the account based on the data submitted and send that configuration data to the client so Account Setup can finish configuring the dial-in components for your service.
</P>

<P>When Navigator receives the configuration data from the server, a plug-in parses the data.</P>

<OL>
<LI>The icon (&lt;ICON&gt;) for your service is saved in the user's profile directory. The filename comes from the DOMAIN_NAME value returned in the MIME stream. This is the same as the ISP name.</LI>
<LI>Once the data is received and parsed,  the plug-in returns control to Account Setup. </LI>
</OL>

<H2><A NAME = "ISPconfig">Protocol: ISP Configuration Data </A></H2>

<P>Your configuration information is sent in a MIME stream. The MIME header in your CGI script must be followed by two carriage returns, per the standard CGI format. The MIME type Navigator uses to receive ISP configuration data can be either of two specially coded content types: </P>

<UL>
<PRE><TT>application/x-netscape-autoconfigure-dialer</TT></PRE>
</UL>

<P>When Navigator sees this MIME type, it expects data in the format described below. The binary file format used by this MIME type is simple, yet extensible. It consists of consecutive name/value pairs separated by 2 bytes of size information: </P>

<PRE><TT>| 2 bytes | ------ x bytes ------ | 2 bytes | ------ y bytes ------ |  (x)              (name)            (y)             (value)</TT></PRE>

<P>The parser iterates as follows until it reaches the end of the stream:</P>
<UL>
<LI>Read 2 bytes of binary data and cast to int for size of Name in bytes (x) </LI>
<LI>Read (x) bytes of ASCII data for the name </LI>
<LI>Read 2 bytes of binary data and cast to int for size of Value in bytes (y) </LI>
<LI>Read (y) bytes of ASCII data for the value </LI>
</UL>

<P>Communicator 4.0+ also accepts the following MIME type:

<UL>
<PRE><TT>application/x-netscape-autoconfigure-dialer-v2</TT></PRE>
</UL>

<P>When Navigator sees this MIME type, it expects data in the format described below. The binary file format used by this MIME type is simple, yet extensible. It consists of consecutive name/value pairs separated by 4 bytes of size information: </P>

<PRE><TT>| 4 bytes | ------ x bytes ------ | 4 bytes | ------ y bytes ------ |  (x)              (name)            (y)             (value)</TT></PRE>

<P>The parser iterates as follows until it reaches the end of the stream:</P>
<UL>
<LI>Read 4 bytes of binary data and cast to int for size of Name in bytes (x) </LI>
<LI>Read (x) bytes of ASCII data for the name </LI>
<LI>Read 4 bytes of binary data and cast to int for size of Value in bytes (y) </LI>
<LI>Read (y) bytes of ASCII data for the value</LI>
</UL>
<P>
<H4>Notes:</H4>
<UL>
<LI>This format is virtually identical to the 3.0 format with the exception that the length descriptions for the name and value fields is a 32 bit integer rather than a 16 bit integer.
<LI>The 3.0 format (application/x-netscape-autoconfigure-dialer with 16 bit integers) will continue to be accepted, but may not be adequate to contain some of the new data fields. The new format is only required when a large amount of data must be contained in one or more fields.
<LI>Older clients will not recognize the new v2 format. We only recommend sending this format if the REG_SIGNUP_VERSION value is 4.0 or greater.
<LI>We recommend continuing to use the 3.0 format, unless you are sure that the version is 4.0 or greater, or if one of your data fields is larger than 16K.
</UL> 

<P>Navigator extracts the following name/value pairs from the data and processes them according to the tables below. </P>

<P>The first name/value pair must always be the status value. If a user cancels, the account server needs to send a MIME stream of STATUS=ERROR to let Navigator gracefully shut down. Otherwise, STATUS=OK and the remaining items are included in the stream. </P>

<P>The length fields are represented in Little Endian ("1234") format. The integer value 6 is represented as 00 06 in application/x-netscape-autoconfigure-dialer and as 00 00 00 06 in application/x-netscape-autoconfigure-dialer-v2. On machines using Big Endian ("4321") or
PDP Endian ("3412") formats, you must take care to convert appropriately. 

<H3>Written to the [ISP Information] section of SAMPLE.IAS </H3>

<P>Navigator writes this information to the <A HREF = "samples.html">SAMPLE.IAS</A> file. (The order of entries may change and some are optional. Since each element is self-identifying via the name this isn't a problem): </P>

<TABLE BORDER=1 >
<TR>
<TH>Data Element</TH>
<TH>Data Element Name</TH>
<TH>Type</TH>
<TH>Description</TH>
</TR>

<TR>
<TD>Status<BR>
<B>Required</B><BR>
<B>Must be the first field</B></TD>
<TD>STATUS</TD>
<TD>String</TD>
<TD>This is set to OK for a normal download. The STATUS field needs to be the first name/value pair passed back in the MIME stream. If the user cancels, it's set to ERROR and no other items are sent. This can also be set to EXIT, to completely shutdown Account Setup. Both ERROR and EXIT result in <B>no</B> account creation.</TD>
</TR>

<TR>
<TD>Site File<BR>
<B>Required</B></TD>
<TD>SITE_FILE</TD>
<TD>String</TD>
<TD>This names the Shiva remote (.SR) site profile file and icon file. It's limited to 8 characters so you can derive up to an 8+3 file for that host. A typical example would be netisp which would lead to site file NET <A HREF = "samples.html">ISP.SR</A> being used by the dialer.</TD>
</TR>

<TR>
<TD>Site Name<BR>
<B>Required</B></TD>
<TD>SITE_NAME</TD>
<TD>String</TD>
<TD>A short textual name of the site, used for identification purposes (e.g., Windows 3.1 Program Manager or Windows 95 Dial-Up Networking item name).</TD>
</TR>

<TR>
<TD>User Login<BR>
<B>Required</B></TD>
<TD>LOGIN</TD>
<TD>String</TD>
<TD>The login ID (in clear text) used to contact your Internet access service.</TD>
</TR>

<TR>
<TD>User Password<BR>
<B>Required</B></TD>
<TD>PASSWORD</TD>
<TD>String</TD>
<TD>The encrypted password for the above login.</TD>
</TR>

<TR>
<TD>Phone Number <BR>
<B>Required</B></TD>
<TD>PHONE_NUM</TD>
<TD>String</TD>
<TD>The complete phone number to dial to contact your site. It's passed in (xxx) xxx-xxxx format. The dialer automatically adjusts for area codes, etc. 

<P>Note: TAPI cononical form is defined as "+CountryCode Space [(AreaCode) Space] SubscriberNumber." Subscriber Number can include periods, spaces, and dashes. </P>
</TD>
</TR>

<TR>
<TD>DNS Address<BR>
<B>Required</B></TD>
<TD>DNS_ADDR</TD>
<TD>String</TD>
<TD>DNS address in xxx.xxx.xxx.xxx format.</TD>
</TR>

<TR>
<TD>Alternate DNS Address<BR>
<B>Required</B></TD>
<TD>DNS_ADDR_2</TD>
<TD>String</TD>
<TD>Secondary DNS address in xxx.xxx.xxx.xxx format (set to 0.0.0.0 if none exists).</TD>
</TR>

<TR>
<TD>NNTP Host<BR>
<B>Required</B></TD>
<TD>NNTP_HOST</TD>
<TD>String</TD>
<TD>The news host (either IP address or hostname).</TD>
</TR>

<TR>
<TD>SMTP Host<BR>
<B>Required</B></TD>
<TD>SMTP_HOST</TD>
<TD>String</TD>
<TD>The email host (either IP address or hostname).</TD>
</TR>

<TR>
<TD>Domain Name<BR>
<B>Required</B></TD>
<TD>DOMAIN_NAME</TD>
<TD>String</TD>
<TD>Your organization's domain name (for email purposes).</TD>
</TR>

<TR>
<TD>POP Server / Login<BR>
<B>Required</B></TD>
<TD>POP_SERVER</TD>
<TD>String</TD>
<TD>The login name and host name or IP address of the user's POP server. The format is &lt;USER&gt;@&lt;POP_SERVER&gt;. This data is stored in the user's mail configuration file.</TD>
</TR>

<TR>
<TD>Email Password<BR>
<B>Required</B></TD>
<TD>POP_PASSWORD</TD>
<TD>String</TD>
<TD>The password for the above POP server.</TD>
</TR>

<TR>
<TD>Home Page URL<BR>
<B>Required</B></TD>
<TD>HOME_URL</TD>
<TD>String</TD>
<TD>The default home page URL. <I>Note:</I> if the home page is locked using the Administration Edition NETSCAPE.LCK file this URL information will be ignored.</TD>
</TR>

<TR>
<TD>Email Address<BR>
<B>Required</B></TD>
<TD>EMAIL_ADDR</TD>
<TD>String</TD>
<TD>The email return address for the user.</TD>
</TR>

<TR>
<TD>Custom Animation</TD>
<TD>ANIMATION_DAT; <BR>ANIMATION_RES</TD>
<TD>Animated gif file</TD>
<TD>These files are combined into the "Custom Animation" file in the profile. </TD>
</TR>

<TR>
<TD>Large Animation</TD>
<TD>ANIMATION_LARGE</TD>
<TD>Animated gif file</TD>
<TD>Windows Only: 32x32 binary gif animation data to replace Netscape N in upper right corner of navigator</TD>
</TR>

<TR>
<TD>Small Animation</TD>
<TD>ANIMATION_SMALL</TD>
<TD>Animated gif file</TD>
<TD>16x16 binary gif animation data to replace Netscape N in upper right corner of navigator</TD>
</TR>

<TR>
<TD>Auto-send character</TD>
<TD>AUTO_SEND</TD>
<TD>String</TD>
<TD>Specifies characters to send from client to server prior to initiating scripted or TTY logins. Applicable only if such characters are needed (e.g., sending two carriage returns to begin a connection).</TD>
</TR>

<TR>
<TD>Bookmark File</TD>
<TD>BOOKMARK_FILE</TD>
<TD>String</TD>
<TD>The new bookmarks are appended if a bookmark file already exists. The new bookmarks will replace the default bookmark file of a brand-new profile.</TD>
</TR>

<TR>
<TD>Dial Area Code (See Phone number information below)</TD>
<TD>DIAL_AREA_CODE</TD>
<TD>String</TD>
<TD>If DIAL_AS_LONG_DISTANCE is set to YES, but calling plan doesn't support dialing area code, set to NO. </TD>
</TR>

<TR>
<TD>Long Distance Flag (See Phone number information below)</TD>
<TD>DIAL_AS_LONG_DISTANCE</TD>
<TD>String</TD>
<TD>If long-distance dialing is needed, set to YES. </TD>
</TR>

<TR>
<TD>ISP Icon</TD>
<TD>ICON</TD>
<TD>32x32 Icon File</TD>
<TD>(Windows platforms only) 32x32 Windows ICO format icon of your organization's logo. Saved in file called &lt;SITE_FILE&gt;.ico. For Macintosh platforms, the contents of the icon file must be sent as inline data for this element.</TD>
</TR>

<TR>
<TD>ISP Account ID</TD>
<TD>IDS_ACCT_ID</TD>
<TD>String</TD>
<TD>The user's account ID with you. Ignored on the client.</TD>
</TR>

<TR>
<TD>IMAP Host Server</TD>
<TD>IMAP_HOST 1, 2, ...</TD>
<TD>String</TD>
<TD>The server(s) for IMAP mail, where <I>1, 2, ...</I> is an integer.</TD>
</TR>

<TR>
<TD>IMAP Server Path </TD>
<TD>IMAP_SERVERPATH</TD>
<TD>String</TD>
<TD>This information overrides the POP_SERVER when present.</TD>
</TR>

<TR>
<TD>ISP Technical Support Number</TD>
<TD>ISP_SUPPORT</TD>
<TD>String</TD>
<TD>Support number the customer should use to contact you.</TD>
</TR>

<TR>
<TD>ISP WWW URL</TD>
<TD>ISP_URL</TD>
<TD>String</TD>
<TD>Your organizations' URL, which is added to the user's bookmark file. This is paired with SITE_NAME for the new bookmark entry.</TD>
</TR>

<TR>
<TD>Lock File</TD>
<TD>LCK_FILE</TD>
<TD>String</TD>
<TD>This data becomes a new profile.cfg file in the current profile. Client-side support of lock files is indicated by AS_LCK_SUPPORT=YES in the initial form post from the client.</TD>

<TR>
<TD>LDAP Description</TD>
<TD>LDAP_DESC_ 1, 2, ... </TD>
<TD>String</TD>
<TD>Where <I>1, 2, ...</I> is an integer and LDAP_HOST[i] is described by LDAP_DESC[i].</TD>
</TR>

<TR>
<TD>LDAP Host</TD>
<TD>LDAP_HOST_1, 2, ...</TD>
<TD>String</TD>
<TD>The server(s) for directory (LDAP) information, where <I>1, 2, ...</I> is an integer.</TD>
</TR>

<TR>
<TD>Login Script</TD>
<TD>LOGIN_SCRIPT</TD>
<TD>String</TD>
<TD>Only specify a login script if your server doesn't support PAP or CHAP protocols. See below for more information on login scripts.</TD>
</TR>

<TR>
<TD>Long Description</TD>
<TD>LONG_DESC</TD>
<TD>String</TD>
<TD>A longer description of the site to be stored for help information.</TD>
</TR>

<TR>
<TD>Location of where new pages will be published</TD>
<TD>PUBLISH_PUSH_URL</TD>
<TD>String</TD>
<TD>URL of where client will upload new HTML pages to. Examples include: ftp://username@server/usr/home or http://username@server/./</TD>
</TR>

<TR>
<TD>Password for account used in PUBLISH_PUSH_URL above</TD>
<TD>PUBLISH_PUSH_PASSWORD</TD>
<TD>String</TD>
<TD>Clear text password for the account on the web publishing server specified in the URL of PUBLISH_PUSH_URL.</TD>
</TR>

<TR>
<TD>Location of where published pages can be viewed</TD>
<TD>PUBLISH_VIEW_URL</TD>
<TD>String</TD>
<TD>URL of where client will view new HTML pages.</TD>
</TR>

<TR>
<TD>Netscape Registration ID</TD>
<TD>REG_ID</TD>
<TD>String</TD>
<TD>Netscape registration ID as stored in the cookie. Netscape reserved field.</TD>
</TR>

<TR>
<TD>VJ Compression</TD>
<TD>VJ_COMPRESSION</TD>
<TD>String</TD>
<TD>YES, NO. 
<P>Allows the account server to control VJ compression status on the client. This field is ignored on the Macintosh client.</P>
</TD>
</TR>
</TABLE>

<H4>Phone number information</H4>

<P>Generally, Account Setup uses a combination of the user's phone number and the ISP's phone number to derive the number to dial (i.e., 1+area code + number, versus the number alone). However, it can happen that both phone numbers are in the same area code but the user still needs to dial a "1" prefix. These two flags give you independent control over dialing "1" (DIAL_AS_LONG_DISTANCE ) and the area code (DIAL_AREA_CODE). For default behavior, see that your account server doesn't set either of these flags. </P>

<P>If DIAL_AS_LONG_DISTANCE is set to YES then the "Home" (default) location for this account will be set up to dial a '1' before the number in the PHONE_NUM field. This field will be ignored if InternationalMode was set in <A HREF = "samples.html">ACCTSET.INI</A></P>

<P>If DIAL_AREA_CODE is set to YES then the "Home" (default) location for this account will dial the area code given in the PHONE_NUM field. If there is no area code given in the PHONE_NUM then this field has no effect. This field will be ignored if InternationalMode was set in <A HREF = "samples.html">ACCTSET.INI</A></P>

<P>If neither of these fields are sent back by your Internet account server, then Account Setup will set 'logical' defaults (both true if the number being dialed has an 800 area code, or has a different area code than the user's number.</P>

<H4>The Login Script</H4>

<P>On Windows 3.1, we use the ShivaPPP script language which is an extremely limited derivative of the Microsoft scripting language. These limitations are further constricted by Account Setup and reduced to the auto_send and login_script variables. </P>

<P>When auto_send and login_script are returned to the PC client, Account Setup does the following: </P>

<OL>
<LI>Place the auto_send character into the &lt;isp&gt;.sr file as: </LI>

<CENTER><TABLE>
<TR>
<TD>[Security]<BR>
AutoSend=&lt;auto_send value&gt; </TD>
</TR>
</TABLE>
</CENTER>

<P>This value is only meaningful when the login_script value is not also present. The Shiva dialer will ignore the auto_send if a script exists.</P>

<LI>Parse the login_script into a script file and place it in &lt;isp&gt; .scp in the same directory as &lt;isp&gt;.sr. </LI>

<P>The login_script configuration value is formatted as: </P>

<CENTER><P><I>wait_for_string "|" [ reply_string ] [ "|" wait_for_string "|" [ reply_string ] ]... </I></P></CENTER>

<P>Note that if the reply_string is omitted and more wait/reply cycles remain, then the "|" delimiter <B>must</B> be present or the cycle will get out of sync. Also note that every character is significant.</P>

<P>The reply_string values "%name" and "%password" are handled specially. The "%name" is converted into the scripting variable $USERID and the "%password" is converted into the scripting variable $PASSWORD. All other values are passed through unmodified. </P>

<UL>
<LI>The script prolog is: </LI>

<CENTER><TABLE>
<TR>
<TD>; &lt;isp&gt;.scp<BR>; Created: &lt;date&gt; at &lt;time&gt;<BR>
;<BR>
;<BR>
proc main<BR>
transmit "^M"<BR>
</TD>
</TR>
</TABLE></CENTER>

<LI>The wait_for_string is scripted as: </LI>

<CENTER><TABLE>
<TR>
<TD>waitfor "&lt;wait_for_string&gt;",matchcase until 4 </TD>
</TR>
</TABLE></CENTER>

<LI>The reply_string is scripted as: </LI>

<CENTER><TABLE>
<TR>
<TD>transmit "&lt;reply_string&gt;"<BR>
transmit "^M"<BR>
</TD>
</TR>
</TABLE></CENTER>

<P>or </P>

<CENTER><TABLE>
<TR>
<TD>transmit $USERID<BR>
transmit "^M"<BR>
</TD>
</TR>
</TABLE></CENTER>

<P>or </P>

<CENTER><TABLE>
<TR>
<TD>transmit $PASSWORD<BR>
transmit "^M"<BR>
</TD>
</TR>
</TABLE></CENTER>

<LI>The script is terminated with: </LI>

<CENTER><TABLE>
<TR>
<TD>endproc </TD>
</TR>
</TABLE></CENTER>
</UL>

<LI>Create the [Script] section in the &lt;isp&gt;.sr file. Set the flags to use scripting and add a pointer to the new script file &lt;isp&gt;scp. </LI>

<CENTER><TABLE>
<TR>
<TD>[Script]<BR>
ScriptEnabled=Yes ; use a script<BR>
ScriptRecord=No ; don't go into record script mode<BR>
ScriptTerminal=No ; don't playback script output during login<BR>
</TD>
</TR>
</TABLE></CENTER>

<P>ScriptFileName=&lt;full path to &lt;isp&gt;.scp&gt; </P>
</OL>

<P>As an example, the login_script value: </P>

<CENTER><P>name:|ispname|type:|ppp|login:|%name|password:|%password </P></CENTER>
<P>will result in the script: </P>

<CENTER><TABLE>
<TR>
<TD>; &lt;isp&gt;.scp<BR>
; Created: &lt;date&gt; at &lt;time&gt;<BR>
;<BR>
;<BR>
proc main<BR>
transmit "^M"<BR>
<BR>
waitfor "name:",matchcase until 4<BR>
transmit "ispname"<BR>
transmit "^M"<BR>
<BR>
waitfor "type:",matchcase until 4<BR>
transmit "ppp"<BR>
transmit "^M"<BR>
<BR>
waitfor "login:",matchcase until 4<BR>
transmit $USERID<BR>
transmit "^M"<BR>
waitfor "password:",matchcase until 4<BR>
transmit $PASSWORD<BR>
transmit "^M"<BR>
<BR>
endproc<BR>
</TD>
</TR>
</TABLE></CENTER>

<H4>Publishing information</H4>

<P>REG_PUBLISHING is set to 'yes' in <A HREF = "samples.html">REGISTER.HTM</A> in the Netscape Navigator 3.0 Gold and all 4.0 and greater releases of the dial up products. When this is sent to an Internet account server, it will send back the appropriate 'push' PUBLISH parameters back to Account Setup. These are then written into NETSCAPE.INI for Windows 3.1 or the Registry for Windows 95 at the given locations:</P>

<UL>
<UL>
<LI>PUBLISH_PUSH_URL - Written to <TT>[Publish] DefaultLocation=</TT> also written to <TT>[Publish] LastLocation=</TT> </LI>
<LI>PUBLISH_VIEW_URL - Written to <TT>[Publish] DefaultBrowseLocation=</TT>
<LI>PUBLISH_PUSH_PASSWORD - encrypted and then written to <TT>[Publish] DefaultPassword= [Publish] LastPassword= [Mail] POP Password=</TT> also <TT>[Publish] RememberPassword="yes"</TT></LI>
</UL>
</UL>
<P><BR>
<BR></P>

<H2><A NAME = "ASW_config">Process: Account Setup Puts Configuration Data in Local Files</A></H2>

<P>After Navigator exits, control returns to Account Setup.</P>

<H3>Windows platforms</H3>

<P>Account Setup automatically performs these steps on Windows platforms: </P>

<OL>
<LI>Create a connection file for your organization named &lt;SITE_FILE&gt;.sr.</LI>
<LI>On Windows 3.1, move the temporary icon file to the directory where the Account Setup program is located. Rename the icon file &lt;SITE_FILE&gt;.ico.</LI>
<LI>Update Navigator's initialization files (e.g., on Windows 3.1, NETSCAPE.INI, and SHIVAPPP.INI; on Windows 95, Windows Registry). </LI>
<LI>On Windows 3.1, the client creates a Windows Program Manager item in the Netscape Dial-Up Edition group for this dial-in connection. The properties of the dialer icon include: </LI>
</OL>

<TABLE BORDER=1 >
<TR>
<TD>Description</TD>
<TD>&lt;SITE_NAME&gt; field returned from your Internet account-server application.</TD>
</TR>

<TR>
<TD>Command Line</TD>
<TD>Path to dialer executable with your organization's parameters.</TD>
</TR>

<TR>
<TD>Working Directory</TD>
<TD>Path to dialer's working directory.</TD>
</TR>

<TR>
<TD>Shortcut Key</TD>
<TD>None.</TD>
</TR>

<TR>
<TD>Icon</TD>
<TD>&lt;ICON&gt; file returned from your Internet account-server application.</TD>
</TR>
</TABLE>


<P>On Windows 95 the client uses data sent back from the account server to configure a Dial-Up Networking object on the desktop and in the Dial-Up Networking folder in the My Computer folder. </P>

<H3>Macintosh platforms</H3>

<P>On Macintosh platforms Account Setup updates the preferences files for Netscape Navigator, Free PPP, MacTCP (if installed), and Open Transport (if installed).</P>

<H2>Process: User Runs Dialer and Navigator</H2>

<P>After exiting Account Setup, the user can run the dialer and then Navigator to log directly into the new account using the configured data. Navigator should immediately connect to all the proper ports and servers. </P>



<hr class="hide">
</div>
</div>
<div id="footer">
<ul>
<li><a href="../../../../sitemap.html">Site Map</a></li>
<li><a href="../../../../security/">Security Updates</a></li>
<li><a href="../../../../contact/">Contact Us</a></li>
<li><a href="../../../../foundation/donate.html">Donate</a></li>
</ul>
<p class="copyright">
Portions of this content are &copy; 1998&#8211;2009 by individual mozilla.org
contributors; content available under a Creative Commons license | <a
href="http://www.mozilla.org/foundation/licensing/website-content.html">Details</a>.</p>
<p>
<span>Last modified February 17,  1999</span>
<span><a href="http://bonsai-www.mozilla.org/cvslog.cgi?file=mozilla-org/html/projects/cck/docs/milan/milan5.html&amp;rev=&amp;root=/www/">Document History</a></span>
</p>
</div>
</div>
</body>
</html>
