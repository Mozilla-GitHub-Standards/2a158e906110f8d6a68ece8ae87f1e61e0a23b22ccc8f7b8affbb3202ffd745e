<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
<link rel="top" title="Home" href="http://www.mozilla.org/">
<link rel="stylesheet" type="text/css" href="../../../css/print.css"  media="print">
<link rel="stylesheet" type="text/css" href="../../../css/base/content.css"  media="all">
<link rel="stylesheet" type="text/css" href="../../../css/cavendish/content.css" title="Cavendish" media="screen">
<link rel="stylesheet" type="text/css" href="../../../css/base/template.css"  media="screen">
<link rel="stylesheet" type="text/css" href="../../../css/cavendish/template.css" title="Cavendish" media="screen">
<link rel="icon" href="../../../images/mozilla-16.png" type="image/png">

   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="Author" content="Katsuhilo Momoi">
   <meta name="GENERATOR" content="Mozilla/4.76 [en] (WinNT; U) [Netscape]">
   <title>International Editor UI/UE Specifications</title>
<script src="../../../__utm.js" type="text/javascript"></script>
</head>
<body id="www-mozilla-org" class="deepLevel">
<div id="container">
<p class="important">You are currently viewing a snapshot of www.mozilla.org taken on April 21, 2008. Most of this content is
highly out of date (some pages haven't been updated since the project began in 1998) and exists for historical purposes only.  If
there are any pages on this archive site that you think should be added back to www.mozilla.org, please <a
href="https://bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=www.mozilla.org">file a bug</a>.</p>
<p class="skipLink"><a href="#mainContent" accesskey="2">Skip to main content</a></p>
<div id="header">
<h1><a href="/" title="Return to home page" accesskey="1">Mozilla</a></h1>
<ul>
<li id="menu_aboutus"><a href="../../../about/" title="Getting the most out of your online experience">About</a></li>
<li id="menu_developers"><a href="../../../developer/" title="Using Mozilla's products for your own applications">Developers</a></li>
<li id="menu_store"><a href="http://store.mozilla.org/?r=mozorg1" title="Shop for Mozilla products on CD and other merchandise">Store</a></li>
<li id="menu_support"><a href="../../../support/" title="Installation, trouble-shooting, and the knowledge base">Support</a></li>
<li id="menu_products"><a href="../../../products/" title="All software Mozilla currently offers">Products</a></li>
</ul>
<form id="searchbox_002443141534113389537:ysdmevkkknw" action="http://www.google.com/cse" title="mozilla.org Search">
<div>
<label for="q" title="Search mozilla.org's sites">search mozilla:</label>
<input type="hidden" name="cx" value="002443141534113389537:ysdmevkkknw">
<input type="hidden" name="cof" value="FORID:0">
<input type="text" id="q" name="q" accesskey="s" size="30">
<input type="submit" id="submit" value="Go">
</div>
</form>
</div>
<hr class="hide">
<div id="mBody">
<div id="side">

<ul id="nav">
<li><a title="Roadmap" href="../../../roadmap.html"><strong> Roadmap</strong></a></li>
<li><a title="Projects" href="../../../projects/"><strong> Projects</strong></a></li>
<li><a title="For developers" href="../../../developer/"><strong> Coding</strong></a>
<ul>
<li><a title="Module Owners" href="../../../owners.html"> Module Owners</a></li>
<li><a title="Hacking" href="../../../hacking/"> Hacking</a></li>
<li><a title="Get the Source" href="http://developer.mozilla.org/en/docs/Download_Mozilla_Source_Code"> Get the Source</a></li>
<li><a title="Building Mozilla" href="http://developer.mozilla.org/en/docs/Build_Documentation"> Build It</a></li>
</ul>
</li>
<li><a title="Testing" href="../../../quality/"><strong> Testing</strong></a>
<ul>
<li><a title="Downloads of mozilla.org software releases" href="../../../download.html"> Releases</a></li>
<li><a title="Latest mozilla builds for testers" href="../../../developer/#builds"> Nightly Builds</a></li>
<li><a title="For testers to report bugs" href="https://bugzilla.mozilla.org/"> Report A Problem</a></li>
</ul>
</li>
<li><a title="Tools for mozilla developers" href="../../../tools.html"><strong> Tools</strong></a>
<ul>
<li><a title="Bug tracking system for mozilla testers." href="https://bugzilla.mozilla.org/"> Bugzilla</a></li>
<li><a title="Latest status of mozilla builds" href="http://tinderbox.mozilla.org/showbuilds.cgi?tree=Firefox"> Tinderbox</a></li>
<li><a title="Latest checkins" href="http://bonsai.mozilla.org/cvsqueryform.cgi"> Bonsai</a></li>
<li><a title="Source cross reference" href="http://lxr.mozilla.org/seamonkey/"> LXR</a></li>
</ul>
</li>
<li><a title="Frequently Asked Questions." href="../../../faq.html"><strong> FAQs</strong></a></li>
</ul>

</div>
<hr class="hide">
<div id="mainContent">





<center>
<h2>
Seamonkey Editor Character Coding Menu UE Specifications</h2></center>

<center><font size=-1>Version 1.2</font></center>

<p>Written by: <a href="mailto: momoi@netscape.com">Katsuhiko Momoi</a>
<br>Last Update: 2/26/2001
<br>** Thanks to <a href="mailto:tague@netscape.com">Tague Griffith</a>,
<a href="mailto:brade@netscape.com">Kathy
Brade</a>, <a href="mailto:bobj@netscape.com">Bobj Jung</a>, <a href="mailto:teruko@netscape.com">Teruko
Kobayashi</a>, <a href="ylong@netscape.com">Yuying Long</a>, <a href="mailto:cmasnke@netscape.com">Charlie
Manske</a>, <a href="mailto:ftang@netscape.com">Frank Tang</a>, and <a href="mailto:yokoyama@netscape.com">Roy
Yokoyama</a> for comments &amp; suggestions.
<br><b>Address Comments to:</b> <a href="mailto:mozilla-i18n@mozilla.org">mozilla-i18n@mozilla.org</a>,
<a href="mailto:mozilla-editor@mozilla.org">mozilla-editor@mozilla.org</a>,
and <a href="mailto:mozilla-ui@mozilla.org">mozilla-ui@mozilla.org</a>,
or post articles at: <a href="news://news.mozilla.org/netscape.public.mozilla.i18n">netscape.public.mozilla.i18n</a>,
<a href="news://news.mozilla.org/netscape.public.mozilla.editor">netscape.public.mozilla.editor</a>,
and <a href="news://news.mozilla.org/netscape.public.mozilla.ui">netscape.public.mozilla.ui</a>.
<br>&nbsp;
<p><b><font color="#FF0000">Note:</font></b> This document contains specific
UI proposal for the Editor charset menu. The Editor charset menu UI is
nearly identical to the Browser charset menu published on the Mozilla.org
site. See: <a href="http://www.mozilla.org/projects/intl/uidocs/browsercharmenu.html">http://www.mozilla.org/projects/intl/uidocs/browsercharmenu.html</a>
<p><b><font color="#FF0000">Note 2</font>:</b> Version 1.2 clarifies a
number of items that had not been addressed in version 1.1. It also eliminated
discussion of alternatives and instead focus on the specifications currently
available with Mozilla builds circa 2/26/2001. For the discussion of proposed
alternatives and other details omitted from this new version, see <a href="5_0intleditorui1.1.html">version
1.1</a> document.
<p>
<hr WIDTH="100%">
<br><b><font size=+1>Contents</font></b>
<p><a href="#general">Editor Charset Menu -- General features</a>
<br><a href="#saveasmenu">Save, Save as ..., and Save as Charset ...</a>
<ul>
<li>
<a href="#currentdocchar">Current Document Encoding</a></li>

<li>
<a href="#savemenus">Save, Save as..., and Save as Charset menu definitions.</a></li>

<li>
<a href="#saveascharmenu">illustration of Save as ... Charset dialog</a></li>
</ul>
<a href="#menuactions">Character Coding Menu item actions</a>
<ul>
<li>
<a href="#opennewdoc">Opening a new document</a></li>

<li>
<a href="#openexistdoc">Opening an existing document into Editor</a></li>

<li>
<a href="#openviabrowser">Opening an existing document via Browser</a></li>

<li>
<a href="#changecharset">Changing Character Coding Menu selection</a></li>

<ul>
<li>
<a href="#menustatus">Menu Status</a></li>
</ul>

<li>
<a href="#selectautodetect">Auto-Detection</a></li>
</ul>
<a href="#override">Charset Override</a>
<p>
<hr WIDTH="100%">
<br><a NAME="general"></a>
<p><b>0. Editor Charset Menu: General Features</b>
<ul>
<li>
<font color="#000000"><b>Browser &amp; Messenger</b> &amp; <b>Editor </b>share
the same <b>View | Character Coding&nbsp;</b> menu architecture. See <a href="http://www.mozilla.org/projects/intl/uidocs/browsercharmenu.html">here</a>
for the Dynamic charset menu proposal. Most of this proposal has been already
implemented in the Browser component at M14 and also appear in Netscape
6.0/6.01. They include the following features</font></li>

<ul>
<li>
Auto-Detector list</li>

<li>
More menu (the remainder -- what is not on the Static menu below.)</li>

<li>
Customize dialog -- this lets you customize the Static part of the encoding
menu below.</li>

<li>
Static encodings list</li>

<ul>
<li>
A list of encodings that will appear in the top tier of the View | Character
Coding menu whether or not a cache list has been built.</li>
</ul>

<li>
Cached encoding list (most recently used 5 encodings that are different
from the items on Static list).</li>
</ul>

<li>
<b><font color="#000000">Semantics:</font></b></li>

<ul>
<li>
<font color="#000000">Switching a <b>View | Character Coding</b> menu item
means ..</font></li>

<ul>
<li>
<font color="#000000">Load/reload existing page/message assuming the document
to be in the </font><font color="#FF0000">chosen</font><font color="#000000">
character encoding. We will adhere to this interpretation as much as possible.
(Cf. See <a href="#override">below</a> for the notion of&nbsp; <b>"Charset
Override"</b>.)</font></li>

<li>
<font color="#000000">In 4.x, this menu was also used to convert source
document into another charset under certain conditions. This function will
be borne by the "Save as Charset..." menu in Mozilla. (Note: Under circumstances
when</font></li>
</ul>
</ul>
</ul>
<a NAME="saveasmenu"></a>
<p><b><font color="#000000">00. Browser/Editor/Messenger/Mail Editor: "Save",
"Save as...", and "Save as Charset" (Editor only) menu items.:</font></b>
<ul>
<li>
<a NAME="currentdocchar"></a><b><font color="#FF0000">Current Document
Encoding:</font></b></li>

<ul>
<li>
<font color="#000000">The current document encoding is the encoding menu
item which is marked by a bullet in front of it.&nbsp; The current encoding
is determined by an algorithm as defined in the Browser Character Coding
menu specification document.&nbsp; It is critical to understand this concept
for saving actions in the Editor.</font></li>

<ul>
<li>
<font color="#000000">On a new document, the Current Document encoding
will be the same as the Default Encoding in </font><b>Edit | Preferences
| Navigator | Languages | Character Coding.</b></li>

<li>
On an existing document, the Current Encoding will be determined honoring
the hierarchy:&nbsp; <b>HTTP charset > Document Meta Charset tag > Auto-detection
(if ON) > Current Document Encoding (if opening it via File | Edit Page
menu) > Default Encoding</b>. Default Encoding will be used only if the
Current Document is not available, e.g. opening directly into the Editor
window without first opening it in the Browser window. In other words,
the highest element in the hierarchy has precedence over the lower elements
in determining what the Current Document Encoding.</li>

<li>
Even is the Current Document has been determined, the user can manually
change it by engaging the <b>View | Character Coding</b> menu.</li>
</ul>
</ul>

<li>
<a NAME="savemenus"></a><b><font color="#000000">File | Save:</font></b></li>

<ul>
<li>
<font color="#000000">Saves the current document using the Current Document
Encoding.</font></li>
</ul>

<li>
<b><font color="#000000">File | Save as:</font></b></li>

<ul>
<li>
<font color="#000000">Like </font>the <font color="#000000"><b>File | Save</b>
menu, this menu saves the current document using the Current Document Encoding.
But if offers an opportunity for the user to saves it as a separate document
with a different name.</font></li>
</ul>

<li>
<b><font color="#000000">File | Save as Charset ... menu:</font></b></li>

<ul>
<li>
<font color="#000000">In addition to <b>File | Save</b> and <b>File Save
as...</b> menu items which also in Browser and Mail window, Editor/Composer
will have <b>File | Save as Charset ...</b> menu, which is not found in
the Browser or Mail window. This menu allows you to save the current document
using an encoding different from the Current Document Encoding.</font></li>

<li>
<font color="#000000">Note: It is possible to incorporate this function
in the <b>File | Save as... </b>menu but as of this writing, there is no
cross-platform widget to accommodate these 2 functions at the same time.
Thus, as a compromise, the selection of a charset is carried by this separate
menu and dialog window -- i.e. b</font>ring up an XPApps widget with charset
selection combobox<font color="#000000">.</font></li>
</ul>

<ul>
<ul>
<li>
<font color="#000000">When this menu is engaged, a window will pop up to
prompt you to name a title when there is no existing title for the document.&nbsp;
If the title of the document already exists, it will be filled in as the
default name. Note that the <b>title</b> of the document is the title in
the HTML document which appears between the tags, &lt;TITLE> and &lt;/TITLE>.</font></li>

<li>
<font color="#000000">The dialog window also contains a list of character
encodings to choose from. The default suggested will be the <b>Current
Document Charset</b>. The list is the same list as the regular charset
menu</font><font color="#FF0000">.</font></li>

<li>
<font color="#000000"><b>Note: </b>This dialog window does not list a format
choice, e.g. HTML or Plain text. The format choice will be left to the
<b>Save
as...</b> dialog window.</font></li>

<li>
<font color="#000000">When the charset is chosen from the dialog and the
"OK" button is pressed, this will bring up the <b>Save as...</b> window
(as defined above). The user then is able to choose a different encoding
than the Current Document Encoding.</font></li>
</ul>
</ul>

<ul>
<ul>
<ul>
<li>
<font color="#000000">Format:</font></li>

<ul>
<li>
<font color="#000000">In <b>HTML format</b>, the user can save the document
using any encoding. If the chosen encoding does not support characters
in the document, then NCRs will be used instead of raw bytes.&nbsp; (Note:
Mozilla will not warn the user of unreasonable conversion. (e.g. Japanese
document into ISO-8859-1.))</font></li>

<li>
<font color="#000000"><b>Plain text format:</b> As of this writing, there
is a bug in that all documents are saved as an HTML file even if the extension,
.txt, is supplied. Thus, the following is a specification for the future.</font></li>

<ul>
<li>
<font color="#000000">Under normal conditions, the system locale default
charset will be suggested to save the document for each language group
if the Current Document Encoding does not match the OS locale charset.
For example, Shift_JIS will be suggested when the user attempts to save
an EUC-JP document into a plain text format. (Note: I18n provides an API
for determining default charset for each language group under a specific
locale. (e.g. EUC-JP if the page is in Shift_JIS and the platform is Unix
EUC locale.) )</font></li>

<li>
<font color="#000000">For Macintosh, we need to suggest Mac-specific encoding
names for the ISO-8859-x family of encodings. For example, if the Current
Document Encoding is ISO-8859-1, then the default suggestion for the encoding
list should be MacRoman rather than ISO-8859-1. For Windows-1252 pages,
we should do the same, i.e. provide MacRoman as the default choice. If
offering MacRoman will corrupt the data, e.g. Windows-1252 proprietary
characters, then we will offer a dialog window explaining this and offering
a choice to save it as Windows-1252 page or as a MacRoman page with some
data corruption. We might also suggest that it should be saved as an HTML
page instead.</font></li>

<li>
<font color="#000000">If the user changes the default encoding suggestion
matching the Current Document Encoding, then we will honor the user's choice
and saves it in plain text format using that encoding selection. In this
case, there could be some data corruption or loss. We should put up a warning
dialog in cases when the characters contained in the document cannot be
supported by the chosen encoding. (Note that in HTML format, we will simply
use NCRs in such a case. This problem arises only for the plain text format.)</font></li>

<li>
There is one advantage of having two menus instead of one is that only
users who need to convert document encoding have to engage the 2nd menu.
Most users will simply select the first one without the encoding conversion
option.</li>
</ul>
</ul>
</ul>
</ul>
</ul>

<li>
<b><font color="#000000">Charset Override:</font></b><font color="#000000">
<b>Save as Charset ...</b> action under certain conditions could lead to
changing the existing Meta charset tag if it replaces the current document.
This amounts to a Charset Override as discussed below.</font></li>

<li>
<b><font color="#000000">Meta HTTP-Equiv Charset tag:</font></b></li>

<ul>
<li>
<font color="#000000">Every document must have an appropriate meta charset
tag or there must be a pre-existing valid meta charset tag in the document.
Such a meta tag must match the Current Document Charset.</font></li>

<li>
<b><font color="#000000">Charset Tag normalization: </font></b><font color="#000000">We
should correct a non-standard or alias charset name into the standard one
when an existing document is opened or saved. For example, <b>x-sjis</b>
will be changed to <b>Shift_JIS</b>. (Open issue: Should we allow the user
to retain a non-standard name? If we allow this option, we might want to
offer a dialog asking the user to approve of the normalization. If the
user says yes, then the existing tag will be normalized. Otherwise, we
will leave it the same as before.)</font></li>

<li>
<font color="#000000">In our code, the meta charset tag is actually generated
when creating a DOM tree. Thus, it is not necessary to save a document
to see the change in the meta-tag. For example, View | Page Source should
always reflect the correct meta charset tag even if the document has not
been saved.</font></li>
</ul>
</ul>
<a NAME="saveascharmenu"></a>
<p><b><font color="#000000">Illustration of "File | Save as Charset ..."
dialog:</font></b>
<p><img SRC="saveaschar.jpg" height=338 width=230>
<br>&nbsp;
<br>&nbsp;
<p><a NAME="menuactions"></a>
<h2>
<b>Meaning of Character Coding menu related actions:</b></h2>

<p><br><a NAME="opennewdoc"></a>
<p><b>1. Opening a new document:</b>
<ul>
<li>
A new document will open with the Character Encoding set to the Default
Encoding determined by the user's default language. (i.e. <b>Edit | Preferences
| Navigator | Languages | Character Coding</b>). The Default Encoding is
discussed in the Browser document under a section called "Fallback Encoding".
In the <b>prefs.js</b> file, the value of this item is represented by <b>intl.charset.default</b>.</li>

<li>
The user can change the Current Document Encoding as many times as he/she
wishes as long as no data has been input.</li>
</ul>
<a NAME="openexistdoc"></a>
<p><b>2. Opening an existing document directly into Editor:</b>
<ul>
<li>
An existing document with a document Meta HTTP-Equiv charset tag will open
with the meta charset value in the document as the Current Document Encoding.
If a valid alias of a known charset is used in the original document, that
tag will be normalized with a dialog asking for permission when opening
an existing document. If the user refuses the offer, we will use the original
meta charset.</li>

<li>
An existing document with HTTP charset information will open with the specified
value obtained from the sever as the Current Document Encoding.</li>

<li>
An existing document with both HTTP and document Meta HTTP-Equiv charset
info will open with the HTTP value obtained from the server as the Current
Document Encoding. (i.e. If the 2 values are not identical, the HTTP value
will predominate.)</li>

<li>
An existing document with neither the HTTP nor Document Meta HTTP-Equiv
charset information will open with the Default Encoding as specified in
<b>Edit
| Preferences | Navigator | Languages | Character Coding </b>as the Current
Document Encoding..</li>

<ul>
<li>
If the user has selected an auto-charset detection module, it will determine
the Current Document Charset unless it fails to detect the encoding. In
the latter case, the Default Encoding as specified in <b>Edit | Preferences
| Navigator | Languages | Character Coding</b> will be used as the Current
Document Encoding.</li>
</ul>

<li>
If an existing document has an unknown or incorrect Meta-charset tag: (This
does not include the case where the document bears an alias of a valid
charset name.)</li>

<ul>
<li>
We will present a dialog: "Editor does not recognize 'ISO-8849-1' as a
valid charset. This document will open in your default charset: Shift_JIS.
Please correct the error with the <b>Reload in Character Encoding</b> menu."</li>
</ul>
</ul>
<a NAME="openviabrowser"></a>
<p><b>3. Opening an existing document via Browser's "Edit" menu:</b>
<ul>
<li>
An existing document will open with the Current Document Charset as determined
by Browser.</li>

<li>
In reality, the Character Encoding values here would be nearly identical
to the cases in 2 above.</li>
</ul>
<a NAME="changecharset"></a>
<p><b><font color="#000000">4. Changing Charset/Character Coding selection:</font></b>
<p><b><font color="#FF0000">Note on 'Dirty' document: </font></b><font color="#000000">We&nbsp;
will gray out the Charset menu in all cases where an action&nbsp; is equivalent
to 'saving the document'. We call such a state of the document as 'dirty'.
Strictly speaking, when a meta-charset is created in a new document in
the DOM tree, such a document is already 'dirty'. This is actually the
definition used in the Editor code. But for the purpose of Character Coding
menu UI specifications, being 'dirty' must include actual HTML data changes.
Simply changing the Character Coding menu (i.e. reloading the document
using the new encoding) will be excluded from this criteria.</font>
<p><b><font color="#000000">Menu enabled or disabled ? -- Two general principles
are as follows:</font></b>
<ul>
<li>
<font color="#000000">The charset menu will be <b>disabled</b> in all cases
in the Editor except when the document is <b>not dirty</b> (i.e. just saved,
just opened (either a new or existing document), or just reloaded -- with
no further new input). See the next section for the cases when the Editor
Character Coding menu will be disabled.</font></li>

<li>
<font color="#000000">When the charset menu is <b>enabled</b> in the editor,
selecting one of the charsets in the menu will cause the editor to reload
the current document assuming the newly selected charset as the source
charset. The Charset (tag) will be overridden if the document has a valid/known
document HTTP-Equiv meta-tag. See the next section for the cases when the
Editor Character Coding menu will be disabled.</font></li>
</ul>

<p><br><a NAME="menustatus"></a>
<p><b><font color="#000000">These 2 principles will cover the following
sorts of specific cases:</font></b>
<ul>
<li>
<b><font color="#000000">Menu Enabled for changing/reloading:</font></b></li>

<ul>
<li>
<font color="#000000">On&nbsp; a new document meeting if there has been
no input. This is a fairly common practice by the user. As long as there
has been no new input, the user should be able to reload as many times
as he/she wishes.</font></li>

<li>
<font color="#000000">On an existing document without document HTTP-Equiv
meta-tag and prior to any additional input -- this includes a state where
the user has just reloaded the document but with no further input. We will
allow an infinite number of reloading as long as the document has not had
new input.</font></li>

<li>
<font color="#000000">The following reloading is allowed but will lead
to changing an existing document HTTP-Equiv charset tag, i.e. <b>Charset
Override</b> as described in the section on Charset Override below..</font></li>

<ul>
<li>
<font color="#000000">Menu change on an existing document with </font>a
valid/known document HTTP-Equiv meta-tag and <font color="#000000">prior
to additional input -- this includes a state where the user has just saved
the document.</font></li>
</ul>
</ul>

<li>
<b><font color="#000000">Menu Disabled/Grayed out: </font></b><font color="#FF0000">The
following situations will not allow a change in</font> the <b>View | Character&nbsp;
Encoding</b> menu, i.e. the document is in 'dirty' state:</li>

<ul>
<li>
<font color="#000000">On a new document -- when there has been some input
under a selected charset.&nbsp; Save this document first, or use the <b>Save
as Charset...</b> menu instead.</font></li>

<li>
On an existing document after input has been made but the document has
not been saved yet. Either <font color="#000000">Save this document first,
or use the <b>Save as Charset...</b> menu instead.</font></li>
</ul>
</ul>
<a NAME="selectautodetect"></a>
<p><b><font color="#000000">5. Selecting Auto-Detection:</font></b>
<ul>
<li>
<font color="#000000">When opening a new document, if auto-detection module
is selected, Mozilla will open with the Default Encoding as the Current
Document Encoding.</font></li>

<li>
<b><font color="#000000">Selecting Auto-Detect menu which contains no saved
data, i.e. a new document:</font></b></li>

<ul>
<li>
<font color="#000000">Auto-detection in the context of Editor makes sense
only if the document contains existing/saved data.</font></li>

<ul>
<li>
<font color="#000000">Therefore, the Current Document Encoding will not
be changed it this case.</font></li>

<ul>
<li>
<font color="#000000">(OPen issue: There could be an alert dialog in such
a case: "You cannot use Auto-Detection on a document with no data in it."&nbsp;
There will be only one "OK" button in this dialog and when "OK" is clicked
on, it will return to the new document without any further action. That
is the Current Document Encoding will not be changed.)</font></li>
</ul>
</ul>

<li>
<font color="#000000">If Auto-detection menu is chosen on a new document
which contains some input but so far has not been saved, then we should</font></li>

<ul>
<li>
<font color="#000000">have the auto-detection have no effect -- i.e. the
Current Document Encoding will not be changed.</font></li>
</ul>

<li>
<font color="#000000">If the user has only a Browser or Mail window open
and then opens a brand new Editor document, and if an Auto-Detection module
is ON, then the new document will open with the Default Encoding -- since
there is no detection needed. (See section 1 "</font><b>Opening a new document:</b>"
above.)</li>
</ul>

<li>
<b><font color="#000000">Selecting Auto-Detect menu which contains saved/pre-existing
data but no charset specified or sent from a HHTP server.</font></b></li>

<ul>
<li>
<font color="#000000">This action should reload the document assuming the
charset determined by the auto-detection process.</font></li>

<li>
<font color="#000000">If for some reason, auto-detection fails, then the
Default/Fallback Encoding will be used.</font></li>
</ul>

<li>
<b><font color="#000000">Selecting Auto-Detect menu which contains saved/pre-existing
data with the charset specified:</font></b></li>

<ul>
<li>
<font color="#000000"><b>Note: </b>As of this writing, changing an auto-detection
menu does not override an existing charset tag or HHTP charset from the
server. So what is written below is a future specification.</font></li>

<ul>
<li>
<font color="#000000">If the result of Auto-Detection agrees with the current
charset value, then nothing further happens.</font></li>

<li>
<font color="#000000">If the result of Auto-Detection is different from
the current charset, then this is a case of Charset Override. Convert/save
the document assuming the newly detected charset. --> See the next section.</font></li>
</ul>
</ul>

<li>
<b><font color="#FF0000">Note: </font></b><font color="#000000">Auto-detection
on opening an existing document has been covered in section titled: "</font><b>2.
Opening an existing document directly into Editor:</b>"</li>
</ul>

<h3>
<a NAME="override"></a></h3>

<h3>
<b><font color="#000000">Charset (Tag) Override: </font></b>a catalog of
cases.</h3>
<b><font color="#000000">For Editor: </font></b>Any time we encounter a
condition in which the Editor potentially needs to <b>change the pre-existing
document HTTP Meta-Equiv tag</b>, we have a case of Charset Override. The
following catalogs these cases and the expected Editor actions. Alternatively,
we might simply convert the document's encoding using NCR's if necessary.
<b>In
the current implementation, this latter option is in force.</b>
<blockquote><b>Expected Action 1: </b>Change the Current Document Encoding
(bullet mark) and the meta tag in the DOM tree (and eventually save it
in this encoding). If there are characters not supported in the chosen
encoding. They will be converted to NERs or NCRs.
<p><b>Expected Action 2: </b>Change the Document Encoding of the target
document. If there are characters not supported in the chosen encoding.
They will be converted to NERs or NCRs. If the same name as the original
document is chosen, then when this file is saved using a new encoding,
the Current Document Encoding of the open document will be changed and
it will be reloaded. If it saved into a different file, the current document
will stay open with no change.
<p><b>Expected Action 3: </b>Present a warning dialog that the Charset
tag is either incorrect or unknown to Mozilla, and ask the user to try
the <b>View | Character Coding</b>&nbsp; menu changes to correct it after
the document is opened but with a warning that such attempts may not succeed
sometimes, i.e. we just may not support the encoding used in the original
document.&nbsp; Offer <b>OK</b> or <b>Cancel</b> as the choices. If <b>OK</b>
is selected, Editor will then open this document in the user's Default
Encoding. If <b>Cancel</b> is selected, Editor will quit.</blockquote>

<ul>
<li>
<b>Upon opening a new document,</b></li>

<ul>
<li>
If the document's Charset tag is unknown to Mozilla or seems to be incorrect.
--> <b>Action 3.</b></li>
</ul>

<li>
<b>View | Character Coding ... menu change:</b></li>

<ul>
<li>
When the user changes the menu and if the document's current Meta Charset
tag is different from the menu selection. --> <b>Action 1</b>.</li>
</ul>

<li>
<b><font color="#000000">Save as Charset... Menu:</font></b></li>

<ul>
<li>
<font color="#000000">The user has selected a charset different from the
existing charset tag, and conversion is reasonable. (e.g. Shift_JIS ->
EUC-JP, BIG5 -> UTF-8, etc.) --> </font><b>Simply save it using NCR's if
necessary so as not to corrupt data. (Action 2).</b></li>

<li>
<font color="#000000">The user has selected a charset different from the
existing charset tag, but conversion is unreasonable. (e.g. Korean -->
Shift_JIS, etc.) --> </font><b>Simply save it using NCR's if necessary
so as not to corrupt data. (Action 2). </b>As of this writing, we don't
offer a warning dialog in this case.</li>
</ul>

<li>
<b>View | Character Coding&nbsp; | Auto-Detect menu change:</b></li>

<ul>
<li>
This discussion is for future. As of this writing, Auto-detection change
cannot effect a change in an existing document with an existing meta-charset
tag.</li>

<ul>
<li>
If the result of Auto-detection contradicts the current charset value -->
<b>Action
1.</b></li>
</ul>
</ul>
</ul>
<b><font color="#000000">For Messenger Mail Editor:</font></b>
<ul>
<li>
<font color="#000000">When the user switches a Character Coding menu,</font></li>

<ul>
<li>
<font color="#000000">This will be equivalent to "send in the chosen charset".</font></li>

<li>
<font color="#000000">There should be a warning against unreasonable "send
charset" for given input. e.g. Western encoding for Japanese input.</font></li>
</ul>
</ul>




<hr class="hide">
</div>
</div>
<div id="footer">
<ul>
<li><a href="../../../sitemap.html">Site Map</a></li>
<li><a href="../../../security/">Security Updates</a></li>
<li><a href="../../../contact/">Contact Us</a></li>
<li><a href="../../../foundation/donate.html">Donate</a></li>
</ul>
<p class="copyright">
Portions of this content are &copy; 1998&#8211;2009 by individual mozilla.org
contributors; content available under a Creative Commons license | <a
href="http://www.mozilla.org/foundation/licensing/website-content.html">Details</a>.</p>
<p>
<span>Last modified May 23,  2002</span>
<span><a href="http://bonsai-www.mozilla.org/cvslog.cgi?file=mozilla-org/html/projects/intl/uidocs/editorcharmenu.html&amp;rev=&amp;root=/www/">Document History</a></span>
</p>
</div>
</div>
</body>
</html>
